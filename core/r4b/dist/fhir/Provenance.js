// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR Resource: Provenance
import * as fhir from '../fhir.js';
// @ts-ignore
import { ProvenanceEntityRoleVsValidation } from '../fhirValueSets/ProvenanceEntityRoleVsValidation.js';
/**
 * Several agents may be associated (i.e. has some responsibility for an activity) with an activity and vice-versa.
 */
export class ProvenanceAgent extends fhir.BackboneElement {
    /**
     * Default constructor for ProvenanceAgent - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        if (source['role']) {
            this.role = source.role.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.role = [];
        }
        if (source['who']) {
            this.who = new fhir.Reference(source.who);
        }
        else {
            this.who = null;
        }
        if (source['onBehalfOf']) {
            this.onBehalfOf = new fhir.Reference(source.onBehalfOf);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance.agent';
        }
        this.vOS('type', exp);
        this.vOA('role', exp);
        this.vRS('who', exp);
        this.vOS('onBehalfOf', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ProvenanceAgent._fts_dataType = 'ProvenanceAgent';
/**
 * An entity used in this activity.
 */
export class ProvenanceEntity extends fhir.BackboneElement {
    /**
     * Default constructor for ProvenanceEntity - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['role']) {
            this.role = new fhir.FhirCode({ value: source.role });
        }
        else {
            this.role = null;
        }
        if (source['_role']) {
            if (this.role) {
                this.role.addExtendedProperties(source._role);
            }
            else {
                this.role = new fhir.FhirCode(source._role);
            }
        }
        if (source['what']) {
            this.what = new fhir.Reference(source.what);
        }
        else {
            this.what = null;
        }
        if (source['agent']) {
            this.agent = source.agent.map((x) => new fhir.ProvenanceAgent(x));
        }
        else {
            this.agent = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance.entity';
        }
        this.vRSV('role', exp, 'ProvenanceEntityRole', ProvenanceEntityRoleVsValidation, 'r');
        this.vRS('what', exp);
        this.vOA('agent', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ProvenanceEntity._fts_dataType = 'ProvenanceEntity';
/**
 * Provenance of a resource is a record that describes entities and processes involved in producing and delivering or otherwise influencing that resource. Provenance provides a critical foundation for assessing authenticity, enabling trust, and allowing reproducibility. Provenance assertions are a form of contextual metadata and can themselves become important records with their own provenance. Provenance statement indicates clinical significance in terms of confidence in authenticity, reliability, and trustworthiness, integrity, and stage in lifecycle (e.g. Document Completion - has the artifact been legally authenticated), all of which may impact security, privacy, and trust policies.
 */
export class Provenance extends fhir.DomainResource {
    /**
     * Default constructor for Provenance - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Provenance';
        if (source['target']) {
            this.target = source.target.map((x) => new fhir.Reference(x));
        }
        else {
            this.target = [];
        }
        if (source['occurred']) {
            this.occurred = source.occurred;
        }
        else if (source['occurredPeriod']) {
            this.occurred = new fhir.Period(source.occurredPeriod);
        }
        else if (source['occurredDateTime']) {
            this.occurred = new fhir.FhirDateTime({ value: source.occurredDateTime });
        }
        if (source['recorded']) {
            this.recorded = new fhir.FhirInstant({ value: source.recorded });
        }
        else {
            this.recorded = null;
        }
        if (source['_recorded']) {
            if (this.recorded) {
                this.recorded.addExtendedProperties(source._recorded);
            }
            else {
                this.recorded = new fhir.FhirInstant(source._recorded);
            }
        }
        if (source['policy']) {
            this.policy = source.policy.map((x) => new fhir.FhirUri({ value: x }));
        }
        else {
            this.policy = [];
        }
        if (source['_policy']) {
            source._policy.forEach((x, i) => {
                if (this.policy.length >= i) {
                    if (x) {
                        this.policy[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.policy.push(new fhir.FhirUri(x));
                    }
                }
            });
        }
        if (source['location']) {
            this.location = new fhir.Reference(source.location);
        }
        if (source['reason']) {
            this.reason = source.reason.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.reason = [];
        }
        if (source['activity']) {
            this.activity = new fhir.CodeableConcept(source.activity);
        }
        if (source['agent']) {
            this.agent = source.agent.map((x) => new fhir.ProvenanceAgent(x));
        }
        else {
            this.agent = [];
        }
        if (source['entity']) {
            this.entity = source.entity.map((x) => new fhir.ProvenanceEntity(x));
        }
        else {
            this.entity = [];
        }
        if (source['signature']) {
            this.signature = source.signature.map((x) => new fhir.Signature(x));
        }
        else {
            this.signature = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance';
        }
        this.vRS('resourceType', exp);
        this.vRA('target', exp);
        this.vOS('occurred', exp);
        this.vRS('recorded', exp);
        this.vOA('policy', exp);
        this.vOS('location', exp);
        this.vOA('reason', exp);
        this.vOS('activity', exp);
        this.vRA('agent', exp);
        this.vOA('entity', exp);
        this.vOA('signature', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Provenance._fts_dataType = 'Provenance';
/**
 * Internal flag to properly serialize choice-type element Provenance.occurred[x]
 */
Provenance._fts_occurredIsChoice = true;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHJvdmVuYW5jZS5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvUHJvdmVuYW5jZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsZ0RBQWdEO0FBQ2hELGtDQUFrQztBQUNsQyw0QkFBNEI7QUFFNUIsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFZbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSxnQ0FBZ0MsRUFBRSxNQUFNLHNEQUFzRCxDQUFDO0FBK0J4Rzs7R0FFRztBQUNILE1BQU0sT0FBTyxlQUFnQixTQUFRLElBQUksQ0FBQyxlQUFlO0lBcUJ2RDs7T0FFRztJQUNILFlBQVksU0FBc0MsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDNUYsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUFFO1FBQzFFLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNuRjtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDeEIsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7U0FBRTthQUM1RDtZQUFFLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDO1NBQUU7UUFDekIsSUFB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RyxDQUFDLENBQUE7UUFDckIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDdEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDekIsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUExR0Q7O0dBRUc7QUFDNkIsd0JBQWEsR0FBVSxZQUFZLENBQUM7QUFhcEU7O0dBRUc7QUFDdUIsZ0NBQXFCLEdBQVEsSUFBSSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0Yi5jb3JlIHZlcnNpb246IDQuMy4wXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogUHJvdmVuYW5jZVxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUHJvdmVuYW5jZUFnZW50VHlwZUNvZGVzLCAgUHJvdmVuYW5jZUFnZW50VHlwZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9Qcm92ZW5hbmNlQWdlbnRUeXBlQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFByb3ZlbmFuY2VBZ2VudFR5cGVWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Byb3ZlbmFuY2VBZ2VudFR5cGVWc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFNlY3VyaXR5Um9sZVR5cGVDb2RlcywgIFNlY3VyaXR5Um9sZVR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvU2VjdXJpdHlSb2xlVHlwZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBTZWN1cml0eVJvbGVUeXBlVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TZWN1cml0eVJvbGVUeXBlVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBQcm92ZW5hbmNlRW50aXR5Um9sZUNvZGVzLCAgUHJvdmVuYW5jZUVudGl0eVJvbGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUHJvdmVuYW5jZUVudGl0eVJvbGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUHJvdmVuYW5jZUVudGl0eVJvbGVWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Byb3ZlbmFuY2VFbnRpdHlSb2xlVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBWM1B1cnBvc2VPZlVzZUNvZGVzLCAgVjNQdXJwb3NlT2ZVc2VDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvVjNQdXJwb3NlT2ZVc2VDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgVjNQdXJwb3NlT2ZVc2VWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1YzUHVycG9zZU9mVXNlVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBQcm92ZW5hbmNlQWN0aXZpdHlUeXBlQ29kZXMsICBQcm92ZW5hbmNlQWN0aXZpdHlUeXBlQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Byb3ZlbmFuY2VBY3Rpdml0eVR5cGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUHJvdmVuYW5jZUFjdGl2aXR5VHlwZVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUHJvdmVuYW5jZUFjdGl2aXR5VHlwZVZzVmFsaWRhdGlvbi5qcyc7XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBQcm92ZW5hbmNlQWdlbnQgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmVuYW5jZUFnZW50QXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogRm9yIGV4YW1wbGU6IGF1dGhvciwgcGVyZm9ybWVyLCBlbnRlcmVyLCBhdHRlc3RlciwgZXRjLlxyXG4gICAqL1xyXG4gIHR5cGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEZvciBleGFtcGxlOiBkb2N0b3IsIG51cnNlLCBjbGVyaywgZXRjLlxyXG4gICAqL1xyXG4gIHJvbGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogd2hvSWRlbnRpdHkgc2hvdWxkIGJlIHVzZWQgd2hlbiB0aGUgYWdlbnQgaXMgbm90IGEgUmVzb3VyY2UgdHlwZS5cclxuICAgKi9cclxuICB3aG86IGZoaXIuUmVmZXJlbmNlQXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIG9uQmVoYWxmT2ZJZGVudGl0eSBzaG91bGQgYmUgdXNlZCB3aGVuIHRoZSBhZ2VudCBpcyBub3QgYSBSZXNvdXJjZSB0eXBlLlxyXG4gICAqL1xyXG4gIG9uQmVoYWxmT2Y/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogU2V2ZXJhbCBhZ2VudHMgbWF5IGJlIGFzc29jaWF0ZWQgKGkuZS4gaGFzIHNvbWUgcmVzcG9uc2liaWxpdHkgZm9yIGFuIGFjdGl2aXR5KSB3aXRoIGFuIGFjdGl2aXR5IGFuZCB2aWNlLXZlcnNhLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFByb3ZlbmFuY2VBZ2VudCBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ1Byb3ZlbmFuY2VBZ2VudCc7XHJcbiAgLyoqXHJcbiAgICogRm9yIGV4YW1wbGU6IGF1dGhvciwgcGVyZm9ybWVyLCBlbnRlcmVyLCBhdHRlc3RlciwgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0eXBlPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEZvciBleGFtcGxlOiBkb2N0b3IsIG51cnNlLCBjbGVyaywgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByb2xlOiBmaGlyLkNvZGVhYmxlQ29uY2VwdFtdO1xyXG4gIC8qKlxyXG4gICAqIHdob0lkZW50aXR5IHNob3VsZCBiZSB1c2VkIHdoZW4gdGhlIGFnZW50IGlzIG5vdCBhIFJlc291cmNlIHR5cGUuXHJcbiAgICovXHJcbiAgcHVibGljIHdobzogZmhpci5SZWZlcmVuY2V8bnVsbDtcclxuICAvKipcclxuICAgKiBvbkJlaGFsZk9mSWRlbnRpdHkgc2hvdWxkIGJlIHVzZWQgd2hlbiB0aGUgYWdlbnQgaXMgbm90IGEgUmVzb3VyY2UgdHlwZS5cclxuICAgKi9cclxuICBwdWJsaWMgb25CZWhhbGZPZj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBQcm92ZW5hbmNlQWdlbnQgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxQcm92ZW5hbmNlQWdlbnRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UudHlwZSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3JvbGUnXSkgeyB0aGlzLnJvbGUgPSBzb3VyY2Uucm9sZS5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnJvbGUgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnd2hvJ10pIHsgdGhpcy53aG8gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLndobyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLndobyA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ29uQmVoYWxmT2YnXSkgeyB0aGlzLm9uQmVoYWxmT2YgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLm9uQmVoYWxmT2YpOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnUHJvdmVuYW5jZS5hZ2VudCcgfVxyXG4gICAgdGhpcy52T1MoJ3R5cGUnLGV4cClcclxuICAgIHRoaXMudk9BKCdyb2xlJyxleHApXHJcbiAgICB0aGlzLnZSUygnd2hvJyxleHApXHJcbiAgICB0aGlzLnZPUygnb25CZWhhbGZPZicsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFByb3ZlbmFuY2VFbnRpdHkgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmVuYW5jZUVudGl0eUFyZ3MgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIEhvdyB0aGUgZW50aXR5IHdhcyB1c2VkIGR1cmluZyB0aGUgYWN0aXZpdHkuXHJcbiAgICovXHJcbiAgcm9sZTogZmhpci5GaGlyQ29kZTxQcm92ZW5hbmNlRW50aXR5Um9sZUNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBQcm92ZW5hbmNlLmVudGl0eS5yb2xlXHJcbiAgICovXHJcbiAgX3JvbGU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIHdoYXRJZGVudGl0eSBzaG91bGQgYmUgdXNlZCBmb3IgZW50aXRpZXMgdGhhdCBhcmUgbm90IGEgUmVzb3VyY2UgdHlwZS5cclxuICAgKi9cclxuICB3aGF0OiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBBIHVzZWNhc2Ugd2hlcmUgb25lIFByb3ZlbmFuY2UuZW50aXR5LmFnZW50IGlzIHVzZWQgd2hlcmUgdGhlIEVudGl0eSB0aGF0IHdhcyB1c2VkIGluIHRoZSBjcmVhdGlvbi91cGRhdGluZyBvZiB0aGUgVGFyZ2V0LCBpcyBub3QgaW4gdGhlIGNvbnRleHQgb2YgdGhlIHNhbWUgY3VzdG9kaWFuc2hpcCBhcyB0aGUgVGFyZ2V0LCBhbmQgdGh1cyB0aGUgbWVhbmluZyBvZiBQcm92ZW5hbmNlLmVudGl0eS5hZ2VudCBpcyB0byBzYXkgdGhhdCB0aGUgZW50aXR5IHJlZmVyZW5jZWQgaXMgbWFuYWdlZCBlbHNld2hlcmUgYW5kIHRoYXQgdGhpcyBBZ2VudCBwcm92aWRlZCBhY2Nlc3MgdG8gaXQuICBUaGlzIHdvdWxkIGJlIHNpbWlsYXIgdG8gd2hlcmUgdGhlIEVudGl0eSBiZWluZyByZWZlcmVuY2VkIGlzIG1hbmFnZWQgb3V0c2lkZSBGSElSLCBzdWNoIGFzIHRocm91Z2ggSEw3IHYyLCB2Mywgb3IgWERTLiBUaGlzIG1pZ2h0IGJlIHdoZXJlIHRoZSBFbnRpdHkgYmVpbmcgcmVmZXJlbmNlZCBpcyBtYW5hZ2VkIGluIGFub3RoZXIgRkhJUiByZXNvdXJjZSBzZXJ2ZXIuIFRodXMgaXQgZXhwbGFpbnMgdGhlIFByb3ZlbmFuY2Ugb2YgdGhhdCBFbnRpdHkncyB1c2UgaW4gdGhlIGNvbnRleHQgb2YgdGhpcyBQcm92ZW5hbmNlIGFjdGl2aXR5LlxyXG4gICAqL1xyXG4gIGFnZW50PzogZmhpci5Qcm92ZW5hbmNlQWdlbnRBcmdzW118dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogQW4gZW50aXR5IHVzZWQgaW4gdGhpcyBhY3Rpdml0eS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBQcm92ZW5hbmNlRW50aXR5IGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnUHJvdmVuYW5jZUVudGl0eSc7XHJcbiAgLyoqXHJcbiAgICogSG93IHRoZSBlbnRpdHkgd2FzIHVzZWQgZHVyaW5nIHRoZSBhY3Rpdml0eS5cclxuICAgKi9cclxuICBwdWJsaWMgcm9sZTogZmhpci5GaGlyQ29kZTxQcm92ZW5hbmNlRW50aXR5Um9sZUNvZGVUeXBlPnxudWxsO1xyXG4gIC8qKlxyXG4gICAqIHdoYXRJZGVudGl0eSBzaG91bGQgYmUgdXNlZCBmb3IgZW50aXRpZXMgdGhhdCBhcmUgbm90IGEgUmVzb3VyY2UgdHlwZS5cclxuICAgKi9cclxuICBwdWJsaWMgd2hhdDogZmhpci5SZWZlcmVuY2V8bnVsbDtcclxuICAvKipcclxuICAgKiBBIHVzZWNhc2Ugd2hlcmUgb25lIFByb3ZlbmFuY2UuZW50aXR5LmFnZW50IGlzIHVzZWQgd2hlcmUgdGhlIEVudGl0eSB0aGF0IHdhcyB1c2VkIGluIHRoZSBjcmVhdGlvbi91cGRhdGluZyBvZiB0aGUgVGFyZ2V0LCBpcyBub3QgaW4gdGhlIGNvbnRleHQgb2YgdGhlIHNhbWUgY3VzdG9kaWFuc2hpcCBhcyB0aGUgVGFyZ2V0LCBhbmQgdGh1cyB0aGUgbWVhbmluZyBvZiBQcm92ZW5hbmNlLmVudGl0eS5hZ2VudCBpcyB0byBzYXkgdGhhdCB0aGUgZW50aXR5IHJlZmVyZW5jZWQgaXMgbWFuYWdlZCBlbHNld2hlcmUgYW5kIHRoYXQgdGhpcyBBZ2VudCBwcm92aWRlZCBhY2Nlc3MgdG8gaXQuICBUaGlzIHdvdWxkIGJlIHNpbWlsYXIgdG8gd2hlcmUgdGhlIEVudGl0eSBiZWluZyByZWZlcmVuY2VkIGlzIG1hbmFnZWQgb3V0c2lkZSBGSElSLCBzdWNoIGFzIHRocm91Z2ggSEw3IHYyLCB2Mywgb3IgWERTLiBUaGlzIG1pZ2h0IGJlIHdoZXJlIHRoZSBFbnRpdHkgYmVpbmcgcmVmZXJlbmNlZCBpcyBtYW5hZ2VkIGluIGFub3RoZXIgRkhJUiByZXNvdXJjZSBzZXJ2ZXIuIFRodXMgaXQgZXhwbGFpbnMgdGhlIFByb3ZlbmFuY2Ugb2YgdGhhdCBFbnRpdHkncyB1c2UgaW4gdGhlIGNvbnRleHQgb2YgdGhpcyBQcm92ZW5hbmNlIGFjdGl2aXR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhZ2VudDogZmhpci5Qcm92ZW5hbmNlQWdlbnRbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBQcm92ZW5hbmNlRW50aXR5IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8UHJvdmVuYW5jZUVudGl0eUFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWydyb2xlJ10pIHsgdGhpcy5yb2xlID0gbmV3IGZoaXIuRmhpckNvZGU8UHJvdmVuYW5jZUVudGl0eVJvbGVDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2Uucm9sZX0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5yb2xlID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3JvbGUnXSkge1xyXG4gICAgICBpZiAodGhpcy5yb2xlKSB7IHRoaXMucm9sZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9yb2xlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMucm9sZSA9IG5ldyBmaGlyLkZoaXJDb2RlPFByb3ZlbmFuY2VFbnRpdHlSb2xlQ29kZVR5cGU+KHNvdXJjZS5fcm9sZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnd2hhdCddKSB7IHRoaXMud2hhdCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2Uud2hhdCk7IH1cclxuICAgIGVsc2UgeyB0aGlzLndoYXQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydhZ2VudCddKSB7IHRoaXMuYWdlbnQgPSBzb3VyY2UuYWdlbnQubWFwKCh4KSA9PiBuZXcgZmhpci5Qcm92ZW5hbmNlQWdlbnQoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5hZ2VudCA9IFtdOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnUHJvdmVuYW5jZS5lbnRpdHknIH1cclxuICAgIHRoaXMudlJTVigncm9sZScsZXhwLCdQcm92ZW5hbmNlRW50aXR5Um9sZScsUHJvdmVuYW5jZUVudGl0eVJvbGVWc1ZhbGlkYXRpb24sJ3InKVxyXG4gICAgdGhpcy52UlMoJ3doYXQnLGV4cClcclxuICAgIHRoaXMudk9BKCdhZ2VudCcsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFByb3ZlbmFuY2UgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmVuYW5jZUFyZ3MgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlQXJncyB7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcmVzb3VyY2VUeXBlOiBcIlByb3ZlbmFuY2VcInx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGFyZ2V0IHJlZmVyZW5jZXMgYXJlIHVzdWFsbHkgdmVyc2lvbiBzcGVjaWZpYywgYnV0IG1pZ2h0IG5vdCBiZSwgaWYgYSB2ZXJzaW9uIGhhcyBub3QgYmVlbiBhc3NpZ25lZCBvciBpZiB0aGUgcHJvdmVuYW5jZSBpbmZvcm1hdGlvbiBpcyBwYXJ0IG9mIHRoZSBzZXQgb2YgcmVzb3VyY2VzIGJlaW5nIG1haW50YWluZWQgKGkuZS4gYSBkb2N1bWVudCkuIFdoZW4gdXNpbmcgdGhlIFJFU1RmdWwgQVBJLCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG1pZ2h0IG5vdCBiZSBrbm93biAoZXNwZWNpYWxseSBub3QgdGhlIHZlcnNpb24gc3BlY2lmaWMgb25lKTsgdGhlIGNsaWVudCBtYXkgZWl0aGVyIHN1Ym1pdCB0aGUgcmVzb3VyY2UgZmlyc3QsIGFuZCB0aGVuIHRoZSBwcm92ZW5hbmNlLCBvciBpdCBtYXkgc3VibWl0IGJvdGggdXNpbmcgYSBzaW5nbGUgdHJhbnNhY3Rpb24uIFNlZSB0aGUgbm90ZXMgb24gdHJhbnNhY3Rpb24gZm9yIGZ1cnRoZXIgZGlzY3Vzc2lvbi5cclxuICAgKi9cclxuICB0YXJnZXQ6IGZoaXIuUmVmZXJlbmNlQXJnc1tdfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBlcmlvZCBjYW4gYmUgYSBsaXR0bGUgYXJiaXRyYXJ5OyB3aGVyZSBwb3NzaWJsZSwgdGhlIHRpbWUgc2hvdWxkIGNvcnJlc3BvbmQgdG8gaHVtYW4gYXNzZXNzbWVudCBvZiB0aGUgYWN0aXZpdHkgdGltZS5cclxuICAgKi9cclxuICBvY2N1cnJlZD86IGZoaXIuUGVyaW9kfGZoaXIuRmhpckRhdGVUaW1lfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcGVyaW9kIGNhbiBiZSBhIGxpdHRsZSBhcmJpdHJhcnk7IHdoZXJlIHBvc3NpYmxlLCB0aGUgdGltZSBzaG91bGQgY29ycmVzcG9uZCB0byBodW1hbiBhc3Nlc3NtZW50IG9mIHRoZSBhY3Rpdml0eSB0aW1lLlxyXG4gICAqL1xyXG4gIG9jY3VycmVkUGVyaW9kPzogZmhpci5QZXJpb2RBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcGVyaW9kIGNhbiBiZSBhIGxpdHRsZSBhcmJpdHJhcnk7IHdoZXJlIHBvc3NpYmxlLCB0aGUgdGltZSBzaG91bGQgY29ycmVzcG9uZCB0byBodW1hbiBhc3Nlc3NtZW50IG9mIHRoZSBhY3Rpdml0eSB0aW1lLlxyXG4gICAqL1xyXG4gIG9jY3VycmVkRGF0ZVRpbWU/OiBmaGlyLkZoaXJEYXRlVGltZXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgY2FuIGJlIGEgbGl0dGxlIGRpZmZlcmVudCBmcm9tIHRoZSB0aW1lIHN0YW1wIG9uIHRoZSByZXNvdXJjZSBpZiB0aGVyZSBpcyBhIGRlbGF5IGJldHdlZW4gcmVjb3JkaW5nIHRoZSBldmVudCBhbmQgdXBkYXRpbmcgdGhlIHByb3ZlbmFuY2UgYW5kIHRhcmdldCByZXNvdXJjZS5cclxuICAgKi9cclxuICByZWNvcmRlZDogZmhpci5GaGlySW5zdGFudHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBQcm92ZW5hbmNlLnJlY29yZGVkXHJcbiAgICovXHJcbiAgX3JlY29yZGVkPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBGb3IgZXhhbXBsZTogV2hlcmUgYW4gT0F1dGggdG9rZW4gYXV0aG9yaXplcywgdGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZyb20gdGhlIE9BdXRoIHRva2VuIGlzIHBsYWNlZCBpbnRvIHRoZSBwb2xpY3kgZWxlbWVudCBXaGVyZSBhIHBvbGljeSBlbmdpbmUgKGUuZy4gWEFDTUwpIGhvbGRzIHBvbGljeSBsb2dpYywgdGhlIHVuaXF1ZSBwb2xpY3kgaWRlbnRpZmllciBpcyBwbGFjZWQgaW50byB0aGUgcG9saWN5IGVsZW1lbnQuXHJcbiAgICovXHJcbiAgcG9saWN5PzogZmhpci5GaGlyVXJpW118KHN0cmluZ3xudWxsKVtdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUHJvdmVuYW5jZS5wb2xpY3lcclxuICAgKi9cclxuICBfcG9saWN5PzooZmhpci5GaGlyRWxlbWVudEFyZ3N8bnVsbClbXTtcclxuICAvKipcclxuICAgKiBXaGVyZSB0aGUgYWN0aXZpdHkgb2NjdXJyZWQsIGlmIHJlbGV2YW50LlxyXG4gICAqL1xyXG4gIGxvY2F0aW9uPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcmVhc29uIHRoYXQgdGhlIGFjdGl2aXR5IHdhcyB0YWtpbmcgcGxhY2UuXHJcbiAgICovXHJcbiAgcmVhc29uPzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEFuIGFjdGl2aXR5IGlzIHNvbWV0aGluZyB0aGF0IG9jY3VycyBvdmVyIGEgcGVyaW9kIG9mIHRpbWUgYW5kIGFjdHMgdXBvbiBvciB3aXRoIGVudGl0aWVzOyBpdCBtYXkgaW5jbHVkZSBjb25zdW1pbmcsIHByb2Nlc3NpbmcsIHRyYW5zZm9ybWluZywgbW9kaWZ5aW5nLCByZWxvY2F0aW5nLCB1c2luZywgb3IgZ2VuZXJhdGluZyBlbnRpdGllcy5cclxuICAgKi9cclxuICBhY3Rpdml0eT86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogU2V2ZXJhbCBhZ2VudHMgbWF5IGJlIGFzc29jaWF0ZWQgKGkuZS4gaGFzIHNvbWUgcmVzcG9uc2liaWxpdHkgZm9yIGFuIGFjdGl2aXR5KSB3aXRoIGFuIGFjdGl2aXR5IGFuZCB2aWNlLXZlcnNhLlxyXG4gICAqL1xyXG4gIGFnZW50OiBmaGlyLlByb3ZlbmFuY2VBZ2VudEFyZ3NbXXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIEFuIGVudGl0eSB1c2VkIGluIHRoaXMgYWN0aXZpdHkuXHJcbiAgICovXHJcbiAgZW50aXR5PzogZmhpci5Qcm92ZW5hbmNlRW50aXR5QXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIGRpZ2l0YWwgc2lnbmF0dXJlIG9uIHRoZSB0YXJnZXQgUmVmZXJlbmNlKHMpLiBUaGUgc2lnbmVyIHNob3VsZCBtYXRjaCBhIFByb3ZlbmFuY2UuYWdlbnQuIFRoZSBwdXJwb3NlIG9mIHRoZSBzaWduYXR1cmUgaXMgaW5kaWNhdGVkLlxyXG4gICAqL1xyXG4gIHNpZ25hdHVyZT86IGZoaXIuU2lnbmF0dXJlQXJnc1tdfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFByb3ZlbmFuY2Ugb2YgYSByZXNvdXJjZSBpcyBhIHJlY29yZCB0aGF0IGRlc2NyaWJlcyBlbnRpdGllcyBhbmQgcHJvY2Vzc2VzIGludm9sdmVkIGluIHByb2R1Y2luZyBhbmQgZGVsaXZlcmluZyBvciBvdGhlcndpc2UgaW5mbHVlbmNpbmcgdGhhdCByZXNvdXJjZS4gUHJvdmVuYW5jZSBwcm92aWRlcyBhIGNyaXRpY2FsIGZvdW5kYXRpb24gZm9yIGFzc2Vzc2luZyBhdXRoZW50aWNpdHksIGVuYWJsaW5nIHRydXN0LCBhbmQgYWxsb3dpbmcgcmVwcm9kdWNpYmlsaXR5LiBQcm92ZW5hbmNlIGFzc2VydGlvbnMgYXJlIGEgZm9ybSBvZiBjb250ZXh0dWFsIG1ldGFkYXRhIGFuZCBjYW4gdGhlbXNlbHZlcyBiZWNvbWUgaW1wb3J0YW50IHJlY29yZHMgd2l0aCB0aGVpciBvd24gcHJvdmVuYW5jZS4gUHJvdmVuYW5jZSBzdGF0ZW1lbnQgaW5kaWNhdGVzIGNsaW5pY2FsIHNpZ25pZmljYW5jZSBpbiB0ZXJtcyBvZiBjb25maWRlbmNlIGluIGF1dGhlbnRpY2l0eSwgcmVsaWFiaWxpdHksIGFuZCB0cnVzdHdvcnRoaW5lc3MsIGludGVncml0eSwgYW5kIHN0YWdlIGluIGxpZmVjeWNsZSAoZS5nLiBEb2N1bWVudCBDb21wbGV0aW9uIC0gaGFzIHRoZSBhcnRpZmFjdCBiZWVuIGxlZ2FsbHkgYXV0aGVudGljYXRlZCksIGFsbCBvZiB3aGljaCBtYXkgaW1wYWN0IHNlY3VyaXR5LCBwcml2YWN5LCBhbmQgdHJ1c3QgcG9saWNpZXMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvdmVuYW5jZSBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2Uge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnUHJvdmVuYW5jZSc7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc291cmNlVHlwZTogXCJQcm92ZW5hbmNlXCI7XHJcbiAgLyoqXHJcbiAgICogVGFyZ2V0IHJlZmVyZW5jZXMgYXJlIHVzdWFsbHkgdmVyc2lvbiBzcGVjaWZpYywgYnV0IG1pZ2h0IG5vdCBiZSwgaWYgYSB2ZXJzaW9uIGhhcyBub3QgYmVlbiBhc3NpZ25lZCBvciBpZiB0aGUgcHJvdmVuYW5jZSBpbmZvcm1hdGlvbiBpcyBwYXJ0IG9mIHRoZSBzZXQgb2YgcmVzb3VyY2VzIGJlaW5nIG1haW50YWluZWQgKGkuZS4gYSBkb2N1bWVudCkuIFdoZW4gdXNpbmcgdGhlIFJFU1RmdWwgQVBJLCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG1pZ2h0IG5vdCBiZSBrbm93biAoZXNwZWNpYWxseSBub3QgdGhlIHZlcnNpb24gc3BlY2lmaWMgb25lKTsgdGhlIGNsaWVudCBtYXkgZWl0aGVyIHN1Ym1pdCB0aGUgcmVzb3VyY2UgZmlyc3QsIGFuZCB0aGVuIHRoZSBwcm92ZW5hbmNlLCBvciBpdCBtYXkgc3VibWl0IGJvdGggdXNpbmcgYSBzaW5nbGUgdHJhbnNhY3Rpb24uIFNlZSB0aGUgbm90ZXMgb24gdHJhbnNhY3Rpb24gZm9yIGZ1cnRoZXIgZGlzY3Vzc2lvbi5cclxuICAgKi9cclxuICBwdWJsaWMgdGFyZ2V0OiBmaGlyLlJlZmVyZW5jZVtdO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwZXJpb2QgY2FuIGJlIGEgbGl0dGxlIGFyYml0cmFyeTsgd2hlcmUgcG9zc2libGUsIHRoZSB0aW1lIHNob3VsZCBjb3JyZXNwb25kIHRvIGh1bWFuIGFzc2Vzc21lbnQgb2YgdGhlIGFjdGl2aXR5IHRpbWUuXHJcbiAgICovXHJcbiAgcHVibGljIG9jY3VycmVkPzogKGZoaXIuUGVyaW9kfGZoaXIuRmhpckRhdGVUaW1lKXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW50ZXJuYWwgZmxhZyB0byBwcm9wZXJseSBzZXJpYWxpemUgY2hvaWNlLXR5cGUgZWxlbWVudCBQcm92ZW5hbmNlLm9jY3VycmVkW3hdXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIHN0YXRpYyByZWFkb25seSBfZnRzX29jY3VycmVkSXNDaG9pY2U6dHJ1ZSA9IHRydWU7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBjYW4gYmUgYSBsaXR0bGUgZGlmZmVyZW50IGZyb20gdGhlIHRpbWUgc3RhbXAgb24gdGhlIHJlc291cmNlIGlmIHRoZXJlIGlzIGEgZGVsYXkgYmV0d2VlbiByZWNvcmRpbmcgdGhlIGV2ZW50IGFuZCB1cGRhdGluZyB0aGUgcHJvdmVuYW5jZSBhbmQgdGFyZ2V0IHJlc291cmNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWNvcmRlZDogZmhpci5GaGlySW5zdGFudHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIEZvciBleGFtcGxlOiBXaGVyZSBhbiBPQXV0aCB0b2tlbiBhdXRob3JpemVzLCB0aGUgdW5pcXVlIGlkZW50aWZpZXIgZnJvbSB0aGUgT0F1dGggdG9rZW4gaXMgcGxhY2VkIGludG8gdGhlIHBvbGljeSBlbGVtZW50IFdoZXJlIGEgcG9saWN5IGVuZ2luZSAoZS5nLiBYQUNNTCkgaG9sZHMgcG9saWN5IGxvZ2ljLCB0aGUgdW5pcXVlIHBvbGljeSBpZGVudGlmaWVyIGlzIHBsYWNlZCBpbnRvIHRoZSBwb2xpY3kgZWxlbWVudC5cclxuICAgKi9cclxuICBwdWJsaWMgcG9saWN5OiBmaGlyLkZoaXJVcmlbXTtcclxuICAvKipcclxuICAgKiBXaGVyZSB0aGUgYWN0aXZpdHkgb2NjdXJyZWQsIGlmIHJlbGV2YW50LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2NhdGlvbj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcmVhc29uIHRoYXQgdGhlIGFjdGl2aXR5IHdhcyB0YWtpbmcgcGxhY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHJlYXNvbjogZmhpci5Db2RlYWJsZUNvbmNlcHRbXTtcclxuICAvKipcclxuICAgKiBBbiBhY3Rpdml0eSBpcyBzb21ldGhpbmcgdGhhdCBvY2N1cnMgb3ZlciBhIHBlcmlvZCBvZiB0aW1lIGFuZCBhY3RzIHVwb24gb3Igd2l0aCBlbnRpdGllczsgaXQgbWF5IGluY2x1ZGUgY29uc3VtaW5nLCBwcm9jZXNzaW5nLCB0cmFuc2Zvcm1pbmcsIG1vZGlmeWluZywgcmVsb2NhdGluZywgdXNpbmcsIG9yIGdlbmVyYXRpbmcgZW50aXRpZXMuXHJcbiAgICovXHJcbiAgcHVibGljIGFjdGl2aXR5PzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFNldmVyYWwgYWdlbnRzIG1heSBiZSBhc3NvY2lhdGVkIChpLmUuIGhhcyBzb21lIHJlc3BvbnNpYmlsaXR5IGZvciBhbiBhY3Rpdml0eSkgd2l0aCBhbiBhY3Rpdml0eSBhbmQgdmljZS12ZXJzYS5cclxuICAgKi9cclxuICBwdWJsaWMgYWdlbnQ6IGZoaXIuUHJvdmVuYW5jZUFnZW50W107XHJcbiAgLyoqXHJcbiAgICogQW4gZW50aXR5IHVzZWQgaW4gdGhpcyBhY3Rpdml0eS5cclxuICAgKi9cclxuICBwdWJsaWMgZW50aXR5OiBmaGlyLlByb3ZlbmFuY2VFbnRpdHlbXTtcclxuICAvKipcclxuICAgKiBBIGRpZ2l0YWwgc2lnbmF0dXJlIG9uIHRoZSB0YXJnZXQgUmVmZXJlbmNlKHMpLiBUaGUgc2lnbmVyIHNob3VsZCBtYXRjaCBhIFByb3ZlbmFuY2UuYWdlbnQuIFRoZSBwdXJwb3NlIG9mIHRoZSBzaWduYXR1cmUgaXMgaW5kaWNhdGVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzaWduYXR1cmU6IGZoaXIuU2lnbmF0dXJlW107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgUHJvdmVuYW5jZSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFByb3ZlbmFuY2VBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnUHJvdmVuYW5jZSc7XHJcbiAgICBpZiAoc291cmNlWyd0YXJnZXQnXSkgeyB0aGlzLnRhcmdldCA9IHNvdXJjZS50YXJnZXQubWFwKCh4KSA9PiBuZXcgZmhpci5SZWZlcmVuY2UoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50YXJnZXQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnb2NjdXJyZWQnXSkgeyB0aGlzLm9jY3VycmVkID0gc291cmNlLm9jY3VycmVkOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ29jY3VycmVkUGVyaW9kJ10pIHsgdGhpcy5vY2N1cnJlZCA9IG5ldyBmaGlyLlBlcmlvZChzb3VyY2Uub2NjdXJyZWRQZXJpb2QpOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ29jY3VycmVkRGF0ZVRpbWUnXSkgeyB0aGlzLm9jY3VycmVkID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHt2YWx1ZTogc291cmNlLm9jY3VycmVkRGF0ZVRpbWV9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncmVjb3JkZWQnXSkgeyB0aGlzLnJlY29yZGVkID0gbmV3IGZoaXIuRmhpckluc3RhbnQoe3ZhbHVlOiBzb3VyY2UucmVjb3JkZWR9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucmVjb3JkZWQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfcmVjb3JkZWQnXSkge1xyXG4gICAgICBpZiAodGhpcy5yZWNvcmRlZCkgeyB0aGlzLnJlY29yZGVkLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3JlY29yZGVkISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMucmVjb3JkZWQgPSBuZXcgZmhpci5GaGlySW5zdGFudChzb3VyY2UuX3JlY29yZGVkIGFzIFBhcnRpYWw8Zmhpci5GaGlySW5zdGFudEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsncG9saWN5J10pIHsgdGhpcy5wb2xpY3kgPSBzb3VyY2UucG9saWN5Lm1hcCgoeCkgPT4gbmV3IGZoaXIuRmhpclVyaSh7dmFsdWU6IHh9KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnBvbGljeSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydfcG9saWN5J10pIHtcclxuICAgICAgc291cmNlLl9wb2xpY3kuZm9yRWFjaCgoeCxpKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMucG9saWN5Lmxlbmd0aCA+PSBpKSB7IGlmICh4KSB7IHRoaXMucG9saWN5W2ldLmFkZEV4dGVuZGVkUHJvcGVydGllcyh4KTsgfSB9XHJcbiAgICAgICAgZWxzZSB7IGlmICh4KSB7IHRoaXMucG9saWN5LnB1c2gobmV3IGZoaXIuRmhpclVyaSh4IGFzIFBhcnRpYWw8Zmhpci5GaGlyVXJpQXJncz4pKTsgfSB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnbG9jYXRpb24nXSkgeyB0aGlzLmxvY2F0aW9uID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5sb2NhdGlvbik7IH1cclxuICAgIGlmIChzb3VyY2VbJ3JlYXNvbiddKSB7IHRoaXMucmVhc29uID0gc291cmNlLnJlYXNvbi5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnJlYXNvbiA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydhY3Rpdml0eSddKSB7IHRoaXMuYWN0aXZpdHkgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLmFjdGl2aXR5KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnYWdlbnQnXSkgeyB0aGlzLmFnZW50ID0gc291cmNlLmFnZW50Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUHJvdmVuYW5jZUFnZW50KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuYWdlbnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZW50aXR5J10pIHsgdGhpcy5lbnRpdHkgPSBzb3VyY2UuZW50aXR5Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUHJvdmVuYW5jZUVudGl0eSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmVudGl0eSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydzaWduYXR1cmUnXSkgeyB0aGlzLnNpZ25hdHVyZSA9IHNvdXJjZS5zaWduYXR1cmUubWFwKCh4KSA9PiBuZXcgZmhpci5TaWduYXR1cmUoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5zaWduYXR1cmUgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ1Byb3ZlbmFuY2UnIH1cclxuICAgIHRoaXMudlJTKCdyZXNvdXJjZVR5cGUnLGV4cClcclxuICAgIHRoaXMudlJBKCd0YXJnZXQnLGV4cClcclxuICAgIHRoaXMudk9TKCdvY2N1cnJlZCcsZXhwKVxyXG4gICAgdGhpcy52UlMoJ3JlY29yZGVkJyxleHApXHJcbiAgICB0aGlzLnZPQSgncG9saWN5JyxleHApXHJcbiAgICB0aGlzLnZPUygnbG9jYXRpb24nLGV4cClcclxuICAgIHRoaXMudk9BKCdyZWFzb24nLGV4cClcclxuICAgIHRoaXMudk9TKCdhY3Rpdml0eScsZXhwKVxyXG4gICAgdGhpcy52UkEoJ2FnZW50JyxleHApXHJcbiAgICB0aGlzLnZPQSgnZW50aXR5JyxleHApXHJcbiAgICB0aGlzLnZPQSgnc2lnbmF0dXJlJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4iXX0=