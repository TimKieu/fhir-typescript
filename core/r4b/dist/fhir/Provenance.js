// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR Resource: Provenance
import * as fhir from '../fhir.js';
// @ts-ignore
import { ProvenanceEntityRoleVsValidation } from '../fhirValueSets/ProvenanceEntityRoleVsValidation.js';
/**
 * Several agents may be associated (i.e. has some responsibility for an activity) with an activity and vice-versa.
 */
export class ProvenanceAgent extends fhir.BackboneElement {
    /**
     * Default constructor for ProvenanceAgent - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        if (source['role']) {
            this.role = source.role.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.role = [];
        }
        if (source['who']) {
            this.who = new fhir.Reference(source.who);
        }
        else {
            this.who = null;
        }
        if (source['onBehalfOf']) {
            this.onBehalfOf = new fhir.Reference(source.onBehalfOf);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance.agent';
        }
        iss.push(...this.vOS('type', exp));
        iss.push(...this.vOA('role', exp));
        iss.push(...this.vRS('who', exp));
        iss.push(...this.vOS('onBehalfOf', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ProvenanceAgent._fts_dataType = 'ProvenanceAgent';
/**
 * An entity used in this activity.
 */
export class ProvenanceEntity extends fhir.BackboneElement {
    /**
     * Default constructor for ProvenanceEntity - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['role']) {
            this.role = new fhir.FhirCode({ value: source.role });
        }
        else {
            this.role = null;
        }
        if (source['_role']) {
            if (this.role) {
                this.role.addExtendedProperties(source._role);
            }
            else {
                this.role = new fhir.FhirCode(source._role);
            }
        }
        if (source['what']) {
            this.what = new fhir.Reference(source.what);
        }
        else {
            this.what = null;
        }
        if (source['agent']) {
            this.agent = source.agent.map((x) => new fhir.ProvenanceAgent(x));
        }
        else {
            this.agent = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance.entity';
        }
        iss.push(...this.vRSV('role', exp, 'ProvenanceEntityRole', ProvenanceEntityRoleVsValidation, 'r'));
        iss.push(...this.vRS('what', exp));
        iss.push(...this.vOA('agent', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ProvenanceEntity._fts_dataType = 'ProvenanceEntity';
/**
 * Provenance of a resource is a record that describes entities and processes involved in producing and delivering or otherwise influencing that resource. Provenance provides a critical foundation for assessing authenticity, enabling trust, and allowing reproducibility. Provenance assertions are a form of contextual metadata and can themselves become important records with their own provenance. Provenance statement indicates clinical significance in terms of confidence in authenticity, reliability, and trustworthiness, integrity, and stage in lifecycle (e.g. Document Completion - has the artifact been legally authenticated), all of which may impact security, privacy, and trust policies.
 */
export class Provenance extends fhir.DomainResource {
    /**
     * Default constructor for Provenance - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Provenance';
        if (source['target']) {
            this.target = source.target.map((x) => new fhir.Reference(x));
        }
        else {
            this.target = [];
        }
        if (source['occurred']) {
            this.occurred = source.occurred;
        }
        else if (source['occurredPeriod']) {
            this.occurred = new fhir.Period(source.occurredPeriod);
        }
        else if (source['occurredDateTime']) {
            this.occurred = new fhir.FhirDateTime({ value: source.occurredDateTime });
        }
        if (source['recorded']) {
            this.recorded = new fhir.FhirInstant({ value: source.recorded });
        }
        else {
            this.recorded = null;
        }
        if (source['_recorded']) {
            if (this.recorded) {
                this.recorded.addExtendedProperties(source._recorded);
            }
            else {
                this.recorded = new fhir.FhirInstant(source._recorded);
            }
        }
        if (source['policy']) {
            this.policy = source.policy.map((x) => new fhir.FhirUri({ value: x }));
        }
        else {
            this.policy = [];
        }
        if (source['_policy']) {
            source._policy.forEach((x, i) => {
                if (this.policy.length >= i) {
                    if (x) {
                        this.policy[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.policy.push(new fhir.FhirUri(x));
                    }
                }
            });
        }
        if (source['location']) {
            this.location = new fhir.Reference(source.location);
        }
        if (source['reason']) {
            this.reason = source.reason.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.reason = [];
        }
        if (source['activity']) {
            this.activity = new fhir.CodeableConcept(source.activity);
        }
        if (source['agent']) {
            this.agent = source.agent.map((x) => new fhir.ProvenanceAgent(x));
        }
        else {
            this.agent = [];
        }
        if (source['entity']) {
            this.entity = source.entity.map((x) => new fhir.ProvenanceEntity(x));
        }
        else {
            this.entity = [];
        }
        if (source['signature']) {
            this.signature = source.signature.map((x) => new fhir.Signature(x));
        }
        else {
            this.signature = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance';
        }
        iss.push(...this.vRPS('resourceType', exp));
        iss.push(...this.vRA('target', exp));
        iss.push(...this.vOS('occurred', exp));
        iss.push(...this.vRS('recorded', exp));
        iss.push(...this.vOA('policy', exp));
        iss.push(...this.vOS('location', exp));
        iss.push(...this.vOA('reason', exp));
        iss.push(...this.vOS('activity', exp));
        iss.push(...this.vRA('agent', exp));
        iss.push(...this.vOA('entity', exp));
        iss.push(...this.vOA('signature', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Provenance._fts_dataType = 'Provenance';
/**
 * Internal flag to properly serialize choice-type element Provenance.occurred[x]
 */
Provenance._fts_occurredIsChoice = true;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHJvdmVuYW5jZS5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvUHJvdmVuYW5jZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsZ0RBQWdEO0FBQ2hELGtDQUFrQztBQUNsQyw0QkFBNEI7QUFFNUIsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFZbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSxnQ0FBZ0MsRUFBRSxNQUFNLHNEQUFzRCxDQUFDO0FBK0J4Rzs7R0FFRztBQUNILE1BQU0sT0FBTyxlQUFnQixTQUFRLElBQUksQ0FBQyxlQUFlO0lBcUJ2RDs7T0FFRztJQUNILFlBQVksU0FBc0MsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDNUYsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUFFO1FBQzFFLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNuRjtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDeEIsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7U0FBRTthQUM1RDtZQUFFLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDO1NBQUU7UUFDekIsSUFB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QUFDO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ25DLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3ZDLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQzs7QUExR0Q7O0dBRUc7QUFDNkIsd0JBQWEsR0FBVSxZQUFZLENBQUM7QUFhcEU7O0dBRUc7QUFDdUIsZ0NBQXFCLEdBQVEsSUFBSSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0Yi5jb3JlIHZlcnNpb246IDQuMy4wXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogUHJvdmVuYW5jZVxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUHJvdmVuYW5jZUFnZW50VHlwZUNvZGVzLCAgUHJvdmVuYW5jZUFnZW50VHlwZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9Qcm92ZW5hbmNlQWdlbnRUeXBlQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFByb3ZlbmFuY2VBZ2VudFR5cGVWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Byb3ZlbmFuY2VBZ2VudFR5cGVWc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFNlY3VyaXR5Um9sZVR5cGVDb2RlcywgIFNlY3VyaXR5Um9sZVR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvU2VjdXJpdHlSb2xlVHlwZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBTZWN1cml0eVJvbGVUeXBlVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TZWN1cml0eVJvbGVUeXBlVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBQcm92ZW5hbmNlRW50aXR5Um9sZUNvZGVzLCAgUHJvdmVuYW5jZUVudGl0eVJvbGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUHJvdmVuYW5jZUVudGl0eVJvbGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUHJvdmVuYW5jZUVudGl0eVJvbGVWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Byb3ZlbmFuY2VFbnRpdHlSb2xlVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBWM1B1cnBvc2VPZlVzZUNvZGVzLCAgVjNQdXJwb3NlT2ZVc2VDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvVjNQdXJwb3NlT2ZVc2VDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgVjNQdXJwb3NlT2ZVc2VWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1YzUHVycG9zZU9mVXNlVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBQcm92ZW5hbmNlQWN0aXZpdHlUeXBlQ29kZXMsICBQcm92ZW5hbmNlQWN0aXZpdHlUeXBlQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Byb3ZlbmFuY2VBY3Rpdml0eVR5cGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUHJvdmVuYW5jZUFjdGl2aXR5VHlwZVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUHJvdmVuYW5jZUFjdGl2aXR5VHlwZVZzVmFsaWRhdGlvbi5qcyc7XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBQcm92ZW5hbmNlQWdlbnQgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmVuYW5jZUFnZW50QXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogRm9yIGV4YW1wbGU6IGF1dGhvciwgcGVyZm9ybWVyLCBlbnRlcmVyLCBhdHRlc3RlciwgZXRjLlxyXG4gICAqL1xyXG4gIHR5cGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEZvciBleGFtcGxlOiBkb2N0b3IsIG51cnNlLCBjbGVyaywgZXRjLlxyXG4gICAqL1xyXG4gIHJvbGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogd2hvSWRlbnRpdHkgc2hvdWxkIGJlIHVzZWQgd2hlbiB0aGUgYWdlbnQgaXMgbm90IGEgUmVzb3VyY2UgdHlwZS5cclxuICAgKi9cclxuICB3aG86IGZoaXIuUmVmZXJlbmNlQXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIG9uQmVoYWxmT2ZJZGVudGl0eSBzaG91bGQgYmUgdXNlZCB3aGVuIHRoZSBhZ2VudCBpcyBub3QgYSBSZXNvdXJjZSB0eXBlLlxyXG4gICAqL1xyXG4gIG9uQmVoYWxmT2Y/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogU2V2ZXJhbCBhZ2VudHMgbWF5IGJlIGFzc29jaWF0ZWQgKGkuZS4gaGFzIHNvbWUgcmVzcG9uc2liaWxpdHkgZm9yIGFuIGFjdGl2aXR5KSB3aXRoIGFuIGFjdGl2aXR5IGFuZCB2aWNlLXZlcnNhLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFByb3ZlbmFuY2VBZ2VudCBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ1Byb3ZlbmFuY2VBZ2VudCc7XHJcbiAgLyoqXHJcbiAgICogRm9yIGV4YW1wbGU6IGF1dGhvciwgcGVyZm9ybWVyLCBlbnRlcmVyLCBhdHRlc3RlciwgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0eXBlPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEZvciBleGFtcGxlOiBkb2N0b3IsIG51cnNlLCBjbGVyaywgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByb2xlOiBmaGlyLkNvZGVhYmxlQ29uY2VwdFtdO1xyXG4gIC8qKlxyXG4gICAqIHdob0lkZW50aXR5IHNob3VsZCBiZSB1c2VkIHdoZW4gdGhlIGFnZW50IGlzIG5vdCBhIFJlc291cmNlIHR5cGUuXHJcbiAgICovXHJcbiAgcHVibGljIHdobzogZmhpci5SZWZlcmVuY2V8bnVsbDtcclxuICAvKipcclxuICAgKiBvbkJlaGFsZk9mSWRlbnRpdHkgc2hvdWxkIGJlIHVzZWQgd2hlbiB0aGUgYWdlbnQgaXMgbm90IGEgUmVzb3VyY2UgdHlwZS5cclxuICAgKi9cclxuICBwdWJsaWMgb25CZWhhbGZPZj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBQcm92ZW5hbmNlQWdlbnQgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxQcm92ZW5hbmNlQWdlbnRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UudHlwZSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3JvbGUnXSkgeyB0aGlzLnJvbGUgPSBzb3VyY2Uucm9sZS5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnJvbGUgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnd2hvJ10pIHsgdGhpcy53aG8gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLndobyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLndobyA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ29uQmVoYWxmT2YnXSkgeyB0aGlzLm9uQmVoYWxmT2YgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLm9uQmVoYWxmT2YpOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnUHJvdmVuYW5jZS5hZ2VudCcgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ3R5cGUnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ3JvbGUnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ3dobycsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnb25CZWhhbGZPZicsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgUHJvdmVuYW5jZUVudGl0eSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBQcm92ZW5hbmNlRW50aXR5QXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogSG93IHRoZSBlbnRpdHkgd2FzIHVzZWQgZHVyaW5nIHRoZSBhY3Rpdml0eS5cclxuICAgKi9cclxuICByb2xlOiBmaGlyLkZoaXJDb2RlPFByb3ZlbmFuY2VFbnRpdHlSb2xlQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFByb3ZlbmFuY2UuZW50aXR5LnJvbGVcclxuICAgKi9cclxuICBfcm9sZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogd2hhdElkZW50aXR5IHNob3VsZCBiZSB1c2VkIGZvciBlbnRpdGllcyB0aGF0IGFyZSBub3QgYSBSZXNvdXJjZSB0eXBlLlxyXG4gICAqL1xyXG4gIHdoYXQ6IGZoaXIuUmVmZXJlbmNlQXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIEEgdXNlY2FzZSB3aGVyZSBvbmUgUHJvdmVuYW5jZS5lbnRpdHkuYWdlbnQgaXMgdXNlZCB3aGVyZSB0aGUgRW50aXR5IHRoYXQgd2FzIHVzZWQgaW4gdGhlIGNyZWF0aW9uL3VwZGF0aW5nIG9mIHRoZSBUYXJnZXQsIGlzIG5vdCBpbiB0aGUgY29udGV4dCBvZiB0aGUgc2FtZSBjdXN0b2RpYW5zaGlwIGFzIHRoZSBUYXJnZXQsIGFuZCB0aHVzIHRoZSBtZWFuaW5nIG9mIFByb3ZlbmFuY2UuZW50aXR5LmFnZW50IGlzIHRvIHNheSB0aGF0IHRoZSBlbnRpdHkgcmVmZXJlbmNlZCBpcyBtYW5hZ2VkIGVsc2V3aGVyZSBhbmQgdGhhdCB0aGlzIEFnZW50IHByb3ZpZGVkIGFjY2VzcyB0byBpdC4gIFRoaXMgd291bGQgYmUgc2ltaWxhciB0byB3aGVyZSB0aGUgRW50aXR5IGJlaW5nIHJlZmVyZW5jZWQgaXMgbWFuYWdlZCBvdXRzaWRlIEZISVIsIHN1Y2ggYXMgdGhyb3VnaCBITDcgdjIsIHYzLCBvciBYRFMuIFRoaXMgbWlnaHQgYmUgd2hlcmUgdGhlIEVudGl0eSBiZWluZyByZWZlcmVuY2VkIGlzIG1hbmFnZWQgaW4gYW5vdGhlciBGSElSIHJlc291cmNlIHNlcnZlci4gVGh1cyBpdCBleHBsYWlucyB0aGUgUHJvdmVuYW5jZSBvZiB0aGF0IEVudGl0eSdzIHVzZSBpbiB0aGUgY29udGV4dCBvZiB0aGlzIFByb3ZlbmFuY2UgYWN0aXZpdHkuXHJcbiAgICovXHJcbiAgYWdlbnQ/OiBmaGlyLlByb3ZlbmFuY2VBZ2VudEFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBbiBlbnRpdHkgdXNlZCBpbiB0aGlzIGFjdGl2aXR5LlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFByb3ZlbmFuY2VFbnRpdHkgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdQcm92ZW5hbmNlRW50aXR5JztcclxuICAvKipcclxuICAgKiBIb3cgdGhlIGVudGl0eSB3YXMgdXNlZCBkdXJpbmcgdGhlIGFjdGl2aXR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyByb2xlOiBmaGlyLkZoaXJDb2RlPFByb3ZlbmFuY2VFbnRpdHlSb2xlQ29kZVR5cGU+fG51bGw7XHJcbiAgLyoqXHJcbiAgICogd2hhdElkZW50aXR5IHNob3VsZCBiZSB1c2VkIGZvciBlbnRpdGllcyB0aGF0IGFyZSBub3QgYSBSZXNvdXJjZSB0eXBlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB3aGF0OiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIEEgdXNlY2FzZSB3aGVyZSBvbmUgUHJvdmVuYW5jZS5lbnRpdHkuYWdlbnQgaXMgdXNlZCB3aGVyZSB0aGUgRW50aXR5IHRoYXQgd2FzIHVzZWQgaW4gdGhlIGNyZWF0aW9uL3VwZGF0aW5nIG9mIHRoZSBUYXJnZXQsIGlzIG5vdCBpbiB0aGUgY29udGV4dCBvZiB0aGUgc2FtZSBjdXN0b2RpYW5zaGlwIGFzIHRoZSBUYXJnZXQsIGFuZCB0aHVzIHRoZSBtZWFuaW5nIG9mIFByb3ZlbmFuY2UuZW50aXR5LmFnZW50IGlzIHRvIHNheSB0aGF0IHRoZSBlbnRpdHkgcmVmZXJlbmNlZCBpcyBtYW5hZ2VkIGVsc2V3aGVyZSBhbmQgdGhhdCB0aGlzIEFnZW50IHByb3ZpZGVkIGFjY2VzcyB0byBpdC4gIFRoaXMgd291bGQgYmUgc2ltaWxhciB0byB3aGVyZSB0aGUgRW50aXR5IGJlaW5nIHJlZmVyZW5jZWQgaXMgbWFuYWdlZCBvdXRzaWRlIEZISVIsIHN1Y2ggYXMgdGhyb3VnaCBITDcgdjIsIHYzLCBvciBYRFMuIFRoaXMgbWlnaHQgYmUgd2hlcmUgdGhlIEVudGl0eSBiZWluZyByZWZlcmVuY2VkIGlzIG1hbmFnZWQgaW4gYW5vdGhlciBGSElSIHJlc291cmNlIHNlcnZlci4gVGh1cyBpdCBleHBsYWlucyB0aGUgUHJvdmVuYW5jZSBvZiB0aGF0IEVudGl0eSdzIHVzZSBpbiB0aGUgY29udGV4dCBvZiB0aGlzIFByb3ZlbmFuY2UgYWN0aXZpdHkuXHJcbiAgICovXHJcbiAgcHVibGljIGFnZW50OiBmaGlyLlByb3ZlbmFuY2VBZ2VudFtdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFByb3ZlbmFuY2VFbnRpdHkgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxQcm92ZW5hbmNlRW50aXR5QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3JvbGUnXSkgeyB0aGlzLnJvbGUgPSBuZXcgZmhpci5GaGlyQ29kZTxQcm92ZW5hbmNlRW50aXR5Um9sZUNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5yb2xlfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnJvbGUgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfcm9sZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnJvbGUpIHsgdGhpcy5yb2xlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3JvbGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5yb2xlID0gbmV3IGZoaXIuRmhpckNvZGU8UHJvdmVuYW5jZUVudGl0eVJvbGVDb2RlVHlwZT4oc291cmNlLl9yb2xlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWyd3aGF0J10pIHsgdGhpcy53aGF0ID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS53aGF0KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMud2hhdCA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ2FnZW50J10pIHsgdGhpcy5hZ2VudCA9IHNvdXJjZS5hZ2VudC5tYXAoKHgpID0+IG5ldyBmaGlyLlByb3ZlbmFuY2VBZ2VudCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmFnZW50ID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdQcm92ZW5hbmNlLmVudGl0eScgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlNWKCdyb2xlJyxleHAsJ1Byb3ZlbmFuY2VFbnRpdHlSb2xlJyxQcm92ZW5hbmNlRW50aXR5Um9sZVZzVmFsaWRhdGlvbiwncicpKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJTKCd3aGF0JyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdhZ2VudCcsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgUHJvdmVuYW5jZSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBQcm92ZW5hbmNlQXJncyBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2VBcmdzIHtcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICByZXNvdXJjZVR5cGU6IFwiUHJvdmVuYW5jZVwifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUYXJnZXQgcmVmZXJlbmNlcyBhcmUgdXN1YWxseSB2ZXJzaW9uIHNwZWNpZmljLCBidXQgbWlnaHQgbm90IGJlLCBpZiBhIHZlcnNpb24gaGFzIG5vdCBiZWVuIGFzc2lnbmVkIG9yIGlmIHRoZSBwcm92ZW5hbmNlIGluZm9ybWF0aW9uIGlzIHBhcnQgb2YgdGhlIHNldCBvZiByZXNvdXJjZXMgYmVpbmcgbWFpbnRhaW5lZCAoaS5lLiBhIGRvY3VtZW50KS4gV2hlbiB1c2luZyB0aGUgUkVTVGZ1bCBBUEksIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2UgbWlnaHQgbm90IGJlIGtub3duIChlc3BlY2lhbGx5IG5vdCB0aGUgdmVyc2lvbiBzcGVjaWZpYyBvbmUpOyB0aGUgY2xpZW50IG1heSBlaXRoZXIgc3VibWl0IHRoZSByZXNvdXJjZSBmaXJzdCwgYW5kIHRoZW4gdGhlIHByb3ZlbmFuY2UsIG9yIGl0IG1heSBzdWJtaXQgYm90aCB1c2luZyBhIHNpbmdsZSB0cmFuc2FjdGlvbi4gU2VlIHRoZSBub3RlcyBvbiB0cmFuc2FjdGlvbiBmb3IgZnVydGhlciBkaXNjdXNzaW9uLlxyXG4gICAqL1xyXG4gIHRhcmdldDogZmhpci5SZWZlcmVuY2VBcmdzW118bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgcGVyaW9kIGNhbiBiZSBhIGxpdHRsZSBhcmJpdHJhcnk7IHdoZXJlIHBvc3NpYmxlLCB0aGUgdGltZSBzaG91bGQgY29ycmVzcG9uZCB0byBodW1hbiBhc3Nlc3NtZW50IG9mIHRoZSBhY3Rpdml0eSB0aW1lLlxyXG4gICAqL1xyXG4gIG9jY3VycmVkPzogZmhpci5QZXJpb2R8Zmhpci5GaGlyRGF0ZVRpbWV8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwZXJpb2QgY2FuIGJlIGEgbGl0dGxlIGFyYml0cmFyeTsgd2hlcmUgcG9zc2libGUsIHRoZSB0aW1lIHNob3VsZCBjb3JyZXNwb25kIHRvIGh1bWFuIGFzc2Vzc21lbnQgb2YgdGhlIGFjdGl2aXR5IHRpbWUuXHJcbiAgICovXHJcbiAgb2NjdXJyZWRQZXJpb2Q/OiBmaGlyLlBlcmlvZEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwZXJpb2QgY2FuIGJlIGEgbGl0dGxlIGFyYml0cmFyeTsgd2hlcmUgcG9zc2libGUsIHRoZSB0aW1lIHNob3VsZCBjb3JyZXNwb25kIHRvIGh1bWFuIGFzc2Vzc21lbnQgb2YgdGhlIGFjdGl2aXR5IHRpbWUuXHJcbiAgICovXHJcbiAgb2NjdXJyZWREYXRlVGltZT86IGZoaXIuRmhpckRhdGVUaW1lfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBjYW4gYmUgYSBsaXR0bGUgZGlmZmVyZW50IGZyb20gdGhlIHRpbWUgc3RhbXAgb24gdGhlIHJlc291cmNlIGlmIHRoZXJlIGlzIGEgZGVsYXkgYmV0d2VlbiByZWNvcmRpbmcgdGhlIGV2ZW50IGFuZCB1cGRhdGluZyB0aGUgcHJvdmVuYW5jZSBhbmQgdGFyZ2V0IHJlc291cmNlLlxyXG4gICAqL1xyXG4gIHJlY29yZGVkOiBmaGlyLkZoaXJJbnN0YW50fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFByb3ZlbmFuY2UucmVjb3JkZWRcclxuICAgKi9cclxuICBfcmVjb3JkZWQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIEZvciBleGFtcGxlOiBXaGVyZSBhbiBPQXV0aCB0b2tlbiBhdXRob3JpemVzLCB0aGUgdW5pcXVlIGlkZW50aWZpZXIgZnJvbSB0aGUgT0F1dGggdG9rZW4gaXMgcGxhY2VkIGludG8gdGhlIHBvbGljeSBlbGVtZW50IFdoZXJlIGEgcG9saWN5IGVuZ2luZSAoZS5nLiBYQUNNTCkgaG9sZHMgcG9saWN5IGxvZ2ljLCB0aGUgdW5pcXVlIHBvbGljeSBpZGVudGlmaWVyIGlzIHBsYWNlZCBpbnRvIHRoZSBwb2xpY3kgZWxlbWVudC5cclxuICAgKi9cclxuICBwb2xpY3k/OiBmaGlyLkZoaXJVcmlbXXwoc3RyaW5nfG51bGwpW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBQcm92ZW5hbmNlLnBvbGljeVxyXG4gICAqL1xyXG4gIF9wb2xpY3k/OihmaGlyLkZoaXJFbGVtZW50QXJnc3xudWxsKVtdO1xyXG4gIC8qKlxyXG4gICAqIFdoZXJlIHRoZSBhY3Rpdml0eSBvY2N1cnJlZCwgaWYgcmVsZXZhbnQuXHJcbiAgICovXHJcbiAgbG9jYXRpb24/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSByZWFzb24gdGhhdCB0aGUgYWN0aXZpdHkgd2FzIHRha2luZyBwbGFjZS5cclxuICAgKi9cclxuICByZWFzb24/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQW4gYWN0aXZpdHkgaXMgc29tZXRoaW5nIHRoYXQgb2NjdXJzIG92ZXIgYSBwZXJpb2Qgb2YgdGltZSBhbmQgYWN0cyB1cG9uIG9yIHdpdGggZW50aXRpZXM7IGl0IG1heSBpbmNsdWRlIGNvbnN1bWluZywgcHJvY2Vzc2luZywgdHJhbnNmb3JtaW5nLCBtb2RpZnlpbmcsIHJlbG9jYXRpbmcsIHVzaW5nLCBvciBnZW5lcmF0aW5nIGVudGl0aWVzLlxyXG4gICAqL1xyXG4gIGFjdGl2aXR5PzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBTZXZlcmFsIGFnZW50cyBtYXkgYmUgYXNzb2NpYXRlZCAoaS5lLiBoYXMgc29tZSByZXNwb25zaWJpbGl0eSBmb3IgYW4gYWN0aXZpdHkpIHdpdGggYW4gYWN0aXZpdHkgYW5kIHZpY2UtdmVyc2EuXHJcbiAgICovXHJcbiAgYWdlbnQ6IGZoaXIuUHJvdmVuYW5jZUFnZW50QXJnc1tdfG51bGw7XHJcbiAgLyoqXHJcbiAgICogQW4gZW50aXR5IHVzZWQgaW4gdGhpcyBhY3Rpdml0eS5cclxuICAgKi9cclxuICBlbnRpdHk/OiBmaGlyLlByb3ZlbmFuY2VFbnRpdHlBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEEgZGlnaXRhbCBzaWduYXR1cmUgb24gdGhlIHRhcmdldCBSZWZlcmVuY2UocykuIFRoZSBzaWduZXIgc2hvdWxkIG1hdGNoIGEgUHJvdmVuYW5jZS5hZ2VudC4gVGhlIHB1cnBvc2Ugb2YgdGhlIHNpZ25hdHVyZSBpcyBpbmRpY2F0ZWQuXHJcbiAgICovXHJcbiAgc2lnbmF0dXJlPzogZmhpci5TaWduYXR1cmVBcmdzW118dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogUHJvdmVuYW5jZSBvZiBhIHJlc291cmNlIGlzIGEgcmVjb3JkIHRoYXQgZGVzY3JpYmVzIGVudGl0aWVzIGFuZCBwcm9jZXNzZXMgaW52b2x2ZWQgaW4gcHJvZHVjaW5nIGFuZCBkZWxpdmVyaW5nIG9yIG90aGVyd2lzZSBpbmZsdWVuY2luZyB0aGF0IHJlc291cmNlLiBQcm92ZW5hbmNlIHByb3ZpZGVzIGEgY3JpdGljYWwgZm91bmRhdGlvbiBmb3IgYXNzZXNzaW5nIGF1dGhlbnRpY2l0eSwgZW5hYmxpbmcgdHJ1c3QsIGFuZCBhbGxvd2luZyByZXByb2R1Y2liaWxpdHkuIFByb3ZlbmFuY2UgYXNzZXJ0aW9ucyBhcmUgYSBmb3JtIG9mIGNvbnRleHR1YWwgbWV0YWRhdGEgYW5kIGNhbiB0aGVtc2VsdmVzIGJlY29tZSBpbXBvcnRhbnQgcmVjb3JkcyB3aXRoIHRoZWlyIG93biBwcm92ZW5hbmNlLiBQcm92ZW5hbmNlIHN0YXRlbWVudCBpbmRpY2F0ZXMgY2xpbmljYWwgc2lnbmlmaWNhbmNlIGluIHRlcm1zIG9mIGNvbmZpZGVuY2UgaW4gYXV0aGVudGljaXR5LCByZWxpYWJpbGl0eSwgYW5kIHRydXN0d29ydGhpbmVzcywgaW50ZWdyaXR5LCBhbmQgc3RhZ2UgaW4gbGlmZWN5Y2xlIChlLmcuIERvY3VtZW50IENvbXBsZXRpb24gLSBoYXMgdGhlIGFydGlmYWN0IGJlZW4gbGVnYWxseSBhdXRoZW50aWNhdGVkKSwgYWxsIG9mIHdoaWNoIG1heSBpbXBhY3Qgc2VjdXJpdHksIHByaXZhY3ksIGFuZCB0cnVzdCBwb2xpY2llcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBQcm92ZW5hbmNlIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdQcm92ZW5hbmNlJztcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzb3VyY2VUeXBlOiBcIlByb3ZlbmFuY2VcIjtcclxuICAvKipcclxuICAgKiBUYXJnZXQgcmVmZXJlbmNlcyBhcmUgdXN1YWxseSB2ZXJzaW9uIHNwZWNpZmljLCBidXQgbWlnaHQgbm90IGJlLCBpZiBhIHZlcnNpb24gaGFzIG5vdCBiZWVuIGFzc2lnbmVkIG9yIGlmIHRoZSBwcm92ZW5hbmNlIGluZm9ybWF0aW9uIGlzIHBhcnQgb2YgdGhlIHNldCBvZiByZXNvdXJjZXMgYmVpbmcgbWFpbnRhaW5lZCAoaS5lLiBhIGRvY3VtZW50KS4gV2hlbiB1c2luZyB0aGUgUkVTVGZ1bCBBUEksIHRoZSBpZGVudGl0eSBvZiB0aGUgcmVzb3VyY2UgbWlnaHQgbm90IGJlIGtub3duIChlc3BlY2lhbGx5IG5vdCB0aGUgdmVyc2lvbiBzcGVjaWZpYyBvbmUpOyB0aGUgY2xpZW50IG1heSBlaXRoZXIgc3VibWl0IHRoZSByZXNvdXJjZSBmaXJzdCwgYW5kIHRoZW4gdGhlIHByb3ZlbmFuY2UsIG9yIGl0IG1heSBzdWJtaXQgYm90aCB1c2luZyBhIHNpbmdsZSB0cmFuc2FjdGlvbi4gU2VlIHRoZSBub3RlcyBvbiB0cmFuc2FjdGlvbiBmb3IgZnVydGhlciBkaXNjdXNzaW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0YXJnZXQ6IGZoaXIuUmVmZXJlbmNlW107XHJcbiAgLyoqXHJcbiAgICogVGhlIHBlcmlvZCBjYW4gYmUgYSBsaXR0bGUgYXJiaXRyYXJ5OyB3aGVyZSBwb3NzaWJsZSwgdGhlIHRpbWUgc2hvdWxkIGNvcnJlc3BvbmQgdG8gaHVtYW4gYXNzZXNzbWVudCBvZiB0aGUgYWN0aXZpdHkgdGltZS5cclxuICAgKi9cclxuICBwdWJsaWMgb2NjdXJyZWQ/OiAoZmhpci5QZXJpb2R8Zmhpci5GaGlyRGF0ZVRpbWUpfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbnRlcm5hbCBmbGFnIHRvIHByb3Blcmx5IHNlcmlhbGl6ZSBjaG9pY2UtdHlwZSBlbGVtZW50IFByb3ZlbmFuY2Uub2NjdXJyZWRbeF1cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgc3RhdGljIHJlYWRvbmx5IF9mdHNfb2NjdXJyZWRJc0Nob2ljZTp0cnVlID0gdHJ1ZTtcclxuICAvKipcclxuICAgKiBUaGlzIGNhbiBiZSBhIGxpdHRsZSBkaWZmZXJlbnQgZnJvbSB0aGUgdGltZSBzdGFtcCBvbiB0aGUgcmVzb3VyY2UgaWYgdGhlcmUgaXMgYSBkZWxheSBiZXR3ZWVuIHJlY29yZGluZyB0aGUgZXZlbnQgYW5kIHVwZGF0aW5nIHRoZSBwcm92ZW5hbmNlIGFuZCB0YXJnZXQgcmVzb3VyY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHJlY29yZGVkOiBmaGlyLkZoaXJJbnN0YW50fG51bGw7XHJcbiAgLyoqXHJcbiAgICogRm9yIGV4YW1wbGU6IFdoZXJlIGFuIE9BdXRoIHRva2VuIGF1dGhvcml6ZXMsIHRoZSB1bmlxdWUgaWRlbnRpZmllciBmcm9tIHRoZSBPQXV0aCB0b2tlbiBpcyBwbGFjZWQgaW50byB0aGUgcG9saWN5IGVsZW1lbnQgV2hlcmUgYSBwb2xpY3kgZW5naW5lIChlLmcuIFhBQ01MKSBob2xkcyBwb2xpY3kgbG9naWMsIHRoZSB1bmlxdWUgcG9saWN5IGlkZW50aWZpZXIgaXMgcGxhY2VkIGludG8gdGhlIHBvbGljeSBlbGVtZW50LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwb2xpY3k6IGZoaXIuRmhpclVyaVtdO1xyXG4gIC8qKlxyXG4gICAqIFdoZXJlIHRoZSBhY3Rpdml0eSBvY2N1cnJlZCwgaWYgcmVsZXZhbnQuXHJcbiAgICovXHJcbiAgcHVibGljIGxvY2F0aW9uPzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSByZWFzb24gdGhhdCB0aGUgYWN0aXZpdHkgd2FzIHRha2luZyBwbGFjZS5cclxuICAgKi9cclxuICBwdWJsaWMgcmVhc29uOiBmaGlyLkNvZGVhYmxlQ29uY2VwdFtdO1xyXG4gIC8qKlxyXG4gICAqIEFuIGFjdGl2aXR5IGlzIHNvbWV0aGluZyB0aGF0IG9jY3VycyBvdmVyIGEgcGVyaW9kIG9mIHRpbWUgYW5kIGFjdHMgdXBvbiBvciB3aXRoIGVudGl0aWVzOyBpdCBtYXkgaW5jbHVkZSBjb25zdW1pbmcsIHByb2Nlc3NpbmcsIHRyYW5zZm9ybWluZywgbW9kaWZ5aW5nLCByZWxvY2F0aW5nLCB1c2luZywgb3IgZ2VuZXJhdGluZyBlbnRpdGllcy5cclxuICAgKi9cclxuICBwdWJsaWMgYWN0aXZpdHk/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogU2V2ZXJhbCBhZ2VudHMgbWF5IGJlIGFzc29jaWF0ZWQgKGkuZS4gaGFzIHNvbWUgcmVzcG9uc2liaWxpdHkgZm9yIGFuIGFjdGl2aXR5KSB3aXRoIGFuIGFjdGl2aXR5IGFuZCB2aWNlLXZlcnNhLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhZ2VudDogZmhpci5Qcm92ZW5hbmNlQWdlbnRbXTtcclxuICAvKipcclxuICAgKiBBbiBlbnRpdHkgdXNlZCBpbiB0aGlzIGFjdGl2aXR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBlbnRpdHk6IGZoaXIuUHJvdmVuYW5jZUVudGl0eVtdO1xyXG4gIC8qKlxyXG4gICAqIEEgZGlnaXRhbCBzaWduYXR1cmUgb24gdGhlIHRhcmdldCBSZWZlcmVuY2UocykuIFRoZSBzaWduZXIgc2hvdWxkIG1hdGNoIGEgUHJvdmVuYW5jZS5hZ2VudC4gVGhlIHB1cnBvc2Ugb2YgdGhlIHNpZ25hdHVyZSBpcyBpbmRpY2F0ZWQuXHJcbiAgICovXHJcbiAgcHVibGljIHNpZ25hdHVyZTogZmhpci5TaWduYXR1cmVbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBQcm92ZW5hbmNlIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8UHJvdmVuYW5jZUFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdQcm92ZW5hbmNlJztcclxuICAgIGlmIChzb3VyY2VbJ3RhcmdldCddKSB7IHRoaXMudGFyZ2V0ID0gc291cmNlLnRhcmdldC5tYXAoKHgpID0+IG5ldyBmaGlyLlJlZmVyZW5jZSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnRhcmdldCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydvY2N1cnJlZCddKSB7IHRoaXMub2NjdXJyZWQgPSBzb3VyY2Uub2NjdXJyZWQ7IH1cclxuICAgIGVsc2UgaWYgKHNvdXJjZVsnb2NjdXJyZWRQZXJpb2QnXSkgeyB0aGlzLm9jY3VycmVkID0gbmV3IGZoaXIuUGVyaW9kKHNvdXJjZS5vY2N1cnJlZFBlcmlvZCk7IH1cclxuICAgIGVsc2UgaWYgKHNvdXJjZVsnb2NjdXJyZWREYXRlVGltZSddKSB7IHRoaXMub2NjdXJyZWQgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoe3ZhbHVlOiBzb3VyY2Uub2NjdXJyZWREYXRlVGltZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydyZWNvcmRlZCddKSB7IHRoaXMucmVjb3JkZWQgPSBuZXcgZmhpci5GaGlySW5zdGFudCh7dmFsdWU6IHNvdXJjZS5yZWNvcmRlZH0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5yZWNvcmRlZCA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ19yZWNvcmRlZCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnJlY29yZGVkKSB7IHRoaXMucmVjb3JkZWQuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fcmVjb3JkZWQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5yZWNvcmRlZCA9IG5ldyBmaGlyLkZoaXJJbnN0YW50KHNvdXJjZS5fcmVjb3JkZWQgYXMgUGFydGlhbDxmaGlyLkZoaXJJbnN0YW50QXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydwb2xpY3knXSkgeyB0aGlzLnBvbGljeSA9IHNvdXJjZS5wb2xpY3kubWFwKCh4KSA9PiBuZXcgZmhpci5GaGlyVXJpKHt2YWx1ZTogeH0pKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucG9saWN5ID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ19wb2xpY3knXSkge1xyXG4gICAgICBzb3VyY2UuX3BvbGljeS5mb3JFYWNoKCh4LGkpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5wb2xpY3kubGVuZ3RoID49IGkpIHsgaWYgKHgpIHsgdGhpcy5wb2xpY3lbaV0uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHgpOyB9IH1cclxuICAgICAgICBlbHNlIHsgaWYgKHgpIHsgdGhpcy5wb2xpY3kucHVzaChuZXcgZmhpci5GaGlyVXJpKHggYXMgUGFydGlhbDxmaGlyLkZoaXJVcmlBcmdzPikpOyB9IH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydsb2NhdGlvbiddKSB7IHRoaXMubG9jYXRpb24gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLmxvY2F0aW9uKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncmVhc29uJ10pIHsgdGhpcy5yZWFzb24gPSBzb3VyY2UucmVhc29uLm1hcCgoeCkgPT4gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucmVhc29uID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2FjdGl2aXR5J10pIHsgdGhpcy5hY3Rpdml0eSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UuYWN0aXZpdHkpOyB9XHJcbiAgICBpZiAoc291cmNlWydhZ2VudCddKSB7IHRoaXMuYWdlbnQgPSBzb3VyY2UuYWdlbnQubWFwKCh4KSA9PiBuZXcgZmhpci5Qcm92ZW5hbmNlQWdlbnQoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5hZ2VudCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydlbnRpdHknXSkgeyB0aGlzLmVudGl0eSA9IHNvdXJjZS5lbnRpdHkubWFwKCh4KSA9PiBuZXcgZmhpci5Qcm92ZW5hbmNlRW50aXR5KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZW50aXR5ID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ3NpZ25hdHVyZSddKSB7IHRoaXMuc2lnbmF0dXJlID0gc291cmNlLnNpZ25hdHVyZS5tYXAoKHgpID0+IG5ldyBmaGlyLlNpZ25hdHVyZSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnNpZ25hdHVyZSA9IFtdOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnUHJvdmVuYW5jZScgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlBTKCdyZXNvdXJjZVR5cGUnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UkEoJ3RhcmdldCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnb2NjdXJyZWQnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ3JlY29yZGVkJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdwb2xpY3knLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2xvY2F0aW9uJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdyZWFzb24nLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2FjdGl2aXR5JyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJBKCdhZ2VudCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPQSgnZW50aXR5JyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdzaWduYXR1cmUnLGV4cCkpO1xyXG4gICAgcmV0dXJuIGlzcztcclxuICB9XHJcbn1cclxuIl19