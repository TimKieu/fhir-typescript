// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR Resource: ResearchSubject
import * as fhir from '../fhir.js';
// @ts-ignore
import { ResearchSubjectStatusVsValidation } from '../fhirValueSets/ResearchSubjectStatusVsValidation.js';
/**
 * A physical entity which is the primary unit of operational and/or administrative interest in a study.
 */
export class ResearchSubject extends fhir.DomainResource {
    /**
     * Default constructor for ResearchSubject - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'ResearchSubject';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['status']) {
            this.status = new fhir.FhirCode({ value: source.status });
        }
        else {
            this.status = null;
        }
        if (source['_status']) {
            if (this.status) {
                this.status.addExtendedProperties(source._status);
            }
            else {
                this.status = new fhir.FhirCode(source._status);
            }
        }
        if (source['period']) {
            this.period = new fhir.Period(source.period);
        }
        if (source['study']) {
            this.study = new fhir.Reference(source.study);
        }
        else {
            this.study = null;
        }
        if (source['individual']) {
            this.individual = new fhir.Reference(source.individual);
        }
        else {
            this.individual = null;
        }
        if (source['assignedArm']) {
            this.assignedArm = new fhir.FhirString({ value: source.assignedArm });
        }
        if (source['_assignedArm']) {
            if (this.assignedArm) {
                this.assignedArm.addExtendedProperties(source._assignedArm);
            }
            else {
                this.assignedArm = new fhir.FhirString(source._assignedArm);
            }
        }
        if (source['actualArm']) {
            this.actualArm = new fhir.FhirString({ value: source.actualArm });
        }
        if (source['_actualArm']) {
            if (this.actualArm) {
                this.actualArm.addExtendedProperties(source._actualArm);
            }
            else {
                this.actualArm = new fhir.FhirString(source._actualArm);
            }
        }
        if (source['consent']) {
            this.consent = new fhir.Reference(source.consent);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ResearchSubject';
        }
        this.vRS('resourceType', exp);
        this.vOA('identifier', exp);
        this.vRSV('status', exp, 'ResearchSubjectStatus', ResearchSubjectStatusVsValidation, 'r');
        this.vOS('period', exp);
        this.vRS('study', exp);
        this.vRS('individual', exp);
        this.vOS('assignedArm', exp);
        this.vOS('actualArm', exp);
        this.vOS('consent', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ResearchSubject._fts_dataType = 'ResearchSubject';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVzZWFyY2hTdWJqZWN0LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9SZXNlYXJjaFN1YmplY3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLGdEQUFnRDtBQUNoRCxrQ0FBa0M7QUFDbEMsaUNBQWlDO0FBRWpDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSx1REFBdUQsQ0FBQztBQXVEMUc7O0dBRUc7QUFDSCxNQUFNLE9BQU8sZUFBZ0IsU0FBUSxJQUFJLENBQUMsY0FBYztJQXlDdEQ7O09BRUc7SUFDSCxZQUFZLFNBQXNDLEVBQUUsRUFBRSxVQUFzQyxFQUFFO1FBQzVGLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkIsSUFBSSxDQUFDLFlBQVksR0FBRyxpQkFBaUIsQ0FBQztRQUN0QyxJQUFJLE1BQU0sQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDaEc7WUFBRSxJQUFJLENBQUMsVUFBVSxHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQzlCLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQWdDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxNQUFNLEVBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDNUc7WUFBRSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzVCLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQ3JCLElBQUksSUFBSSxDQUFD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QUMsR0FBRyxDQUFDLENBQUE7UUFDckYsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDdEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDckIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDMUIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDM0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDekIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDdkIsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUF2RkQ7O0dBRUc7QUFDNkIsNkJBQWEsR0FBVSxpQkFBaUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yNGIuY29yZSB2ZXJzaW9uOiA0LjMuMFxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgUmVzb3VyY2U6IFJlc2VhcmNoU3ViamVjdFxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUmVzZWFyY2hTdWJqZWN0U3RhdHVzQ29kZXMsICBSZXNlYXJjaFN1YmplY3RTdGF0dXNDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUmVzZWFyY2hTdWJqZWN0U3RhdHVzQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFJlc2VhcmNoU3ViamVjdFN0YXR1c1ZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUmVzZWFyY2hTdWJqZWN0U3RhdHVzVnNWYWxpZGF0aW9uLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFJlc2VhcmNoU3ViamVjdCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBSZXNlYXJjaFN1YmplY3RBcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJSZXNlYXJjaFN1YmplY3RcInx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWRlbnRpZmllcnMgYXNzaWduZWQgdG8gdGhpcyByZXNlYXJjaCBzdWJqZWN0IGZvciBhIHN0dWR5LlxyXG4gICAqL1xyXG4gIGlkZW50aWZpZXI/OiBmaGlyLklkZW50aWZpZXJBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBzdWJqZWN0LlxyXG4gICAqL1xyXG4gIHN0YXR1czogZmhpci5GaGlyQ29kZTxSZXNlYXJjaFN1YmplY3RTdGF0dXNDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUmVzZWFyY2hTdWJqZWN0LnN0YXR1c1xyXG4gICAqL1xyXG4gIF9zdGF0dXM/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBkYXRlcyB0aGUgc3ViamVjdCBiZWdhbiBhbmQgZW5kZWQgdGhlaXIgcGFydGljaXBhdGlvbiBpbiB0aGUgc3R1ZHkuXHJcbiAgICovXHJcbiAgcGVyaW9kPzogZmhpci5QZXJpb2RBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBSZWZlcmVuY2UgdG8gdGhlIHN0dWR5IHRoZSBzdWJqZWN0IGlzIHBhcnRpY2lwYXRpbmcgaW4uXHJcbiAgICovXHJcbiAgc3R1ZHk6IGZoaXIuUmVmZXJlbmNlQXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSByZWNvcmQgb2YgdGhlIHBlcnNvbiBvciBhbmltYWwgd2hvIGlzIGludm9sdmVkIGluIHRoZSBzdHVkeS5cclxuICAgKi9cclxuICBpbmRpdmlkdWFsOiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgbmFtZSBvZiB0aGUgYXJtIGluIHRoZSBzdHVkeSB0aGUgc3ViamVjdCBpcyBleHBlY3RlZCB0byBmb2xsb3cgYXMgcGFydCBvZiB0aGlzIHN0dWR5LlxyXG4gICAqL1xyXG4gIGFzc2lnbmVkQXJtPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFJlc2VhcmNoU3ViamVjdC5hc3NpZ25lZEFybVxyXG4gICAqL1xyXG4gIF9hc3NpZ25lZEFybT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVGhlIG5hbWUgb2YgdGhlIGFybSBpbiB0aGUgc3R1ZHkgdGhlIHN1YmplY3QgYWN0dWFsbHkgZm9sbG93ZWQgYXMgcGFydCBvZiB0aGlzIHN0dWR5LlxyXG4gICAqL1xyXG4gIGFjdHVhbEFybT86IGZoaXIuRmhpclN0cmluZ3xzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBSZXNlYXJjaFN1YmplY3QuYWN0dWFsQXJtXHJcbiAgICovXHJcbiAgX2FjdHVhbEFybT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogQSByZWNvcmQgb2YgdGhlIHBhdGllbnQncyBpbmZvcm1lZCBhZ3JlZW1lbnQgdG8gcGFydGljaXBhdGUgaW4gdGhlIHN0dWR5LlxyXG4gICAqL1xyXG4gIGNvbnNlbnQ/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogQSBwaHlzaWNhbCBlbnRpdHkgd2hpY2ggaXMgdGhlIHByaW1hcnkgdW5pdCBvZiBvcGVyYXRpb25hbCBhbmQvb3IgYWRtaW5pc3RyYXRpdmUgaW50ZXJlc3QgaW4gYSBzdHVkeS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSZXNlYXJjaFN1YmplY3QgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ1Jlc2VhcmNoU3ViamVjdCc7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc291cmNlVHlwZTogXCJSZXNlYXJjaFN1YmplY3RcIjtcclxuICAvKipcclxuICAgKiBJZGVudGlmaWVycyBhc3NpZ25lZCB0byB0aGlzIHJlc2VhcmNoIHN1YmplY3QgZm9yIGEgc3R1ZHkuXHJcbiAgICovXHJcbiAgcHVibGljIGlkZW50aWZpZXI6IGZoaXIuSWRlbnRpZmllcltdO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBzdWJqZWN0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0dXM6IGZoaXIuRmhpckNvZGU8UmVzZWFyY2hTdWJqZWN0U3RhdHVzQ29kZVR5cGU+fG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIGRhdGVzIHRoZSBzdWJqZWN0IGJlZ2FuIGFuZCBlbmRlZCB0aGVpciBwYXJ0aWNpcGF0aW9uIGluIHRoZSBzdHVkeS5cclxuICAgKi9cclxuICBwdWJsaWMgcGVyaW9kPzogZmhpci5QZXJpb2R8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFJlZmVyZW5jZSB0byB0aGUgc3R1ZHkgdGhlIHN1YmplY3QgaXMgcGFydGljaXBhdGluZyBpbi5cclxuICAgKi9cclxuICBwdWJsaWMgc3R1ZHk6IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHJlY29yZCBvZiB0aGUgcGVyc29uIG9yIGFuaW1hbCB3aG8gaXMgaW52b2x2ZWQgaW4gdGhlIHN0dWR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbmRpdmlkdWFsOiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBhcm0gaW4gdGhlIHN0dWR5IHRoZSBzdWJqZWN0IGlzIGV4cGVjdGVkIHRvIGZvbGxvdyBhcyBwYXJ0IG9mIHRoaXMgc3R1ZHkuXHJcbiAgICovXHJcbiAgcHVibGljIGFzc2lnbmVkQXJtPzogZmhpci5GaGlyU3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgbmFtZSBvZiB0aGUgYXJtIGluIHRoZSBzdHVkeSB0aGUgc3ViamVjdCBhY3R1YWxseSBmb2xsb3dlZCBhcyBwYXJ0IG9mIHRoaXMgc3R1ZHkuXHJcbiAgICovXHJcbiAgcHVibGljIGFjdHVhbEFybT86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQSByZWNvcmQgb2YgdGhlIHBhdGllbnQncyBpbmZvcm1lZCBhZ3JlZW1lbnQgdG8gcGFydGljaXBhdGUgaW4gdGhlIHN0dWR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zZW50PzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFJlc2VhcmNoU3ViamVjdCAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFJlc2VhcmNoU3ViamVjdEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdSZXNlYXJjaFN1YmplY3QnO1xyXG4gICAgaWYgKHNvdXJjZVsnaWRlbnRpZmllciddKSB7IHRoaXMuaWRlbnRpZmllciA9IHNvdXJjZS5pZGVudGlmaWVyLm1hcCgoeCkgPT4gbmV3IGZoaXIuSWRlbnRpZmllcih4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmlkZW50aWZpZXIgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3RhdHVzJ10pIHsgdGhpcy5zdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxSZXNlYXJjaFN1YmplY3RTdGF0dXNDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2Uuc3RhdHVzfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnN0YXR1cyA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ19zdGF0dXMnXSkge1xyXG4gICAgICBpZiAodGhpcy5zdGF0dXMpIHsgdGhpcy5zdGF0dXMuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fc3RhdHVzISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuc3RhdHVzID0gbmV3IGZoaXIuRmhpckNvZGU8UmVzZWFyY2hTdWJqZWN0U3RhdHVzQ29kZVR5cGU+KHNvdXJjZS5fc3RhdHVzIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydwZXJpb2QnXSkgeyB0aGlzLnBlcmlvZCA9IG5ldyBmaGlyLlBlcmlvZChzb3VyY2UucGVyaW9kKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3R1ZHknXSkgeyB0aGlzLnN0dWR5ID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5zdHVkeSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnN0dWR5ID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaW5kaXZpZHVhbCddKSB7IHRoaXMuaW5kaXZpZHVhbCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuaW5kaXZpZHVhbCk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmluZGl2aWR1YWwgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydhc3NpZ25lZEFybSddKSB7IHRoaXMuYXNzaWduZWRBcm0gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLmFzc2lnbmVkQXJtfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19hc3NpZ25lZEFybSddKSB7XHJcbiAgICAgIGlmICh0aGlzLmFzc2lnbmVkQXJtKSB7IHRoaXMuYXNzaWduZWRBcm0uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fYXNzaWduZWRBcm0hKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5hc3NpZ25lZEFybSA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9hc3NpZ25lZEFybSBhcyBQYXJ0aWFsPGZoaXIuRmhpclN0cmluZ0FyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnYWN0dWFsQXJtJ10pIHsgdGhpcy5hY3R1YWxBcm0gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLmFjdHVhbEFybX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfYWN0dWFsQXJtJ10pIHtcclxuICAgICAgaWYgKHRoaXMuYWN0dWFsQXJtKSB7IHRoaXMuYWN0dWFsQXJtLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2FjdHVhbEFybSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmFjdHVhbEFybSA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9hY3R1YWxBcm0gYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2NvbnNlbnQnXSkgeyB0aGlzLmNvbnNlbnQgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLmNvbnNlbnQpOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnUmVzZWFyY2hTdWJqZWN0JyB9XHJcbiAgICB0aGlzLnZSUygncmVzb3VyY2VUeXBlJyxleHApXHJcbiAgICB0aGlzLnZPQSgnaWRlbnRpZmllcicsZXhwKVxyXG4gICAgdGhpcy52UlNWKCdzdGF0dXMnLGV4cCwnUmVzZWFyY2hTdWJqZWN0U3RhdHVzJyxSZXNlYXJjaFN1YmplY3RTdGF0dXNWc1ZhbGlkYXRpb24sJ3InKVxyXG4gICAgdGhpcy52T1MoJ3BlcmlvZCcsZXhwKVxyXG4gICAgdGhpcy52UlMoJ3N0dWR5JyxleHApXHJcbiAgICB0aGlzLnZSUygnaW5kaXZpZHVhbCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2Fzc2lnbmVkQXJtJyxleHApXHJcbiAgICB0aGlzLnZPUygnYWN0dWFsQXJtJyxleHApXHJcbiAgICB0aGlzLnZPUygnY29uc2VudCcsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuIl19