// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: CodeableConcept
import * as fhir from '../fhir.js';
/**
 * A concept that may be defined by a formal reference to a terminology or ontology or may be provided by text.
 */
export class CodeableConcept extends fhir.FhirElement {
    /**
     * Default constructor for CodeableConcept - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['coding']) {
            this.coding = source.coding.map((x) => new fhir.Coding(x));
        }
        else {
            this.coding = [];
        }
        if (source['text']) {
            this.text = new fhir.FhirString({ value: source.text });
        }
        if (source['_text']) {
            if (this.text) {
                this.text.addExtendedProperties(source._text);
            }
            else {
                this.text = new fhir.FhirString(source._text);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'CodeableConcept';
        }
        this.vOA('coding', exp);
        this.vOS('text', exp);
        return issues;
    }
    /**
     * Fluent-style function to add codings
     * @param coding
     * @returns this CodeableConcept, with the additional coding
     */
    addCoding(coding) {
        this.coding.push(new fhir.Coding(coding));
        return this;
    }
    /**
     * Fluent-style function to remove ALL instances of codings with a system and/or code
     * @param system
     * @param code
     * @returns this CodeableConcept, updated without the requesting coding
     */
    removeCoding(system, code) {
        if (this.coding.length === 0) {
            return this;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        let clean = this.coding.filter((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c)))) ?? [];
        this.coding = clean;
        return this;
    }
    /**
     * Find the first coding with a matching system and/or code
     * @param system
     * @param code
     * @returns A matching Coding or undefined.
     */
    findCoding(system, code) {
        if (this.coding.length === 0) {
            return undefined;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        return this.coding.find((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c))));
    }
    /**
     * Find all instances of an extension with a matching URL, optionally recurse into extension.extension.
     * @param url URL to search for
     * @param searchNested If the search should nest into extensions
     * @returns A new array of FHIR Extensions, with just the desired extensions
     */
    filterCodings(system, code) {
        if (this.coding.length === 0) {
            return [];
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        return this.coding.filter((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c))));
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCoding(system, code) {
        if (this.coding.length === 0) {
            return false;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        if ((s) && (c)) {
            return (this.coding.find((coding) => (coding.system?.value === s) && (coding.code?.value === c)) !== undefined);
        }
        if (s) {
            return (this.coding.find((coding) => (coding.system?.value === s)) !== undefined);
        }
        if (c) {
            return (this.coding.find((coding) => coding.code?.value === c) !== undefined);
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromObject(codings) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const obj of Object.values(codings)) {
            if (!obj) {
                continue;
            }
            const system = obj['system'] ?? '';
            const code = obj['code'] ?? '';
            if (this.hasCoding(system, code)) {
                return true;
            }
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromValidationObj(vsValidation) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const coding of this.coding) {
            const sc = (coding.system?.value ?? '') + '|' + (coding.code?.value ?? '');
            const c = coding.code?.value ?? '';
            if (vsValidation.find((v) => (v === sc) || (v === c))) {
                return true;
            }
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromValidationHash(vsValidation) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const coding of this.coding) {
            const sc = fhir.FhirBase._hash52_1a_fast((coding.system?.value ?? '') + '|' + (coding.code?.value ?? ''));
            const c = fhir.FhirBase._hash52_1a_fast(coding.code?.value ?? '');
            if (vsValidation.find((v) => (v === sc) || (v === c))) {
                return true;
            }
        }
        return false;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
CodeableConcept._fts_dataType = 'CodeableConcept';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29kZWFibGVDb25jZXB0LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9Db2RlYWJsZUNvbmNlcHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLGdEQUFnRDtBQUNoRCxrQ0FBa0M7QUFDbEMsb0NBQW9DO0FBRXBDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBb0JuQzs7R0FFRztBQUNILE1BQU0sT0FBTyxlQUFnQixTQUFRLElBQUksQ0FBQyxXQUFXO0lBYW5EOztPQUVHO0lBQ0gsWUFBWSxTQUFzQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUM1RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNoRjtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDMUIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQzlFLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxLQUFNLENBQUMsQ0FBQzthQUFFO2lCQUM3RDtnQkFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsS0FBcUMsQ0FBQyxDQUFDO2FBQUU7U0FDeEY7SUFDSCxDQUFDO0lBQ0Q7O09BRUc7SUFDYSxpQkFBaUIsQ0FBQyxNQUFhLEVBQUU7UUFDL0MsSUFBSSxNQUFNLEdBQW1CLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUMxRCxJQUFJLEdBQUcsS0FBSyxFQUFFLEVBQUU7WUFBRSxHQUFHLEdBQUcsaUJBQWlCLENBQUE7U0FBRTtRQUMzQyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUN0QixJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUNwQixPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBQ0Q7Ozs7T0FJRztJQUNLLFNBQVMsQ0FBQyxNQUFzQjtRQUN0QyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUMxQyxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLFlBQVksQ0FBQyxNQUE2QixFQUFFLElBQTJCO1FBQzVFLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzVCLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxNQUFNLENBQUMsR0FBVSxDQUFDLE9BQU8sTUFBTSxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFFLE1BQTBCLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQztRQUNqRyxNQUFNLENBQUMsR0FBVSxDQUFDLE9BQU8sSUFBSSxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFFLElBQXdCLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQztRQUMzRixJQUFJLEtBQUssR0FBaUIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM3SixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztRQUNwQixPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLFVBQVUsQ0FBQyxNQUE2QixFQUFFLElBQTJCO1FBQzFFLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzVCLE9BQU8sU0FBUyxDQUFDO1NBQ2xCO1FBQ0QsTUFBTSxDQUFDLEdBQVUsQ0FBQyxPQUFPLE1BQU0sS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBRSxNQUEwQixDQUFDLEtBQUssSUFBSSxFQUFFLENBQUM7UUFDakcsTUFBTSxDQUFDLEdBQVUsQ0FBQyxPQUFPLElBQUksS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBRSxJQUF3QixDQUFDLEtBQUssSUFBSSxFQUFFLENBQUM7UUFDM0YsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFD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QUssTUFBTSxNQUFNLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNoQyxNQUFNLEVBQUUsR0FBVSxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsS0FBSyxJQUFJLEVBQUUsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsS0FBSyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDakgsTUFBTSxDQUFDLEdBQVUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLENBQUM7WUFFekUsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFO2dCQUNyRCxPQUFPLElBQUksQ0FBQzthQUNiO1NBQ0Y7UUFFRCxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7O0FBN0xEOztHQUVHO0FBQzZCLDZCQUFhLEdBQVUsaUJBQWlCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjRiLmNvcmUgdmVyc2lvbjogNC4zLjBcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIENvbXBsZXhUeXBlOiBDb2RlYWJsZUNvbmNlcHRcclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgQ29kZWFibGVDb25jZXB0IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIENvZGVhYmxlQ29uY2VwdEFyZ3MgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogQ29kZXMgbWF5IGJlIGRlZmluZWQgdmVyeSBjYXN1YWxseSBpbiBlbnVtZXJhdGlvbnMsIG9yIGNvZGUgbGlzdHMsIHVwIHRvIHZlcnkgZm9ybWFsIGRlZmluaXRpb25zIHN1Y2ggYXMgU05PTUVEIENUIC0gc2VlIHRoZSBITDcgdjMgQ29yZSBQcmluY2lwbGVzIGZvciBtb3JlIGluZm9ybWF0aW9uLiAgT3JkZXJpbmcgb2YgY29kaW5ncyBpcyB1bmRlZmluZWQgYW5kIFNIQUxMIE5PVCBiZSB1c2VkIHRvIGluZmVyIG1lYW5pbmcuIEdlbmVyYWxseSwgYXQgbW9zdCBvbmx5IG9uZSBvZiB0aGUgY29kaW5nIHZhbHVlcyB3aWxsIGJlIGxhYmVsZWQgYXMgVXNlclNlbGVjdGVkID0gdHJ1ZS5cclxuICAgKi9cclxuICBjb2Rpbmc/OiBmaGlyLkNvZGluZ0FyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVmVyeSBvZnRlbiB0aGUgdGV4dCBpcyB0aGUgc2FtZSBhcyBhIGRpc3BsYXlOYW1lIG9mIG9uZSBvZiB0aGUgY29kaW5ncy5cclxuICAgKi9cclxuICB0ZXh0PzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IENvZGVhYmxlQ29uY2VwdC50ZXh0XHJcbiAgICovXHJcbiAgX3RleHQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG59XHJcblxyXG4vKipcclxuICogQSBjb25jZXB0IHRoYXQgbWF5IGJlIGRlZmluZWQgYnkgYSBmb3JtYWwgcmVmZXJlbmNlIHRvIGEgdGVybWlub2xvZ3kgb3Igb250b2xvZ3kgb3IgbWF5IGJlIHByb3ZpZGVkIGJ5IHRleHQuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ29kZWFibGVDb25jZXB0IGV4dGVuZHMgZmhpci5GaGlyRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdDb2RlYWJsZUNvbmNlcHQnO1xyXG4gIC8qKlxyXG4gICAqIENvZGVzIG1heSBiZSBkZWZpbmVkIHZlcnkgY2FzdWFsbHkgaW4gZW51bWVyYXRpb25zLCBvciBjb2RlIGxpc3RzLCB1cCB0byB2ZXJ5IGZvcm1hbCBkZWZpbml0aW9ucyBzdWNoIGFzIFNOT01FRCBDVCAtIHNlZSB0aGUgSEw3IHYzIENvcmUgUHJpbmNpcGxlcyBmb3IgbW9yZSBpbmZvcm1hdGlvbi4gIE9yZGVyaW5nIG9mIGNvZGluZ3MgaXMgdW5kZWZpbmVkIGFuZCBTSEFMTCBOT1QgYmUgdXNlZCB0byBpbmZlciBtZWFuaW5nLiBHZW5lcmFsbHksIGF0IG1vc3Qgb25seSBvbmUgb2YgdGhlIGNvZGluZyB2YWx1ZXMgd2lsbCBiZSBsYWJlbGVkIGFzIFVzZXJTZWxlY3RlZCA9IHRydWUuXHJcbiAgICovXHJcbiAgcHVibGljIGNvZGluZzogZmhpci5Db2RpbmdbXTtcclxuICAvKipcclxuICAgKiBWZXJ5IG9mdGVuIHRoZSB0ZXh0IGlzIHRoZSBzYW1lIGFzIGEgZGlzcGxheU5hbWUgb2Ygb25lIG9mIHRoZSBjb2RpbmdzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0ZXh0PzogZmhpci5GaGlyU3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBDb2RlYWJsZUNvbmNlcHQgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxDb2RlYWJsZUNvbmNlcHRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsnY29kaW5nJ10pIHsgdGhpcy5jb2RpbmcgPSBzb3VyY2UuY29kaW5nLm1hcCgoeCkgPT4gbmV3IGZoaXIuQ29kaW5nKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuY29kaW5nID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ3RleHQnXSkgeyB0aGlzLnRleHQgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLnRleHR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3RleHQnXSkge1xyXG4gICAgICBpZiAodGhpcy50ZXh0KSB7IHRoaXMudGV4dC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl90ZXh0ISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudGV4dCA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl90ZXh0IGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnQ29kZWFibGVDb25jZXB0JyB9XHJcbiAgICB0aGlzLnZPQSgnY29kaW5nJyxleHApXHJcbiAgICB0aGlzLnZPUygndGV4dCcsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbiAgLyoqXHJcbiAgICogRmx1ZW50LXN0eWxlIGZ1bmN0aW9uIHRvIGFkZCBjb2RpbmdzXHJcbiAgICogQHBhcmFtIGNvZGluZyBcclxuICAgKiBAcmV0dXJucyB0aGlzIENvZGVhYmxlQ29uY2VwdCwgd2l0aCB0aGUgYWRkaXRpb25hbCBjb2RpbmdcclxuICAgKi9cclxuICAgcHVibGljIGFkZENvZGluZyhjb2Rpbmc6Zmhpci5Db2RpbmdBcmdzKTpDb2RlYWJsZUNvbmNlcHQge1xyXG4gICAgdGhpcy5jb2RpbmcucHVzaChuZXcgZmhpci5Db2RpbmcoY29kaW5nKSk7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZsdWVudC1zdHlsZSBmdW5jdGlvbiB0byByZW1vdmUgQUxMIGluc3RhbmNlcyBvZiBjb2RpbmdzIHdpdGggYSBzeXN0ZW0gYW5kL29yIGNvZGVcclxuICAgKiBAcGFyYW0gc3lzdGVtIFxyXG4gICAqIEBwYXJhbSBjb2RlIFxyXG4gICAqIEByZXR1cm5zIHRoaXMgQ29kZWFibGVDb25jZXB0LCB1cGRhdGVkIHdpdGhvdXQgdGhlIHJlcXVlc3RpbmcgY29kaW5nXHJcbiAgICovXHJcbiAgcHVibGljIHJlbW92ZUNvZGluZyhzeXN0ZW06Zmhpci5GaGlyU3RyaW5nfHN0cmluZywgY29kZTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nKTpDb2RlYWJsZUNvbmNlcHQge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIGNvbnN0IHM6c3RyaW5nID0gKHR5cGVvZiBzeXN0ZW0gPT09ICdzdHJpbmcnKSA/IHN5c3RlbSA6IChzeXN0ZW0gYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIGNvbnN0IGM6c3RyaW5nID0gKHR5cGVvZiBjb2RlID09PSAnc3RyaW5nJykgPyBjb2RlIDogKGNvZGUgYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIGxldCBjbGVhbjpmaGlyLkNvZGluZ1tdID0gdGhpcy5jb2RpbmcuZmlsdGVyKChjb2RpbmcpID0+ICgoKHMgPT09ICcnKSB8fCAoY29kaW5nLnN5c3RlbT8udmFsdWUgPT09IHMpKSAmJiAoKGMgPT09ICcnKSB8fCAoY29kaW5nLmNvZGU/LnZhbHVlID09PSBjKSkpKSA/PyBbXTtcclxuICAgIHRoaXMuY29kaW5nID0gY2xlYW47XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZpbmQgdGhlIGZpcnN0IGNvZGluZyB3aXRoIGEgbWF0Y2hpbmcgc3lzdGVtIGFuZC9vciBjb2RlXHJcbiAgICogQHBhcmFtIHN5c3RlbSBcclxuICAgKiBAcGFyYW0gY29kZSBcclxuICAgKiBAcmV0dXJucyBBIG1hdGNoaW5nIENvZGluZyBvciB1bmRlZmluZWQuXHJcbiAgICovXHJcbiAgcHVibGljIGZpbmRDb2Rpbmcoc3lzdGVtOmZoaXIuRmhpclN0cmluZ3xzdHJpbmcsIGNvZGU6Zmhpci5GaGlyU3RyaW5nfHN0cmluZyk6Zmhpci5Db2Rpbmd8dW5kZWZpbmVkIHtcclxuICAgIGlmICh0aGlzLmNvZGluZy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIGNvbnN0IHM6c3RyaW5nID0gKHR5cGVvZiBzeXN0ZW0gPT09ICdzdHJpbmcnKSA/IHN5c3RlbSA6IChzeXN0ZW0gYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIGNvbnN0IGM6c3RyaW5nID0gKHR5cGVvZiBjb2RlID09PSAnc3RyaW5nJykgPyBjb2RlIDogKGNvZGUgYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIHJldHVybiB0aGlzLmNvZGluZy5maW5kKChjb2RpbmcpID0+ICgoKHMgPT09ICcnKSB8fCAoY29kaW5nLnN5c3RlbT8udmFsdWUgPT09IHMpKSAmJiAoKGMgPT09ICcnKSB8fCAoY29kaW5nLmNvZGU/LnZhbHVlID09PSBjKSkpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZpbmQgYWxsIGluc3RhbmNlcyBvZiBhbiBleHRlbnNpb24gd2l0aCBhIG1hdGNoaW5nIFVSTCwgb3B0aW9uYWxseSByZWN1cnNlIGludG8gZXh0ZW5zaW9uLmV4dGVuc2lvbi5cclxuICAgKiBAcGFyYW0gdXJsIFVSTCB0byBzZWFyY2ggZm9yXHJcbiAgICogQHBhcmFtIHNlYXJjaE5lc3RlZCBJZiB0aGUgc2VhcmNoIHNob3VsZCBuZXN0IGludG8gZXh0ZW5zaW9uc1xyXG4gICAqIEByZXR1cm5zIEEgbmV3IGFycmF5IG9mIEZISVIgRXh0ZW5zaW9ucywgd2l0aCBqdXN0IHRoZSBkZXNpcmVkIGV4dGVuc2lvbnNcclxuICAgKi9cclxuICBwdWJsaWMgZmlsdGVyQ29kaW5ncyhzeXN0ZW06Zmhpci5GaGlyU3RyaW5nfHN0cmluZywgY29kZTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nKTpmaGlyLkNvZGluZ1tdIHtcclxuICAgIGlmICh0aGlzLmNvZGluZy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgY29uc3QgczpzdHJpbmcgPSAodHlwZW9mIHN5c3RlbSA9PT0gJ3N0cmluZycpID8gc3lzdGVtIDogKHN5c3RlbSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgY29uc3QgYzpzdHJpbmcgPSAodHlwZW9mIGNvZGUgPT09ICdzdHJpbmcnKSA/IGNvZGUgOiAoY29kZSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgcmV0dXJuIHRoaXMuY29kaW5nLmZpbHRlcigoY29kaW5nKSA9PiAoKChzID09PSAnJykgfHwgKGNvZGluZy5zeXN0ZW0/LnZhbHVlID09PSBzKSkgJiYgKChjID09PSAnJykgfHwgKGNvZGluZy5jb2RlPy52YWx1ZSA9PT0gYykpKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUZXN0IHdoZXRoZXIgdGhpcyBDb2RlYWJsZUNvbmNlcHQgY29udGFpbnMgYSBzcGVjaWZpYyBjb2RpbmcuXHJcbiAgICogQHBhcmFtIHN5c3RlbSBTeXN0ZW0gdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IHN5c3RlbS5cclxuICAgKiBAcGFyYW0gY29kZSBDb2RlIHRvIHNlYXJjaCBmb3IsIGVtcHR5IHN0cmluZyB3aWxsIG1hdGNoIGFueSBjb2RlLlxyXG4gICAqIEByZXR1cm5zIFRydWUgaWYgdGhpcyBjb25jZXB0IGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgY29kaW5nLCBmYWxzZSBpZiBpdCBkb2VzIG5vdC5cclxuICAgKi9cclxuICBwdWJsaWMgaGFzQ29kaW5nKHN5c3RlbTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nLCBjb2RlOmZoaXIuRmhpclN0cmluZ3xzdHJpbmcpOmJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHM6c3RyaW5nID0gKHR5cGVvZiBzeXN0ZW0gPT09ICdzdHJpbmcnKSA/IHN5c3RlbSA6IChzeXN0ZW0gYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIGNvbnN0IGM6c3RyaW5nID0gKHR5cGVvZiBjb2RlID09PSAnc3RyaW5nJykgPyBjb2RlIDogKGNvZGUgYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuXHJcbiAgICBpZiAoKHMpICYmIChjKSkge1xyXG4gICAgICByZXR1cm4gKHRoaXMuY29kaW5nLmZpbmQoKGNvZGluZykgPT4gKGNvZGluZy5zeXN0ZW0/LnZhbHVlID09PSBzKSAmJiAoY29kaW5nLmNvZGU/LnZhbHVlID09PSBjKSkgIT09IHVuZGVmaW5lZCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHMpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLmNvZGluZy5maW5kKChjb2RpbmcpID0+IChjb2Rpbmcuc3lzdGVtPy52YWx1ZSA9PT0gcykpICE9PSB1bmRlZmluZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5jb2RpbmcuZmluZCgoY29kaW5nKSA9PiBjb2RpbmcuY29kZT8udmFsdWUgPT09IGMpICE9PSB1bmRlZmluZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRlc3Qgd2hldGhlciB0aGlzIENvZGVhYmxlQ29uY2VwdCBjb250YWlucyBhIHNwZWNpZmljIGNvZGluZy5cclxuICAgKiBAcGFyYW0gc3lzdGVtIFN5c3RlbSB0byBzZWFyY2ggZm9yLCBlbXB0eSBzdHJpbmcgd2lsbCBtYXRjaCBhbnkgc3lzdGVtLlxyXG4gICAqIEBwYXJhbSBjb2RlIENvZGUgdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IGNvZGUuXHJcbiAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGlzIGNvbmNlcHQgY29udGFpbnMgdGhlIHNwZWNpZmllZCBjb2RpbmcsIGZhbHNlIGlmIGl0IGRvZXMgbm90LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBoYXNDb2RpbmdGcm9tT2JqZWN0KGNvZGluZ3M6YW55KTpib29sZWFuIHtcclxuICAgIGlmICh0aGlzLmNvZGluZy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAoY29uc3Qgb2JqIG9mIE9iamVjdC52YWx1ZXMoY29kaW5ncykpIHtcclxuICAgICAgaWYgKCFvYmopIHsgY29udGludWU7IH1cclxuICAgICAgY29uc3Qgc3lzdGVtOnN0cmluZyA9IChvYmogYXMgYW55KVsnc3lzdGVtJ10gPz8gJyc7XHJcbiAgICAgIGNvbnN0IGNvZGU6c3RyaW5nID0gKG9iaiBhcyBhbnkpWydjb2RlJ10gPz8gJyc7XHJcblxyXG4gICAgICBpZiAodGhpcy5oYXNDb2Rpbmcoc3lzdGVtLCBjb2RlKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGVzdCB3aGV0aGVyIHRoaXMgQ29kZWFibGVDb25jZXB0IGNvbnRhaW5zIGEgc3BlY2lmaWMgY29kaW5nLlxyXG4gICAqIEBwYXJhbSBzeXN0ZW0gU3lzdGVtIHRvIHNlYXJjaCBmb3IsIGVtcHR5IHN0cmluZyB3aWxsIG1hdGNoIGFueSBzeXN0ZW0uXHJcbiAgICogQHBhcmFtIGNvZGUgQ29kZSB0byBzZWFyY2ggZm9yLCBlbXB0eSBzdHJpbmcgd2lsbCBtYXRjaCBhbnkgY29kZS5cclxuICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoaXMgY29uY2VwdCBjb250YWlucyB0aGUgc3BlY2lmaWVkIGNvZGluZywgZmFsc2UgaWYgaXQgZG9lcyBub3QuXHJcbiAgICovXHJcbiAgcHVibGljIGhhc0NvZGluZ0Zyb21WYWxpZGF0aW9uT2JqKHZzVmFsaWRhdGlvbjpSZWFkb25seTxzdHJpbmdbXT4pOmJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBjb2Rpbmcgb2YgdGhpcy5jb2RpbmcpIHtcclxuICAgICAgY29uc3Qgc2M6c3RyaW5nID0gKGNvZGluZy5zeXN0ZW0/LnZhbHVlID8/ICcnKSArICd8JyArIChjb2RpbmcuY29kZT8udmFsdWUgPz8gJycpO1xyXG4gICAgICBjb25zdCBjOnN0cmluZyA9IGNvZGluZy5jb2RlPy52YWx1ZSA/PyAnJztcclxuXHJcbiAgICAgIGlmICh2c1ZhbGlkYXRpb24uZmluZCgodikgPT4gKHYgPT09IHNjKSB8fCAodiA9PT0gYykpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUZXN0IHdoZXRoZXIgdGhpcyBDb2RlYWJsZUNvbmNlcHQgY29udGFpbnMgYSBzcGVjaWZpYyBjb2RpbmcuXHJcbiAgICogQHBhcmFtIHN5c3RlbSBTeXN0ZW0gdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IHN5c3RlbS5cclxuICAgKiBAcGFyYW0gY29kZSBDb2RlIHRvIHNlYXJjaCBmb3IsIGVtcHR5IHN0cmluZyB3aWxsIG1hdGNoIGFueSBjb2RlLlxyXG4gICAqIEByZXR1cm5zIFRydWUgaWYgdGhpcyBjb25jZXB0IGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgY29kaW5nLCBmYWxzZSBpZiBpdCBkb2VzIG5vdC5cclxuICAgKi9cclxuICBwdWJsaWMgaGFzQ29kaW5nRnJvbVZhbGlkYXRpb25IYXNoKHZzVmFsaWRhdGlvbjpSZWFkb25seTxudW1iZXJbXT4pOmJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBjb2Rpbmcgb2YgdGhpcy5jb2RpbmcpIHtcclxuICAgICAgY29uc3Qgc2M6bnVtYmVyID0gZmhpci5GaGlyQmFzZS5faGFzaDUyXzFhX2Zhc3QoKGNvZGluZy5zeXN0ZW0/LnZhbHVlID8/ICcnKSArICd8JyArIChjb2RpbmcuY29kZT8udmFsdWUgPz8gJycpKTtcclxuICAgICAgY29uc3QgYzpudW1iZXIgPSBmaGlyLkZoaXJCYXNlLl9oYXNoNTJfMWFfZmFzdChjb2RpbmcuY29kZT8udmFsdWUgPz8gJycpO1xyXG5cclxuICAgICAgaWYgKHZzVmFsaWRhdGlvbi5maW5kKCh2KSA9PiAodiA9PT0gc2MpIHx8ICh2ID09PSBjKSkpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgfVxyXG4iXX0=