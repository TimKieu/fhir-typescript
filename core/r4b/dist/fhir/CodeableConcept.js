// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: CodeableConcept
import * as fhir from '../fhir.js';
/**
 * A concept that may be defined by a formal reference to a terminology or ontology or may be provided by text.
 */
export class CodeableConcept extends fhir.FhirElement {
    /**
     * Default constructor for CodeableConcept - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['coding']) {
            this.coding = source.coding.map((x) => new fhir.Coding(x));
        }
        else {
            this.coding = [];
        }
        if (source['text']) {
            this.text = new fhir.FhirString({ value: source.text });
        }
        if (source['_text']) {
            if (this.text) {
                this.text.addExtendedProperties(source._text);
            }
            else {
                this.text = new fhir.FhirString(source._text);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'CodeableConcept';
        }
        iss.push(...this.vOA('coding', exp));
        iss.push(...this.vOS('text', exp));
        return iss;
    }
    /**
     * Fluent-style function to add codings
     * @param coding
     * @returns this CodeableConcept, with the additional coding
     */
    addCoding(coding) {
        this.coding.push(new fhir.Coding(coding));
        return this;
    }
    /**
     * Fluent-style function to remove ALL instances of codings with a system and/or code
     * @param system
     * @param code
     * @returns this CodeableConcept, updated without the requesting coding
     */
    removeCoding(system, code) {
        if (this.coding.length === 0) {
            return this;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        let clean = this.coding.filter((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c)))) ?? [];
        this.coding = clean;
        return this;
    }
    /**
     * Find the first coding with a matching system and/or code
     * @param system
     * @param code
     * @returns A matching Coding or undefined.
     */
    findCoding(system, code) {
        if (this.coding.length === 0) {
            return undefined;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        return this.coding.find((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c))));
    }
    /**
     * Find all instances of an extension with a matching URL, optionally recurse into extension.extension.
     * @param url URL to search for
     * @param searchNested If the search should nest into extensions
     * @returns A new array of FHIR Extensions, with just the desired extensions
     */
    filterCodings(system, code) {
        if (this.coding.length === 0) {
            return [];
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        return this.coding.filter((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c))));
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCoding(system, code) {
        if (this.coding.length === 0) {
            return false;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        if ((s) && (c)) {
            return (this.coding.find((coding) => (coding.system?.value === s) && (coding.code?.value === c)) !== undefined);
        }
        if (s) {
            return (this.coding.find((coding) => (coding.system?.value === s)) !== undefined);
        }
        if (c) {
            return (this.coding.find((coding) => coding.code?.value === c) !== undefined);
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromObject(codings) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const obj of Object.values(codings)) {
            if (!obj) {
                continue;
            }
            const system = obj['system'] ?? '';
            const code = obj['code'] ?? '';
            if (this.hasCoding(system, code)) {
                return true;
            }
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromValidationObj(vsValidation) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const coding of this.coding) {
            const sc = (coding.system?.value ?? '') + '|' + (coding.code?.value ?? '');
            const c = coding.code?.value ?? '';
            if (vsValidation.find((v) => (v === sc) || (v === c))) {
                return true;
            }
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromValidationHash(vsValidation) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const coding of this.coding) {
            const sc = fhir.FhirBase._hash52_1a_fast((coding.system?.value ?? '') + '|' + (coding.code?.value ?? ''));
            const c = fhir.FhirBase._hash52_1a_fast(coding.code?.value ?? '');
            if (vsValidation.find((v) => (v === sc) || (v === c))) {
                return true;
            }
        }
        return false;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
CodeableConcept._fts_dataType = 'CodeableConcept';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29kZWFibGVDb25jZXB0LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9Db2RlYWJsZUNvbmNlcHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLGdEQUFnRDtBQUNoRCxrQ0FBa0M7QUFDbEMsb0NBQW9DO0FBRXBDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBb0JuQzs7R0FFRztBQUNILE1BQU0sT0FBTyxlQUFnQixTQUFRLElBQUksQ0FBQyxXQUFXO0lBYW5EOztPQUVHO0lBQ0gsWUFBWSxTQUFzQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUM1RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNoRjtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDMUIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQzlFLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxLQUFNLENBQUMsQ0FBQzthQUFFO2lCQUM3RDtnQkFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFN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LENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUM1QixPQUFPLEtBQUssQ0FBQztTQUNkO1FBRUQsS0FBSyxNQUFNLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2hDLE1BQU0sRUFBRSxHQUFVLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztZQUNqSCxNQUFNLENBQUMsR0FBVSxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssSUFBSSxFQUFFLENBQUMsQ0FBQztZQUV6RSxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQ3JELE9BQU8sSUFBSSxDQUFDO2FBQ2I7U0FDRjtRQUVELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQzs7QUE3TEQ7O0dBRUc7QUFDNkIsNkJBQWEsR0FBVSxpQkFBaUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yNGIuY29yZSB2ZXJzaW9uOiA0LjMuMFxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgQ29tcGxleFR5cGU6IENvZGVhYmxlQ29uY2VwdFxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBDb2RlYWJsZUNvbmNlcHQgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29kZWFibGVDb25jZXB0QXJncyBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBDb2RlcyBtYXkgYmUgZGVmaW5lZCB2ZXJ5IGNhc3VhbGx5IGluIGVudW1lcmF0aW9ucywgb3IgY29kZSBsaXN0cywgdXAgdG8gdmVyeSBmb3JtYWwgZGVmaW5pdGlvbnMgc3VjaCBhcyBTTk9NRUQgQ1QgLSBzZWUgdGhlIEhMNyB2MyBDb3JlIFByaW5jaXBsZXMgZm9yIG1vcmUgaW5mb3JtYXRpb24uICBPcmRlcmluZyBvZiBjb2RpbmdzIGlzIHVuZGVmaW5lZCBhbmQgU0hBTEwgTk9UIGJlIHVzZWQgdG8gaW5mZXIgbWVhbmluZy4gR2VuZXJhbGx5LCBhdCBtb3N0IG9ubHkgb25lIG9mIHRoZSBjb2RpbmcgdmFsdWVzIHdpbGwgYmUgbGFiZWxlZCBhcyBVc2VyU2VsZWN0ZWQgPSB0cnVlLlxyXG4gICAqL1xyXG4gIGNvZGluZz86IGZoaXIuQ29kaW5nQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBWZXJ5IG9mdGVuIHRoZSB0ZXh0IGlzIHRoZSBzYW1lIGFzIGEgZGlzcGxheU5hbWUgb2Ygb25lIG9mIHRoZSBjb2RpbmdzLlxyXG4gICAqL1xyXG4gIHRleHQ/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogQ29kZWFibGVDb25jZXB0LnRleHRcclxuICAgKi9cclxuICBfdGV4dD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIGNvbmNlcHQgdGhhdCBtYXkgYmUgZGVmaW5lZCBieSBhIGZvcm1hbCByZWZlcmVuY2UgdG8gYSB0ZXJtaW5vbG9neSBvciBvbnRvbG9neSBvciBtYXkgYmUgcHJvdmlkZWQgYnkgdGV4dC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBDb2RlYWJsZUNvbmNlcHQgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0NvZGVhYmxlQ29uY2VwdCc7XHJcbiAgLyoqXHJcbiAgICogQ29kZXMgbWF5IGJlIGRlZmluZWQgdmVyeSBjYXN1YWxseSBpbiBlbnVtZXJhdGlvbnMsIG9yIGNvZGUgbGlzdHMsIHVwIHRvIHZlcnkgZm9ybWFsIGRlZmluaXRpb25zIHN1Y2ggYXMgU05PTUVEIENUIC0gc2VlIHRoZSBITDcgdjMgQ29yZSBQcmluY2lwbGVzIGZvciBtb3JlIGluZm9ybWF0aW9uLiAgT3JkZXJpbmcgb2YgY29kaW5ncyBpcyB1bmRlZmluZWQgYW5kIFNIQUxMIE5PVCBiZSB1c2VkIHRvIGluZmVyIG1lYW5pbmcuIEdlbmVyYWxseSwgYXQgbW9zdCBvbmx5IG9uZSBvZiB0aGUgY29kaW5nIHZhbHVlcyB3aWxsIGJlIGxhYmVsZWQgYXMgVXNlclNlbGVjdGVkID0gdHJ1ZS5cclxuICAgKi9cclxuICBwdWJsaWMgY29kaW5nOiBmaGlyLkNvZGluZ1tdO1xyXG4gIC8qKlxyXG4gICAqIFZlcnkgb2Z0ZW4gdGhlIHRleHQgaXMgdGhlIHNhbWUgYXMgYSBkaXNwbGF5TmFtZSBvZiBvbmUgb2YgdGhlIGNvZGluZ3MuXHJcbiAgICovXHJcbiAgcHVibGljIHRleHQ/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIENvZGVhYmxlQ29uY2VwdCAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPENvZGVhYmxlQ29uY2VwdEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWydjb2RpbmcnXSkgeyB0aGlzLmNvZGluZyA9IHNvdXJjZS5jb2RpbmcubWFwKCh4KSA9PiBuZXcgZmhpci5Db2RpbmcoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5jb2RpbmcgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsndGV4dCddKSB7IHRoaXMudGV4dCA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoe3ZhbHVlOiBzb3VyY2UudGV4dH0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfdGV4dCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnRleHQpIHsgdGhpcy50ZXh0LmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3RleHQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy50ZXh0ID0gbmV3IGZoaXIuRmhpclN0cmluZyhzb3VyY2UuX3RleHQgYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPik7IH1cclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdDb2RlYWJsZUNvbmNlcHQnIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdjb2RpbmcnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ3RleHQnLGV4cCkpO1xyXG4gICAgcmV0dXJuIGlzcztcclxuICB9XHJcbiAgLyoqXHJcbiAgICogRmx1ZW50LXN0eWxlIGZ1bmN0aW9uIHRvIGFkZCBjb2RpbmdzXHJcbiAgICogQHBhcmFtIGNvZGluZyBcclxuICAgKiBAcmV0dXJucyB0aGlzIENvZGVhYmxlQ29uY2VwdCwgd2l0aCB0aGUgYWRkaXRpb25hbCBjb2RpbmdcclxuICAgKi9cclxuICAgcHVibGljIGFkZENvZGluZyhjb2Rpbmc6Zmhpci5Db2RpbmdBcmdzKTpDb2RlYWJsZUNvbmNlcHQge1xyXG4gICAgdGhpcy5jb2RpbmcucHVzaChuZXcgZmhpci5Db2RpbmcoY29kaW5nKSk7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZsdWVudC1zdHlsZSBmdW5jdGlvbiB0byByZW1vdmUgQUxMIGluc3RhbmNlcyBvZiBjb2RpbmdzIHdpdGggYSBzeXN0ZW0gYW5kL29yIGNvZGVcclxuICAgKiBAcGFyYW0gc3lzdGVtIFxyXG4gICAqIEBwYXJhbSBjb2RlIFxyXG4gICAqIEByZXR1cm5zIHRoaXMgQ29kZWFibGVDb25jZXB0LCB1cGRhdGVkIHdpdGhvdXQgdGhlIHJlcXVlc3RpbmcgY29kaW5nXHJcbiAgICovXHJcbiAgcHVibGljIHJlbW92ZUNvZGluZyhzeXN0ZW06Zmhpci5GaGlyU3RyaW5nfHN0cmluZywgY29kZTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nKTpDb2RlYWJsZUNvbmNlcHQge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIGNvbnN0IHM6c3RyaW5nID0gKHR5cGVvZiBzeXN0ZW0gPT09ICdzdHJpbmcnKSA/IHN5c3RlbSA6IChzeXN0ZW0gYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIGNvbnN0IGM6c3RyaW5nID0gKHR5cGVvZiBjb2RlID09PSAnc3RyaW5nJykgPyBjb2RlIDogKGNvZGUgYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIGxldCBjbGVhbjpmaGlyLkNvZGluZ1tdID0gdGhpcy5jb2RpbmcuZmlsdGVyKChjb2RpbmcpID0+ICgoKHMgPT09ICcnKSB8fCAoY29kaW5nLnN5c3RlbT8udmFsdWUgPT09IHMpKSAmJiAoKGMgPT09ICcnKSB8fCAoY29kaW5nLmNvZGU/LnZhbHVlID09PSBjKSkpKSA/PyBbXTtcclxuICAgIHRoaXMuY29kaW5nID0gY2xlYW47XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZpbmQgdGhlIGZpcnN0IGNvZGluZyB3aXRoIGEgbWF0Y2hpbmcgc3lzdGVtIGFuZC9vciBjb2RlXHJcbiAgICogQHBhcmFtIHN5c3RlbSBcclxuICAgKiBAcGFyYW0gY29kZSBcclxuICAgKiBAcmV0dXJucyBBIG1hdGNoaW5nIENvZGluZyBvciB1bmRlZmluZWQuXHJcbiAgICovXHJcbiAgcHVibGljIGZpbmRDb2Rpbmcoc3lzdGVtOmZoaXIuRmhpclN0cmluZ3xzdHJpbmcsIGNvZGU6Zmhpci5GaGlyU3RyaW5nfHN0cmluZyk6Zmhpci5Db2Rpbmd8dW5kZWZpbmVkIHtcclxuICAgIGlmICh0aGlzLmNvZGluZy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIGNvbnN0IHM6c3RyaW5nID0gKHR5cGVvZiBzeXN0ZW0gPT09ICdzdHJpbmcnKSA/IHN5c3RlbSA6IChzeXN0ZW0gYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIGNvbnN0IGM6c3RyaW5nID0gKHR5cGVvZiBjb2RlID09PSAnc3RyaW5nJykgPyBjb2RlIDogKGNvZGUgYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIHJldHVybiB0aGlzLmNvZGluZy5maW5kKChjb2RpbmcpID0+ICgoKHMgPT09ICcnKSB8fCAoY29kaW5nLnN5c3RlbT8udmFsdWUgPT09IHMpKSAmJiAoKGMgPT09ICcnKSB8fCAoY29kaW5nLmNvZGU/LnZhbHVlID09PSBjKSkpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZpbmQgYWxsIGluc3RhbmNlcyBvZiBhbiBleHRlbnNpb24gd2l0aCBhIG1hdGNoaW5nIFVSTCwgb3B0aW9uYWxseSByZWN1cnNlIGludG8gZXh0ZW5zaW9uLmV4dGVuc2lvbi5cclxuICAgKiBAcGFyYW0gdXJsIFVSTCB0byBzZWFyY2ggZm9yXHJcbiAgICogQHBhcmFtIHNlYXJjaE5lc3RlZCBJZiB0aGUgc2VhcmNoIHNob3VsZCBuZXN0IGludG8gZXh0ZW5zaW9uc1xyXG4gICAqIEByZXR1cm5zIEEgbmV3IGFycmF5IG9mIEZISVIgRXh0ZW5zaW9ucywgd2l0aCBqdXN0IHRoZSBkZXNpcmVkIGV4dGVuc2lvbnNcclxuICAgKi9cclxuICBwdWJsaWMgZmlsdGVyQ29kaW5ncyhzeXN0ZW06Zmhpci5GaGlyU3RyaW5nfHN0cmluZywgY29kZTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nKTpmaGlyLkNvZGluZ1tdIHtcclxuICAgIGlmICh0aGlzLmNvZGluZy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgY29uc3QgczpzdHJpbmcgPSAodHlwZW9mIHN5c3RlbSA9PT0gJ3N0cmluZycpID8gc3lzdGVtIDogKHN5c3RlbSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgY29uc3QgYzpzdHJpbmcgPSAodHlwZW9mIGNvZGUgPT09ICdzdHJpbmcnKSA/IGNvZGUgOiAoY29kZSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgcmV0dXJuIHRoaXMuY29kaW5nLmZpbHRlcigoY29kaW5nKSA9PiAoKChzID09PSAnJykgfHwgKGNvZGluZy5zeXN0ZW0/LnZhbHVlID09PSBzKSkgJiYgKChjID09PSAnJykgfHwgKGNvZGluZy5jb2RlPy52YWx1ZSA9PT0gYykpKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUZXN0IHdoZXRoZXIgdGhpcyBDb2RlYWJsZUNvbmNlcHQgY29udGFpbnMgYSBzcGVjaWZpYyBjb2RpbmcuXHJcbiAgICogQHBhcmFtIHN5c3RlbSBTeXN0ZW0gdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IHN5c3RlbS5cclxuICAgKiBAcGFyYW0gY29kZSBDb2RlIHRvIHNlYXJjaCBmb3IsIGVtcHR5IHN0cmluZyB3aWxsIG1hdGNoIGFueSBjb2RlLlxyXG4gICAqIEByZXR1cm5zIFRydWUgaWYgdGhpcyBjb25jZXB0IGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgY29kaW5nLCBmYWxzZSBpZiBpdCBkb2VzIG5vdC5cclxuICAgKi9cclxuICBwdWJsaWMgaGFzQ29kaW5nKHN5c3RlbTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nLCBjb2RlOmZoaXIuRmhpclN0cmluZ3xzdHJpbmcpOmJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHM6c3RyaW5nID0gKHR5cGVvZiBzeXN0ZW0gPT09ICdzdHJpbmcnKSA/IHN5c3RlbSA6IChzeXN0ZW0gYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuICAgIGNvbnN0IGM6c3RyaW5nID0gKHR5cGVvZiBjb2RlID09PSAnc3RyaW5nJykgPyBjb2RlIDogKGNvZGUgYXMgZmhpci5GaGlyU3RyaW5nKS52YWx1ZSA/PyAnJztcclxuXHJcbiAgICBpZiAoKHMpICYmIChjKSkge1xyXG4gICAgICByZXR1cm4gKHRoaXMuY29kaW5nLmZpbmQoKGNvZGluZykgPT4gKGNvZGluZy5zeXN0ZW0/LnZhbHVlID09PSBzKSAmJiAoY29kaW5nLmNvZGU/LnZhbHVlID09PSBjKSkgIT09IHVuZGVmaW5lZCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHMpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLmNvZGluZy5maW5kKChjb2RpbmcpID0+IChjb2Rpbmcuc3lzdGVtPy52YWx1ZSA9PT0gcykpICE9PSB1bmRlZmluZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5jb2RpbmcuZmluZCgoY29kaW5nKSA9PiBjb2RpbmcuY29kZT8udmFsdWUgPT09IGMpICE9PSB1bmRlZmluZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRlc3Qgd2hldGhlciB0aGlzIENvZGVhYmxlQ29uY2VwdCBjb250YWlucyBhIHNwZWNpZmljIGNvZGluZy5cclxuICAgKiBAcGFyYW0gc3lzdGVtIFN5c3RlbSB0byBzZWFyY2ggZm9yLCBlbXB0eSBzdHJpbmcgd2lsbCBtYXRjaCBhbnkgc3lzdGVtLlxyXG4gICAqIEBwYXJhbSBjb2RlIENvZGUgdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IGNvZGUuXHJcbiAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGlzIGNvbmNlcHQgY29udGFpbnMgdGhlIHNwZWNpZmllZCBjb2RpbmcsIGZhbHNlIGlmIGl0IGRvZXMgbm90LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBoYXNDb2RpbmdGcm9tT2JqZWN0KGNvZGluZ3M6YW55KTpib29sZWFuIHtcclxuICAgIGlmICh0aGlzLmNvZGluZy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAoY29uc3Qgb2JqIG9mIE9iamVjdC52YWx1ZXMoY29kaW5ncykpIHtcclxuICAgICAgaWYgKCFvYmopIHsgY29udGludWU7IH1cclxuICAgICAgY29uc3Qgc3lzdGVtOnN0cmluZyA9IChvYmogYXMgYW55KVsnc3lzdGVtJ10gPz8gJyc7XHJcbiAgICAgIGNvbnN0IGNvZGU6c3RyaW5nID0gKG9iaiBhcyBhbnkpWydjb2RlJ10gPz8gJyc7XHJcblxyXG4gICAgICBpZiAodGhpcy5oYXNDb2Rpbmcoc3lzdGVtLCBjb2RlKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGVzdCB3aGV0aGVyIHRoaXMgQ29kZWFibGVDb25jZXB0IGNvbnRhaW5zIGEgc3BlY2lmaWMgY29kaW5nLlxyXG4gICAqIEBwYXJhbSBzeXN0ZW0gU3lzdGVtIHRvIHNlYXJjaCBmb3IsIGVtcHR5IHN0cmluZyB3aWxsIG1hdGNoIGFueSBzeXN0ZW0uXHJcbiAgICogQHBhcmFtIGNvZGUgQ29kZSB0byBzZWFyY2ggZm9yLCBlbXB0eSBzdHJpbmcgd2lsbCBtYXRjaCBhbnkgY29kZS5cclxuICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoaXMgY29uY2VwdCBjb250YWlucyB0aGUgc3BlY2lmaWVkIGNvZGluZywgZmFsc2UgaWYgaXQgZG9lcyBub3QuXHJcbiAgICovXHJcbiAgcHVibGljIGhhc0NvZGluZ0Zyb21WYWxpZGF0aW9uT2JqKHZzVmFsaWRhdGlvbjpSZWFkb25seTxzdHJpbmdbXT4pOmJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBjb2Rpbmcgb2YgdGhpcy5jb2RpbmcpIHtcclxuICAgICAgY29uc3Qgc2M6c3RyaW5nID0gKGNvZGluZy5zeXN0ZW0/LnZhbHVlID8/ICcnKSArICd8JyArIChjb2RpbmcuY29kZT8udmFsdWUgPz8gJycpO1xyXG4gICAgICBjb25zdCBjOnN0cmluZyA9IGNvZGluZy5jb2RlPy52YWx1ZSA/PyAnJztcclxuXHJcbiAgICAgIGlmICh2c1ZhbGlkYXRpb24uZmluZCgodikgPT4gKHYgPT09IHNjKSB8fCAodiA9PT0gYykpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUZXN0IHdoZXRoZXIgdGhpcyBDb2RlYWJsZUNvbmNlcHQgY29udGFpbnMgYSBzcGVjaWZpYyBjb2RpbmcuXHJcbiAgICogQHBhcmFtIHN5c3RlbSBTeXN0ZW0gdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IHN5c3RlbS5cclxuICAgKiBAcGFyYW0gY29kZSBDb2RlIHRvIHNlYXJjaCBmb3IsIGVtcHR5IHN0cmluZyB3aWxsIG1hdGNoIGFueSBjb2RlLlxyXG4gICAqIEByZXR1cm5zIFRydWUgaWYgdGhpcyBjb25jZXB0IGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgY29kaW5nLCBmYWxzZSBpZiBpdCBkb2VzIG5vdC5cclxuICAgKi9cclxuICBwdWJsaWMgaGFzQ29kaW5nRnJvbVZhbGlkYXRpb25IYXNoKHZzVmFsaWRhdGlvbjpSZWFkb25seTxudW1iZXJbXT4pOmJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBjb2Rpbmcgb2YgdGhpcy5jb2RpbmcpIHtcclxuICAgICAgY29uc3Qgc2M6bnVtYmVyID0gZmhpci5GaGlyQmFzZS5faGFzaDUyXzFhX2Zhc3QoKGNvZGluZy5zeXN0ZW0/LnZhbHVlID8/ICcnKSArICd8JyArIChjb2RpbmcuY29kZT8udmFsdWUgPz8gJycpKTtcclxuICAgICAgY29uc3QgYzpudW1iZXIgPSBmaGlyLkZoaXJCYXNlLl9oYXNoNTJfMWFfZmFzdChjb2RpbmcuY29kZT8udmFsdWUgPz8gJycpO1xyXG5cclxuICAgICAgaWYgKHZzVmFsaWRhdGlvbi5maW5kKCh2KSA9PiAodiA9PT0gc2MpIHx8ICh2ID09PSBjKSkpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgfVxyXG4iXX0=