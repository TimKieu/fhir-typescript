// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: Reference
import * as fhir from '../fhir.js';
/**
 * A reference from one resource to another.
 */
export class Reference extends fhir.FhirElement {
    /**
     * Default constructor for Reference - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['reference'] !== undefined) {
            this.reference = new fhir.FhirString({ value: source.reference }, options);
        }
        if (source['_reference']) {
            if (this.reference) {
                this.reference.addExtendedProperties(source._reference);
            }
            else {
                this.reference = new fhir.FhirString(source._reference, options);
            }
        }
        if (source['type'] !== undefined) {
            this.type = new fhir.FhirUri({ value: source.type }, options);
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirUri(source._type, options);
            }
        }
        if (source['identifier']) {
            this.identifier = new fhir.Identifier(source.identifier, options);
        }
        if (source['display'] !== undefined) {
            this.display = new fhir.FhirString({ value: source.display }, options);
        }
        if (source['_display']) {
            if (this.display) {
                this.display.addExtendedProperties(source._display);
            }
            else {
                this.display = new fhir.FhirString(source._display, options);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Reference';
        }
        iss.push(...this.vOS('reference', exp));
        iss.push(...this.vOS('type', exp));
        iss.push(...this.vOS('identifier', exp));
        iss.push(...this.vOS('display', exp));
        return iss;
    }
    /**
     * Create a reference from an existing resource
     */
    static fromResource(source, baseUrl = '') {
        if (baseUrl.endsWith('/')) {
            return new Reference({
                type: source.resourceType ?? undefined,
                reference: baseUrl + source.resourceType + '/' + source.id,
            });
        }
        return new Reference({
            type: source.resourceType ?? undefined,
            reference: ((baseUrl.length > 0) ? (baseUrl + '/') : '') + source.resourceType + '/' + source.id,
        });
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Reference._fts_dataType = 'Reference';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVmZXJlbmNlLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9SZWZlcmVuY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLGdEQUFnRDtBQUNoRCxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBMkNuQzs7R0FFRztBQUNILE1BQU0sT0FBTyxTQUFVLFNBQVEsSUFBSSxDQUFDLFdBQVc7SUF3QjdDOztPQUVHO0lBQ0gsWUFBWSxTQUFnQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUN0RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxLQUFLLFNBQVMsRUFBRTtZQUFFLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxTQUFTLEVBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUFFO1FBQ3BILElBQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxFQUFFO1lBQ3hCLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtnQkFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxVQUFXLENBQUMsQ0FBQzthQUFFO2lCQUM1RTtnQkFBRSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsVUFBMEMsRUFBRSxPQUFPLENBQUMsQ0FBQzthQUFFO1NBQzNHO1FBQ0QsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssU0FBUyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLElBQUksRUFBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQUU7UUFDbEcs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Q0FBQzs7QUF6RUQ7O0dBRUc7QUFDNkIsdUJBQWEsR0FBVSxXQUFXLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjRiLmNvcmUgdmVyc2lvbjogNC4zLjBcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIENvbXBsZXhUeXBlOiBSZWZlcmVuY2VcclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFJlc291cmNlVHlwZXNDb2RlcywgIFJlc291cmNlVHlwZXNDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUmVzb3VyY2VUeXBlc0NvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBSZXNvdXJjZVR5cGVzVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9SZXNvdXJjZVR5cGVzVnNWYWxpZGF0aW9uLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFJlZmVyZW5jZSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBSZWZlcmVuY2VBcmdzIGV4dGVuZHMgZmhpci5GaGlyRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFVzaW5nIGFic29sdXRlIFVSTHMgcHJvdmlkZXMgYSBzdGFibGUgc2NhbGFibGUgYXBwcm9hY2ggc3VpdGFibGUgZm9yIGEgY2xvdWQvd2ViIGNvbnRleHQsIHdoaWxlIHVzaW5nIHJlbGF0aXZlL2xvZ2ljYWwgcmVmZXJlbmNlcyBwcm92aWRlcyBhIGZsZXhpYmxlIGFwcHJvYWNoIHN1aXRhYmxlIGZvciB1c2Ugd2hlbiB0cmFkaW5nIGFjcm9zcyBjbG9zZWQgZWNvLXN5c3RlbSBib3VuZGFyaWVzLiAgIEFic29sdXRlIFVSTHMgZG8gbm90IG5lZWQgdG8gcG9pbnQgdG8gYSBGSElSIFJFU1RmdWwgc2VydmVyLCB0aG91Z2ggdGhpcyBpcyB0aGUgcHJlZmVycmVkIGFwcHJvYWNoLiBJZiB0aGUgVVJMIGNvbmZvcm1zIHRvIHRoZSBzdHJ1Y3R1cmUgXCIvW3R5cGVdL1tpZF1cIiB0aGVuIGl0IHNob3VsZCBiZSBhc3N1bWVkIHRoYXQgdGhlIHJlZmVyZW5jZSBpcyB0byBhIEZISVIgUkVTVGZ1bCBzZXJ2ZXIuXHJcbiAgICovXHJcbiAgcmVmZXJlbmNlPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFJlZmVyZW5jZS5yZWZlcmVuY2VcclxuICAgKi9cclxuICBfcmVmZXJlbmNlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGlzIGVsZW1lbnQgaXMgdXNlZCB0byBpbmRpY2F0ZSB0aGUgdHlwZSBvZiAgdGhlIHRhcmdldCBvZiB0aGUgcmVmZXJlbmNlLiBUaGlzIG1heSBiZSB1c2VkIHdoaWNoIGV2ZXIgb2YgdGhlIG90aGVyIGVsZW1lbnRzIGFyZSBwb3B1bGF0ZWQgKG9yIG5vdCkuIEluIHNvbWUgY2FzZXMsIHRoZSB0eXBlIG9mIHRoZSB0YXJnZXQgbWF5IGJlIGRldGVybWluZWQgYnkgaW5zcGVjdGlvbiBvZiB0aGUgcmVmZXJlbmNlIChlLmcuIGEgUkVTVGZ1bCBVUkwpIG9yIGJ5IHJlc29sdmluZyB0aGUgdGFyZ2V0IG9mIHRoZSByZWZlcmVuY2U7IGlmIGJvdGggdGhlIHR5cGUgYW5kIGEgcmVmZXJlbmNlIGlzIHByb3ZpZGVkLCB0aGUgcmVmZXJlbmNlIFNIQUxMIHJlc29sdmUgdG8gYSByZXNvdXJjZSBvZiB0aGUgc2FtZSB0eXBlIGFzIHRoYXQgc3BlY2lmaWVkLlxyXG4gICAqL1xyXG4gIHR5cGU/OiBmaGlyLkZoaXJVcml8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUmVmZXJlbmNlLnR5cGVcclxuICAgKi9cclxuICBfdHlwZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogV2hlbiBhbiBpZGVudGlmaWVyIGlzIHByb3ZpZGVkIGluIHBsYWNlIG9mIGEgcmVmZXJlbmNlLCBhbnkgc3lzdGVtIHByb2Nlc3NpbmcgdGhlIHJlZmVyZW5jZSB3aWxsIG9ubHkgYmUgYWJsZSB0byByZXNvbHZlIHRoZSBpZGVudGlmaWVyIHRvIGEgcmVmZXJlbmNlIGlmIGl0IHVuZGVyc3RhbmRzIHRoZSBidXNpbmVzcyBjb250ZXh0IGluIHdoaWNoIHRoZSBpZGVudGlmaWVyIGlzIHVzZWQuIFNvbWV0aW1lcyB0aGlzIGlzIGdsb2JhbCAoZS5nLiBhIG5hdGlvbmFsIGlkZW50aWZpZXIpIGJ1dCBvZnRlbiBpdCBpcyBub3QuIEZvciB0aGlzIHJlYXNvbiwgbm9uZSBvZiB0aGUgdXNlZnVsIG1lY2hhbmlzbXMgZGVzY3JpYmVkIGZvciB3b3JraW5nIHdpdGggcmVmZXJlbmNlcyAoZS5nLiBjaGFpbmluZywgaW5jbHVkZXMpIGFyZSBwb3NzaWJsZSwgbm9yIHNob3VsZCBzZXJ2ZXJzIGJlIGV4cGVjdGVkIHRvIGJlIGFibGUgcmVzb2x2ZSB0aGUgcmVmZXJlbmNlLiBTZXJ2ZXJzIG1heSBhY2NlcHQgYW4gaWRlbnRpZmllciBiYXNlZCByZWZlcmVuY2UgdW50b3VjaGVkLCByZXNvbHZlIGl0LCBhbmQvb3IgcmVqZWN0IGl0IC0gc2VlIENhcGFiaWxpdHlTdGF0ZW1lbnQucmVzdC5yZXNvdXJjZS5yZWZlcmVuY2VQb2xpY3kuIFxyXG4gICAqIFdoZW4gYm90aCBhbiBpZGVudGlmaWVyIGFuZCBhIGxpdGVyYWwgcmVmZXJlbmNlIGFyZSBwcm92aWRlZCwgdGhlIGxpdGVyYWwgcmVmZXJlbmNlIGlzIHByZWZlcnJlZC4gQXBwbGljYXRpb25zIHByb2Nlc3NpbmcgdGhlIHJlc291cmNlIGFyZSBhbGxvd2VkIC0gYnV0IG5vdCByZXF1aXJlZCAtIHRvIGNoZWNrIHRoYXQgdGhlIGlkZW50aWZpZXIgbWF0Y2hlcyB0aGUgbGl0ZXJhbCByZWZlcmVuY2VcclxuICAgKiBBcHBsaWNhdGlvbnMgY29udmVydGluZyBhIGxvZ2ljYWwgcmVmZXJlbmNlIHRvIGEgbGl0ZXJhbCByZWZlcmVuY2UgbWF5IGNob29zZSB0byBsZWF2ZSB0aGUgbG9naWNhbCByZWZlcmVuY2UgcHJlc2VudCwgb3IgcmVtb3ZlIGl0LlxyXG4gICAqIFJlZmVyZW5jZSBpcyBpbnRlbmRlZCB0byBwb2ludCB0byBhIHN0cnVjdHVyZSB0aGF0IGNhbiBwb3RlbnRpYWxseSBiZSBleHByZXNzZWQgYXMgYSBGSElSIHJlc291cmNlLCB0aG91Z2ggdGhlcmUgaXMgbm8gbmVlZCBmb3IgaXQgdG8gZXhpc3QgYXMgYW4gYWN0dWFsIEZISVIgcmVzb3VyY2UgaW5zdGFuY2UgLSBleGNlcHQgaW4gYXMgbXVjaCBhcyBhbiBhcHBsaWNhdGlvbiB3aXNoZXMgdG8gYWN0dWFsIGZpbmQgdGhlIHRhcmdldCBvZiB0aGUgcmVmZXJlbmNlLiBUaGUgY29udGVudCByZWZlcnJlZCB0byBiZSB0aGUgaWRlbnRpZmllciBtdXN0IG1lZXQgdGhlIGxvZ2ljYWwgY29uc3RyYWludHMgaW1wbGllZCBieSBhbnkgbGltaXRhdGlvbnMgb24gd2hhdCByZXNvdXJjZSB0eXBlcyBhcmUgcGVybWl0dGVkIGZvciB0aGUgcmVmZXJlbmNlLiAgRm9yIGV4YW1wbGUsIGl0IHdvdWxkIG5vdCBiZSBsZWdpdGltYXRlIHRvIHNlbmQgdGhlIGlkZW50aWZpZXIgZm9yIGEgZHJ1ZyBwcmVzY3JpcHRpb24gaWYgdGhlIHR5cGUgd2VyZSBSZWZlcmVuY2UoT2JzZXJ2YXRpb258RGlhZ25vc3RpY1JlcG9ydCkuICBPbmUgb2YgdGhlIHVzZS1jYXNlcyBmb3IgUmVmZXJlbmNlLmlkZW50aWZpZXIgaXMgdGhlIHNpdHVhdGlvbiB3aGVyZSBubyBGSElSIHJlcHJlc2VudGF0aW9uIGV4aXN0cyAod2hlcmUgdGhlIHR5cGUgaXMgUmVmZXJlbmNlIChBbnkpLlxyXG4gICAqL1xyXG4gIGlkZW50aWZpZXI/OiBmaGlyLklkZW50aWZpZXJBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGlzIGlzIGdlbmVyYWxseSBub3QgdGhlIHNhbWUgYXMgdGhlIFJlc291cmNlLnRleHQgb2YgdGhlIHJlZmVyZW5jZWQgcmVzb3VyY2UuICBUaGUgcHVycG9zZSBpcyB0byBpZGVudGlmeSB3aGF0J3MgYmVpbmcgcmVmZXJlbmNlZCwgbm90IHRvIGZ1bGx5IGRlc2NyaWJlIGl0LlxyXG4gICAqL1xyXG4gIGRpc3BsYXk/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUmVmZXJlbmNlLmRpc3BsYXlcclxuICAgKi9cclxuICBfZGlzcGxheT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIHJlZmVyZW5jZSBmcm9tIG9uZSByZXNvdXJjZSB0byBhbm90aGVyLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJlZmVyZW5jZSBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnUmVmZXJlbmNlJztcclxuICAvKipcclxuICAgKiBVc2luZyBhYnNvbHV0ZSBVUkxzIHByb3ZpZGVzIGEgc3RhYmxlIHNjYWxhYmxlIGFwcHJvYWNoIHN1aXRhYmxlIGZvciBhIGNsb3VkL3dlYiBjb250ZXh0LCB3aGlsZSB1c2luZyByZWxhdGl2ZS9sb2dpY2FsIHJlZmVyZW5jZXMgcHJvdmlkZXMgYSBmbGV4aWJsZSBhcHByb2FjaCBzdWl0YWJsZSBmb3IgdXNlIHdoZW4gdHJhZGluZyBhY3Jvc3MgY2xvc2VkIGVjby1zeXN0ZW0gYm91bmRhcmllcy4gICBBYnNvbHV0ZSBVUkxzIGRvIG5vdCBuZWVkIHRvIHBvaW50IHRvIGEgRkhJUiBSRVNUZnVsIHNlcnZlciwgdGhvdWdoIHRoaXMgaXMgdGhlIHByZWZlcnJlZCBhcHByb2FjaC4gSWYgdGhlIFVSTCBjb25mb3JtcyB0byB0aGUgc3RydWN0dXJlIFwiL1t0eXBlXS9baWRdXCIgdGhlbiBpdCBzaG91bGQgYmUgYXNzdW1lZCB0aGF0IHRoZSByZWZlcmVuY2UgaXMgdG8gYSBGSElSIFJFU1RmdWwgc2VydmVyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWZlcmVuY2U/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgZWxlbWVudCBpcyB1c2VkIHRvIGluZGljYXRlIHRoZSB0eXBlIG9mICB0aGUgdGFyZ2V0IG9mIHRoZSByZWZlcmVuY2UuIFRoaXMgbWF5IGJlIHVzZWQgd2hpY2ggZXZlciBvZiB0aGUgb3RoZXIgZWxlbWVudHMgYXJlIHBvcHVsYXRlZCAob3Igbm90KS4gSW4gc29tZSBjYXNlcywgdGhlIHR5cGUgb2YgdGhlIHRhcmdldCBtYXkgYmUgZGV0ZXJtaW5lZCBieSBpbnNwZWN0aW9uIG9mIHRoZSByZWZlcmVuY2UgKGUuZy4gYSBSRVNUZnVsIFVSTCkgb3IgYnkgcmVzb2x2aW5nIHRoZSB0YXJnZXQgb2YgdGhlIHJlZmVyZW5jZTsgaWYgYm90aCB0aGUgdHlwZSBhbmQgYSByZWZlcmVuY2UgaXMgcHJvdmlkZWQsIHRoZSByZWZlcmVuY2UgU0hBTEwgcmVzb2x2ZSB0byBhIHJlc291cmNlIG9mIHRoZSBzYW1lIHR5cGUgYXMgdGhhdCBzcGVjaWZpZWQuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU/OiBmaGlyLkZoaXJVcml8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFdoZW4gYW4gaWRlbnRpZmllciBpcyBwcm92aWRlZCBpbiBwbGFjZSBvZiBhIHJlZmVyZW5jZSwgYW55IHN5c3RlbSBwcm9jZXNzaW5nIHRoZSByZWZlcmVuY2Ugd2lsbCBvbmx5IGJlIGFibGUgdG8gcmVzb2x2ZSB0aGUgaWRlbnRpZmllciB0byBhIHJlZmVyZW5jZSBpZiBpdCB1bmRlcnN0YW5kcyB0aGUgYnVzaW5lc3MgY29udGV4dCBpbiB3aGljaCB0aGUgaWRlbnRpZmllciBpcyB1c2VkLiBTb21ldGltZXMgdGhpcyBpcyBnbG9iYWwgKGUuZy4gYSBuYXRpb25hbCBpZGVudGlmaWVyKSBidXQgb2Z0ZW4gaXQgaXMgbm90LiBGb3IgdGhpcyByZWFzb24sIG5vbmUgb2YgdGhlIHVzZWZ1bCBtZWNoYW5pc21zIGRlc2NyaWJlZCBmb3Igd29ya2luZyB3aXRoIHJlZmVyZW5jZXMgKGUuZy4gY2hhaW5pbmcsIGluY2x1ZGVzKSBhcmUgcG9zc2libGUsIG5vciBzaG91bGQgc2VydmVycyBiZSBleHBlY3RlZCB0byBiZSBhYmxlIHJlc29sdmUgdGhlIHJlZmVyZW5jZS4gU2VydmVycyBtYXkgYWNjZXB0IGFuIGlkZW50aWZpZXIgYmFzZWQgcmVmZXJlbmNlIHVudG91Y2hlZCwgcmVzb2x2ZSBpdCwgYW5kL29yIHJlamVjdCBpdCAtIHNlZSBDYXBhYmlsaXR5U3RhdGVtZW50LnJlc3QucmVzb3VyY2UucmVmZXJlbmNlUG9saWN5LiBcclxuICAgKiBXaGVuIGJvdGggYW4gaWRlbnRpZmllciBhbmQgYSBsaXRlcmFsIHJlZmVyZW5jZSBhcmUgcHJvdmlkZWQsIHRoZSBsaXRlcmFsIHJlZmVyZW5jZSBpcyBwcmVmZXJyZWQuIEFwcGxpY2F0aW9ucyBwcm9jZXNzaW5nIHRoZSByZXNvdXJjZSBhcmUgYWxsb3dlZCAtIGJ1dCBub3QgcmVxdWlyZWQgLSB0byBjaGVjayB0aGF0IHRoZSBpZGVudGlmaWVyIG1hdGNoZXMgdGhlIGxpdGVyYWwgcmVmZXJlbmNlXHJcbiAgICogQXBwbGljYXRpb25zIGNvbnZlcnRpbmcgYSBsb2dpY2FsIHJlZmVyZW5jZSB0byBhIGxpdGVyYWwgcmVmZXJlbmNlIG1heSBjaG9vc2UgdG8gbGVhdmUgdGhlIGxvZ2ljYWwgcmVmZXJlbmNlIHByZXNlbnQsIG9yIHJlbW92ZSBpdC5cclxuICAgKiBSZWZlcmVuY2UgaXMgaW50ZW5kZWQgdG8gcG9pbnQgdG8gYSBzdHJ1Y3R1cmUgdGhhdCBjYW4gcG90ZW50aWFsbHkgYmUgZXhwcmVzc2VkIGFzIGEgRkhJUiByZXNvdXJjZSwgdGhvdWdoIHRoZXJlIGlzIG5vIG5lZWQgZm9yIGl0IHRvIGV4aXN0IGFzIGFuIGFjdHVhbCBGSElSIHJlc291cmNlIGluc3RhbmNlIC0gZXhjZXB0IGluIGFzIG11Y2ggYXMgYW4gYXBwbGljYXRpb24gd2lzaGVzIHRvIGFjdHVhbCBmaW5kIHRoZSB0YXJnZXQgb2YgdGhlIHJlZmVyZW5jZS4gVGhlIGNvbnRlbnQgcmVmZXJyZWQgdG8gYmUgdGhlIGlkZW50aWZpZXIgbXVzdCBtZWV0IHRoZSBsb2dpY2FsIGNvbnN0cmFpbnRzIGltcGxpZWQgYnkgYW55IGxpbWl0YXRpb25zIG9uIHdoYXQgcmVzb3VyY2UgdHlwZXMgYXJlIHBlcm1pdHRlZCBmb3IgdGhlIHJlZmVyZW5jZS4gIEZvciBleGFtcGxlLCBpdCB3b3VsZCBub3QgYmUgbGVnaXRpbWF0ZSB0byBzZW5kIHRoZSBpZGVudGlmaWVyIGZvciBhIGRydWcgcHJlc2NyaXB0aW9uIGlmIHRoZSB0eXBlIHdlcmUgUmVmZXJlbmNlKE9ic2VydmF0aW9ufERpYWdub3N0aWNSZXBvcnQpLiAgT25lIG9mIHRoZSB1c2UtY2FzZXMgZm9yIFJlZmVyZW5jZS5pZGVudGlmaWVyIGlzIHRoZSBzaXR1YXRpb24gd2hlcmUgbm8gRkhJUiByZXByZXNlbnRhdGlvbiBleGlzdHMgKHdoZXJlIHRoZSB0eXBlIGlzIFJlZmVyZW5jZSAoQW55KS5cclxuICAgKi9cclxuICBwdWJsaWMgaWRlbnRpZmllcj86IGZoaXIuSWRlbnRpZmllcnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBpcyBnZW5lcmFsbHkgbm90IHRoZSBzYW1lIGFzIHRoZSBSZXNvdXJjZS50ZXh0IG9mIHRoZSByZWZlcmVuY2VkIHJlc291cmNlLiAgVGhlIHB1cnBvc2UgaXMgdG8gaWRlbnRpZnkgd2hhdCdzIGJlaW5nIHJlZmVyZW5jZWQsIG5vdCB0byBmdWxseSBkZXNjcmliZSBpdC5cclxuICAgKi9cclxuICBwdWJsaWMgZGlzcGxheT86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgUmVmZXJlbmNlIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8UmVmZXJlbmNlQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3JlZmVyZW5jZSddICE9PSB1bmRlZmluZWQpIHsgdGhpcy5yZWZlcmVuY2UgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLnJlZmVyZW5jZX0sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfcmVmZXJlbmNlJ10pIHtcclxuICAgICAgaWYgKHRoaXMucmVmZXJlbmNlKSB7IHRoaXMucmVmZXJlbmNlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3JlZmVyZW5jZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnJlZmVyZW5jZSA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9yZWZlcmVuY2UgYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPiwgb3B0aW9ucyk7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3R5cGUnXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkZoaXJVcmkoe3ZhbHVlOiBzb3VyY2UudHlwZX0sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfdHlwZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnR5cGUpIHsgdGhpcy50eXBlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3R5cGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy50eXBlID0gbmV3IGZoaXIuRmhpclVyaShzb3VyY2UuX3R5cGUgYXMgUGFydGlhbDxmaGlyLkZoaXJVcmlBcmdzPiwgb3B0aW9ucyk7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2lkZW50aWZpZXInXSkgeyB0aGlzLmlkZW50aWZpZXIgPSBuZXcgZmhpci5JZGVudGlmaWVyKHNvdXJjZS5pZGVudGlmaWVyLCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZGlzcGxheSddICE9PSB1bmRlZmluZWQpIHsgdGhpcy5kaXNwbGF5ID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS5kaXNwbGF5fSwgb3B0aW9ucyk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19kaXNwbGF5J10pIHtcclxuICAgICAgaWYgKHRoaXMuZGlzcGxheSkgeyB0aGlzLmRpc3BsYXkuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fZGlzcGxheSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmRpc3BsYXkgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHNvdXJjZS5fZGlzcGxheSBhcyBQYXJ0aWFsPGZoaXIuRmhpclN0cmluZ0FyZ3M+LCBvcHRpb25zKTsgfVxyXG4gICAgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ1JlZmVyZW5jZScgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ3JlZmVyZW5jZScsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygndHlwZScsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnaWRlbnRpZmllcicsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnZGlzcGxheScsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIGEgcmVmZXJlbmNlIGZyb20gYW4gZXhpc3RpbmcgcmVzb3VyY2VcclxuICAgKi9cclxuICAgc3RhdGljIGZyb21SZXNvdXJjZShzb3VyY2U6Zmhpci5GaGlyUmVzb3VyY2UsIGJhc2VVcmw6c3RyaW5nPScnKTpSZWZlcmVuY2Uge1xyXG4gICAgaWYgKGJhc2VVcmwuZW5kc1dpdGgoJy8nKSkge1xyXG4gICAgICByZXR1cm4gbmV3IFJlZmVyZW5jZSh7XHJcbiAgICAgICAgdHlwZTogc291cmNlLnJlc291cmNlVHlwZSA/PyB1bmRlZmluZWQsXHJcbiAgICAgICAgcmVmZXJlbmNlOiBiYXNlVXJsICsgc291cmNlLnJlc291cmNlVHlwZSArICcvJyArIHNvdXJjZS5pZCxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBSZWZlcmVuY2Uoe1xyXG4gICAgICB0eXBlOiBzb3VyY2UucmVzb3VyY2VUeXBlID8/IHVuZGVmaW5lZCxcclxuICAgICAgcmVmZXJlbmNlOiAoKGJhc2VVcmwubGVuZ3RoID4gMCkgPyAoYmFzZVVybCArICcvJykgOiAnJykgKyBzb3VyY2UucmVzb3VyY2VUeXBlICsgJy8nICsgc291cmNlLmlkLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==