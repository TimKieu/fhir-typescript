// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR Resource: SubscriptionStatus
import * as fhir from '../fhir.js';
// @ts-ignore
import { SubscriptionStatusVsValidation } from '../fhirValueSets/SubscriptionStatusVsValidation.js';
// @ts-ignore
import { SubscriptionNotificationTypeVsValidation } from '../fhirValueSets/SubscriptionNotificationTypeVsValidation.js';
/**
 * Detailed information about events relevant to this subscription notification.
 */
export class SubscriptionStatusNotificationEvent extends fhir.BackboneElement {
    /**
     * Default constructor for SubscriptionStatusNotificationEvent - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['eventNumber'] !== undefined) {
            this.eventNumber = new fhir.FhirString({ value: source.eventNumber }, options);
        }
        else {
            this.eventNumber = null;
        }
        if (source['_eventNumber']) {
            if (this.eventNumber) {
                this.eventNumber.addExtendedProperties(source._eventNumber);
            }
            else {
                this.eventNumber = new fhir.FhirString(source._eventNumber, options);
            }
        }
        if (source['timestamp'] !== undefined) {
            this.timestamp = new fhir.FhirInstant({ value: source.timestamp }, options);
        }
        if (source['_timestamp']) {
            if (this.timestamp) {
                this.timestamp.addExtendedProperties(source._timestamp);
            }
            else {
                this.timestamp = new fhir.FhirInstant(source._timestamp, options);
            }
        }
        if (source['focus']) {
            this.focus = new fhir.Reference(source.focus, options);
        }
        if (source['additionalContext']) {
            this.additionalContext = source.additionalContext.map((x) => new fhir.Reference(x, options));
        }
        else {
            this.additionalContext = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'SubscriptionStatus.notificationEvent';
        }
        iss.push(...this.vRS('eventNumber', exp));
        iss.push(...this.vOS('timestamp', exp));
        iss.push(...this.vOS('focus', exp));
        iss.push(...this.vOA('additionalContext', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
SubscriptionStatusNotificationEvent._fts_dataType = 'SubscriptionStatusNotificationEvent';
/**
 * The SubscriptionStatus resource describes the state of a Subscription during notifications.
 */
export class SubscriptionStatus extends fhir.DomainResource {
    /**
     * Default constructor for SubscriptionStatus - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'SubscriptionStatus';
        if (source['status'] !== undefined) {
            this.status = new fhir.FhirCode({ value: source.status }, options);
        }
        if (source['_status']) {
            if (this.status) {
                this.status.addExtendedProperties(source._status);
            }
            else {
                this.status = new fhir.FhirCode(source._status, options);
            }
        }
        if (source['type'] !== undefined) {
            this.type = new fhir.FhirCode({ value: source.type }, options);
        }
        else {
            this.type = null;
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirCode(source._type, options);
            }
        }
        if (source['eventsSinceSubscriptionStart'] !== undefined) {
            this.eventsSinceSubscriptionStart = new fhir.FhirString({ value: source.eventsSinceSubscriptionStart }, options);
        }
        if (source['_eventsSinceSubscriptionStart']) {
            if (this.eventsSinceSubscriptionStart) {
                this.eventsSinceSubscriptionStart.addExtendedProperties(source._eventsSinceSubscriptionStart);
            }
            else {
                this.eventsSinceSubscriptionStart = new fhir.FhirString(source._eventsSinceSubscriptionStart, options);
            }
        }
        if (source['notificationEvent']) {
            this.notificationEvent = source.notificationEvent.map((x) => new fhir.SubscriptionStatusNotificationEvent(x, options));
        }
        else {
            this.notificationEvent = [];
        }
        if (source['subscription']) {
            this.subscription = new fhir.Reference(source.subscription, options);
        }
        else {
            this.subscription = null;
        }
        if (source['topic'] !== undefined) {
            this.topic = new fhir.FhirCanonical({ value: source.topic }, options);
        }
        if (source['_topic']) {
            if (this.topic) {
                this.topic.addExtendedProperties(source._topic);
            }
            else {
                this.topic = new fhir.FhirCanonical(source._topic, options);
            }
        }
        if (source['error']) {
            this.error = source.error.map((x) => new fhir.CodeableConcept(x, options));
        }
        else {
            this.error = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'SubscriptionStatus';
        }
        iss.push(...this.vOSV('status', exp, 'SubscriptionStatus', SubscriptionStatusVsValidation, 'r'));
        iss.push(...this.vRSV('type', exp, 'SubscriptionNotificationType', SubscriptionNotificationTypeVsValidation, 'r'));
        iss.push(...this.vOS('eventsSinceSubscriptionStart', exp));
        iss.push(...this.vOA('notificationEvent', exp));
        iss.push(...this.vRS('subscription', exp));
        iss.push(...this.vOS('topic', exp));
        iss.push(...this.vOA('error', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
SubscriptionStatus._fts_dataType = 'SubscriptionStatus';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3Vic2NyaXB0aW9uU3RhdHVzLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9TdWJzY3JpcHRpb25TdGF0dXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLGdEQUFnRDtBQUNoRCxrQ0FBa0M7QUFDbEMsb0NBQW9DO0FBRXBDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsOEJBQThCLEVBQUUsTUFBTSxvREFBb0QsQ0FBQztBQUdwRyxhQUFhO0FBQ2IsT0FBTyxFQUFFLHdDQUF3QyxFQUFFLE1BQU0sOERBQThELENBQUM7QUFtQ3hIOztHQUVHO0FBQ0gsTUFBTSxPQUFPLG1DQUFvQyxTQUFRLElBQUksQ0FBQyxlQUFlO0lBcUIzRTs7T0FFRztJQUNILFlBQVksU0FBMEQsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDaEgsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxhQUFhLENBQUMsS0FBSyxTQUFTLEVBQUU7WUFBRSxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsV0FBVyxFQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FBRTthQUNySDtZQUFFLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO1NBQUU7UUFDakMsSUFBSSxNQUFNLENBQUMsY0FBYyxDQUFDLEVBQUU7WUFDMUIsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUFFLElBQUksQ0FBQyxXQUFXLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLFlBQWEsQ0FBQyxDQUFDO2FBQUU7aUJBQ2xGO2dCQUFFLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxZQUE0QyxFQUFFLE9BQU8sQ0FBQyxD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LEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbkMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbkMsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDOztBQXBGRDs7R0FFRztBQUM2QixnQ0FBYSxHQUFVLG9CQUFvQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0Yi5jb3JlIHZlcnNpb246IDQuMy4wXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogU3Vic2NyaXB0aW9uU3RhdHVzXHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb25TdGF0dXNDb2RlcywgIFN1YnNjcmlwdGlvblN0YXR1c0NvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TdWJzY3JpcHRpb25TdGF0dXNDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uU3RhdHVzVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TdWJzY3JpcHRpb25TdGF0dXNWc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbk5vdGlmaWNhdGlvblR5cGVDb2RlcywgIFN1YnNjcmlwdGlvbk5vdGlmaWNhdGlvblR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvU3Vic2NyaXB0aW9uTm90aWZpY2F0aW9uVHlwZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb25Ob3RpZmljYXRpb25UeXBlVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TdWJzY3JpcHRpb25Ob3RpZmljYXRpb25UeXBlVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb25FcnJvckNvZGVzLCAgU3Vic2NyaXB0aW9uRXJyb3JDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvU3Vic2NyaXB0aW9uRXJyb3JDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uRXJyb3JWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1N1YnNjcmlwdGlvbkVycm9yVnNWYWxpZGF0aW9uLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFN1YnNjcmlwdGlvblN0YXR1c05vdGlmaWNhdGlvbkV2ZW50IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFN1YnNjcmlwdGlvblN0YXR1c05vdGlmaWNhdGlvbkV2ZW50QXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogVGhlIHNlcXVlbnRpYWwgbnVtYmVyIG9mIHRoaXMgZXZlbnQgaW4gdGhpcyBzdWJzY3JpcHRpb24gY29udGV4dC4gTm90ZSB0aGF0IHRoaXMgdmFsdWUgaXMgYSA2NC1iaXQgaW50ZWdlciB2YWx1ZSwgZW5jb2RlZCBhcyBhIHN0cmluZy5cclxuICAgKi9cclxuICBldmVudE51bWJlcjogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFN1YnNjcmlwdGlvblN0YXR1cy5ub3RpZmljYXRpb25FdmVudC5ldmVudE51bWJlclxyXG4gICAqL1xyXG4gIF9ldmVudE51bWJlcj86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVGhlIGFjdHVhbCB0aW1lIHRoaXMgZXZlbnQgb2NjdXJlZCBvbiB0aGUgc2VydmVyLlxyXG4gICAqL1xyXG4gIHRpbWVzdGFtcD86IGZoaXIuRmhpckluc3RhbnR8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogU3Vic2NyaXB0aW9uU3RhdHVzLm5vdGlmaWNhdGlvbkV2ZW50LnRpbWVzdGFtcFxyXG4gICAqL1xyXG4gIF90aW1lc3RhbXA/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBmb2N1cyBvZiB0aGlzIGV2ZW50LiBXaGlsZSB0aGlzIHdpbGwgdXN1YWxseSBiZSBhIHJlZmVyZW5jZSB0byB0aGUgZm9jdXMgcmVzb3VyY2Ugb2YgdGhlIGV2ZW50LCBpdCBNQVkgY29udGFpbiBhIHJlZmVyZW5jZSB0byBhIG5vbi1GSElSIG9iamVjdC5cclxuICAgKi9cclxuICBmb2N1cz86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQWRkaXRpb25hbCBjb250ZXh0IGluZm9ybWF0aW9uIGZvciB0aGlzIGV2ZW50LiBHZW5lcmFsbHksIHRoaXMgd2lsbCBjb250YWluIHJlZmVyZW5jZXMgdG8gYWRkaXRpb25hbCByZXNvdXJjZXMgaW5jbHVkZWQgd2l0aCB0aGUgZXZlbnQgKGUuZy4sIHRoZSBQYXRpZW50IHJlbGV2YW50IHRvIGFuIEVuY291bnRlciksIGhvd2V2ZXIgaXQgTUFZIHJlZmVyIHRvIG5vbi1GSElSIG9iamVjdHMuXHJcbiAgICovXHJcbiAgYWRkaXRpb25hbENvbnRleHQ/OiBmaGlyLlJlZmVyZW5jZUFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXRhaWxlZCBpbmZvcm1hdGlvbiBhYm91dCBldmVudHMgcmVsZXZhbnQgdG8gdGhpcyBzdWJzY3JpcHRpb24gbm90aWZpY2F0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFN1YnNjcmlwdGlvblN0YXR1c05vdGlmaWNhdGlvbkV2ZW50IGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnU3Vic2NyaXB0aW9uU3RhdHVzTm90aWZpY2F0aW9uRXZlbnQnO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBzZXF1ZW50aWFsIG51bWJlciBvZiB0aGlzIGV2ZW50IGluIHRoaXMgc3Vic2NyaXB0aW9uIGNvbnRleHQuIE5vdGUgdGhhdCB0aGlzIHZhbHVlIGlzIGEgNjQtYml0IGludGVnZXIgdmFsdWUsIGVuY29kZWQgYXMgYSBzdHJpbmcuXHJcbiAgICovXHJcbiAgcHVibGljIGV2ZW50TnVtYmVyOiBmaGlyLkZoaXJTdHJpbmd8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgYWN0dWFsIHRpbWUgdGhpcyBldmVudCBvY2N1cmVkIG9uIHRoZSBzZXJ2ZXIuXHJcbiAgICovXHJcbiAgcHVibGljIHRpbWVzdGFtcD86IGZoaXIuRmhpckluc3RhbnR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBmb2N1cyBvZiB0aGlzIGV2ZW50LiBXaGlsZSB0aGlzIHdpbGwgdXN1YWxseSBiZSBhIHJlZmVyZW5jZSB0byB0aGUgZm9jdXMgcmVzb3VyY2Ugb2YgdGhlIGV2ZW50LCBpdCBNQVkgY29udGFpbiBhIHJlZmVyZW5jZSB0byBhIG5vbi1GSElSIG9iamVjdC5cclxuICAgKi9cclxuICBwdWJsaWMgZm9jdXM/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQWRkaXRpb25hbCBjb250ZXh0IGluZm9ybWF0aW9uIGZvciB0aGlzIGV2ZW50LiBHZW5lcmFsbHksIHRoaXMgd2lsbCBjb250YWluIHJlZmVyZW5jZXMgdG8gYWRkaXRpb25hbCByZXNvdXJjZXMgaW5jbHVkZWQgd2l0aCB0aGUgZXZlbnQgKGUuZy4sIHRoZSBQYXRpZW50IHJlbGV2YW50IHRvIGFuIEVuY291bnRlciksIGhvd2V2ZXIgaXQgTUFZIHJlZmVyIHRvIG5vbi1GSElSIG9iamVjdHMuXHJcbiAgICovXHJcbiAgcHVibGljIGFkZGl0aW9uYWxDb250ZXh0OiBmaGlyLlJlZmVyZW5jZVtdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFN1YnNjcmlwdGlvblN0YXR1c05vdGlmaWNhdGlvbkV2ZW50IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8U3Vic2NyaXB0aW9uU3RhdHVzTm90aWZpY2F0aW9uRXZlbnRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsnZXZlbnROdW1iZXInXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMuZXZlbnROdW1iZXIgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLmV2ZW50TnVtYmVyfSwgb3B0aW9ucyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmV2ZW50TnVtYmVyID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2V2ZW50TnVtYmVyJ10pIHtcclxuICAgICAgaWYgKHRoaXMuZXZlbnROdW1iZXIpIHsgdGhpcy5ldmVudE51bWJlci5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9ldmVudE51bWJlciEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmV2ZW50TnVtYmVyID0gbmV3IGZoaXIuRmhpclN0cmluZyhzb3VyY2UuX2V2ZW50TnVtYmVyIGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4sIG9wdGlvbnMpOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWyd0aW1lc3RhbXAnXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMudGltZXN0YW1wID0gbmV3IGZoaXIuRmhpckluc3RhbnQoe3ZhbHVlOiBzb3VyY2UudGltZXN0YW1wfSwgb3B0aW9ucyk7IH1cclxuICAgIGlmIChzb3VyY2VbJ190aW1lc3RhbXAnXSkge1xyXG4gICAgICBpZiAodGhpcy50aW1lc3RhbXApIHsgdGhpcy50aW1lc3RhbXAuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdGltZXN0YW1wISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudGltZXN0YW1wID0gbmV3IGZoaXIuRmhpckluc3RhbnQoc291cmNlLl90aW1lc3RhbXAgYXMgUGFydGlhbDxmaGlyLkZoaXJJbnN0YW50QXJncz4sIG9wdGlvbnMpOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydmb2N1cyddKSB7IHRoaXMuZm9jdXMgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLmZvY3VzLCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnYWRkaXRpb25hbENvbnRleHQnXSkgeyB0aGlzLmFkZGl0aW9uYWxDb250ZXh0ID0gc291cmNlLmFkZGl0aW9uYWxDb250ZXh0Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgsIG9wdGlvbnMpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuYWRkaXRpb25hbENvbnRleHQgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ1N1YnNjcmlwdGlvblN0YXR1cy5ub3RpZmljYXRpb25FdmVudCcgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ2V2ZW50TnVtYmVyJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCd0aW1lc3RhbXAnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2ZvY3VzJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdhZGRpdGlvbmFsQ29udGV4dCcsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgU3Vic2NyaXB0aW9uU3RhdHVzIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFN1YnNjcmlwdGlvblN0YXR1c0FyZ3MgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlQXJncyB7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcmVzb3VyY2VUeXBlOiBcIlN1YnNjcmlwdGlvblN0YXR1c1wifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgc3RhdHVzIG9mIHRoZSBzdWJzY3JpcHRpb24sIHdoaWNoIG1hcmtzIHRoZSBzZXJ2ZXIgc3RhdGUgZm9yIG1hbmFnaW5nIHRoZSBzdWJzY3JpcHRpb24uXHJcbiAgICovXHJcbiAgc3RhdHVzPzogZmhpci5GaGlyQ29kZTxTdWJzY3JpcHRpb25TdGF0dXNDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogU3Vic2NyaXB0aW9uU3RhdHVzLnN0YXR1c1xyXG4gICAqL1xyXG4gIF9zdGF0dXM/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSB0eXBlIG9mIGV2ZW50IGJlaW5nIGNvbnZleWVkIHdpdGggdGhpcyBub3RpZmljYWl0b24uXHJcbiAgICovXHJcbiAgdHlwZTogZmhpci5GaGlyQ29kZTxTdWJzY3JpcHRpb25Ob3RpZmljYXRpb25UeXBlQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFN1YnNjcmlwdGlvblN0YXR1cy50eXBlXHJcbiAgICovXHJcbiAgX3R5cGU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSB0b3RhbCBudW1iZXIgb2YgYWN0dWFsIGV2ZW50cyB3aGljaCBoYXZlIGJlZW4gZ2VuZXJhdGVkIHNpbmNlIHRoZSBTdWJzY3JpcHRpb24gd2FzIGNyZWF0ZWQgKGluY2x1c2l2ZSBvZiB0aGlzIG5vdGlmaWNhdGlvbikgLSByZWdhcmRsZXNzIG9mIGhvdyBtYW55IGhhdmUgYmVlbiBzdWNjZXNzZnVsbHkgY29tbXVuaWNhdGVkLiAgVGhpcyBudW1iZXIgaXMgTk9UIGluY3JlbWVudGVkIGZvciBoYW5kc2hha2UgYW5kIGhlYXJ0YmVhdCBub3RpZmljYXRpb25zLlxyXG4gICAqL1xyXG4gIGV2ZW50c1NpbmNlU3Vic2NyaXB0aW9uU3RhcnQ/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogU3Vic2NyaXB0aW9uU3RhdHVzLmV2ZW50c1NpbmNlU3Vic2NyaXB0aW9uU3RhcnRcclxuICAgKi9cclxuICBfZXZlbnRzU2luY2VTdWJzY3JpcHRpb25TdGFydD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogRGV0YWlsZWQgaW5mb3JtYXRpb24gYWJvdXQgZXZlbnRzIHJlbGV2YW50IHRvIHRoaXMgc3Vic2NyaXB0aW9uIG5vdGlmaWNhdGlvbi5cclxuICAgKi9cclxuICBub3RpZmljYXRpb25FdmVudD86IGZoaXIuU3Vic2NyaXB0aW9uU3RhdHVzTm90aWZpY2F0aW9uRXZlbnRBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSByZWZlcmVuY2UgdG8gdGhlIFN1YnNjcmlwdGlvbiB3aGljaCBnZW5lcmF0ZWQgdGhpcyBub3RpZmljYXRpb24uXHJcbiAgICovXHJcbiAgc3Vic2NyaXB0aW9uOiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGlzIHZhbHVlIFNIT1VMRCBOT1QgYmUgcHJlc2VudCB3aGVuIHVzaW5nIGBlbXB0eWAgcGF5bG9hZHMsIE1BWSBiZSBwcmVzZW50IHdoZW4gdXNpbmcgYGlkLW9ubHlgIHBheWxvYWRzLCBhbmQgU0hPVUxEIGJlIHByZXNlbnQgd2hlbiB1c2luZyBgZnVsbC1yZXNvdXJjZWAgcGF5bG9hZHMuXHJcbiAgICovXHJcbiAgdG9waWM/OiBmaGlyLkZoaXJDYW5vbmljYWx8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogU3Vic2NyaXB0aW9uU3RhdHVzLnRvcGljXHJcbiAgICovXHJcbiAgX3RvcGljPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBSZWNvbW1lbmRlZCBwcmFjdGljZTogY2xlYXIgZXJyb3JzIHdoZW4gc3RhdHVzIGlzIHVwZGF0ZWQuXHJcbiAgICovXHJcbiAgZXJyb3I/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgU3Vic2NyaXB0aW9uU3RhdHVzIHJlc291cmNlIGRlc2NyaWJlcyB0aGUgc3RhdGUgb2YgYSBTdWJzY3JpcHRpb24gZHVyaW5nIG5vdGlmaWNhdGlvbnMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgU3Vic2NyaXB0aW9uU3RhdHVzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdTdWJzY3JpcHRpb25TdGF0dXMnO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiU3Vic2NyaXB0aW9uU3RhdHVzXCI7XHJcbiAgLyoqXHJcbiAgICogVGhlIHN0YXR1cyBvZiB0aGUgc3Vic2NyaXB0aW9uLCB3aGljaCBtYXJrcyB0aGUgc2VydmVyIHN0YXRlIGZvciBtYW5hZ2luZyB0aGUgc3Vic2NyaXB0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0dXM/OiBmaGlyLkZoaXJDb2RlPFN1YnNjcmlwdGlvblN0YXR1c0NvZGVUeXBlPnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHR5cGUgb2YgZXZlbnQgYmVpbmcgY29udmV5ZWQgd2l0aCB0aGlzIG5vdGlmaWNhaXRvbi5cclxuICAgKi9cclxuICBwdWJsaWMgdHlwZTogZmhpci5GaGlyQ29kZTxTdWJzY3JpcHRpb25Ob3RpZmljYXRpb25UeXBlQ29kZVR5cGU+fG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHRvdGFsIG51bWJlciBvZiBhY3R1YWwgZXZlbnRzIHdoaWNoIGhhdmUgYmVlbiBnZW5lcmF0ZWQgc2luY2UgdGhlIFN1YnNjcmlwdGlvbiB3YXMgY3JlYXRlZCAoaW5jbHVzaXZlIG9mIHRoaXMgbm90aWZpY2F0aW9uKSAtIHJlZ2FyZGxlc3Mgb2YgaG93IG1hbnkgaGF2ZSBiZWVuIHN1Y2Nlc3NmdWxseSBjb21tdW5pY2F0ZWQuICBUaGlzIG51bWJlciBpcyBOT1QgaW5jcmVtZW50ZWQgZm9yIGhhbmRzaGFrZSBhbmQgaGVhcnRiZWF0IG5vdGlmaWNhdGlvbnMuXHJcbiAgICovXHJcbiAgcHVibGljIGV2ZW50c1NpbmNlU3Vic2NyaXB0aW9uU3RhcnQ/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IGV2ZW50cyByZWxldmFudCB0byB0aGlzIHN1YnNjcmlwdGlvbiBub3RpZmljYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIG5vdGlmaWNhdGlvbkV2ZW50OiBmaGlyLlN1YnNjcmlwdGlvblN0YXR1c05vdGlmaWNhdGlvbkV2ZW50W107XHJcbiAgLyoqXHJcbiAgICogVGhlIHJlZmVyZW5jZSB0byB0aGUgU3Vic2NyaXB0aW9uIHdoaWNoIGdlbmVyYXRlZCB0aGlzIG5vdGlmaWNhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgc3Vic2NyaXB0aW9uOiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgdmFsdWUgU0hPVUxEIE5PVCBiZSBwcmVzZW50IHdoZW4gdXNpbmcgYGVtcHR5YCBwYXlsb2FkcywgTUFZIGJlIHByZXNlbnQgd2hlbiB1c2luZyBgaWQtb25seWAgcGF5bG9hZHMsIGFuZCBTSE9VTEQgYmUgcHJlc2VudCB3aGVuIHVzaW5nIGBmdWxsLXJlc291cmNlYCBwYXlsb2Fkcy5cclxuICAgKi9cclxuICBwdWJsaWMgdG9waWM/OiBmaGlyLkZoaXJDYW5vbmljYWx8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFJlY29tbWVuZGVkIHByYWN0aWNlOiBjbGVhciBlcnJvcnMgd2hlbiBzdGF0dXMgaXMgdXBkYXRlZC5cclxuICAgKi9cclxuICBwdWJsaWMgZXJyb3I6IGZoaXIuQ29kZWFibGVDb25jZXB0W107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgU3Vic2NyaXB0aW9uU3RhdHVzIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8U3Vic2NyaXB0aW9uU3RhdHVzQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIHRoaXMucmVzb3VyY2VUeXBlID0gJ1N1YnNjcmlwdGlvblN0YXR1cyc7XHJcbiAgICBpZiAoc291cmNlWydzdGF0dXMnXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMuc3RhdHVzID0gbmV3IGZoaXIuRmhpckNvZGU8U3Vic2NyaXB0aW9uU3RhdHVzQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLnN0YXR1c30sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfc3RhdHVzJ10pIHtcclxuICAgICAgaWYgKHRoaXMuc3RhdHVzKSB7IHRoaXMuc3RhdHVzLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3N0YXR1cyEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnN0YXR1cyA9IG5ldyBmaGlyLkZoaXJDb2RlPFN1YnNjcmlwdGlvblN0YXR1c0NvZGVUeXBlPihzb3VyY2UuX3N0YXR1cyBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+LCBvcHRpb25zKTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddICE9PSB1bmRlZmluZWQpIHsgdGhpcy50eXBlID0gbmV3IGZoaXIuRmhpckNvZGU8U3Vic2NyaXB0aW9uTm90aWZpY2F0aW9uVHlwZUNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS50eXBlfSwgb3B0aW9ucyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfdHlwZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnR5cGUpIHsgdGhpcy50eXBlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3R5cGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy50eXBlID0gbmV3IGZoaXIuRmhpckNvZGU8U3Vic2NyaXB0aW9uTm90aWZpY2F0aW9uVHlwZUNvZGVUeXBlPihzb3VyY2UuX3R5cGUgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPiwgb3B0aW9ucyk7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2V2ZW50c1NpbmNlU3Vic2NyaXB0aW9uU3RhcnQnXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMuZXZlbnRzU2luY2VTdWJzY3JpcHRpb25TdGFydCA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoe3ZhbHVlOiBzb3VyY2UuZXZlbnRzU2luY2VTdWJzY3JpcHRpb25TdGFydH0sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfZXZlbnRzU2luY2VTdWJzY3JpcHRpb25TdGFydCddKSB7XHJcbiAgICAgIGlmICh0aGlzLmV2ZW50c1NpbmNlU3Vic2NyaXB0aW9uU3RhcnQpIHsgdGhpcy5ldmVudHNTaW5jZVN1YnNjcmlwdGlvblN0YXJ0LmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2V2ZW50c1NpbmNlU3Vic2NyaXB0aW9uU3RhcnQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5ldmVudHNTaW5jZVN1YnNjcmlwdGlvblN0YXJ0ID0gbmV3IGZoaXIuRmhpclN0cmluZyhzb3VyY2UuX2V2ZW50c1NpbmNlU3Vic2NyaXB0aW9uU3RhcnQgYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPiwgb3B0aW9ucyk7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ25vdGlmaWNhdGlvbkV2ZW50J10pIHsgdGhpcy5ub3RpZmljYXRpb25FdmVudCA9IHNvdXJjZS5ub3RpZmljYXRpb25FdmVudC5tYXAoKHgpID0+IG5ldyBmaGlyLlN1YnNjcmlwdGlvblN0YXR1c05vdGlmaWNhdGlvbkV2ZW50KHgsIG9wdGlvbnMpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMubm90aWZpY2F0aW9uRXZlbnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3Vic2NyaXB0aW9uJ10pIHsgdGhpcy5zdWJzY3JpcHRpb24gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnN1YnNjcmlwdGlvbiwgb3B0aW9ucyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnN1YnNjcmlwdGlvbiA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ3RvcGljJ10gIT09IHVuZGVmaW5lZCkgeyB0aGlzLnRvcGljID0gbmV3IGZoaXIuRmhpckNhbm9uaWNhbCh7dmFsdWU6IHNvdXJjZS50b3BpY30sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfdG9waWMnXSkge1xyXG4gICAgICBpZiAodGhpcy50b3BpYykgeyB0aGlzLnRvcGljLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3RvcGljISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudG9waWMgPSBuZXcgZmhpci5GaGlyQ2Fub25pY2FsKHNvdXJjZS5fdG9waWMgYXMgUGFydGlhbDxmaGlyLkZoaXJDYW5vbmljYWxBcmdzPiwgb3B0aW9ucyk7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2Vycm9yJ10pIHsgdGhpcy5lcnJvciA9IHNvdXJjZS5lcnJvci5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdCh4LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmVycm9yID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdTdWJzY3JpcHRpb25TdGF0dXMnIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TVignc3RhdHVzJyxleHAsJ1N1YnNjcmlwdGlvblN0YXR1cycsU3Vic2NyaXB0aW9uU3RhdHVzVnNWYWxpZGF0aW9uLCdyJykpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlNWKCd0eXBlJyxleHAsJ1N1YnNjcmlwdGlvbk5vdGlmaWNhdGlvblR5cGUnLFN1YnNjcmlwdGlvbk5vdGlmaWNhdGlvblR5cGVWc1ZhbGlkYXRpb24sJ3InKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnZXZlbnRzU2luY2VTdWJzY3JpcHRpb25TdGFydCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPQSgnbm90aWZpY2F0aW9uRXZlbnQnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ3N1YnNjcmlwdGlvbicsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygndG9waWMnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ2Vycm9yJyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbiJdfQ==