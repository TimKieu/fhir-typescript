// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR Resource: Person
import * as fhir from '../fhir.js';
// @ts-ignore
import { IdentityAssuranceLevelVsValidation } from '../fhirValueSets/IdentityAssuranceLevelVsValidation.js';
// @ts-ignore
import { AdministrativeGenderVsValidation } from '../fhirValueSets/AdministrativeGenderVsValidation.js';
/**
 * Link to a resource that concerns the same actual person.
 */
export class PersonLink extends fhir.BackboneElement {
    /**
     * Default constructor for PersonLink - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['target']) {
            this.target = new fhir.Reference(source.target, options);
        }
        else {
            this.target = null;
        }
        if (source['assurance'] !== undefined) {
            this.assurance = new fhir.FhirCode({ value: source.assurance }, options);
        }
        if (source['_assurance']) {
            if (this.assurance) {
                this.assurance.addExtendedProperties(source._assurance);
            }
            else {
                this.assurance = new fhir.FhirCode(source._assurance, options);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Person.link';
        }
        iss.push(...this.vRS('target', exp));
        iss.push(...this.vOSV('assurance', exp, 'IdentityAssuranceLevel', IdentityAssuranceLevelVsValidation, 'r'));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
PersonLink._fts_dataType = 'PersonLink';
/**
 * Demographics and administrative information about a person independent of a specific health-related context.
 */
export class Person extends fhir.DomainResource {
    /**
     * Default constructor for Person - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Person';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x, options));
        }
        else {
            this.identifier = [];
        }
        if (source['name']) {
            this.name = source.name.map((x) => new fhir.HumanName(x, options));
        }
        else {
            this.name = [];
        }
        if (source['telecom']) {
            this.telecom = source.telecom.map((x) => new fhir.ContactPoint(x, options));
        }
        else {
            this.telecom = [];
        }
        if (source['gender'] !== undefined) {
            this.gender = new fhir.FhirCode({ value: source.gender }, options);
        }
        if (source['_gender']) {
            if (this.gender) {
                this.gender.addExtendedProperties(source._gender);
            }
            else {
                this.gender = new fhir.FhirCode(source._gender, options);
            }
        }
        if (source['birthDate'] !== undefined) {
            this.birthDate = new fhir.FhirDate({ value: source.birthDate }, options);
        }
        if (source['_birthDate']) {
            if (this.birthDate) {
                this.birthDate.addExtendedProperties(source._birthDate);
            }
            else {
                this.birthDate = new fhir.FhirDate(source._birthDate, options);
            }
        }
        if (source['address']) {
            this.address = source.address.map((x) => new fhir.Address(x, options));
        }
        else {
            this.address = [];
        }
        if (source['photo']) {
            this.photo = new fhir.Attachment(source.photo, options);
        }
        if (source['managingOrganization']) {
            this.managingOrganization = new fhir.Reference(source.managingOrganization, options);
        }
        if (source['active'] !== undefined) {
            this.active = new fhir.FhirBoolean({ value: source.active }, options);
        }
        if (source['_active']) {
            if (this.active) {
                this.active.addExtendedProperties(source._active);
            }
            else {
                this.active = new fhir.FhirBoolean(source._active, options);
            }
        }
        if (source['link']) {
            this.link = source.link.map((x) => new fhir.PersonLink(x, options));
        }
        else {
            this.link = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Person';
        }
        iss.push(...this.vOA('identifier', exp));
        iss.push(...this.vOA('name', exp));
        iss.push(...this.vOA('telecom', exp));
        iss.push(...this.vOSV('gender', exp, 'AdministrativeGender', AdministrativeGenderVsValidation, 'r'));
        iss.push(...this.vOS('birthDate', exp));
        iss.push(...this.vOA('address', exp));
        iss.push(...this.vOS('photo', exp));
        iss.push(...this.vOS('managingOrganization', exp));
        iss.push(...this.vOS('active', exp));
        iss.push(...this.vOA('link', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Person._fts_dataType = 'Person';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUGVyc29uLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9QZXJzb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLGdEQUFnRDtBQUNoRCxrQ0FBa0M7QUFDbEMsd0JBQXdCO0FBRXhCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsa0NBQWtDLEVBQUUsTUFBTSx3REFBd0QsQ0FBQztBQUc1RyxhQUFhO0FBQ2IsT0FBTyxFQUFFLGdDQUFnQyxFQUFFLE1BQU0sc0RBQXNELENBQUM7QUFtQnhHOztHQUVHO0FBQ0gsTUFBTSxPQUFPLFVBQVcsU0FBUSxJQUFJLENBQUMsZUFBZTtJQWFsRDs7T0FFRztJQUNILFlBQVksU0FBaUMsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDdkYsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FBRTthQUM5RTtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO1NBQUU7UUFDNUIsSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLEtBQUssU0FBUyxFQUFFO1lBQUUsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQWlDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxTQUFTLEVBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUFFO1FBQ2xKLElBQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxFQUFFO1lBQ3hCLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtnQkFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxVQUFXLENBQUMs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RyxDQUFDLENBQUMsQ0FBQztRQUNsQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNyQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUMsR0FBRyxFQUFDLHNCQUFzQixFQUFDLGdDQUFnQyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDakcsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDdkMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDckMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbkMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsc0JBQXNCLEVBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNsRCxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNwQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNsQyxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUM7O0FBbkdEOztHQUVHO0FBQzZCLG9CQUFhLEdBQVUsUUFBUSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0Yi5jb3JlIHZlcnNpb246IDQuMy4wXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogUGVyc29uXHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBJZGVudGl0eUFzc3VyYW5jZUxldmVsQ29kZXMsICBJZGVudGl0eUFzc3VyYW5jZUxldmVsQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0lkZW50aXR5QXNzdXJhbmNlTGV2ZWxDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgSWRlbnRpdHlBc3N1cmFuY2VMZXZlbFZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvSWRlbnRpdHlBc3N1cmFuY2VMZXZlbFZzVmFsaWRhdGlvbi5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgQWRtaW5pc3RyYXRpdmVHZW5kZXJDb2RlcywgIEFkbWluaXN0cmF0aXZlR2VuZGVyQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0FkbWluaXN0cmF0aXZlR2VuZGVyQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IEFkbWluaXN0cmF0aXZlR2VuZGVyVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9BZG1pbmlzdHJhdGl2ZUdlbmRlclZzVmFsaWRhdGlvbi5qcyc7XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBQZXJzb25MaW5rIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFBlcnNvbkxpbmtBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgcmVzb3VyY2UgdG8gd2hpY2ggdGhpcyBhY3R1YWwgcGVyc29uIGlzIGFzc29jaWF0ZWQuXHJcbiAgICovXHJcbiAgdGFyZ2V0OiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBMZXZlbCBvZiBhc3N1cmFuY2UgdGhhdCB0aGlzIGxpbmsgaXMgYXNzb2NpYXRlZCB3aXRoIHRoZSB0YXJnZXQgcmVzb3VyY2UuXHJcbiAgICovXHJcbiAgYXNzdXJhbmNlPzogZmhpci5GaGlyQ29kZTxJZGVudGl0eUFzc3VyYW5jZUxldmVsQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFBlcnNvbi5saW5rLmFzc3VyYW5jZVxyXG4gICAqL1xyXG4gIF9hc3N1cmFuY2U/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG59XHJcblxyXG4vKipcclxuICogTGluayB0byBhIHJlc291cmNlIHRoYXQgY29uY2VybnMgdGhlIHNhbWUgYWN0dWFsIHBlcnNvbi5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBQZXJzb25MaW5rIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnUGVyc29uTGluayc7XHJcbiAgLyoqXHJcbiAgICogVGhlIHJlc291cmNlIHRvIHdoaWNoIHRoaXMgYWN0dWFsIHBlcnNvbiBpcyBhc3NvY2lhdGVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0YXJnZXQ6IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogTGV2ZWwgb2YgYXNzdXJhbmNlIHRoYXQgdGhpcyBsaW5rIGlzIGFzc29jaWF0ZWQgd2l0aCB0aGUgdGFyZ2V0IHJlc291cmNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhc3N1cmFuY2U/OiBmaGlyLkZoaXJDb2RlPElkZW50aXR5QXNzdXJhbmNlTGV2ZWxDb2RlVHlwZT58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFBlcnNvbkxpbmsgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxQZXJzb25MaW5rQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3RhcmdldCddKSB7IHRoaXMudGFyZ2V0ID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS50YXJnZXQsIG9wdGlvbnMpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50YXJnZXQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydhc3N1cmFuY2UnXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMuYXNzdXJhbmNlID0gbmV3IGZoaXIuRmhpckNvZGU8SWRlbnRpdHlBc3N1cmFuY2VMZXZlbENvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5hc3N1cmFuY2V9LCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2Fzc3VyYW5jZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLmFzc3VyYW5jZSkgeyB0aGlzLmFzc3VyYW5jZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9hc3N1cmFuY2UhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5hc3N1cmFuY2UgPSBuZXcgZmhpci5GaGlyQ29kZTxJZGVudGl0eUFzc3VyYW5jZUxldmVsQ29kZVR5cGU+KHNvdXJjZS5fYXNzdXJhbmNlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4sIG9wdGlvbnMpOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnUGVyc29uLmxpbmsnIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJTKCd0YXJnZXQnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1NWKCdhc3N1cmFuY2UnLGV4cCwnSWRlbnRpdHlBc3N1cmFuY2VMZXZlbCcsSWRlbnRpdHlBc3N1cmFuY2VMZXZlbFZzVmFsaWRhdGlvbiwncicpKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBQZXJzb24gdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGVyc29uQXJncyBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2VBcmdzIHtcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICByZXNvdXJjZVR5cGU6IFwiUGVyc29uXCJ8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXIgZm9yIGEgcGVyc29uIHdpdGhpbiBhIHBhcnRpY3VsYXIgc2NvcGUuXHJcbiAgICovXHJcbiAgaWRlbnRpZmllcj86IGZoaXIuSWRlbnRpZmllckFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogUGVyc29uIG1heSBoYXZlIG11bHRpcGxlIG5hbWVzIHdpdGggZGlmZmVyZW50IHVzZXMgb3IgYXBwbGljYWJsZSBwZXJpb2RzLlxyXG4gICAqL1xyXG4gIG5hbWU/OiBmaGlyLkh1bWFuTmFtZUFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogUGVyc29uIG1heSBoYXZlIG11bHRpcGxlIHdheXMgdG8gYmUgY29udGFjdGVkIHdpdGggZGlmZmVyZW50IHVzZXMgb3IgYXBwbGljYWJsZSBwZXJpb2RzLiAgTWF5IG5lZWQgdG8gaGF2ZSBvcHRpb25zIGZvciBjb250YWN0aW5nIHRoZSBwZXJzb24gdXJnZW50bHkgYW5kIGFsc28gdG8gaGVscCB3aXRoIGlkZW50aWZpY2F0aW9uLlxyXG4gICAqL1xyXG4gIHRlbGVjb20/OiBmaGlyLkNvbnRhY3RQb2ludEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGdlbmRlciBtaWdodCBub3QgbWF0Y2ggdGhlIGJpb2xvZ2ljYWwgc2V4IGFzIGRldGVybWluZWQgYnkgZ2VuZXRpY3MsIG9yIHRoZSBpbmRpdmlkdWFsJ3MgcHJlZmVycmVkIGlkZW50aWZpY2F0aW9uLiBOb3RlIHRoYXQgZm9yIGJvdGggaHVtYW5zIGFuZCBwYXJ0aWN1bGFybHkgYW5pbWFscywgdGhlcmUgYXJlIG90aGVyIGxlZ2l0aW1hdGUgcG9zc2liaWxpdGllcyB0aGFuIE0gYW5kIEYsIHRob3VnaCBhIGNsZWFyIG1ham9yaXR5IG9mIHN5c3RlbXMgYW5kIGNvbnRleHRzIG9ubHkgc3VwcG9ydCBNIGFuZCBGLlxyXG4gICAqL1xyXG4gIGdlbmRlcj86IGZoaXIuRmhpckNvZGU8QWRtaW5pc3RyYXRpdmVHZW5kZXJDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUGVyc29uLmdlbmRlclxyXG4gICAqL1xyXG4gIF9nZW5kZXI/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIEF0IGxlYXN0IGFuIGVzdGltYXRlZCB5ZWFyIHNob3VsZCBiZSBwcm92aWRlZCBhcyBhIGd1ZXNzIGlmIHRoZSByZWFsIERPQiBpcyB1bmtub3duLlxyXG4gICAqL1xyXG4gIGJpcnRoRGF0ZT86IGZoaXIuRmhpckRhdGV8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUGVyc29uLmJpcnRoRGF0ZVxyXG4gICAqL1xyXG4gIF9iaXJ0aERhdGU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFBlcnNvbiBtYXkgaGF2ZSBtdWx0aXBsZSBhZGRyZXNzZXMgd2l0aCBkaWZmZXJlbnQgdXNlcyBvciBhcHBsaWNhYmxlIHBlcmlvZHMuXHJcbiAgICovXHJcbiAgYWRkcmVzcz86IGZoaXIuQWRkcmVzc0FyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQW4gaW1hZ2UgdGhhdCBjYW4gYmUgZGlzcGxheWVkIGFzIGEgdGh1bWJuYWlsIG9mIHRoZSBwZXJzb24gdG8gZW5oYW5jZSB0aGUgaWRlbnRpZmljYXRpb24gb2YgdGhlIGluZGl2aWR1YWwuXHJcbiAgICovXHJcbiAgcGhvdG8/OiBmaGlyLkF0dGFjaG1lbnRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgb3JnYW5pemF0aW9uIHRoYXQgaXMgdGhlIGN1c3RvZGlhbiBvZiB0aGUgcGVyc29uIHJlY29yZC5cclxuICAgKi9cclxuICBtYW5hZ2luZ09yZ2FuaXphdGlvbj86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogV2hldGhlciB0aGlzIHBlcnNvbidzIHJlY29yZCBpcyBpbiBhY3RpdmUgdXNlLlxyXG4gICAqL1xyXG4gIGFjdGl2ZT86IGZoaXIuRmhpckJvb2xlYW58Ym9vbGVhbnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFBlcnNvbi5hY3RpdmVcclxuICAgKi9cclxuICBfYWN0aXZlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBMaW5rIHRvIGEgcmVzb3VyY2UgdGhhdCBjb25jZXJucyB0aGUgc2FtZSBhY3R1YWwgcGVyc29uLlxyXG4gICAqL1xyXG4gIGxpbms/OiBmaGlyLlBlcnNvbkxpbmtBcmdzW118dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogRGVtb2dyYXBoaWNzIGFuZCBhZG1pbmlzdHJhdGl2ZSBpbmZvcm1hdGlvbiBhYm91dCBhIHBlcnNvbiBpbmRlcGVuZGVudCBvZiBhIHNwZWNpZmljIGhlYWx0aC1yZWxhdGVkIGNvbnRleHQuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUGVyc29uIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdQZXJzb24nO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiUGVyc29uXCI7XHJcbiAgLyoqXHJcbiAgICogSWRlbnRpZmllciBmb3IgYSBwZXJzb24gd2l0aGluIGEgcGFydGljdWxhciBzY29wZS5cclxuICAgKi9cclxuICBwdWJsaWMgaWRlbnRpZmllcjogZmhpci5JZGVudGlmaWVyW107XHJcbiAgLyoqXHJcbiAgICogUGVyc29uIG1heSBoYXZlIG11bHRpcGxlIG5hbWVzIHdpdGggZGlmZmVyZW50IHVzZXMgb3IgYXBwbGljYWJsZSBwZXJpb2RzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBuYW1lOiBmaGlyLkh1bWFuTmFtZVtdO1xyXG4gIC8qKlxyXG4gICAqIFBlcnNvbiBtYXkgaGF2ZSBtdWx0aXBsZSB3YXlzIHRvIGJlIGNvbnRhY3RlZCB3aXRoIGRpZmZlcmVudCB1c2VzIG9yIGFwcGxpY2FibGUgcGVyaW9kcy4gIE1heSBuZWVkIHRvIGhhdmUgb3B0aW9ucyBmb3IgY29udGFjdGluZyB0aGUgcGVyc29uIHVyZ2VudGx5IGFuZCBhbHNvIHRvIGhlbHAgd2l0aCBpZGVudGlmaWNhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgdGVsZWNvbTogZmhpci5Db250YWN0UG9pbnRbXTtcclxuICAvKipcclxuICAgKiBUaGUgZ2VuZGVyIG1pZ2h0IG5vdCBtYXRjaCB0aGUgYmlvbG9naWNhbCBzZXggYXMgZGV0ZXJtaW5lZCBieSBnZW5ldGljcywgb3IgdGhlIGluZGl2aWR1YWwncyBwcmVmZXJyZWQgaWRlbnRpZmljYXRpb24uIE5vdGUgdGhhdCBmb3IgYm90aCBodW1hbnMgYW5kIHBhcnRpY3VsYXJseSBhbmltYWxzLCB0aGVyZSBhcmUgb3RoZXIgbGVnaXRpbWF0ZSBwb3NzaWJpbGl0aWVzIHRoYW4gTSBhbmQgRiwgdGhvdWdoIGEgY2xlYXIgbWFqb3JpdHkgb2Ygc3lzdGVtcyBhbmQgY29udGV4dHMgb25seSBzdXBwb3J0IE0gYW5kIEYuXHJcbiAgICovXHJcbiAgcHVibGljIGdlbmRlcj86IGZoaXIuRmhpckNvZGU8QWRtaW5pc3RyYXRpdmVHZW5kZXJDb2RlVHlwZT58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEF0IGxlYXN0IGFuIGVzdGltYXRlZCB5ZWFyIHNob3VsZCBiZSBwcm92aWRlZCBhcyBhIGd1ZXNzIGlmIHRoZSByZWFsIERPQiBpcyB1bmtub3duLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBiaXJ0aERhdGU/OiBmaGlyLkZoaXJEYXRlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBQZXJzb24gbWF5IGhhdmUgbXVsdGlwbGUgYWRkcmVzc2VzIHdpdGggZGlmZmVyZW50IHVzZXMgb3IgYXBwbGljYWJsZSBwZXJpb2RzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhZGRyZXNzOiBmaGlyLkFkZHJlc3NbXTtcclxuICAvKipcclxuICAgKiBBbiBpbWFnZSB0aGF0IGNhbiBiZSBkaXNwbGF5ZWQgYXMgYSB0aHVtYm5haWwgb2YgdGhlIHBlcnNvbiB0byBlbmhhbmNlIHRoZSBpZGVudGlmaWNhdGlvbiBvZiB0aGUgaW5kaXZpZHVhbC5cclxuICAgKi9cclxuICBwdWJsaWMgcGhvdG8/OiBmaGlyLkF0dGFjaG1lbnR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBvcmdhbml6YXRpb24gdGhhdCBpcyB0aGUgY3VzdG9kaWFuIG9mIHRoZSBwZXJzb24gcmVjb3JkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBtYW5hZ2luZ09yZ2FuaXphdGlvbj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBXaGV0aGVyIHRoaXMgcGVyc29uJ3MgcmVjb3JkIGlzIGluIGFjdGl2ZSB1c2UuXHJcbiAgICovXHJcbiAgcHVibGljIGFjdGl2ZT86IGZoaXIuRmhpckJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIExpbmsgdG8gYSByZXNvdXJjZSB0aGF0IGNvbmNlcm5zIHRoZSBzYW1lIGFjdHVhbCBwZXJzb24uXHJcbiAgICovXHJcbiAgcHVibGljIGxpbms6IGZoaXIuUGVyc29uTGlua1tdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFBlcnNvbiAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFBlcnNvbkFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdQZXJzb24nO1xyXG4gICAgaWYgKHNvdXJjZVsnaWRlbnRpZmllciddKSB7IHRoaXMuaWRlbnRpZmllciA9IHNvdXJjZS5pZGVudGlmaWVyLm1hcCgoeCkgPT4gbmV3IGZoaXIuSWRlbnRpZmllcih4LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmlkZW50aWZpZXIgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnbmFtZSddKSB7IHRoaXMubmFtZSA9IHNvdXJjZS5uYW1lLm1hcCgoeCkgPT4gbmV3IGZoaXIuSHVtYW5OYW1lKHgsIG9wdGlvbnMpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMubmFtZSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWyd0ZWxlY29tJ10pIHsgdGhpcy50ZWxlY29tID0gc291cmNlLnRlbGVjb20ubWFwKCh4KSA9PiBuZXcgZmhpci5Db250YWN0UG9pbnQoeCwgb3B0aW9ucykpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50ZWxlY29tID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2dlbmRlciddICE9PSB1bmRlZmluZWQpIHsgdGhpcy5nZW5kZXIgPSBuZXcgZmhpci5GaGlyQ29kZTxBZG1pbmlzdHJhdGl2ZUdlbmRlckNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5nZW5kZXJ9LCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2dlbmRlciddKSB7XHJcbiAgICAgIGlmICh0aGlzLmdlbmRlcikgeyB0aGlzLmdlbmRlci5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9nZW5kZXIhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5nZW5kZXIgPSBuZXcgZmhpci5GaGlyQ29kZTxBZG1pbmlzdHJhdGl2ZUdlbmRlckNvZGVUeXBlPihzb3VyY2UuX2dlbmRlciBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+LCBvcHRpb25zKTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnYmlydGhEYXRlJ10gIT09IHVuZGVmaW5lZCkgeyB0aGlzLmJpcnRoRGF0ZSA9IG5ldyBmaGlyLkZoaXJEYXRlKHt2YWx1ZTogc291cmNlLmJpcnRoRGF0ZX0sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfYmlydGhEYXRlJ10pIHtcclxuICAgICAgaWYgKHRoaXMuYmlydGhEYXRlKSB7IHRoaXMuYmlydGhEYXRlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2JpcnRoRGF0ZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmJpcnRoRGF0ZSA9IG5ldyBmaGlyLkZoaXJEYXRlKHNvdXJjZS5fYmlydGhEYXRlIGFzIFBhcnRpYWw8Zmhpci5GaGlyRGF0ZUFyZ3M+LCBvcHRpb25zKTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnYWRkcmVzcyddKSB7IHRoaXMuYWRkcmVzcyA9IHNvdXJjZS5hZGRyZXNzLm1hcCgoeCkgPT4gbmV3IGZoaXIuQWRkcmVzcyh4LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmFkZHJlc3MgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncGhvdG8nXSkgeyB0aGlzLnBob3RvID0gbmV3IGZoaXIuQXR0YWNobWVudChzb3VyY2UucGhvdG8sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydtYW5hZ2luZ09yZ2FuaXphdGlvbiddKSB7IHRoaXMubWFuYWdpbmdPcmdhbml6YXRpb24gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLm1hbmFnaW5nT3JnYW5pemF0aW9uLCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnYWN0aXZlJ10gIT09IHVuZGVmaW5lZCkgeyB0aGlzLmFjdGl2ZSA9IG5ldyBmaGlyLkZoaXJCb29sZWFuKHt2YWx1ZTogc291cmNlLmFjdGl2ZX0sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfYWN0aXZlJ10pIHtcclxuICAgICAgaWYgKHRoaXMuYWN0aXZlKSB7IHRoaXMuYWN0aXZlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2FjdGl2ZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmFjdGl2ZSA9IG5ldyBmaGlyLkZoaXJCb29sZWFuKHNvdXJjZS5fYWN0aXZlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQm9vbGVhbkFyZ3M+LCBvcHRpb25zKTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnbGluayddKSB7IHRoaXMubGluayA9IHNvdXJjZS5saW5rLm1hcCgoeCkgPT4gbmV3IGZoaXIuUGVyc29uTGluayh4LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmxpbmsgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ1BlcnNvbicgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ2lkZW50aWZpZXInLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ25hbWUnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ3RlbGVjb20nLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1NWKCdnZW5kZXInLGV4cCwnQWRtaW5pc3RyYXRpdmVHZW5kZXInLEFkbWluaXN0cmF0aXZlR2VuZGVyVnNWYWxpZGF0aW9uLCdyJykpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2JpcnRoRGF0ZScsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPQSgnYWRkcmVzcycsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygncGhvdG8nLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ21hbmFnaW5nT3JnYW5pemF0aW9uJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdhY3RpdmUnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ2xpbmsnLGV4cCkpO1xyXG4gICAgcmV0dXJuIGlzcztcclxuICB9XHJcbn1cclxuIl19