// <auto-generated/>
// Contents of: hl7.fhir.r4b.core version: 4.3.0
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: HumanName
import * as fhir from '../fhir.js';
// @ts-ignore
import { NameUseVsValidation } from '../fhirValueSets/NameUseVsValidation.js';
/**
 * A human's name with the ability to identify parts and usage.
 */
export class HumanName extends fhir.FhirElement {
    /**
     * Default constructor for HumanName - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['use']) {
            this.use = new fhir.FhirCode({ value: source.use });
        }
        if (source['_use']) {
            if (this.use) {
                this.use.addExtendedProperties(source._use);
            }
            else {
                this.use = new fhir.FhirCode(source._use);
            }
        }
        if (source['text']) {
            this.text = new fhir.FhirString({ value: source.text });
        }
        if (source['_text']) {
            if (this.text) {
                this.text.addExtendedProperties(source._text);
            }
            else {
                this.text = new fhir.FhirString(source._text);
            }
        }
        if (source['family']) {
            this.family = new fhir.FhirString({ value: source.family });
        }
        if (source['_family']) {
            if (this.family) {
                this.family.addExtendedProperties(source._family);
            }
            else {
                this.family = new fhir.FhirString(source._family);
            }
        }
        if (source['given']) {
            this.given = source.given.map((x) => new fhir.FhirString({ value: x }));
        }
        else {
            this.given = [];
        }
        if (source['_given']) {
            source._given.forEach((x, i) => {
                if (this.given.length >= i) {
                    if (x) {
                        this.given[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.given.push(new fhir.FhirString(x));
                    }
                }
            });
        }
        if (source['prefix']) {
            this.prefix = source.prefix.map((x) => new fhir.FhirString({ value: x }));
        }
        else {
            this.prefix = [];
        }
        if (source['_prefix']) {
            source._prefix.forEach((x, i) => {
                if (this.prefix.length >= i) {
                    if (x) {
                        this.prefix[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.prefix.push(new fhir.FhirString(x));
                    }
                }
            });
        }
        if (source['suffix']) {
            this.suffix = source.suffix.map((x) => new fhir.FhirString({ value: x }));
        }
        else {
            this.suffix = [];
        }
        if (source['_suffix']) {
            source._suffix.forEach((x, i) => {
                if (this.suffix.length >= i) {
                    if (x) {
                        this.suffix[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.suffix.push(new fhir.FhirString(x));
                    }
                }
            });
        }
        if (source['period']) {
            this.period = new fhir.Period(source.period);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'HumanName';
        }
        this.vOSV('use', exp, 'NameUse', NameUseVsValidation, 'r');
        this.vOS('text', exp);
        this.vOS('family', exp);
        this.vOA('given', exp);
        this.vOA('prefix', exp);
        this.vOA('suffix', exp);
        this.vOS('period', exp);
        return issues;
    }
    /**
     * Convert a HumanName into a displayable string
     */
    toDisplay(familyFirst = true, includeAnnotations = false) {
        if ((this.text) && (this.text.length > 0)) {
            return this.text.toString();
        }
        var val = '';
        if (familyFirst) {
            if (this.family) {
                val = this.family.toString();
            }
            if (this.given) {
                val += (val.length > 0 ? ', ' : '') + this.given.join(' ');
            }
            if (includeAnnotations) {
                if (this.suffix) {
                    val += (val.length > 0 ? ', ' : '') + this.suffix.join(', ');
                }
                if (this.prefix) {
                    val += (val.length > 0 ? ', ' : '') + this.prefix.join(', ');
                }
            }
            return val;
        }
        if ((includeAnnotations) && (this.prefix)) {
            val += this.prefix.join(', ');
        }
        if (this.given) {
            val = (val.length > 0 ? ' ' : '') + this.given.join(' ');
        }
        if (this.family) {
            val += (val.length > 0 ? ' ' : '') + this.family;
        }
        if ((includeAnnotations) && (this.suffix)) {
            val += (val.length > 0 ? ', ' : '') + this.suffix.join(', ');
        }
        return val;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
HumanName._fts_dataType = 'HumanName';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSHVtYW5OYW1lLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9IdW1hbk5hbWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLGdEQUFnRDtBQUNoRCxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx5Q0FBeUMsQ0FBQztBQTJEOUU7O0dBRUc7QUFDSCxNQUFNLE9BQU8sU0FBVSxTQUFRLElBQUksQ0FBQyxXQUFXO0lBaUM3Qzs7T0FFRztJQUNILFlBQVksU0FBZ0MsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDdEYsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFrQixFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsR0FBRyxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQzFGLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQ2xCLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRTtnQkFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxJQUFLLENBQUMsQ0FBQzthQUFFO2lCQUMxRDtnQkFBRSxJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBa0IsTUFBTSxDQUFDLElBQThCLENBQUMsQ0FBQzthQUFFO1NBQy9GO1FBQ0QsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUFF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LENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1NBQ2xEO1FBRUQsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDekMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDOUQ7UUFFRCxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUM7O0FBOUlDOztHQUVHO0FBQzZCLHVCQUFhLEdBQVUsV0FBVyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0Yi5jb3JlIHZlcnNpb246IDQuMy4wXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBDb21wbGV4VHlwZTogSHVtYW5OYW1lXHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBOYW1lVXNlQ29kZXMsICBOYW1lVXNlQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL05hbWVVc2VDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTmFtZVVzZVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTmFtZVVzZVZzVmFsaWRhdGlvbi5qcyc7XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBIdW1hbk5hbWUgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSHVtYW5OYW1lQXJncyBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBBcHBsaWNhdGlvbnMgY2FuIGFzc3VtZSB0aGF0IGEgbmFtZSBpcyBjdXJyZW50IHVubGVzcyBpdCBleHBsaWNpdGx5IHNheXMgdGhhdCBpdCBpcyB0ZW1wb3Jhcnkgb3Igb2xkLlxyXG4gICAqL1xyXG4gIHVzZT86IGZoaXIuRmhpckNvZGU8TmFtZVVzZUNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBIdW1hbk5hbWUudXNlXHJcbiAgICovXHJcbiAgX3VzZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogQ2FuIHByb3ZpZGUgYm90aCBhIHRleHQgcmVwcmVzZW50YXRpb24gYW5kIHBhcnRzLiBBcHBsaWNhdGlvbnMgdXBkYXRpbmcgYSBuYW1lIFNIQUxMIGVuc3VyZSB0aGF0IHdoZW4gYm90aCB0ZXh0IGFuZCBwYXJ0cyBhcmUgcHJlc2VudCwgIG5vIGNvbnRlbnQgaXMgaW5jbHVkZWQgaW4gdGhlIHRleHQgdGhhdCBpc24ndCBmb3VuZCBpbiBhIHBhcnQuXHJcbiAgICovXHJcbiAgdGV4dD86IGZoaXIuRmhpclN0cmluZ3xzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBIdW1hbk5hbWUudGV4dFxyXG4gICAqL1xyXG4gIF90ZXh0PzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBGYW1pbHkgTmFtZSBtYXkgYmUgZGVjb21wb3NlZCBpbnRvIHNwZWNpZmljIHBhcnRzIHVzaW5nIGV4dGVuc2lvbnMgKGRlLCBubCwgZXMgcmVsYXRlZCBjdWx0dXJlcykuXHJcbiAgICovXHJcbiAgZmFtaWx5PzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEh1bWFuTmFtZS5mYW1pbHlcclxuICAgKi9cclxuICBfZmFtaWx5PzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBJZiBvbmx5IGluaXRpYWxzIGFyZSByZWNvcmRlZCwgdGhleSBtYXkgYmUgdXNlZCBpbiBwbGFjZSBvZiB0aGUgZnVsbCBuYW1lIHBhcnRzLiBJbml0aWFscyBtYXkgYmUgc2VwYXJhdGVkIGludG8gbXVsdGlwbGUgZ2l2ZW4gbmFtZXMgYnV0IG9mdGVuIGFyZW4ndCBkdWUgdG8gcGFyYWN0aWNhbCBsaW1pdGF0aW9ucy4gIFRoaXMgZWxlbWVudCBpcyBub3QgY2FsbGVkIFwiZmlyc3QgbmFtZVwiIHNpbmNlIGdpdmVuIG5hbWVzIGRvIG5vdCBhbHdheXMgY29tZSBmaXJzdC5cclxuICAgKi9cclxuICBnaXZlbj86IGZoaXIuRmhpclN0cmluZ1tdfChzdHJpbmd8bnVsbClbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEh1bWFuTmFtZS5naXZlblxyXG4gICAqL1xyXG4gIF9naXZlbj86KGZoaXIuRmhpckVsZW1lbnRBcmdzfG51bGwpW107XHJcbiAgLyoqXHJcbiAgICogUGFydCBvZiB0aGUgbmFtZSB0aGF0IGlzIGFjcXVpcmVkIGFzIGEgdGl0bGUgZHVlIHRvIGFjYWRlbWljLCBsZWdhbCwgZW1wbG95bWVudCBvciBub2JpbGl0eSBzdGF0dXMsIGV0Yy4gYW5kIHRoYXQgYXBwZWFycyBhdCB0aGUgc3RhcnQgb2YgdGhlIG5hbWUuXHJcbiAgICovXHJcbiAgcHJlZml4PzogZmhpci5GaGlyU3RyaW5nW118KHN0cmluZ3xudWxsKVtdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSHVtYW5OYW1lLnByZWZpeFxyXG4gICAqL1xyXG4gIF9wcmVmaXg/OihmaGlyLkZoaXJFbGVtZW50QXJnc3xudWxsKVtdO1xyXG4gIC8qKlxyXG4gICAqIFBhcnQgb2YgdGhlIG5hbWUgdGhhdCBpcyBhY3F1aXJlZCBhcyBhIHRpdGxlIGR1ZSB0byBhY2FkZW1pYywgbGVnYWwsIGVtcGxveW1lbnQgb3Igbm9iaWxpdHkgc3RhdHVzLCBldGMuIGFuZCB0aGF0IGFwcGVhcnMgYXQgdGhlIGVuZCBvZiB0aGUgbmFtZS5cclxuICAgKi9cclxuICBzdWZmaXg/OiBmaGlyLkZoaXJTdHJpbmdbXXwoc3RyaW5nfG51bGwpW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBIdW1hbk5hbWUuc3VmZml4XHJcbiAgICovXHJcbiAgX3N1ZmZpeD86KGZoaXIuRmhpckVsZW1lbnRBcmdzfG51bGwpW107XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIHRoZSBwZXJpb2Qgb2YgdGltZSB3aGVuIHRoaXMgbmFtZSB3YXMgdmFsaWQgZm9yIHRoZSBuYW1lZCBwZXJzb24uXHJcbiAgICovXHJcbiAgcGVyaW9kPzogZmhpci5QZXJpb2RBcmdzfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEEgaHVtYW4ncyBuYW1lIHdpdGggdGhlIGFiaWxpdHkgdG8gaWRlbnRpZnkgcGFydHMgYW5kIHVzYWdlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEh1bWFuTmFtZSBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnSHVtYW5OYW1lJztcclxuICAvKipcclxuICAgKiBBcHBsaWNhdGlvbnMgY2FuIGFzc3VtZSB0aGF0IGEgbmFtZSBpcyBjdXJyZW50IHVubGVzcyBpdCBleHBsaWNpdGx5IHNheXMgdGhhdCBpdCBpcyB0ZW1wb3Jhcnkgb3Igb2xkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1c2U/OiBmaGlyLkZoaXJDb2RlPE5hbWVVc2VDb2RlVHlwZT58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIENhbiBwcm92aWRlIGJvdGggYSB0ZXh0IHJlcHJlc2VudGF0aW9uIGFuZCBwYXJ0cy4gQXBwbGljYXRpb25zIHVwZGF0aW5nIGEgbmFtZSBTSEFMTCBlbnN1cmUgdGhhdCB3aGVuIGJvdGggdGV4dCBhbmQgcGFydHMgYXJlIHByZXNlbnQsICBubyBjb250ZW50IGlzIGluY2x1ZGVkIGluIHRoZSB0ZXh0IHRoYXQgaXNuJ3QgZm91bmQgaW4gYSBwYXJ0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0ZXh0PzogZmhpci5GaGlyU3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBGYW1pbHkgTmFtZSBtYXkgYmUgZGVjb21wb3NlZCBpbnRvIHNwZWNpZmljIHBhcnRzIHVzaW5nIGV4dGVuc2lvbnMgKGRlLCBubCwgZXMgcmVsYXRlZCBjdWx0dXJlcykuXHJcbiAgICovXHJcbiAgcHVibGljIGZhbWlseT86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWYgb25seSBpbml0aWFscyBhcmUgcmVjb3JkZWQsIHRoZXkgbWF5IGJlIHVzZWQgaW4gcGxhY2Ugb2YgdGhlIGZ1bGwgbmFtZSBwYXJ0cy4gSW5pdGlhbHMgbWF5IGJlIHNlcGFyYXRlZCBpbnRvIG11bHRpcGxlIGdpdmVuIG5hbWVzIGJ1dCBvZnRlbiBhcmVuJ3QgZHVlIHRvIHBhcmFjdGljYWwgbGltaXRhdGlvbnMuICBUaGlzIGVsZW1lbnQgaXMgbm90IGNhbGxlZCBcImZpcnN0IG5hbWVcIiBzaW5jZSBnaXZlbiBuYW1lcyBkbyBub3QgYWx3YXlzIGNvbWUgZmlyc3QuXHJcbiAgICovXHJcbiAgcHVibGljIGdpdmVuOiBmaGlyLkZoaXJTdHJpbmdbXTtcclxuICAvKipcclxuICAgKiBQYXJ0IG9mIHRoZSBuYW1lIHRoYXQgaXMgYWNxdWlyZWQgYXMgYSB0aXRsZSBkdWUgdG8gYWNhZGVtaWMsIGxlZ2FsLCBlbXBsb3ltZW50IG9yIG5vYmlsaXR5IHN0YXR1cywgZXRjLiBhbmQgdGhhdCBhcHBlYXJzIGF0IHRoZSBzdGFydCBvZiB0aGUgbmFtZS5cclxuICAgKi9cclxuICBwdWJsaWMgcHJlZml4OiBmaGlyLkZoaXJTdHJpbmdbXTtcclxuICAvKipcclxuICAgKiBQYXJ0IG9mIHRoZSBuYW1lIHRoYXQgaXMgYWNxdWlyZWQgYXMgYSB0aXRsZSBkdWUgdG8gYWNhZGVtaWMsIGxlZ2FsLCBlbXBsb3ltZW50IG9yIG5vYmlsaXR5IHN0YXR1cywgZXRjLiBhbmQgdGhhdCBhcHBlYXJzIGF0IHRoZSBlbmQgb2YgdGhlIG5hbWUuXHJcbiAgICovXHJcbiAgcHVibGljIHN1ZmZpeDogZmhpci5GaGlyU3RyaW5nW107XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIHRoZSBwZXJpb2Qgb2YgdGltZSB3aGVuIHRoaXMgbmFtZSB3YXMgdmFsaWQgZm9yIHRoZSBuYW1lZCBwZXJzb24uXHJcbiAgICovXHJcbiAgcHVibGljIHBlcmlvZD86IGZoaXIuUGVyaW9kfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBIdW1hbk5hbWUgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxIdW1hbk5hbWVBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndXNlJ10pIHsgdGhpcy51c2UgPSBuZXcgZmhpci5GaGlyQ29kZTxOYW1lVXNlQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLnVzZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfdXNlJ10pIHtcclxuICAgICAgaWYgKHRoaXMudXNlKSB7IHRoaXMudXNlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3VzZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnVzZSA9IG5ldyBmaGlyLkZoaXJDb2RlPE5hbWVVc2VDb2RlVHlwZT4oc291cmNlLl91c2UgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3RleHQnXSkgeyB0aGlzLnRleHQgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLnRleHR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3RleHQnXSkge1xyXG4gICAgICBpZiAodGhpcy50ZXh0KSB7IHRoaXMudGV4dC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl90ZXh0ISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudGV4dCA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl90ZXh0IGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydmYW1pbHknXSkgeyB0aGlzLmZhbWlseSA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoe3ZhbHVlOiBzb3VyY2UuZmFtaWx5fSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19mYW1pbHknXSkge1xyXG4gICAgICBpZiAodGhpcy5mYW1pbHkpIHsgdGhpcy5mYW1pbHkuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fZmFtaWx5ISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuZmFtaWx5ID0gbmV3IGZoaXIuRmhpclN0cmluZyhzb3VyY2UuX2ZhbWlseSBhcyBQYXJ0aWFsPGZoaXIuRmhpclN0cmluZ0FyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnZ2l2ZW4nXSkgeyB0aGlzLmdpdmVuID0gc291cmNlLmdpdmVuLm1hcCgoeCkgPT4gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHh9KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmdpdmVuID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ19naXZlbiddKSB7XHJcbiAgICAgIHNvdXJjZS5fZ2l2ZW4uZm9yRWFjaCgoeCxpKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2l2ZW4ubGVuZ3RoID49IGkpIHsgaWYgKHgpIHsgdGhpcy5naXZlbltpXS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoeCk7IH0gfVxyXG4gICAgICAgIGVsc2UgeyBpZiAoeCkgeyB0aGlzLmdpdmVuLnB1c2gobmV3IGZoaXIuRmhpclN0cmluZyh4IGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pKTsgfSB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsncHJlZml4J10pIHsgdGhpcy5wcmVmaXggPSBzb3VyY2UucHJlZml4Lm1hcCgoeCkgPT4gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHh9KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnByZWZpeCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydfcHJlZml4J10pIHtcclxuICAgICAgc291cmNlLl9wcmVmaXguZm9yRWFjaCgoeCxpKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJlZml4Lmxlbmd0aCA+PSBpKSB7IGlmICh4KSB7IHRoaXMucHJlZml4W2ldLmFkZEV4dGVuZGVkUHJvcGVydGllcyh4KTsgfSB9XHJcbiAgICAgICAgZWxzZSB7IGlmICh4KSB7IHRoaXMucHJlZml4LnB1c2gobmV3IGZoaXIuRmhpclN0cmluZyh4IGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pKTsgfSB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3VmZml4J10pIHsgdGhpcy5zdWZmaXggPSBzb3VyY2Uuc3VmZml4Lm1hcCgoeCkgPT4gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHh9KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnN1ZmZpeCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydfc3VmZml4J10pIHtcclxuICAgICAgc291cmNlLl9zdWZmaXguZm9yRWFjaCgoeCxpKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3VmZml4Lmxlbmd0aCA+PSBpKSB7IGlmICh4KSB7IHRoaXMuc3VmZml4W2ldLmFkZEV4dGVuZGVkUHJvcGVydGllcyh4KTsgfSB9XHJcbiAgICAgICAgZWxzZSB7IGlmICh4KSB7IHRoaXMuc3VmZml4LnB1c2gobmV3IGZoaXIuRmhpclN0cmluZyh4IGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pKTsgfSB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsncGVyaW9kJ10pIHsgdGhpcy5wZXJpb2QgPSBuZXcgZmhpci5QZXJpb2Qoc291cmNlLnBlcmlvZCk7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdIdW1hbk5hbWUnIH1cclxuICAgIHRoaXMudk9TVigndXNlJyxleHAsJ05hbWVVc2UnLE5hbWVVc2VWc1ZhbGlkYXRpb24sJ3InKVxyXG4gICAgdGhpcy52T1MoJ3RleHQnLGV4cClcclxuICAgIHRoaXMudk9TKCdmYW1pbHknLGV4cClcclxuICAgIHRoaXMudk9BKCdnaXZlbicsZXhwKVxyXG4gICAgdGhpcy52T0EoJ3ByZWZpeCcsZXhwKVxyXG4gICAgdGhpcy52T0EoJ3N1ZmZpeCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ3BlcmlvZCcsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcblxyXG4vKipcclxuICogQ29udmVydCBhIEh1bWFuTmFtZSBpbnRvIGEgZGlzcGxheWFibGUgc3RyaW5nXHJcbiAqL1xyXG50b0Rpc3BsYXkoZmFtaWx5Rmlyc3Q6Ym9vbGVhbiA9IHRydWUsIGluY2x1ZGVBbm5vdGF0aW9uczpib29sZWFuID0gZmFsc2UpOnN0cmluZyB7XHJcbiAgaWYgKCh0aGlzLnRleHQpICYmICh0aGlzLnRleHQubGVuZ3RoID4gMCkpIHtcclxuICAgIHJldHVybiB0aGlzLnRleHQudG9TdHJpbmcoKTtcclxuICB9XHJcblxyXG4gIHZhciB2YWw6c3RyaW5nID0gJyc7XHJcblxyXG4gIGlmIChmYW1pbHlGaXJzdCkge1xyXG4gICAgaWYgKHRoaXMuZmFtaWx5KSB7XHJcbiAgICAgIHZhbCA9IHRoaXMuZmFtaWx5LnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuZ2l2ZW4pIHtcclxuICAgICAgdmFsICs9ICh2YWwubGVuZ3RoID4gMCA/ICcsICcgOiAnJykgKyB0aGlzLmdpdmVuLmpvaW4oJyAnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoaW5jbHVkZUFubm90YXRpb25zKSB7XHJcbiAgICAgIGlmICh0aGlzLnN1ZmZpeCkge1xyXG4gICAgICAgIHZhbCArPSAodmFsLmxlbmd0aCA+IDAgPyAnLCAnIDogJycpICsgdGhpcy5zdWZmaXguam9pbignLCAnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHRoaXMucHJlZml4KSB7XHJcbiAgICAgICAgdmFsICs9ICh2YWwubGVuZ3RoID4gMCA/ICcsICcgOiAnJykgKyB0aGlzLnByZWZpeC5qb2luKCcsICcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHZhbDtcclxuICB9XHJcblxyXG4gIGlmICgoaW5jbHVkZUFubm90YXRpb25zKSAmJiAodGhpcy5wcmVmaXgpKSB7XHJcbiAgICB2YWwgKz0gdGhpcy5wcmVmaXguam9pbignLCAnKTtcclxuICB9XHJcblxyXG4gIGlmICh0aGlzLmdpdmVuKSB7XHJcbiAgICB2YWwgPSAodmFsLmxlbmd0aCA+IDAgPyAnICcgOiAnJykgKyB0aGlzLmdpdmVuLmpvaW4oJyAnKTtcclxuICB9XHJcbiAgaWYgKHRoaXMuZmFtaWx5KSB7XHJcbiAgICB2YWwgKz0gKHZhbC5sZW5ndGggPiAwID8gJyAnIDogJycpICsgdGhpcy5mYW1pbHk7XHJcbiAgfVxyXG5cclxuICBpZiAoKGluY2x1ZGVBbm5vdGF0aW9ucykgJiYgKHRoaXMuc3VmZml4KSkge1xyXG4gICAgdmFsICs9ICh2YWwubGVuZ3RoID4gMCA/ICcsICcgOiAnJykgKyB0aGlzLnN1ZmZpeC5qb2luKCcsICcpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHZhbDtcclxufVxyXG59XHJcbiJdfQ==