// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: Provenance
import * as fhir from '../fhir.js';
// @ts-ignore
import { ProvenanceEntityRoleVsValidation } from '../fhirValueSets/ProvenanceEntityRoleVsValidation.js';
/**
 * Several agents may be associated (i.e. has some responsibility for an activity) with an activity and vice-versa.
 */
export class ProvenanceAgent extends fhir.BackboneElement {
    /**
     * Default constructor for ProvenanceAgent - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type, options);
        }
        if (source['role']) {
            this.role = source.role.map((x) => new fhir.CodeableConcept(x, options));
        }
        else {
            this.role = [];
        }
        if (source['who']) {
            this.who = new fhir.Reference(source.who, options);
        }
        else {
            this.who = null;
        }
        if (source['onBehalfOf']) {
            this.onBehalfOf = new fhir.Reference(source.onBehalfOf, options);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance.agent';
        }
        iss.push(...this.vOS('type', exp));
        iss.push(...this.vOA('role', exp));
        iss.push(...this.vRS('who', exp));
        iss.push(...this.vOS('onBehalfOf', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ProvenanceAgent._fts_dataType = 'ProvenanceAgent';
/**
 * An entity used in this activity.
 */
export class ProvenanceEntity extends fhir.BackboneElement {
    /**
     * Default constructor for ProvenanceEntity - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['role'] !== undefined) {
            this.role = new fhir.FhirCode({ value: source.role }, options);
        }
        else {
            this.role = null;
        }
        if (source['_role']) {
            if (this.role) {
                this.role.addExtendedProperties(source._role);
            }
            else {
                this.role = new fhir.FhirCode(source._role, options);
            }
        }
        if (source['what']) {
            this.what = new fhir.Reference(source.what, options);
        }
        else {
            this.what = null;
        }
        if (source['agent']) {
            this.agent = source.agent.map((x) => new fhir.ProvenanceAgent(x, options));
        }
        else {
            this.agent = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance.entity';
        }
        iss.push(...this.vRSV('role', exp, 'ProvenanceEntityRole', ProvenanceEntityRoleVsValidation, 'r'));
        iss.push(...this.vRS('what', exp));
        iss.push(...this.vOA('agent', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ProvenanceEntity._fts_dataType = 'ProvenanceEntity';
/**
 * Provenance of a resource is a record that describes entities and processes involved in producing and delivering or otherwise influencing that resource. Provenance provides a critical foundation for assessing authenticity, enabling trust, and allowing reproducibility. Provenance assertions are a form of contextual metadata and can themselves become important records with their own provenance. Provenance statement indicates clinical significance in terms of confidence in authenticity, reliability, and trustworthiness, integrity, and stage in lifecycle (e.g. Document Completion - has the artifact been legally authenticated), all of which may impact security, privacy, and trust policies.
 */
export class Provenance extends fhir.DomainResource {
    /**
     * Default constructor for Provenance - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Provenance';
        if (source['target']) {
            this.target = source.target.map((x) => new fhir.Reference(x, options));
        }
        else {
            this.target = [];
        }
        if (source['occurred']) {
            this.occurred = source.occurred;
        }
        else if (source['occurredPeriod']) {
            this.occurred = new fhir.Period(source.occurredPeriod, options);
        }
        else if (source['occurredDateTime'] !== undefined) {
            this.occurred = new fhir.FhirDateTime({ value: source.occurredDateTime }, options);
        }
        if (source['recorded'] !== undefined) {
            this.recorded = new fhir.FhirInstant({ value: source.recorded }, options);
        }
        else {
            this.recorded = null;
        }
        if (source['_recorded']) {
            if (this.recorded) {
                this.recorded.addExtendedProperties(source._recorded);
            }
            else {
                this.recorded = new fhir.FhirInstant(source._recorded, options);
            }
        }
        if (source['policy'] !== undefined) {
            this.policy = source.policy.map((x) => new fhir.FhirUri({ value: x }, options));
        }
        else {
            this.policy = [];
        }
        if (source['_policy']) {
            source._policy.forEach((x, i) => {
                if (this.policy.length >= i) {
                    if (x) {
                        this.policy[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.policy.push(new fhir.FhirUri(x));
                    }
                }
            });
        }
        if (source['location']) {
            this.location = new fhir.Reference(source.location, options);
        }
        if (source['reason']) {
            this.reason = source.reason.map((x) => new fhir.CodeableConcept(x, options));
        }
        else {
            this.reason = [];
        }
        if (source['activity']) {
            this.activity = new fhir.CodeableConcept(source.activity, options);
        }
        if (source['agent']) {
            this.agent = source.agent.map((x) => new fhir.ProvenanceAgent(x, options));
        }
        else {
            this.agent = [];
        }
        if (source['entity']) {
            this.entity = source.entity.map((x) => new fhir.ProvenanceEntity(x, options));
        }
        else {
            this.entity = [];
        }
        if (source['signature']) {
            this.signature = source.signature.map((x) => new fhir.Signature(x, options));
        }
        else {
            this.signature = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Provenance';
        }
        iss.push(...this.vRA('target', exp));
        iss.push(...this.vOS('occurred', exp));
        iss.push(...this.vRS('recorded', exp));
        iss.push(...this.vOA('policy', exp));
        iss.push(...this.vOS('location', exp));
        iss.push(...this.vOA('reason', exp));
        iss.push(...this.vOS('activity', exp));
        iss.push(...this.vRA('agent', exp));
        iss.push(...this.vOA('entity', exp));
        iss.push(...this.vOA('signature', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Provenance._fts_dataType = 'Provenance';
/**
 * Internal flag to properly serialize choice-type element Provenance.occurred[x]
 */
Provenance._fts_occurredIsChoice = true;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHJvdmVuYW5jZS5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvUHJvdmVuYW5jZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQyw0QkFBNEI7QUFFNUIsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFZbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSxnQ0FBZ0MsRUFBRSxNQUFNLHNEQUFzRCxDQUFDO0FBK0J4Rzs7R0FFRztBQUNILE1BQU0sT0FBTyxlQUFnQixTQUFRLElBQUksQ0FBQyxlQUFlO0lBcUJ2RDs7T0FFRztJQUNILFlBQVksU0FBc0MsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDNUYsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FBRTtRQUNuRixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUFFO2FBQzVGO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7U0FBRTtRQUN4QixJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FBRTthQUNyRTtZQUFFLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDO1NBQUU7UUFDekIsSUFBSSxNQUFNLENBQUMsWUFBWSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsVUFBVSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQUU7SUFDakcsQ0FBQztJQUNEOztPQUVHO0lBQ2EsaUJBQWlCLENBQUMsTUFBYSxFQUFFO1FBQy9DLElBQUksR0FBRyxHQUFtQixLQUFLLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdkQsSUFBSSxHQUFHLEtBQUssRUFBRSxFQUFFO1lBQUUsR0FBRyxHQUFHLGtCQUFrQixDQUFBO1NBQUU7UUFDNUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbEMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbEMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDakMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDeEMsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDOztBQTNDRDs7R0FFRztBQUM2Qiw2QkFBYSxHQUFVLGlCQUFpQixDQUFDO0FBZ0UzRTs7R0FFRztBQUNILE1BQU0sT0FBTyxnQkFBaUIsU0FBUSxJQUFJLENBQUMsZUFBZTtJQWlCeEQ7O09BRUc7SUFDSCxZQUFZLFNBQXVDLEVBQUUsRUFBRSxVQUFzQyxFQUFFO1FBQzdGLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssU0FBUyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQStCLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUFFO2FBQzVIO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7U0FBRTtRQUMxQixJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUNuQixJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsS0FBTSxDQUFDLENBQUM7YUFBRTtpQkFDN0Q7Z0JBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQStCLE1BQU0sQ0FBQyxLQUErQixFQUFFLE9BQU8sQ0FBQyxDQUFDO2FBQUU7U0FDdkg7UUFDRCxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FBRTthQUN4RTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1NBQUU7UUFDMUIsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FBRTthQUMvRjtZQUFFLElBQUksQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDO1NBQUU7SUFDM0IsQ0FBQztJQUNEOztPQUVHO0lBQ2EsaUJBQWlCLENBQUMsTUFBYSxFQUFFO1FBQy9DLElBQUksR0FBRyxHQUFtQixLQUFLLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdkQsSUFBSSxHQUFHLEtBQUssRUFBRSxFQUFFO1lBQUUsR0FBRyxHQUFHLG1CQUFtQixDQUFBO1NBQUU7UUFDN0MsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFDLEdBQUcsRUFBQyxzQkFBc0IsRUFBQyxnQ0FBZ0MsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQy9GLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2xDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ25DLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQzs7QUExQ0Q7O0dBRUc7QUFDNkIsOEJBQWEsR0FBVSxrQkFBa0IsQ0FBQztBQTJHNUU7O0dBRUc7QUFDSCxNQUFNLE9BQU8sVUFBVyxTQUFRLElBQUksQ0FBQyxjQUFjO0lBcURqRDs7T0FFRztJQUNILFlBQVksU0FBaUMsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDdkYsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztRQUNqQyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUFFO2FBQzVGO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUM7U0FBRTtRQUMxQixJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQztTQUFFO2FBQ3ZELElBQUksTUFBTSxDQUFDLGdCQUFnQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQUU7YUFDbEcsSUFBSSxNQUFNLENBQUMsa0JBQWtCLENBQUMsS0FBSyxTQUFTLEVBQUU7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsZ0JBQWdCLEVBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUFFO1FBQ3hJLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLFNBQVMsRUFBRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxRQUFRLEVBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUFFO2FBQzdHO1lBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7U0FBRTtRQUM5QixJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRTtZQUN2QixJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsU0FBVSxDQUFDLENBQUM7YUFBRTtpQkFDekU7Z0JBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLFNBQTBDLEVBQUUsT0FBTyxDQUFDLENBQUM7YUFBRTtTQUMzRztRQUNELElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLFNBQVMsRUFBRTtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFDLEtBQUssRUFBRSxDQUFDLEVBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDakg7WUFBRSxJQUFJLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQzFCLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQ3JCLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBRSxFQUFFO2dCQUM3QixJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxJQUFJLENBQUMsRUFBRTtvQkFBRSxJQUFJLENBQUMsRUFBRTt3QkFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDO3FCQUFFO2lCQUFFO3FCQUMvRTtvQkFBRSxJQUFJLENBQUMsRUFBRTt3QkFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBOEIsQ0FBQyxDQUFDLENBQUM7cUJBQUU7aUJBQUU7WUFDekYsQ0FBQyxDQUFDLENBQUM7U0FDSjtRQUNELElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUFFO1FBQ3pGLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDbEc7WUFBRSxJQUFJLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQzFCLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUFFO1FBQy9GLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDL0Y7WUFBRSxJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQ3pCLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNuRztZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDMUIsSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNyRztZQUFFLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1NBQUU7SUFDL0IsQ0FBQztJQUNEOztPQUVHO0lBQ2EsaUJBQWlCLENBQUMsTUFBYSxFQUFFO1FBQy9DLElBQUksR0FBRyxHQUFtQixLQUFLLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdkQsSUFBSSxHQUFHLEtBQUssRUFBRSxFQUFFO1lBQUUsR0FBRyxHQUFHLFlBQVksQ0FBQTtTQUFFO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ25DLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3ZDLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQzs7QUF6R0Q7O0dBRUc7QUFDNkIsd0JBQWEsR0FBVSxZQUFZLENBQUM7QUFhcEU7O0dBRUc7QUFDdUIsZ0NBQXFCLEdBQVEsSUFBSSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0LmNvcmUgdmVyc2lvbjogNC4wLjFcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIFJlc291cmNlOiBQcm92ZW5hbmNlXHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBQcm92ZW5hbmNlQWdlbnRUeXBlQ29kZXMsICBQcm92ZW5hbmNlQWdlbnRUeXBlQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Byb3ZlbmFuY2VBZ2VudFR5cGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUHJvdmVuYW5jZUFnZW50VHlwZVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUHJvdmVuYW5jZUFnZW50VHlwZVZzVmFsaWRhdGlvbi5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU2VjdXJpdHlSb2xlVHlwZUNvZGVzLCAgU2VjdXJpdHlSb2xlVHlwZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TZWN1cml0eVJvbGVUeXBlQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFNlY3VyaXR5Um9sZVR5cGVWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1NlY3VyaXR5Um9sZVR5cGVWc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFByb3ZlbmFuY2VFbnRpdHlSb2xlQ29kZXMsICBQcm92ZW5hbmNlRW50aXR5Um9sZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9Qcm92ZW5hbmNlRW50aXR5Um9sZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBQcm92ZW5hbmNlRW50aXR5Um9sZVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUHJvdmVuYW5jZUVudGl0eVJvbGVWc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFYzUHVycG9zZU9mVXNlQ29kZXMsICBWM1B1cnBvc2VPZlVzZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9WM1B1cnBvc2VPZlVzZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBWM1B1cnBvc2VPZlVzZVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvVjNQdXJwb3NlT2ZVc2VWc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFByb3ZlbmFuY2VBY3Rpdml0eVR5cGVDb2RlcywgIFByb3ZlbmFuY2VBY3Rpdml0eVR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUHJvdmVuYW5jZUFjdGl2aXR5VHlwZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBQcm92ZW5hbmNlQWN0aXZpdHlUeXBlVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9Qcm92ZW5hbmNlQWN0aXZpdHlUeXBlVnNWYWxpZGF0aW9uLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFByb3ZlbmFuY2VBZ2VudCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBQcm92ZW5hbmNlQWdlbnRBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBGb3IgZXhhbXBsZTogYXV0aG9yLCBwZXJmb3JtZXIsIGVudGVyZXIsIGF0dGVzdGVyLCBldGMuXHJcbiAgICovXHJcbiAgdHlwZT86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRm9yIGV4YW1wbGU6IGRvY3RvciwgbnVyc2UsIGNsZXJrLCBldGMuXHJcbiAgICovXHJcbiAgcm9sZT86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiB3aG9JZGVudGl0eSBzaG91bGQgYmUgdXNlZCB3aGVuIHRoZSBhZ2VudCBpcyBub3QgYSBSZXNvdXJjZSB0eXBlLlxyXG4gICAqL1xyXG4gIHdobzogZmhpci5SZWZlcmVuY2VBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogb25CZWhhbGZPZklkZW50aXR5IHNob3VsZCBiZSB1c2VkIHdoZW4gdGhlIGFnZW50IGlzIG5vdCBhIFJlc291cmNlIHR5cGUuXHJcbiAgICovXHJcbiAgb25CZWhhbGZPZj86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXZlcmFsIGFnZW50cyBtYXkgYmUgYXNzb2NpYXRlZCAoaS5lLiBoYXMgc29tZSByZXNwb25zaWJpbGl0eSBmb3IgYW4gYWN0aXZpdHkpIHdpdGggYW4gYWN0aXZpdHkgYW5kIHZpY2UtdmVyc2EuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvdmVuYW5jZUFnZW50IGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnUHJvdmVuYW5jZUFnZW50JztcclxuICAvKipcclxuICAgKiBGb3IgZXhhbXBsZTogYXV0aG9yLCBwZXJmb3JtZXIsIGVudGVyZXIsIGF0dGVzdGVyLCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRm9yIGV4YW1wbGU6IGRvY3RvciwgbnVyc2UsIGNsZXJrLCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIHJvbGU6IGZoaXIuQ29kZWFibGVDb25jZXB0W107XHJcbiAgLyoqXHJcbiAgICogd2hvSWRlbnRpdHkgc2hvdWxkIGJlIHVzZWQgd2hlbiB0aGUgYWdlbnQgaXMgbm90IGEgUmVzb3VyY2UgdHlwZS5cclxuICAgKi9cclxuICBwdWJsaWMgd2hvOiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIG9uQmVoYWxmT2ZJZGVudGl0eSBzaG91bGQgYmUgdXNlZCB3aGVuIHRoZSBhZ2VudCBpcyBub3QgYSBSZXNvdXJjZSB0eXBlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkJlaGFsZk9mPzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFByb3ZlbmFuY2VBZ2VudCAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFByb3ZlbmFuY2VBZ2VudEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWyd0eXBlJ10pIHsgdGhpcy50eXBlID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS50eXBlLCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncm9sZSddKSB7IHRoaXMucm9sZSA9IHNvdXJjZS5yb2xlLm1hcCgoeCkgPT4gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHgsIG9wdGlvbnMpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucm9sZSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWyd3aG8nXSkgeyB0aGlzLndobyA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2Uud2hvLCBvcHRpb25zKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMud2hvID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnb25CZWhhbGZPZiddKSB7IHRoaXMub25CZWhhbGZPZiA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2Uub25CZWhhbGZPZiwgb3B0aW9ucyk7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdQcm92ZW5hbmNlLmFnZW50JyB9XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygndHlwZScsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPQSgncm9sZScsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZSUygnd2hvJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdvbkJlaGFsZk9mJyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBQcm92ZW5hbmNlRW50aXR5IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFByb3ZlbmFuY2VFbnRpdHlBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBIb3cgdGhlIGVudGl0eSB3YXMgdXNlZCBkdXJpbmcgdGhlIGFjdGl2aXR5LlxyXG4gICAqL1xyXG4gIHJvbGU6IGZoaXIuRmhpckNvZGU8UHJvdmVuYW5jZUVudGl0eVJvbGVDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUHJvdmVuYW5jZS5lbnRpdHkucm9sZVxyXG4gICAqL1xyXG4gIF9yb2xlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiB3aGF0SWRlbnRpdHkgc2hvdWxkIGJlIHVzZWQgZm9yIGVudGl0aWVzIHRoYXQgYXJlIG5vdCBhIFJlc291cmNlIHR5cGUuXHJcbiAgICovXHJcbiAgd2hhdDogZmhpci5SZWZlcmVuY2VBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogQSB1c2VjYXNlIHdoZXJlIG9uZSBQcm92ZW5hbmNlLmVudGl0eS5hZ2VudCBpcyB1c2VkIHdoZXJlIHRoZSBFbnRpdHkgdGhhdCB3YXMgdXNlZCBpbiB0aGUgY3JlYXRpb24vdXBkYXRpbmcgb2YgdGhlIFRhcmdldCwgaXMgbm90IGluIHRoZSBjb250ZXh0IG9mIHRoZSBzYW1lIGN1c3RvZGlhbnNoaXAgYXMgdGhlIFRhcmdldCwgYW5kIHRodXMgdGhlIG1lYW5pbmcgb2YgUHJvdmVuYW5jZS5lbnRpdHkuYWdlbnQgaXMgdG8gc2F5IHRoYXQgdGhlIGVudGl0eSByZWZlcmVuY2VkIGlzIG1hbmFnZWQgZWxzZXdoZXJlIGFuZCB0aGF0IHRoaXMgQWdlbnQgcHJvdmlkZWQgYWNjZXNzIHRvIGl0LiAgVGhpcyB3b3VsZCBiZSBzaW1pbGFyIHRvIHdoZXJlIHRoZSBFbnRpdHkgYmVpbmcgcmVmZXJlbmNlZCBpcyBtYW5hZ2VkIG91dHNpZGUgRkhJUiwgc3VjaCBhcyB0aHJvdWdoIEhMNyB2MiwgdjMsIG9yIFhEUy4gVGhpcyBtaWdodCBiZSB3aGVyZSB0aGUgRW50aXR5IGJlaW5nIHJlZmVyZW5jZWQgaXMgbWFuYWdlZCBpbiBhbm90aGVyIEZISVIgcmVzb3VyY2Ugc2VydmVyLiBUaHVzIGl0IGV4cGxhaW5zIHRoZSBQcm92ZW5hbmNlIG9mIHRoYXQgRW50aXR5J3MgdXNlIGluIHRoZSBjb250ZXh0IG9mIHRoaXMgUHJvdmVuYW5jZSBhY3Rpdml0eS5cclxuICAgKi9cclxuICBhZ2VudD86IGZoaXIuUHJvdmVuYW5jZUFnZW50QXJnc1tdfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFuIGVudGl0eSB1c2VkIGluIHRoaXMgYWN0aXZpdHkuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvdmVuYW5jZUVudGl0eSBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ1Byb3ZlbmFuY2VFbnRpdHknO1xyXG4gIC8qKlxyXG4gICAqIEhvdyB0aGUgZW50aXR5IHdhcyB1c2VkIGR1cmluZyB0aGUgYWN0aXZpdHkuXHJcbiAgICovXHJcbiAgcHVibGljIHJvbGU6IGZoaXIuRmhpckNvZGU8UHJvdmVuYW5jZUVudGl0eVJvbGVDb2RlVHlwZT58bnVsbDtcclxuICAvKipcclxuICAgKiB3aGF0SWRlbnRpdHkgc2hvdWxkIGJlIHVzZWQgZm9yIGVudGl0aWVzIHRoYXQgYXJlIG5vdCBhIFJlc291cmNlIHR5cGUuXHJcbiAgICovXHJcbiAgcHVibGljIHdoYXQ6IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogQSB1c2VjYXNlIHdoZXJlIG9uZSBQcm92ZW5hbmNlLmVudGl0eS5hZ2VudCBpcyB1c2VkIHdoZXJlIHRoZSBFbnRpdHkgdGhhdCB3YXMgdXNlZCBpbiB0aGUgY3JlYXRpb24vdXBkYXRpbmcgb2YgdGhlIFRhcmdldCwgaXMgbm90IGluIHRoZSBjb250ZXh0IG9mIHRoZSBzYW1lIGN1c3RvZGlhbnNoaXAgYXMgdGhlIFRhcmdldCwgYW5kIHRodXMgdGhlIG1lYW5pbmcgb2YgUHJvdmVuYW5jZS5lbnRpdHkuYWdlbnQgaXMgdG8gc2F5IHRoYXQgdGhlIGVudGl0eSByZWZlcmVuY2VkIGlzIG1hbmFnZWQgZWxzZXdoZXJlIGFuZCB0aGF0IHRoaXMgQWdlbnQgcHJvdmlkZWQgYWNjZXNzIHRvIGl0LiAgVGhpcyB3b3VsZCBiZSBzaW1pbGFyIHRvIHdoZXJlIHRoZSBFbnRpdHkgYmVpbmcgcmVmZXJlbmNlZCBpcyBtYW5hZ2VkIG91dHNpZGUgRkhJUiwgc3VjaCBhcyB0aHJvdWdoIEhMNyB2MiwgdjMsIG9yIFhEUy4gVGhpcyBtaWdodCBiZSB3aGVyZSB0aGUgRW50aXR5IGJlaW5nIHJlZmVyZW5jZWQgaXMgbWFuYWdlZCBpbiBhbm90aGVyIEZISVIgcmVzb3VyY2Ugc2VydmVyLiBUaHVzIGl0IGV4cGxhaW5zIHRoZSBQcm92ZW5hbmNlIG9mIHRoYXQgRW50aXR5J3MgdXNlIGluIHRoZSBjb250ZXh0IG9mIHRoaXMgUHJvdmVuYW5jZSBhY3Rpdml0eS5cclxuICAgKi9cclxuICBwdWJsaWMgYWdlbnQ6IGZoaXIuUHJvdmVuYW5jZUFnZW50W107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgUHJvdmVuYW5jZUVudGl0eSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFByb3ZlbmFuY2VFbnRpdHlBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsncm9sZSddICE9PSB1bmRlZmluZWQpIHsgdGhpcy5yb2xlID0gbmV3IGZoaXIuRmhpckNvZGU8UHJvdmVuYW5jZUVudGl0eVJvbGVDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2Uucm9sZX0sIG9wdGlvbnMpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5yb2xlID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3JvbGUnXSkge1xyXG4gICAgICBpZiAodGhpcy5yb2xlKSB7IHRoaXMucm9sZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9yb2xlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMucm9sZSA9IG5ldyBmaGlyLkZoaXJDb2RlPFByb3ZlbmFuY2VFbnRpdHlSb2xlQ29kZVR5cGU+KHNvdXJjZS5fcm9sZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+LCBvcHRpb25zKTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnd2hhdCddKSB7IHRoaXMud2hhdCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2Uud2hhdCwgb3B0aW9ucyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLndoYXQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydhZ2VudCddKSB7IHRoaXMuYWdlbnQgPSBzb3VyY2UuYWdlbnQubWFwKCh4KSA9PiBuZXcgZmhpci5Qcm92ZW5hbmNlQWdlbnQoeCwgb3B0aW9ucykpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5hZ2VudCA9IFtdOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnUHJvdmVuYW5jZS5lbnRpdHknIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJTVigncm9sZScsZXhwLCdQcm92ZW5hbmNlRW50aXR5Um9sZScsUHJvdmVuYW5jZUVudGl0eVJvbGVWc1ZhbGlkYXRpb24sJ3InKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZSUygnd2hhdCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPQSgnYWdlbnQnLGV4cCkpO1xyXG4gICAgcmV0dXJuIGlzcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFByb3ZlbmFuY2UgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmVuYW5jZUFyZ3MgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlQXJncyB7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcmVzb3VyY2VUeXBlOiBcIlByb3ZlbmFuY2VcInx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGFyZ2V0IHJlZmVyZW5jZXMgYXJlIHVzdWFsbHkgdmVyc2lvbiBzcGVjaWZpYywgYnV0IG1pZ2h0IG5vdCBiZSwgaWYgYSB2ZXJzaW9uIGhhcyBub3QgYmVlbiBhc3NpZ25lZCBvciBpZiB0aGUgcHJvdmVuYW5jZSBpbmZvcm1hdGlvbiBpcyBwYXJ0IG9mIHRoZSBzZXQgb2YgcmVzb3VyY2VzIGJlaW5nIG1haW50YWluZWQgKGkuZS4gYSBkb2N1bWVudCkuIFdoZW4gdXNpbmcgdGhlIFJFU1RmdWwgQVBJLCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG1pZ2h0IG5vdCBiZSBrbm93biAoZXNwZWNpYWxseSBub3QgdGhlIHZlcnNpb24gc3BlY2lmaWMgb25lKTsgdGhlIGNsaWVudCBtYXkgZWl0aGVyIHN1Ym1pdCB0aGUgcmVzb3VyY2UgZmlyc3QsIGFuZCB0aGVuIHRoZSBwcm92ZW5hbmNlLCBvciBpdCBtYXkgc3VibWl0IGJvdGggdXNpbmcgYSBzaW5nbGUgdHJhbnNhY3Rpb24uIFNlZSB0aGUgbm90ZXMgb24gdHJhbnNhY3Rpb24gZm9yIGZ1cnRoZXIgZGlzY3Vzc2lvbi5cclxuICAgKi9cclxuICB0YXJnZXQ6IGZoaXIuUmVmZXJlbmNlQXJnc1tdfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBlcmlvZCBjYW4gYmUgYSBsaXR0bGUgYXJiaXRyYXJ5OyB3aGVyZSBwb3NzaWJsZSwgdGhlIHRpbWUgc2hvdWxkIGNvcnJlc3BvbmQgdG8gaHVtYW4gYXNzZXNzbWVudCBvZiB0aGUgYWN0aXZpdHkgdGltZS5cclxuICAgKi9cclxuICBvY2N1cnJlZD86IGZoaXIuUGVyaW9kfGZoaXIuRmhpckRhdGVUaW1lfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcGVyaW9kIGNhbiBiZSBhIGxpdHRsZSBhcmJpdHJhcnk7IHdoZXJlIHBvc3NpYmxlLCB0aGUgdGltZSBzaG91bGQgY29ycmVzcG9uZCB0byBodW1hbiBhc3Nlc3NtZW50IG9mIHRoZSBhY3Rpdml0eSB0aW1lLlxyXG4gICAqL1xyXG4gIG9jY3VycmVkUGVyaW9kPzogZmhpci5QZXJpb2RBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcGVyaW9kIGNhbiBiZSBhIGxpdHRsZSBhcmJpdHJhcnk7IHdoZXJlIHBvc3NpYmxlLCB0aGUgdGltZSBzaG91bGQgY29ycmVzcG9uZCB0byBodW1hbiBhc3Nlc3NtZW50IG9mIHRoZSBhY3Rpdml0eSB0aW1lLlxyXG4gICAqL1xyXG4gIG9jY3VycmVkRGF0ZVRpbWU/OiBmaGlyLkZoaXJEYXRlVGltZXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgY2FuIGJlIGEgbGl0dGxlIGRpZmZlcmVudCBmcm9tIHRoZSB0aW1lIHN0YW1wIG9uIHRoZSByZXNvdXJjZSBpZiB0aGVyZSBpcyBhIGRlbGF5IGJldHdlZW4gcmVjb3JkaW5nIHRoZSBldmVudCBhbmQgdXBkYXRpbmcgdGhlIHByb3ZlbmFuY2UgYW5kIHRhcmdldCByZXNvdXJjZS5cclxuICAgKi9cclxuICByZWNvcmRlZDogZmhpci5GaGlySW5zdGFudHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBQcm92ZW5hbmNlLnJlY29yZGVkXHJcbiAgICovXHJcbiAgX3JlY29yZGVkPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBGb3IgZXhhbXBsZTogV2hlcmUgYW4gT0F1dGggdG9rZW4gYXV0aG9yaXplcywgdGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZyb20gdGhlIE9BdXRoIHRva2VuIGlzIHBsYWNlZCBpbnRvIHRoZSBwb2xpY3kgZWxlbWVudCBXaGVyZSBhIHBvbGljeSBlbmdpbmUgKGUuZy4gWEFDTUwpIGhvbGRzIHBvbGljeSBsb2dpYywgdGhlIHVuaXF1ZSBwb2xpY3kgaWRlbnRpZmllciBpcyBwbGFjZWQgaW50byB0aGUgcG9saWN5IGVsZW1lbnQuXHJcbiAgICovXHJcbiAgcG9saWN5PzogZmhpci5GaGlyVXJpW118KHN0cmluZ3xudWxsKVtdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUHJvdmVuYW5jZS5wb2xpY3lcclxuICAgKi9cclxuICBfcG9saWN5PzooZmhpci5GaGlyRWxlbWVudEFyZ3N8bnVsbClbXTtcclxuICAvKipcclxuICAgKiBXaGVyZSB0aGUgYWN0aXZpdHkgb2NjdXJyZWQsIGlmIHJlbGV2YW50LlxyXG4gICAqL1xyXG4gIGxvY2F0aW9uPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcmVhc29uIHRoYXQgdGhlIGFjdGl2aXR5IHdhcyB0YWtpbmcgcGxhY2UuXHJcbiAgICovXHJcbiAgcmVhc29uPzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEFuIGFjdGl2aXR5IGlzIHNvbWV0aGluZyB0aGF0IG9jY3VycyBvdmVyIGEgcGVyaW9kIG9mIHRpbWUgYW5kIGFjdHMgdXBvbiBvciB3aXRoIGVudGl0aWVzOyBpdCBtYXkgaW5jbHVkZSBjb25zdW1pbmcsIHByb2Nlc3NpbmcsIHRyYW5zZm9ybWluZywgbW9kaWZ5aW5nLCByZWxvY2F0aW5nLCB1c2luZywgb3IgZ2VuZXJhdGluZyBlbnRpdGllcy5cclxuICAgKi9cclxuICBhY3Rpdml0eT86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogU2V2ZXJhbCBhZ2VudHMgbWF5IGJlIGFzc29jaWF0ZWQgKGkuZS4gaGFzIHNvbWUgcmVzcG9uc2liaWxpdHkgZm9yIGFuIGFjdGl2aXR5KSB3aXRoIGFuIGFjdGl2aXR5IGFuZCB2aWNlLXZlcnNhLlxyXG4gICAqL1xyXG4gIGFnZW50OiBmaGlyLlByb3ZlbmFuY2VBZ2VudEFyZ3NbXXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIEFuIGVudGl0eSB1c2VkIGluIHRoaXMgYWN0aXZpdHkuXHJcbiAgICovXHJcbiAgZW50aXR5PzogZmhpci5Qcm92ZW5hbmNlRW50aXR5QXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIGRpZ2l0YWwgc2lnbmF0dXJlIG9uIHRoZSB0YXJnZXQgUmVmZXJlbmNlKHMpLiBUaGUgc2lnbmVyIHNob3VsZCBtYXRjaCBhIFByb3ZlbmFuY2UuYWdlbnQuIFRoZSBwdXJwb3NlIG9mIHRoZSBzaWduYXR1cmUgaXMgaW5kaWNhdGVkLlxyXG4gICAqL1xyXG4gIHNpZ25hdHVyZT86IGZoaXIuU2lnbmF0dXJlQXJnc1tdfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFByb3ZlbmFuY2Ugb2YgYSByZXNvdXJjZSBpcyBhIHJlY29yZCB0aGF0IGRlc2NyaWJlcyBlbnRpdGllcyBhbmQgcHJvY2Vzc2VzIGludm9sdmVkIGluIHByb2R1Y2luZyBhbmQgZGVsaXZlcmluZyBvciBvdGhlcndpc2UgaW5mbHVlbmNpbmcgdGhhdCByZXNvdXJjZS4gUHJvdmVuYW5jZSBwcm92aWRlcyBhIGNyaXRpY2FsIGZvdW5kYXRpb24gZm9yIGFzc2Vzc2luZyBhdXRoZW50aWNpdHksIGVuYWJsaW5nIHRydXN0LCBhbmQgYWxsb3dpbmcgcmVwcm9kdWNpYmlsaXR5LiBQcm92ZW5hbmNlIGFzc2VydGlvbnMgYXJlIGEgZm9ybSBvZiBjb250ZXh0dWFsIG1ldGFkYXRhIGFuZCBjYW4gdGhlbXNlbHZlcyBiZWNvbWUgaW1wb3J0YW50IHJlY29yZHMgd2l0aCB0aGVpciBvd24gcHJvdmVuYW5jZS4gUHJvdmVuYW5jZSBzdGF0ZW1lbnQgaW5kaWNhdGVzIGNsaW5pY2FsIHNpZ25pZmljYW5jZSBpbiB0ZXJtcyBvZiBjb25maWRlbmNlIGluIGF1dGhlbnRpY2l0eSwgcmVsaWFiaWxpdHksIGFuZCB0cnVzdHdvcnRoaW5lc3MsIGludGVncml0eSwgYW5kIHN0YWdlIGluIGxpZmVjeWNsZSAoZS5nLiBEb2N1bWVudCBDb21wbGV0aW9uIC0gaGFzIHRoZSBhcnRpZmFjdCBiZWVuIGxlZ2FsbHkgYXV0aGVudGljYXRlZCksIGFsbCBvZiB3aGljaCBtYXkgaW1wYWN0IHNlY3VyaXR5LCBwcml2YWN5LCBhbmQgdHJ1c3QgcG9saWNpZXMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvdmVuYW5jZSBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2Uge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnUHJvdmVuYW5jZSc7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc291cmNlVHlwZTogXCJQcm92ZW5hbmNlXCI7XHJcbiAgLyoqXHJcbiAgICogVGFyZ2V0IHJlZmVyZW5jZXMgYXJlIHVzdWFsbHkgdmVyc2lvbiBzcGVjaWZpYywgYnV0IG1pZ2h0IG5vdCBiZSwgaWYgYSB2ZXJzaW9uIGhhcyBub3QgYmVlbiBhc3NpZ25lZCBvciBpZiB0aGUgcHJvdmVuYW5jZSBpbmZvcm1hdGlvbiBpcyBwYXJ0IG9mIHRoZSBzZXQgb2YgcmVzb3VyY2VzIGJlaW5nIG1haW50YWluZWQgKGkuZS4gYSBkb2N1bWVudCkuIFdoZW4gdXNpbmcgdGhlIFJFU1RmdWwgQVBJLCB0aGUgaWRlbnRpdHkgb2YgdGhlIHJlc291cmNlIG1pZ2h0IG5vdCBiZSBrbm93biAoZXNwZWNpYWxseSBub3QgdGhlIHZlcnNpb24gc3BlY2lmaWMgb25lKTsgdGhlIGNsaWVudCBtYXkgZWl0aGVyIHN1Ym1pdCB0aGUgcmVzb3VyY2UgZmlyc3QsIGFuZCB0aGVuIHRoZSBwcm92ZW5hbmNlLCBvciBpdCBtYXkgc3VibWl0IGJvdGggdXNpbmcgYSBzaW5nbGUgdHJhbnNhY3Rpb24uIFNlZSB0aGUgbm90ZXMgb24gdHJhbnNhY3Rpb24gZm9yIGZ1cnRoZXIgZGlzY3Vzc2lvbi5cclxuICAgKi9cclxuICBwdWJsaWMgdGFyZ2V0OiBmaGlyLlJlZmVyZW5jZVtdO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwZXJpb2QgY2FuIGJlIGEgbGl0dGxlIGFyYml0cmFyeTsgd2hlcmUgcG9zc2libGUsIHRoZSB0aW1lIHNob3VsZCBjb3JyZXNwb25kIHRvIGh1bWFuIGFzc2Vzc21lbnQgb2YgdGhlIGFjdGl2aXR5IHRpbWUuXHJcbiAgICovXHJcbiAgcHVibGljIG9jY3VycmVkPzogKGZoaXIuUGVyaW9kfGZoaXIuRmhpckRhdGVUaW1lKXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW50ZXJuYWwgZmxhZyB0byBwcm9wZXJseSBzZXJpYWxpemUgY2hvaWNlLXR5cGUgZWxlbWVudCBQcm92ZW5hbmNlLm9jY3VycmVkW3hdXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIHN0YXRpYyByZWFkb25seSBfZnRzX29jY3VycmVkSXNDaG9pY2U6dHJ1ZSA9IHRydWU7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBjYW4gYmUgYSBsaXR0bGUgZGlmZmVyZW50IGZyb20gdGhlIHRpbWUgc3RhbXAgb24gdGhlIHJlc291cmNlIGlmIHRoZXJlIGlzIGEgZGVsYXkgYmV0d2VlbiByZWNvcmRpbmcgdGhlIGV2ZW50IGFuZCB1cGRhdGluZyB0aGUgcHJvdmVuYW5jZSBhbmQgdGFyZ2V0IHJlc291cmNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWNvcmRlZDogZmhpci5GaGlySW5zdGFudHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIEZvciBleGFtcGxlOiBXaGVyZSBhbiBPQXV0aCB0b2tlbiBhdXRob3JpemVzLCB0aGUgdW5pcXVlIGlkZW50aWZpZXIgZnJvbSB0aGUgT0F1dGggdG9rZW4gaXMgcGxhY2VkIGludG8gdGhlIHBvbGljeSBlbGVtZW50IFdoZXJlIGEgcG9saWN5IGVuZ2luZSAoZS5nLiBYQUNNTCkgaG9sZHMgcG9saWN5IGxvZ2ljLCB0aGUgdW5pcXVlIHBvbGljeSBpZGVudGlmaWVyIGlzIHBsYWNlZCBpbnRvIHRoZSBwb2xpY3kgZWxlbWVudC5cclxuICAgKi9cclxuICBwdWJsaWMgcG9saWN5OiBmaGlyLkZoaXJVcmlbXTtcclxuICAvKipcclxuICAgKiBXaGVyZSB0aGUgYWN0aXZpdHkgb2NjdXJyZWQsIGlmIHJlbGV2YW50LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2NhdGlvbj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcmVhc29uIHRoYXQgdGhlIGFjdGl2aXR5IHdhcyB0YWtpbmcgcGxhY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHJlYXNvbjogZmhpci5Db2RlYWJsZUNvbmNlcHRbXTtcclxuICAvKipcclxuICAgKiBBbiBhY3Rpdml0eSBpcyBzb21ldGhpbmcgdGhhdCBvY2N1cnMgb3ZlciBhIHBlcmlvZCBvZiB0aW1lIGFuZCBhY3RzIHVwb24gb3Igd2l0aCBlbnRpdGllczsgaXQgbWF5IGluY2x1ZGUgY29uc3VtaW5nLCBwcm9jZXNzaW5nLCB0cmFuc2Zvcm1pbmcsIG1vZGlmeWluZywgcmVsb2NhdGluZywgdXNpbmcsIG9yIGdlbmVyYXRpbmcgZW50aXRpZXMuXHJcbiAgICovXHJcbiAgcHVibGljIGFjdGl2aXR5PzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFNldmVyYWwgYWdlbnRzIG1heSBiZSBhc3NvY2lhdGVkIChpLmUuIGhhcyBzb21lIHJlc3BvbnNpYmlsaXR5IGZvciBhbiBhY3Rpdml0eSkgd2l0aCBhbiBhY3Rpdml0eSBhbmQgdmljZS12ZXJzYS5cclxuICAgKi9cclxuICBwdWJsaWMgYWdlbnQ6IGZoaXIuUHJvdmVuYW5jZUFnZW50W107XHJcbiAgLyoqXHJcbiAgICogQW4gZW50aXR5IHVzZWQgaW4gdGhpcyBhY3Rpdml0eS5cclxuICAgKi9cclxuICBwdWJsaWMgZW50aXR5OiBmaGlyLlByb3ZlbmFuY2VFbnRpdHlbXTtcclxuICAvKipcclxuICAgKiBBIGRpZ2l0YWwgc2lnbmF0dXJlIG9uIHRoZSB0YXJnZXQgUmVmZXJlbmNlKHMpLiBUaGUgc2lnbmVyIHNob3VsZCBtYXRjaCBhIFByb3ZlbmFuY2UuYWdlbnQuIFRoZSBwdXJwb3NlIG9mIHRoZSBzaWduYXR1cmUgaXMgaW5kaWNhdGVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzaWduYXR1cmU6IGZoaXIuU2lnbmF0dXJlW107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgUHJvdmVuYW5jZSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFByb3ZlbmFuY2VBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnUHJvdmVuYW5jZSc7XHJcbiAgICBpZiAoc291cmNlWyd0YXJnZXQnXSkgeyB0aGlzLnRhcmdldCA9IHNvdXJjZS50YXJnZXQubWFwKCh4KSA9PiBuZXcgZmhpci5SZWZlcmVuY2UoeCwgb3B0aW9ucykpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50YXJnZXQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnb2NjdXJyZWQnXSkgeyB0aGlzLm9jY3VycmVkID0gc291cmNlLm9jY3VycmVkOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ29jY3VycmVkUGVyaW9kJ10pIHsgdGhpcy5vY2N1cnJlZCA9IG5ldyBmaGlyLlBlcmlvZChzb3VyY2Uub2NjdXJyZWRQZXJpb2QsIG9wdGlvbnMpOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ29jY3VycmVkRGF0ZVRpbWUnXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMub2NjdXJyZWQgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoe3ZhbHVlOiBzb3VyY2Uub2NjdXJyZWREYXRlVGltZX0sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydyZWNvcmRlZCddICE9PSB1bmRlZmluZWQpIHsgdGhpcy5yZWNvcmRlZCA9IG5ldyBmaGlyLkZoaXJJbnN0YW50KHt2YWx1ZTogc291cmNlLnJlY29yZGVkfSwgb3B0aW9ucyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnJlY29yZGVkID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3JlY29yZGVkJ10pIHtcclxuICAgICAgaWYgKHRoaXMucmVjb3JkZWQpIHsgdGhpcy5yZWNvcmRlZC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9yZWNvcmRlZCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnJlY29yZGVkID0gbmV3IGZoaXIuRmhpckluc3RhbnQoc291cmNlLl9yZWNvcmRlZCBhcyBQYXJ0aWFsPGZoaXIuRmhpckluc3RhbnRBcmdzPiwgb3B0aW9ucyk7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3BvbGljeSddICE9PSB1bmRlZmluZWQpIHsgdGhpcy5wb2xpY3kgPSBzb3VyY2UucG9saWN5Lm1hcCgoeCkgPT4gbmV3IGZoaXIuRmhpclVyaSh7dmFsdWU6IHh9LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnBvbGljeSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydfcG9saWN5J10pIHtcclxuICAgICAgc291cmNlLl9wb2xpY3kuZm9yRWFjaCgoeCxpKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMucG9saWN5Lmxlbmd0aCA+PSBpKSB7IGlmICh4KSB7IHRoaXMucG9saWN5W2ldLmFkZEV4dGVuZGVkUHJvcGVydGllcyh4KTsgfSB9XHJcbiAgICAgICAgZWxzZSB7IGlmICh4KSB7IHRoaXMucG9saWN5LnB1c2gobmV3IGZoaXIuRmhpclVyaSh4IGFzIFBhcnRpYWw8Zmhpci5GaGlyVXJpQXJncz4pKTsgfSB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnbG9jYXRpb24nXSkgeyB0aGlzLmxvY2F0aW9uID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5sb2NhdGlvbiwgb3B0aW9ucyk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3JlYXNvbiddKSB7IHRoaXMucmVhc29uID0gc291cmNlLnJlYXNvbi5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdCh4LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnJlYXNvbiA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydhY3Rpdml0eSddKSB7IHRoaXMuYWN0aXZpdHkgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLmFjdGl2aXR5LCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnYWdlbnQnXSkgeyB0aGlzLmFnZW50ID0gc291cmNlLmFnZW50Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUHJvdmVuYW5jZUFnZW50KHgsIG9wdGlvbnMpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuYWdlbnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZW50aXR5J10pIHsgdGhpcy5lbnRpdHkgPSBzb3VyY2UuZW50aXR5Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUHJvdmVuYW5jZUVudGl0eSh4LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmVudGl0eSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydzaWduYXR1cmUnXSkgeyB0aGlzLnNpZ25hdHVyZSA9IHNvdXJjZS5zaWduYXR1cmUubWFwKCh4KSA9PiBuZXcgZmhpci5TaWduYXR1cmUoeCwgb3B0aW9ucykpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5zaWduYXR1cmUgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ1Byb3ZlbmFuY2UnIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJBKCd0YXJnZXQnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ29jY3VycmVkJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJTKCdyZWNvcmRlZCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPQSgncG9saWN5JyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdsb2NhdGlvbicsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPQSgncmVhc29uJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdhY3Rpdml0eScsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZSQSgnYWdlbnQnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ2VudGl0eScsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPQSgnc2lnbmF0dXJlJyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbiJdfQ==