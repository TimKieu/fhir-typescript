// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: Medication
import * as fhir from '../fhir.js';
// @ts-ignore
import { MedicationStatusVsValidation } from '../fhirValueSets/MedicationStatusVsValidation.js';
/**
 * The ingredients need not be a complete list.  If an ingredient is not specified, this does not indicate whether an ingredient is present or absent.  If an ingredient is specified it does not mean that all ingredients are specified.  It is possible to specify both inactive and active ingredients.
 */
export class MedicationIngredient extends fhir.BackboneElement {
    /**
     * Default constructor for MedicationIngredient - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['item']) {
            this.item = source.item;
        }
        else if (source['itemCodeableConcept']) {
            this.item = new fhir.CodeableConcept(source.itemCodeableConcept);
        }
        else if (source['itemReference']) {
            this.item = new fhir.Reference(source.itemReference);
        }
        else {
            this.item = null;
        }
        if (source['isActive']) {
            this.isActive = new fhir.FhirBoolean({ value: source.isActive });
        }
        if (source['_isActive']) {
            if (this.isActive) {
                this.isActive.addExtendedProperties(source._isActive);
            }
            else {
                this.isActive = new fhir.FhirBoolean(source._isActive);
            }
        }
        if (source['strength']) {
            this.strength = new fhir.Ratio(source.strength);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Medication.ingredient';
        }
        this.vRS('item', exp);
        this.vOS('isActive', exp);
        this.vOS('strength', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
MedicationIngredient._fts_dataType = 'MedicationIngredient';
/**
 * Internal flag to properly serialize choice-type element Medication.ingredient.item[x]
 */
MedicationIngredient._fts_itemIsChoice = true;
/**
 * Information that only applies to packages (not products).
 */
export class MedicationBatch extends fhir.BackboneElement {
    /**
     * Default constructor for MedicationBatch - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['lotNumber']) {
            this.lotNumber = new fhir.FhirString({ value: source.lotNumber });
        }
        if (source['_lotNumber']) {
            if (this.lotNumber) {
                this.lotNumber.addExtendedProperties(source._lotNumber);
            }
            else {
                this.lotNumber = new fhir.FhirString(source._lotNumber);
            }
        }
        if (source['expirationDate']) {
            this.expirationDate = new fhir.FhirDateTime({ value: source.expirationDate });
        }
        if (source['_expirationDate']) {
            if (this.expirationDate) {
                this.expirationDate.addExtendedProperties(source._expirationDate);
            }
            else {
                this.expirationDate = new fhir.FhirDateTime(source._expirationDate);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Medication.batch';
        }
        this.vOS('lotNumber', exp);
        this.vOS('expirationDate', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
MedicationBatch._fts_dataType = 'MedicationBatch';
/**
 * This resource is primarily used for the identification and definition of a medication for the purposes of prescribing, dispensing, and administering a medication as well as for making statements about medication use.
 */
export class Medication extends fhir.DomainResource {
    /**
     * Default constructor for Medication - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Medication';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['code']) {
            this.code = new fhir.CodeableConcept(source.code);
        }
        if (source['status']) {
            this.status = new fhir.FhirCode({ value: source.status });
        }
        if (source['_status']) {
            if (this.status) {
                this.status.addExtendedProperties(source._status);
            }
            else {
                this.status = new fhir.FhirCode(source._status);
            }
        }
        if (source['manufacturer']) {
            this.manufacturer = new fhir.Reference(source.manufacturer);
        }
        if (source['form']) {
            this.form = new fhir.CodeableConcept(source.form);
        }
        if (source['amount']) {
            this.amount = new fhir.Ratio(source.amount);
        }
        if (source['ingredient']) {
            this.ingredient = source.ingredient.map((x) => new fhir.MedicationIngredient(x));
        }
        else {
            this.ingredient = [];
        }
        if (source['batch']) {
            this.batch = new fhir.MedicationBatch(source.batch);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Medication';
        }
        this.vRS('resourceType', exp);
        this.vOA('identifier', exp);
        this.vOS('code', exp);
        this.vOSV('status', exp, 'MedicationStatus', MedicationStatusVsValidation, 'r');
        this.vOS('manufacturer', exp);
        this.vOS('form', exp);
        this.vOS('amount', exp);
        this.vOA('ingredient', exp);
        this.vOS('batch', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Medication._fts_dataType = 'Medication';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVkaWNhdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvTWVkaWNhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQyw0QkFBNEI7QUFFNUIsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFRbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLGtEQUFrRCxDQUFDO0FBbUNoRzs7R0FFRztBQUNILE1BQU0sT0FBTyxvQkFBcUIsU0FBUSxJQUFJLENBQUMsZUFBZTtJQXFCNUQ7O09BRUc7SUFDSCxZQUFZLFNBQTJDLEVBQUUsRUFBRSxVQUFzQyxFQUFFO1FBQ2pHLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7U0FBRTthQUMzQyxJQUFJLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUM7U0FBRTthQUN4RyxJQUFJLE1BQU0sQ0FBQyxlQUFlLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQztTQUFFO2FBQ3RGO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7U0FBRTtRQUMxQixJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxRQUFRLEVBQUMsQ0FBQyxDQUFD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QWlCLENBQUMsTUFBYSxFQUFFO1FBQy9DLElBQUksTUFBTSxHQUFtQixLQUFLLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDMUQsSUFBSSxHQUFHLEtBQUssRUFBRSxFQUFFO1lBQUUsR0FBRyxHQUFHLFlBQVksQ0FBQTtTQUFFO1FBQ3RDLElBQUksQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzVCLElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzFCLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3BCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFDLEdBQUcsRUFBQyxrQkFBa0IsRUFBQyw0QkFBNEIsRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUMzRSxJQUFJLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUM1QixJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUNwQixJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUN0QixJQUFJLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUMxQixJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUNyQixPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDOztBQTdFRDs7R0FFRztBQUM2Qix3QkFBYSxHQUFVLFlBQVksQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yNC5jb3JlIHZlcnNpb246IDQuMC4xXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogTWVkaWNhdGlvblxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWVkaWNhdGlvbkNvZGVzLCAgTWVkaWNhdGlvbkNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZWRpY2F0aW9uQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1lZGljYXRpb25Wc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01lZGljYXRpb25Wc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1lZGljYXRpb25TdGF0dXNDb2RlcywgIE1lZGljYXRpb25TdGF0dXNDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWVkaWNhdGlvblN0YXR1c0NvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZWRpY2F0aW9uU3RhdHVzVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZWRpY2F0aW9uU3RhdHVzVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZWRpY2F0aW9uRm9ybUNvZGVzLCAgTWVkaWNhdGlvbkZvcm1Db2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWVkaWNhdGlvbkZvcm1Db2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWVkaWNhdGlvbkZvcm1Wc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01lZGljYXRpb25Gb3JtVnNWYWxpZGF0aW9uLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIE1lZGljYXRpb25JbmdyZWRpZW50IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE1lZGljYXRpb25JbmdyZWRpZW50QXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogVGhlIGFjdHVhbCBpbmdyZWRpZW50IC0gZWl0aGVyIGEgc3Vic3RhbmNlIChzaW1wbGUgaW5ncmVkaWVudCkgb3IgYW5vdGhlciBtZWRpY2F0aW9uIG9mIGEgbWVkaWNhdGlvbi5cclxuICAgKi9cclxuICBpdGVtPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8Zmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhY3R1YWwgaW5ncmVkaWVudCAtIGVpdGhlciBhIHN1YnN0YW5jZSAoc2ltcGxlIGluZ3JlZGllbnQpIG9yIGFub3RoZXIgbWVkaWNhdGlvbiBvZiBhIG1lZGljYXRpb24uXHJcbiAgICovXHJcbiAgaXRlbUNvZGVhYmxlQ29uY2VwdD86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGFjdHVhbCBpbmdyZWRpZW50IC0gZWl0aGVyIGEgc3Vic3RhbmNlIChzaW1wbGUgaW5ncmVkaWVudCkgb3IgYW5vdGhlciBtZWRpY2F0aW9uIG9mIGEgbWVkaWNhdGlvbi5cclxuICAgKi9cclxuICBpdGVtUmVmZXJlbmNlPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbmRpY2F0aW9uIG9mIHdoZXRoZXIgdGhpcyBpbmdyZWRpZW50IGFmZmVjdHMgdGhlIHRoZXJhcGV1dGljIGFjdGlvbiBvZiB0aGUgZHJ1Zy5cclxuICAgKi9cclxuICBpc0FjdGl2ZT86IGZoaXIuRmhpckJvb2xlYW58Ym9vbGVhbnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IE1lZGljYXRpb24uaW5ncmVkaWVudC5pc0FjdGl2ZVxyXG4gICAqL1xyXG4gIF9pc0FjdGl2ZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogU3BlY2lmaWVzIGhvdyBtYW55IChvciBob3cgbXVjaCkgb2YgdGhlIGl0ZW1zIHRoZXJlIGFyZSBpbiB0aGlzIE1lZGljYXRpb24uICBGb3IgZXhhbXBsZSwgMjUwIG1nIHBlciB0YWJsZXQuICBUaGlzIGlzIGV4cHJlc3NlZCBhcyBhIHJhdGlvIHdoZXJlIHRoZSBudW1lcmF0b3IgaXMgMjUwbWcgYW5kIHRoZSBkZW5vbWluYXRvciBpcyAxIHRhYmxldC5cclxuICAgKi9cclxuICBzdHJlbmd0aD86IGZoaXIuUmF0aW9BcmdzfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoZSBpbmdyZWRpZW50cyBuZWVkIG5vdCBiZSBhIGNvbXBsZXRlIGxpc3QuICBJZiBhbiBpbmdyZWRpZW50IGlzIG5vdCBzcGVjaWZpZWQsIHRoaXMgZG9lcyBub3QgaW5kaWNhdGUgd2hldGhlciBhbiBpbmdyZWRpZW50IGlzIHByZXNlbnQgb3IgYWJzZW50LiAgSWYgYW4gaW5ncmVkaWVudCBpcyBzcGVjaWZpZWQgaXQgZG9lcyBub3QgbWVhbiB0aGF0IGFsbCBpbmdyZWRpZW50cyBhcmUgc3BlY2lmaWVkLiAgSXQgaXMgcG9zc2libGUgdG8gc3BlY2lmeSBib3RoIGluYWN0aXZlIGFuZCBhY3RpdmUgaW5ncmVkaWVudHMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTWVkaWNhdGlvbkluZ3JlZGllbnQgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdNZWRpY2F0aW9uSW5ncmVkaWVudCc7XHJcbiAgLyoqXHJcbiAgICogVGhlIGFjdHVhbCBpbmdyZWRpZW50IC0gZWl0aGVyIGEgc3Vic3RhbmNlIChzaW1wbGUgaW5ncmVkaWVudCkgb3IgYW5vdGhlciBtZWRpY2F0aW9uIG9mIGEgbWVkaWNhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgaXRlbTogKGZoaXIuQ29kZWFibGVDb25jZXB0fGZoaXIuUmVmZXJlbmNlKXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIEludGVybmFsIGZsYWcgdG8gcHJvcGVybHkgc2VyaWFsaXplIGNob2ljZS10eXBlIGVsZW1lbnQgTWVkaWNhdGlvbi5pbmdyZWRpZW50Lml0ZW1beF1cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgc3RhdGljIHJlYWRvbmx5IF9mdHNfaXRlbUlzQ2hvaWNlOnRydWUgPSB0cnVlO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRpb24gb2Ygd2hldGhlciB0aGlzIGluZ3JlZGllbnQgYWZmZWN0cyB0aGUgdGhlcmFwZXV0aWMgYWN0aW9uIG9mIHRoZSBkcnVnLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpc0FjdGl2ZT86IGZoaXIuRmhpckJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFNwZWNpZmllcyBob3cgbWFueSAob3IgaG93IG11Y2gpIG9mIHRoZSBpdGVtcyB0aGVyZSBhcmUgaW4gdGhpcyBNZWRpY2F0aW9uLiAgRm9yIGV4YW1wbGUsIDI1MCBtZyBwZXIgdGFibGV0LiAgVGhpcyBpcyBleHByZXNzZWQgYXMgYSByYXRpbyB3aGVyZSB0aGUgbnVtZXJhdG9yIGlzIDI1MG1nIGFuZCB0aGUgZGVub21pbmF0b3IgaXMgMSB0YWJsZXQuXHJcbiAgICovXHJcbiAgcHVibGljIHN0cmVuZ3RoPzogZmhpci5SYXRpb3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgTWVkaWNhdGlvbkluZ3JlZGllbnQgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxNZWRpY2F0aW9uSW5ncmVkaWVudEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWydpdGVtJ10pIHsgdGhpcy5pdGVtID0gc291cmNlLml0ZW07IH1cclxuICAgIGVsc2UgaWYgKHNvdXJjZVsnaXRlbUNvZGVhYmxlQ29uY2VwdCddKSB7IHRoaXMuaXRlbSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UuaXRlbUNvZGVhYmxlQ29uY2VwdCk7IH1cclxuICAgIGVsc2UgaWYgKHNvdXJjZVsnaXRlbVJlZmVyZW5jZSddKSB7IHRoaXMuaXRlbSA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuaXRlbVJlZmVyZW5jZSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLml0ZW0gPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydpc0FjdGl2ZSddKSB7IHRoaXMuaXNBY3RpdmUgPSBuZXcgZmhpci5GaGlyQm9vbGVhbih7dmFsdWU6IHNvdXJjZS5pc0FjdGl2ZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfaXNBY3RpdmUnXSkge1xyXG4gICAgICBpZiAodGhpcy5pc0FjdGl2ZSkgeyB0aGlzLmlzQWN0aXZlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2lzQWN0aXZlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuaXNBY3RpdmUgPSBuZXcgZmhpci5GaGlyQm9vbGVhbihzb3VyY2UuX2lzQWN0aXZlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQm9vbGVhbkFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3RyZW5ndGgnXSkgeyB0aGlzLnN0cmVuZ3RoID0gbmV3IGZoaXIuUmF0aW8oc291cmNlLnN0cmVuZ3RoKTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ01lZGljYXRpb24uaW5ncmVkaWVudCcgfVxyXG4gICAgdGhpcy52UlMoJ2l0ZW0nLGV4cClcclxuICAgIHRoaXMudk9TKCdpc0FjdGl2ZScsZXhwKVxyXG4gICAgdGhpcy52T1MoJ3N0cmVuZ3RoJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgTWVkaWNhdGlvbkJhdGNoIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE1lZGljYXRpb25CYXRjaEFyZ3MgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhc3NpZ25lZCBsb3QgbnVtYmVyIG9mIGEgYmF0Y2ggb2YgdGhlIHNwZWNpZmllZCBwcm9kdWN0LlxyXG4gICAqL1xyXG4gIGxvdE51bWJlcj86IGZoaXIuRmhpclN0cmluZ3xzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBNZWRpY2F0aW9uLmJhdGNoLmxvdE51bWJlclxyXG4gICAqL1xyXG4gIF9sb3ROdW1iZXI/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFdoZW4gdGhpcyBzcGVjaWZpYyBiYXRjaCBvZiBwcm9kdWN0IHdpbGwgZXhwaXJlLlxyXG4gICAqL1xyXG4gIGV4cGlyYXRpb25EYXRlPzogZmhpci5GaGlyRGF0ZVRpbWV8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogTWVkaWNhdGlvbi5iYXRjaC5leHBpcmF0aW9uRGF0ZVxyXG4gICAqL1xyXG4gIF9leHBpcmF0aW9uRGF0ZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbmZvcm1hdGlvbiB0aGF0IG9ubHkgYXBwbGllcyB0byBwYWNrYWdlcyAobm90IHByb2R1Y3RzKS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBNZWRpY2F0aW9uQmF0Y2ggZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdNZWRpY2F0aW9uQmF0Y2gnO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhc3NpZ25lZCBsb3QgbnVtYmVyIG9mIGEgYmF0Y2ggb2YgdGhlIHNwZWNpZmllZCBwcm9kdWN0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb3ROdW1iZXI/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFdoZW4gdGhpcyBzcGVjaWZpYyBiYXRjaCBvZiBwcm9kdWN0IHdpbGwgZXhwaXJlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBleHBpcmF0aW9uRGF0ZT86IGZoaXIuRmhpckRhdGVUaW1lfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBNZWRpY2F0aW9uQmF0Y2ggLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxNZWRpY2F0aW9uQmF0Y2hBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsnbG90TnVtYmVyJ10pIHsgdGhpcy5sb3ROdW1iZXIgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLmxvdE51bWJlcn0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfbG90TnVtYmVyJ10pIHtcclxuICAgICAgaWYgKHRoaXMubG90TnVtYmVyKSB7IHRoaXMubG90TnVtYmVyLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2xvdE51bWJlciEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmxvdE51bWJlciA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9sb3ROdW1iZXIgYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2V4cGlyYXRpb25EYXRlJ10pIHsgdGhpcy5leHBpcmF0aW9uRGF0ZSA9IG5ldyBmaGlyLkZoaXJEYXRlVGltZSh7dmFsdWU6IHNvdXJjZS5leHBpcmF0aW9uRGF0ZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfZXhwaXJhdGlvbkRhdGUnXSkge1xyXG4gICAgICBpZiAodGhpcy5leHBpcmF0aW9uRGF0ZSkgeyB0aGlzLmV4cGlyYXRpb25EYXRlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2V4cGlyYXRpb25EYXRlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuZXhwaXJhdGlvbkRhdGUgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoc291cmNlLl9leHBpcmF0aW9uRGF0ZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckRhdGVUaW1lQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnTWVkaWNhdGlvbi5iYXRjaCcgfVxyXG4gICAgdGhpcy52T1MoJ2xvdE51bWJlcicsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2V4cGlyYXRpb25EYXRlJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgTWVkaWNhdGlvbiB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBNZWRpY2F0aW9uQXJncyBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2VBcmdzIHtcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICByZXNvdXJjZVR5cGU6IFwiTWVkaWNhdGlvblwifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgc2VyaWFsIG51bWJlciBjb3VsZCBiZSBpbmNsdWRlZCBhcyBhbiBpZGVudGlmaWVyLlxyXG4gICAqL1xyXG4gIGlkZW50aWZpZXI/OiBmaGlyLklkZW50aWZpZXJBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlcGVuZGluZyBvbiB0aGUgY29udGV4dCBvZiB1c2UsIHRoZSBjb2RlIHRoYXQgd2FzIGFjdHVhbGx5IHNlbGVjdGVkIGJ5IHRoZSB1c2VyIChwcmVzY3JpYmVyLCBkaXNwZW5zZXIsIGV0Yy4pIHdpbGwgaGF2ZSB0aGUgY29kaW5nLnVzZXJTZWxlY3RlZCBzZXQgdG8gdHJ1ZS4gIEFzIGRlc2NyaWJlZCBpbiB0aGUgY29kaW5nIGRhdGF0eXBlOiBcIkEgY29kaW5nIG1heSBiZSBtYXJrZWQgYXMgYSBcInVzZXJTZWxlY3RlZFwiIGlmIGEgdXNlciBzZWxlY3RlZCB0aGUgcGFydGljdWxhciBjb2RlZCB2YWx1ZSBpbiBhIHVzZXIgaW50ZXJmYWNlIChlLmcuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBpbiBhIHBpY2stbGlzdCkuIElmIGEgdXNlciBzZWxlY3RlZCBjb2RpbmcgZXhpc3RzLCBpdCBpcyB0aGUgcHJlZmVycmVkIGNob2ljZSBmb3IgcGVyZm9ybWluZyB0cmFuc2xhdGlvbnMgZXRjLiBPdGhlciBjb2RlcyBjYW4gb25seSBiZSBsaXRlcmFsIHRyYW5zbGF0aW9ucyB0byBhbHRlcm5hdGl2ZSBjb2RlIHN5c3RlbXMsIG9yIGNvZGVzIGF0IGEgbG93ZXIgbGV2ZWwgb2YgZ3JhbnVsYXJpdHkgKGUuZy4gYSBnZW5lcmljIGNvZGUgZm9yIGEgdmVuZG9yLXNwZWNpZmljIHByaW1hcnkgb25lKS5cclxuICAgKi9cclxuICBjb2RlPzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGlzIHN0YXR1cyBpcyBpbnRlbmRlZCB0byBpZGVudGlmeSBpZiB0aGUgbWVkaWNhdGlvbiBpbiBhIGxvY2FsIHN5c3RlbSBpcyBpbiBhY3RpdmUgdXNlIHdpdGhpbiBhIGRydWcgZGF0YWJhc2Ugb3IgaW52ZW50b3J5LiAgRm9yIGV4YW1wbGUsIGEgcGhhcm1hY3kgc3lzdGVtIG1heSBjcmVhdGUgYSBuZXcgZHJ1ZyBmaWxlIHJlY29yZCBmb3IgYSBjb21wb3VuZGVkIHByb2R1Y3QgXCJBQkMgSG9zcGl0YWwgU3BlY2lhbCBDcmVhbVwiIHdpdGggYW4gYWN0aXZlIHN0YXR1cy4gIEF0IHNvbWUgcG9pbnQgaW4gdGhlIGZ1dHVyZSwgaXQgbWF5IGJlIGRldGVybWluZWQgdGhhdCB0aGUgZHJ1ZyByZWNvcmQgd2FzIGNyZWF0ZWQgd2l0aCBhbiBlcnJvciBhbmQgdGhlIHN0YXR1cyBpcyBjaGFuZ2VkIHRvIFwiZW50ZXJlZCBpbiBlcnJvclwiLiAgIFRoaXMgc3RhdHVzIGlzIG5vdCBpbnRlbmRlZCB0byBzcGVjaWZ5IGlmIGEgbWVkaWNhdGlvbiBpcyBwYXJ0IG9mIGEgcGFydGljdWxhciBmb3JtdWxhcnkuICBJdCBpcyBwb3NzaWJsZSB0aGF0IHRoZSBkcnVnIHJlY29yZCBtYXkgYmUgcmVmZXJlbmNlZCBieSBtdWx0aXBsZSBmb3JtdWxhcmllcyBvciBjYXRhbG9ndWVzIGFuZCBlYWNoIG9mIHRob3NlIGVudHJpZXMgd291bGQgaGF2ZSBhIHNlcGFyYXRlIHN0YXR1cy5cclxuICAgKi9cclxuICBzdGF0dXM/OiBmaGlyLkZoaXJDb2RlPE1lZGljYXRpb25TdGF0dXNDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogTWVkaWNhdGlvbi5zdGF0dXNcclxuICAgKi9cclxuICBfc3RhdHVzPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGRldGFpbHMgb2YgdGhlIG1hbnVmYWN0dXJlciBvZiB0aGUgbWVkaWNhdGlvbiBwcm9kdWN0LiAgVGhpcyBpcyBub3QgaW50ZW5kZWQgdG8gcmVwcmVzZW50IHRoZSBkaXN0cmlidXRvciBvZiBhIG1lZGljYXRpb24gcHJvZHVjdC5cclxuICAgKi9cclxuICBtYW51ZmFjdHVyZXI/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFdoZW4gTWVkaWNhdGlvbiBpcyByZWZlcmVuY2VkIGZyb20gTWVkaWNhdGlvblJlcXVlc3QsIHRoaXMgaXMgdGhlIG9yZGVyZWQgZm9ybS4gIFdoZW4gTWVkaWNhdGlvbiBpcyByZWZlcmVuY2VkIHdpdGhpbiBNZWRpY2F0aW9uRGlzcGVuc2UsIHRoaXMgaXMgdGhlIGRpc3BlbnNlZCBmb3JtLiAgV2hlbiBNZWRpY2F0aW9uIGlzIHJlZmVyZW5jZWQgd2l0aGluIE1lZGljYXRpb25BZG1pbmlzdHJhdGlvbiwgdGhpcyBpcyBhZG1pbmlzdGVyZWQgZm9ybS5cclxuICAgKi9cclxuICBmb3JtPzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBTcGVjaWZpYyBhbW91bnQgb2YgdGhlIGRydWcgaW4gdGhlIHBhY2thZ2VkIHByb2R1Y3QuICBGb3IgZXhhbXBsZSwgd2hlbiBzcGVjaWZ5aW5nIGEgcHJvZHVjdCB0aGF0IGhhcyB0aGUgc2FtZSBzdHJlbmd0aCAoRm9yIGV4YW1wbGUsIEluc3VsaW4gZ2xhcmdpbmUgMTAwIHVuaXQgcGVyIG1MIHNvbHV0aW9uIGZvciBpbmplY3Rpb24pLCB0aGlzIGF0dHJpYnV0ZSBwcm92aWRlcyBhZGRpdGlvbmFsIGNsYXJpZmljYXRpb24gb2YgdGhlIHBhY2thZ2UgYW1vdW50IChGb3IgZXhhbXBsZSwgMyBtTCwgMTBtTCwgZXRjLikuXHJcbiAgICovXHJcbiAgYW1vdW50PzogZmhpci5SYXRpb0FyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBpbmdyZWRpZW50cyBuZWVkIG5vdCBiZSBhIGNvbXBsZXRlIGxpc3QuICBJZiBhbiBpbmdyZWRpZW50IGlzIG5vdCBzcGVjaWZpZWQsIHRoaXMgZG9lcyBub3QgaW5kaWNhdGUgd2hldGhlciBhbiBpbmdyZWRpZW50IGlzIHByZXNlbnQgb3IgYWJzZW50LiAgSWYgYW4gaW5ncmVkaWVudCBpcyBzcGVjaWZpZWQgaXQgZG9lcyBub3QgbWVhbiB0aGF0IGFsbCBpbmdyZWRpZW50cyBhcmUgc3BlY2lmaWVkLiAgSXQgaXMgcG9zc2libGUgdG8gc3BlY2lmeSBib3RoIGluYWN0aXZlIGFuZCBhY3RpdmUgaW5ncmVkaWVudHMuXHJcbiAgICovXHJcbiAgaW5ncmVkaWVudD86IGZoaXIuTWVkaWNhdGlvbkluZ3JlZGllbnRBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEluZm9ybWF0aW9uIHRoYXQgb25seSBhcHBsaWVzIHRvIHBhY2thZ2VzIChub3QgcHJvZHVjdHMpLlxyXG4gICAqL1xyXG4gIGJhdGNoPzogZmhpci5NZWRpY2F0aW9uQmF0Y2hBcmdzfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgcmVzb3VyY2UgaXMgcHJpbWFyaWx5IHVzZWQgZm9yIHRoZSBpZGVudGlmaWNhdGlvbiBhbmQgZGVmaW5pdGlvbiBvZiBhIG1lZGljYXRpb24gZm9yIHRoZSBwdXJwb3NlcyBvZiBwcmVzY3JpYmluZywgZGlzcGVuc2luZywgYW5kIGFkbWluaXN0ZXJpbmcgYSBtZWRpY2F0aW9uIGFzIHdlbGwgYXMgZm9yIG1ha2luZyBzdGF0ZW1lbnRzIGFib3V0IG1lZGljYXRpb24gdXNlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE1lZGljYXRpb24gZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ01lZGljYXRpb24nO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiTWVkaWNhdGlvblwiO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBzZXJpYWwgbnVtYmVyIGNvdWxkIGJlIGluY2x1ZGVkIGFzIGFuIGlkZW50aWZpZXIuXHJcbiAgICovXHJcbiAgcHVibGljIGlkZW50aWZpZXI6IGZoaXIuSWRlbnRpZmllcltdO1xyXG4gIC8qKlxyXG4gICAqIERlcGVuZGluZyBvbiB0aGUgY29udGV4dCBvZiB1c2UsIHRoZSBjb2RlIHRoYXQgd2FzIGFjdHVhbGx5IHNlbGVjdGVkIGJ5IHRoZSB1c2VyIChwcmVzY3JpYmVyLCBkaXNwZW5zZXIsIGV0Yy4pIHdpbGwgaGF2ZSB0aGUgY29kaW5nLnVzZXJTZWxlY3RlZCBzZXQgdG8gdHJ1ZS4gIEFzIGRlc2NyaWJlZCBpbiB0aGUgY29kaW5nIGRhdGF0eXBlOiBcIkEgY29kaW5nIG1heSBiZSBtYXJrZWQgYXMgYSBcInVzZXJTZWxlY3RlZFwiIGlmIGEgdXNlciBzZWxlY3RlZCB0aGUgcGFydGljdWxhciBjb2RlZCB2YWx1ZSBpbiBhIHVzZXIgaW50ZXJmYWNlIChlLmcuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBpbiBhIHBpY2stbGlzdCkuIElmIGEgdXNlciBzZWxlY3RlZCBjb2RpbmcgZXhpc3RzLCBpdCBpcyB0aGUgcHJlZmVycmVkIGNob2ljZSBmb3IgcGVyZm9ybWluZyB0cmFuc2xhdGlvbnMgZXRjLiBPdGhlciBjb2RlcyBjYW4gb25seSBiZSBsaXRlcmFsIHRyYW5zbGF0aW9ucyB0byBhbHRlcm5hdGl2ZSBjb2RlIHN5c3RlbXMsIG9yIGNvZGVzIGF0IGEgbG93ZXIgbGV2ZWwgb2YgZ3JhbnVsYXJpdHkgKGUuZy4gYSBnZW5lcmljIGNvZGUgZm9yIGEgdmVuZG9yLXNwZWNpZmljIHByaW1hcnkgb25lKS5cclxuICAgKi9cclxuICBwdWJsaWMgY29kZT86IGZoaXIuQ29kZWFibGVDb25jZXB0fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGlzIHN0YXR1cyBpcyBpbnRlbmRlZCB0byBpZGVudGlmeSBpZiB0aGUgbWVkaWNhdGlvbiBpbiBhIGxvY2FsIHN5c3RlbSBpcyBpbiBhY3RpdmUgdXNlIHdpdGhpbiBhIGRydWcgZGF0YWJhc2Ugb3IgaW52ZW50b3J5LiAgRm9yIGV4YW1wbGUsIGEgcGhhcm1hY3kgc3lzdGVtIG1heSBjcmVhdGUgYSBuZXcgZHJ1ZyBmaWxlIHJlY29yZCBmb3IgYSBjb21wb3VuZGVkIHByb2R1Y3QgXCJBQkMgSG9zcGl0YWwgU3BlY2lhbCBDcmVhbVwiIHdpdGggYW4gYWN0aXZlIHN0YXR1cy4gIEF0IHNvbWUgcG9pbnQgaW4gdGhlIGZ1dHVyZSwgaXQgbWF5IGJlIGRldGVybWluZWQgdGhhdCB0aGUgZHJ1ZyByZWNvcmQgd2FzIGNyZWF0ZWQgd2l0aCBhbiBlcnJvciBhbmQgdGhlIHN0YXR1cyBpcyBjaGFuZ2VkIHRvIFwiZW50ZXJlZCBpbiBlcnJvclwiLiAgIFRoaXMgc3RhdHVzIGlzIG5vdCBpbnRlbmRlZCB0byBzcGVjaWZ5IGlmIGEgbWVkaWNhdGlvbiBpcyBwYXJ0IG9mIGEgcGFydGljdWxhciBmb3JtdWxhcnkuICBJdCBpcyBwb3NzaWJsZSB0aGF0IHRoZSBkcnVnIHJlY29yZCBtYXkgYmUgcmVmZXJlbmNlZCBieSBtdWx0aXBsZSBmb3JtdWxhcmllcyBvciBjYXRhbG9ndWVzIGFuZCBlYWNoIG9mIHRob3NlIGVudHJpZXMgd291bGQgaGF2ZSBhIHNlcGFyYXRlIHN0YXR1cy5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdHVzPzogZmhpci5GaGlyQ29kZTxNZWRpY2F0aW9uU3RhdHVzQ29kZVR5cGU+fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGRldGFpbHMgb2YgdGhlIG1hbnVmYWN0dXJlciBvZiB0aGUgbWVkaWNhdGlvbiBwcm9kdWN0LiAgVGhpcyBpcyBub3QgaW50ZW5kZWQgdG8gcmVwcmVzZW50IHRoZSBkaXN0cmlidXRvciBvZiBhIG1lZGljYXRpb24gcHJvZHVjdC5cclxuICAgKi9cclxuICBwdWJsaWMgbWFudWZhY3R1cmVyPzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFdoZW4gTWVkaWNhdGlvbiBpcyByZWZlcmVuY2VkIGZyb20gTWVkaWNhdGlvblJlcXVlc3QsIHRoaXMgaXMgdGhlIG9yZGVyZWQgZm9ybS4gIFdoZW4gTWVkaWNhdGlvbiBpcyByZWZlcmVuY2VkIHdpdGhpbiBNZWRpY2F0aW9uRGlzcGVuc2UsIHRoaXMgaXMgdGhlIGRpc3BlbnNlZCBmb3JtLiAgV2hlbiBNZWRpY2F0aW9uIGlzIHJlZmVyZW5jZWQgd2l0aGluIE1lZGljYXRpb25BZG1pbmlzdHJhdGlvbiwgdGhpcyBpcyBhZG1pbmlzdGVyZWQgZm9ybS5cclxuICAgKi9cclxuICBwdWJsaWMgZm9ybT86IGZoaXIuQ29kZWFibGVDb25jZXB0fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBTcGVjaWZpYyBhbW91bnQgb2YgdGhlIGRydWcgaW4gdGhlIHBhY2thZ2VkIHByb2R1Y3QuICBGb3IgZXhhbXBsZSwgd2hlbiBzcGVjaWZ5aW5nIGEgcHJvZHVjdCB0aGF0IGhhcyB0aGUgc2FtZSBzdHJlbmd0aCAoRm9yIGV4YW1wbGUsIEluc3VsaW4gZ2xhcmdpbmUgMTAwIHVuaXQgcGVyIG1MIHNvbHV0aW9uIGZvciBpbmplY3Rpb24pLCB0aGlzIGF0dHJpYnV0ZSBwcm92aWRlcyBhZGRpdGlvbmFsIGNsYXJpZmljYXRpb24gb2YgdGhlIHBhY2thZ2UgYW1vdW50IChGb3IgZXhhbXBsZSwgMyBtTCwgMTBtTCwgZXRjLikuXHJcbiAgICovXHJcbiAgcHVibGljIGFtb3VudD86IGZoaXIuUmF0aW98dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBpbmdyZWRpZW50cyBuZWVkIG5vdCBiZSBhIGNvbXBsZXRlIGxpc3QuICBJZiBhbiBpbmdyZWRpZW50IGlzIG5vdCBzcGVjaWZpZWQsIHRoaXMgZG9lcyBub3QgaW5kaWNhdGUgd2hldGhlciBhbiBpbmdyZWRpZW50IGlzIHByZXNlbnQgb3IgYWJzZW50LiAgSWYgYW4gaW5ncmVkaWVudCBpcyBzcGVjaWZpZWQgaXQgZG9lcyBub3QgbWVhbiB0aGF0IGFsbCBpbmdyZWRpZW50cyBhcmUgc3BlY2lmaWVkLiAgSXQgaXMgcG9zc2libGUgdG8gc3BlY2lmeSBib3RoIGluYWN0aXZlIGFuZCBhY3RpdmUgaW5ncmVkaWVudHMuXHJcbiAgICovXHJcbiAgcHVibGljIGluZ3JlZGllbnQ6IGZoaXIuTWVkaWNhdGlvbkluZ3JlZGllbnRbXTtcclxuICAvKipcclxuICAgKiBJbmZvcm1hdGlvbiB0aGF0IG9ubHkgYXBwbGllcyB0byBwYWNrYWdlcyAobm90IHByb2R1Y3RzKS5cclxuICAgKi9cclxuICBwdWJsaWMgYmF0Y2g/OiBmaGlyLk1lZGljYXRpb25CYXRjaHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgTWVkaWNhdGlvbiAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPE1lZGljYXRpb25BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnTWVkaWNhdGlvbic7XHJcbiAgICBpZiAoc291cmNlWydpZGVudGlmaWVyJ10pIHsgdGhpcy5pZGVudGlmaWVyID0gc291cmNlLmlkZW50aWZpZXIubWFwKCh4KSA9PiBuZXcgZmhpci5JZGVudGlmaWVyKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaWRlbnRpZmllciA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydjb2RlJ10pIHsgdGhpcy5jb2RlID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5jb2RlKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3RhdHVzJ10pIHsgdGhpcy5zdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxNZWRpY2F0aW9uU3RhdHVzQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLnN0YXR1c30pOyB9XHJcbiAgICBpZiAoc291cmNlWydfc3RhdHVzJ10pIHtcclxuICAgICAgaWYgKHRoaXMuc3RhdHVzKSB7IHRoaXMuc3RhdHVzLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3N0YXR1cyEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnN0YXR1cyA9IG5ldyBmaGlyLkZoaXJDb2RlPE1lZGljYXRpb25TdGF0dXNDb2RlVHlwZT4oc291cmNlLl9zdGF0dXMgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ21hbnVmYWN0dXJlciddKSB7IHRoaXMubWFudWZhY3R1cmVyID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5tYW51ZmFjdHVyZXIpOyB9XHJcbiAgICBpZiAoc291cmNlWydmb3JtJ10pIHsgdGhpcy5mb3JtID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5mb3JtKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnYW1vdW50J10pIHsgdGhpcy5hbW91bnQgPSBuZXcgZmhpci5SYXRpbyhzb3VyY2UuYW1vdW50KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaW5ncmVkaWVudCddKSB7IHRoaXMuaW5ncmVkaWVudCA9IHNvdXJjZS5pbmdyZWRpZW50Lm1hcCgoeCkgPT4gbmV3IGZoaXIuTWVkaWNhdGlvbkluZ3JlZGllbnQoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5pbmdyZWRpZW50ID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2JhdGNoJ10pIHsgdGhpcy5iYXRjaCA9IG5ldyBmaGlyLk1lZGljYXRpb25CYXRjaChzb3VyY2UuYmF0Y2gpOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnTWVkaWNhdGlvbicgfVxyXG4gICAgdGhpcy52UlMoJ3Jlc291cmNlVHlwZScsZXhwKVxyXG4gICAgdGhpcy52T0EoJ2lkZW50aWZpZXInLGV4cClcclxuICAgIHRoaXMudk9TKCdjb2RlJyxleHApXHJcbiAgICB0aGlzLnZPU1YoJ3N0YXR1cycsZXhwLCdNZWRpY2F0aW9uU3RhdHVzJyxNZWRpY2F0aW9uU3RhdHVzVnNWYWxpZGF0aW9uLCdyJylcclxuICAgIHRoaXMudk9TKCdtYW51ZmFjdHVyZXInLGV4cClcclxuICAgIHRoaXMudk9TKCdmb3JtJyxleHApXHJcbiAgICB0aGlzLnZPUygnYW1vdW50JyxleHApXHJcbiAgICB0aGlzLnZPQSgnaW5ncmVkaWVudCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2JhdGNoJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4iXX0=