// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: CodeableConcept
import * as fhir from '../fhir.js';
/**
 * A concept that may be defined by a formal reference to a terminology or ontology or may be provided by text.
 */
export class CodeableConcept extends fhir.FhirElement {
    /**
     * Default constructor for CodeableConcept - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['coding']) {
            this.coding = source.coding.map((x) => new fhir.Coding(x));
        }
        else {
            this.coding = [];
        }
        if (source['text']) {
            this.text = new fhir.FhirString({ value: source.text });
        }
        if (source['_text']) {
            if (this.text) {
                this.text.addExtendedProperties(source._text);
            }
            else {
                this.text = new fhir.FhirString(source._text);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'CodeableConcept';
        }
        iss.push(...this.vOA('coding', exp));
        iss.push(...this.vOS('text', exp));
        return iss;
    }
    /**
     * Fluent-style function to add codings
     * @param coding
     * @returns this CodeableConcept, with the additional coding
     */
    addCoding(coding) {
        this.coding.push(new fhir.Coding(coding));
        return this;
    }
    /**
     * Fluent-style function to remove ALL instances of codings with a system and/or code
     * @param system
     * @param code
     * @returns this CodeableConcept, updated without the requesting coding
     */
    removeCoding(system, code) {
        if (this.coding.length === 0) {
            return this;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        let clean = this.coding.filter((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c)))) ?? [];
        this.coding = clean;
        return this;
    }
    /**
     * Find the first coding with a matching system and/or code
     * @param system
     * @param code
     * @returns A matching Coding or undefined.
     */
    findCoding(system, code) {
        if (this.coding.length === 0) {
            return undefined;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        return this.coding.find((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c))));
    }
    /**
     * Find all instances of an extension with a matching URL, optionally recurse into extension.extension.
     * @param url URL to search for
     * @param searchNested If the search should nest into extensions
     * @returns A new array of FHIR Extensions, with just the desired extensions
     */
    filterCodings(system, code) {
        if (this.coding.length === 0) {
            return [];
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        return this.coding.filter((coding) => (((s === '') || (coding.system?.value === s)) && ((c === '') || (coding.code?.value === c))));
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCoding(system, code) {
        if (this.coding.length === 0) {
            return false;
        }
        const s = (typeof system === 'string') ? system : system.value ?? '';
        const c = (typeof code === 'string') ? code : code.value ?? '';
        if ((s) && (c)) {
            return (this.coding.find((coding) => (coding.system?.value === s) && (coding.code?.value === c)) !== undefined);
        }
        if (s) {
            return (this.coding.find((coding) => (coding.system?.value === s)) !== undefined);
        }
        if (c) {
            return (this.coding.find((coding) => coding.code?.value === c) !== undefined);
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromObject(codings) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const obj of Object.values(codings)) {
            if (!obj) {
                continue;
            }
            const system = obj['system'] ?? '';
            const code = obj['code'] ?? '';
            if (this.hasCoding(system, code)) {
                return true;
            }
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromValidationObj(vsValidation) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const coding of this.coding) {
            const sc = (coding.system?.value ?? '') + '|' + (coding.code?.value ?? '');
            const c = coding.code?.value ?? '';
            if (vsValidation.find((v) => (v === sc) || (v === c))) {
                return true;
            }
        }
        return false;
    }
    /**
     * Test whether this CodeableConcept contains a specific coding.
     * @param system System to search for, empty string will match any system.
     * @param code Code to search for, empty string will match any code.
     * @returns True if this concept contains the specified coding, false if it does not.
     */
    hasCodingFromValidationHash(vsValidation) {
        if (this.coding.length === 0) {
            return false;
        }
        for (const coding of this.coding) {
            const sc = fhir.FhirBase._hash52_1a_fast((coding.system?.value ?? '') + '|' + (coding.code?.value ?? ''));
            const c = fhir.FhirBase._hash52_1a_fast(coding.code?.value ?? '');
            if (vsValidation.find((v) => (v === sc) || (v === c))) {
                return true;
            }
        }
        return false;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
CodeableConcept._fts_dataType = 'CodeableConcept';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29kZWFibGVDb25jZXB0LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9Db2RlYWJsZUNvbmNlcHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsb0NBQW9DO0FBRXBDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBb0JuQzs7R0FFRztBQUNILE1BQU0sT0FBTyxlQUFnQixTQUFRLElBQUksQ0FBQyxXQUFXO0lBYW5EOztPQUVHO0lBQ0gsWUFBWSxTQUFzQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUM1RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNoRjtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDMUIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQzlFLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxLQUFNLENBQUMsQ0FBQzthQUFFO2lCQUM3RDtnQkFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFN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LENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUM1QixPQUFPLEtBQUssQ0FBQztTQUNkO1FBRUQsS0FBSyxNQUFNLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2hDLE1BQU0sRUFBRSxHQUFVLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztZQUNqSCxNQUFNLENBQUMsR0FBVSxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssSUFBSSxFQUFFLENBQUMsQ0FBQztZQUV6RSxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQ3JELE9BQU8sSUFBSSxDQUFDO2FBQ2I7U0FDRjtRQUVELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQzs7QUE3TEQ7O0dBRUc7QUFDNkIsNkJBQWEsR0FBVSxpQkFBaUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yNC5jb3JlIHZlcnNpb246IDQuMC4xXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBDb21wbGV4VHlwZTogQ29kZWFibGVDb25jZXB0XHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIENvZGVhYmxlQ29uY2VwdCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBDb2RlYWJsZUNvbmNlcHRBcmdzIGV4dGVuZHMgZmhpci5GaGlyRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIENvZGVzIG1heSBiZSBkZWZpbmVkIHZlcnkgY2FzdWFsbHkgaW4gZW51bWVyYXRpb25zLCBvciBjb2RlIGxpc3RzLCB1cCB0byB2ZXJ5IGZvcm1hbCBkZWZpbml0aW9ucyBzdWNoIGFzIFNOT01FRCBDVCAtIHNlZSB0aGUgSEw3IHYzIENvcmUgUHJpbmNpcGxlcyBmb3IgbW9yZSBpbmZvcm1hdGlvbi4gIE9yZGVyaW5nIG9mIGNvZGluZ3MgaXMgdW5kZWZpbmVkIGFuZCBTSEFMTCBOT1QgYmUgdXNlZCB0byBpbmZlciBtZWFuaW5nLiBHZW5lcmFsbHksIGF0IG1vc3Qgb25seSBvbmUgb2YgdGhlIGNvZGluZyB2YWx1ZXMgd2lsbCBiZSBsYWJlbGVkIGFzIFVzZXJTZWxlY3RlZCA9IHRydWUuXHJcbiAgICovXHJcbiAgY29kaW5nPzogZmhpci5Db2RpbmdBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFZlcnkgb2Z0ZW4gdGhlIHRleHQgaXMgdGhlIHNhbWUgYXMgYSBkaXNwbGF5TmFtZSBvZiBvbmUgb2YgdGhlIGNvZGluZ3MuXHJcbiAgICovXHJcbiAgdGV4dD86IGZoaXIuRmhpclN0cmluZ3xzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBDb2RlYWJsZUNvbmNlcHQudGV4dFxyXG4gICAqL1xyXG4gIF90ZXh0PzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxufVxyXG5cclxuLyoqXHJcbiAqIEEgY29uY2VwdCB0aGF0IG1heSBiZSBkZWZpbmVkIGJ5IGEgZm9ybWFsIHJlZmVyZW5jZSB0byBhIHRlcm1pbm9sb2d5IG9yIG9udG9sb2d5IG9yIG1heSBiZSBwcm92aWRlZCBieSB0ZXh0LlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENvZGVhYmxlQ29uY2VwdCBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnQ29kZWFibGVDb25jZXB0JztcclxuICAvKipcclxuICAgKiBDb2RlcyBtYXkgYmUgZGVmaW5lZCB2ZXJ5IGNhc3VhbGx5IGluIGVudW1lcmF0aW9ucywgb3IgY29kZSBsaXN0cywgdXAgdG8gdmVyeSBmb3JtYWwgZGVmaW5pdGlvbnMgc3VjaCBhcyBTTk9NRUQgQ1QgLSBzZWUgdGhlIEhMNyB2MyBDb3JlIFByaW5jaXBsZXMgZm9yIG1vcmUgaW5mb3JtYXRpb24uICBPcmRlcmluZyBvZiBjb2RpbmdzIGlzIHVuZGVmaW5lZCBhbmQgU0hBTEwgTk9UIGJlIHVzZWQgdG8gaW5mZXIgbWVhbmluZy4gR2VuZXJhbGx5LCBhdCBtb3N0IG9ubHkgb25lIG9mIHRoZSBjb2RpbmcgdmFsdWVzIHdpbGwgYmUgbGFiZWxlZCBhcyBVc2VyU2VsZWN0ZWQgPSB0cnVlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb2Rpbmc6IGZoaXIuQ29kaW5nW107XHJcbiAgLyoqXHJcbiAgICogVmVyeSBvZnRlbiB0aGUgdGV4dCBpcyB0aGUgc2FtZSBhcyBhIGRpc3BsYXlOYW1lIG9mIG9uZSBvZiB0aGUgY29kaW5ncy5cclxuICAgKi9cclxuICBwdWJsaWMgdGV4dD86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgQ29kZWFibGVDb25jZXB0IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8Q29kZWFibGVDb25jZXB0QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ2NvZGluZyddKSB7IHRoaXMuY29kaW5nID0gc291cmNlLmNvZGluZy5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGluZyh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmNvZGluZyA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWyd0ZXh0J10pIHsgdGhpcy50ZXh0ID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS50ZXh0fSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ190ZXh0J10pIHtcclxuICAgICAgaWYgKHRoaXMudGV4dCkgeyB0aGlzLnRleHQuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdGV4dCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnRleHQgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHNvdXJjZS5fdGV4dCBhcyBQYXJ0aWFsPGZoaXIuRmhpclN0cmluZ0FyZ3M+KTsgfVxyXG4gICAgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ0NvZGVhYmxlQ29uY2VwdCcgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ2NvZGluZycsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygndGV4dCcsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBGbHVlbnQtc3R5bGUgZnVuY3Rpb24gdG8gYWRkIGNvZGluZ3NcclxuICAgKiBAcGFyYW0gY29kaW5nIFxyXG4gICAqIEByZXR1cm5zIHRoaXMgQ29kZWFibGVDb25jZXB0LCB3aXRoIHRoZSBhZGRpdGlvbmFsIGNvZGluZ1xyXG4gICAqL1xyXG4gICBwdWJsaWMgYWRkQ29kaW5nKGNvZGluZzpmaGlyLkNvZGluZ0FyZ3MpOkNvZGVhYmxlQ29uY2VwdCB7XHJcbiAgICB0aGlzLmNvZGluZy5wdXNoKG5ldyBmaGlyLkNvZGluZyhjb2RpbmcpKTtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmx1ZW50LXN0eWxlIGZ1bmN0aW9uIHRvIHJlbW92ZSBBTEwgaW5zdGFuY2VzIG9mIGNvZGluZ3Mgd2l0aCBhIHN5c3RlbSBhbmQvb3IgY29kZVxyXG4gICAqIEBwYXJhbSBzeXN0ZW0gXHJcbiAgICogQHBhcmFtIGNvZGUgXHJcbiAgICogQHJldHVybnMgdGhpcyBDb2RlYWJsZUNvbmNlcHQsIHVwZGF0ZWQgd2l0aG91dCB0aGUgcmVxdWVzdGluZyBjb2RpbmdcclxuICAgKi9cclxuICBwdWJsaWMgcmVtb3ZlQ29kaW5nKHN5c3RlbTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nLCBjb2RlOmZoaXIuRmhpclN0cmluZ3xzdHJpbmcpOkNvZGVhYmxlQ29uY2VwdCB7XHJcbiAgICBpZiAodGhpcy5jb2RpbmcubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gICAgY29uc3QgczpzdHJpbmcgPSAodHlwZW9mIHN5c3RlbSA9PT0gJ3N0cmluZycpID8gc3lzdGVtIDogKHN5c3RlbSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgY29uc3QgYzpzdHJpbmcgPSAodHlwZW9mIGNvZGUgPT09ICdzdHJpbmcnKSA/IGNvZGUgOiAoY29kZSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgbGV0IGNsZWFuOmZoaXIuQ29kaW5nW10gPSB0aGlzLmNvZGluZy5maWx0ZXIoKGNvZGluZykgPT4gKCgocyA9PT0gJycpIHx8IChjb2Rpbmcuc3lzdGVtPy52YWx1ZSA9PT0gcykpICYmICgoYyA9PT0gJycpIHx8IChjb2RpbmcuY29kZT8udmFsdWUgPT09IGMpKSkpID8/IFtdO1xyXG4gICAgdGhpcy5jb2RpbmcgPSBjbGVhbjtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmluZCB0aGUgZmlyc3QgY29kaW5nIHdpdGggYSBtYXRjaGluZyBzeXN0ZW0gYW5kL29yIGNvZGVcclxuICAgKiBAcGFyYW0gc3lzdGVtIFxyXG4gICAqIEBwYXJhbSBjb2RlIFxyXG4gICAqIEByZXR1cm5zIEEgbWF0Y2hpbmcgQ29kaW5nIG9yIHVuZGVmaW5lZC5cclxuICAgKi9cclxuICBwdWJsaWMgZmluZENvZGluZyhzeXN0ZW06Zmhpci5GaGlyU3RyaW5nfHN0cmluZywgY29kZTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nKTpmaGlyLkNvZGluZ3x1bmRlZmluZWQge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgY29uc3QgczpzdHJpbmcgPSAodHlwZW9mIHN5c3RlbSA9PT0gJ3N0cmluZycpID8gc3lzdGVtIDogKHN5c3RlbSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgY29uc3QgYzpzdHJpbmcgPSAodHlwZW9mIGNvZGUgPT09ICdzdHJpbmcnKSA/IGNvZGUgOiAoY29kZSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgcmV0dXJuIHRoaXMuY29kaW5nLmZpbmQoKGNvZGluZykgPT4gKCgocyA9PT0gJycpIHx8IChjb2Rpbmcuc3lzdGVtPy52YWx1ZSA9PT0gcykpICYmICgoYyA9PT0gJycpIHx8IChjb2RpbmcuY29kZT8udmFsdWUgPT09IGMpKSkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmluZCBhbGwgaW5zdGFuY2VzIG9mIGFuIGV4dGVuc2lvbiB3aXRoIGEgbWF0Y2hpbmcgVVJMLCBvcHRpb25hbGx5IHJlY3Vyc2UgaW50byBleHRlbnNpb24uZXh0ZW5zaW9uLlxyXG4gICAqIEBwYXJhbSB1cmwgVVJMIHRvIHNlYXJjaCBmb3JcclxuICAgKiBAcGFyYW0gc2VhcmNoTmVzdGVkIElmIHRoZSBzZWFyY2ggc2hvdWxkIG5lc3QgaW50byBleHRlbnNpb25zXHJcbiAgICogQHJldHVybnMgQSBuZXcgYXJyYXkgb2YgRkhJUiBFeHRlbnNpb25zLCB3aXRoIGp1c3QgdGhlIGRlc2lyZWQgZXh0ZW5zaW9uc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBmaWx0ZXJDb2RpbmdzKHN5c3RlbTpmaGlyLkZoaXJTdHJpbmd8c3RyaW5nLCBjb2RlOmZoaXIuRmhpclN0cmluZ3xzdHJpbmcpOmZoaXIuQ29kaW5nW10ge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgICBjb25zdCBzOnN0cmluZyA9ICh0eXBlb2Ygc3lzdGVtID09PSAnc3RyaW5nJykgPyBzeXN0ZW0gOiAoc3lzdGVtIGFzIGZoaXIuRmhpclN0cmluZykudmFsdWUgPz8gJyc7XHJcbiAgICBjb25zdCBjOnN0cmluZyA9ICh0eXBlb2YgY29kZSA9PT0gJ3N0cmluZycpID8gY29kZSA6IChjb2RlIGFzIGZoaXIuRmhpclN0cmluZykudmFsdWUgPz8gJyc7XHJcbiAgICByZXR1cm4gdGhpcy5jb2RpbmcuZmlsdGVyKChjb2RpbmcpID0+ICgoKHMgPT09ICcnKSB8fCAoY29kaW5nLnN5c3RlbT8udmFsdWUgPT09IHMpKSAmJiAoKGMgPT09ICcnKSB8fCAoY29kaW5nLmNvZGU/LnZhbHVlID09PSBjKSkpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRlc3Qgd2hldGhlciB0aGlzIENvZGVhYmxlQ29uY2VwdCBjb250YWlucyBhIHNwZWNpZmljIGNvZGluZy5cclxuICAgKiBAcGFyYW0gc3lzdGVtIFN5c3RlbSB0byBzZWFyY2ggZm9yLCBlbXB0eSBzdHJpbmcgd2lsbCBtYXRjaCBhbnkgc3lzdGVtLlxyXG4gICAqIEBwYXJhbSBjb2RlIENvZGUgdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IGNvZGUuXHJcbiAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGlzIGNvbmNlcHQgY29udGFpbnMgdGhlIHNwZWNpZmllZCBjb2RpbmcsIGZhbHNlIGlmIGl0IGRvZXMgbm90LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBoYXNDb2Rpbmcoc3lzdGVtOmZoaXIuRmhpclN0cmluZ3xzdHJpbmcsIGNvZGU6Zmhpci5GaGlyU3RyaW5nfHN0cmluZyk6Ym9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy5jb2RpbmcubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgczpzdHJpbmcgPSAodHlwZW9mIHN5c3RlbSA9PT0gJ3N0cmluZycpID8gc3lzdGVtIDogKHN5c3RlbSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG4gICAgY29uc3QgYzpzdHJpbmcgPSAodHlwZW9mIGNvZGUgPT09ICdzdHJpbmcnKSA/IGNvZGUgOiAoY29kZSBhcyBmaGlyLkZoaXJTdHJpbmcpLnZhbHVlID8/ICcnO1xyXG5cclxuICAgIGlmICgocykgJiYgKGMpKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5jb2RpbmcuZmluZCgoY29kaW5nKSA9PiAoY29kaW5nLnN5c3RlbT8udmFsdWUgPT09IHMpICYmIChjb2RpbmcuY29kZT8udmFsdWUgPT09IGMpKSAhPT0gdW5kZWZpbmVkKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocykge1xyXG4gICAgICByZXR1cm4gKHRoaXMuY29kaW5nLmZpbmQoKGNvZGluZykgPT4gKGNvZGluZy5zeXN0ZW0/LnZhbHVlID09PSBzKSkgIT09IHVuZGVmaW5lZCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGMpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLmNvZGluZy5maW5kKChjb2RpbmcpID0+IGNvZGluZy5jb2RlPy52YWx1ZSA9PT0gYykgIT09IHVuZGVmaW5lZCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGVzdCB3aGV0aGVyIHRoaXMgQ29kZWFibGVDb25jZXB0IGNvbnRhaW5zIGEgc3BlY2lmaWMgY29kaW5nLlxyXG4gICAqIEBwYXJhbSBzeXN0ZW0gU3lzdGVtIHRvIHNlYXJjaCBmb3IsIGVtcHR5IHN0cmluZyB3aWxsIG1hdGNoIGFueSBzeXN0ZW0uXHJcbiAgICogQHBhcmFtIGNvZGUgQ29kZSB0byBzZWFyY2ggZm9yLCBlbXB0eSBzdHJpbmcgd2lsbCBtYXRjaCBhbnkgY29kZS5cclxuICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoaXMgY29uY2VwdCBjb250YWlucyB0aGUgc3BlY2lmaWVkIGNvZGluZywgZmFsc2UgaWYgaXQgZG9lcyBub3QuXHJcbiAgICovXHJcbiAgcHVibGljIGhhc0NvZGluZ0Zyb21PYmplY3QoY29kaW5nczphbnkpOmJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuY29kaW5nLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBvYmogb2YgT2JqZWN0LnZhbHVlcyhjb2RpbmdzKSkge1xyXG4gICAgICBpZiAoIW9iaikgeyBjb250aW51ZTsgfVxyXG4gICAgICBjb25zdCBzeXN0ZW06c3RyaW5nID0gKG9iaiBhcyBhbnkpWydzeXN0ZW0nXSA/PyAnJztcclxuICAgICAgY29uc3QgY29kZTpzdHJpbmcgPSAob2JqIGFzIGFueSlbJ2NvZGUnXSA/PyAnJztcclxuXHJcbiAgICAgIGlmICh0aGlzLmhhc0NvZGluZyhzeXN0ZW0sIGNvZGUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUZXN0IHdoZXRoZXIgdGhpcyBDb2RlYWJsZUNvbmNlcHQgY29udGFpbnMgYSBzcGVjaWZpYyBjb2RpbmcuXHJcbiAgICogQHBhcmFtIHN5c3RlbSBTeXN0ZW0gdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IHN5c3RlbS5cclxuICAgKiBAcGFyYW0gY29kZSBDb2RlIHRvIHNlYXJjaCBmb3IsIGVtcHR5IHN0cmluZyB3aWxsIG1hdGNoIGFueSBjb2RlLlxyXG4gICAqIEByZXR1cm5zIFRydWUgaWYgdGhpcyBjb25jZXB0IGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgY29kaW5nLCBmYWxzZSBpZiBpdCBkb2VzIG5vdC5cclxuICAgKi9cclxuICBwdWJsaWMgaGFzQ29kaW5nRnJvbVZhbGlkYXRpb25PYmoodnNWYWxpZGF0aW9uOlJlYWRvbmx5PHN0cmluZ1tdPik6Ym9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy5jb2RpbmcubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGNvbnN0IGNvZGluZyBvZiB0aGlzLmNvZGluZykge1xyXG4gICAgICBjb25zdCBzYzpzdHJpbmcgPSAoY29kaW5nLnN5c3RlbT8udmFsdWUgPz8gJycpICsgJ3wnICsgKGNvZGluZy5jb2RlPy52YWx1ZSA/PyAnJyk7XHJcbiAgICAgIGNvbnN0IGM6c3RyaW5nID0gY29kaW5nLmNvZGU/LnZhbHVlID8/ICcnO1xyXG5cclxuICAgICAgaWYgKHZzVmFsaWRhdGlvbi5maW5kKCh2KSA9PiAodiA9PT0gc2MpIHx8ICh2ID09PSBjKSkpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRlc3Qgd2hldGhlciB0aGlzIENvZGVhYmxlQ29uY2VwdCBjb250YWlucyBhIHNwZWNpZmljIGNvZGluZy5cclxuICAgKiBAcGFyYW0gc3lzdGVtIFN5c3RlbSB0byBzZWFyY2ggZm9yLCBlbXB0eSBzdHJpbmcgd2lsbCBtYXRjaCBhbnkgc3lzdGVtLlxyXG4gICAqIEBwYXJhbSBjb2RlIENvZGUgdG8gc2VhcmNoIGZvciwgZW1wdHkgc3RyaW5nIHdpbGwgbWF0Y2ggYW55IGNvZGUuXHJcbiAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGlzIGNvbmNlcHQgY29udGFpbnMgdGhlIHNwZWNpZmllZCBjb2RpbmcsIGZhbHNlIGlmIGl0IGRvZXMgbm90LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBoYXNDb2RpbmdGcm9tVmFsaWRhdGlvbkhhc2godnNWYWxpZGF0aW9uOlJlYWRvbmx5PG51bWJlcltdPik6Ym9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy5jb2RpbmcubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGNvbnN0IGNvZGluZyBvZiB0aGlzLmNvZGluZykge1xyXG4gICAgICBjb25zdCBzYzpudW1iZXIgPSBmaGlyLkZoaXJCYXNlLl9oYXNoNTJfMWFfZmFzdCgoY29kaW5nLnN5c3RlbT8udmFsdWUgPz8gJycpICsgJ3wnICsgKGNvZGluZy5jb2RlPy52YWx1ZSA/PyAnJykpO1xyXG4gICAgICBjb25zdCBjOm51bWJlciA9IGZoaXIuRmhpckJhc2UuX2hhc2g1Ml8xYV9mYXN0KGNvZGluZy5jb2RlPy52YWx1ZSA/PyAnJyk7XHJcblxyXG4gICAgICBpZiAodnNWYWxpZGF0aW9uLmZpbmQoKHYpID0+ICh2ID09PSBzYykgfHwgKHYgPT09IGMpKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICB9XHJcbiJdfQ==