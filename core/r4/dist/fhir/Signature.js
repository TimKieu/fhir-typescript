// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: Signature
import * as fhir from '../fhir.js';
/**
 * A signature along with supporting context. The signature may be a digital signature that is cryptographic in nature, or some other signature acceptable to the domain. This other signature may be as simple as a graphical image representing a hand-written signature, or a signature ceremony Different signature approaches have different utilities.
 */
export class Signature extends fhir.FhirElement {
    /**
     * Default constructor for Signature - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = source.type.map((x) => new fhir.Coding(x));
        }
        else {
            this.type = [];
        }
        if (source['when']) {
            this.when = new fhir.FhirInstant({ value: source.when });
        }
        else {
            this.when = null;
        }
        if (source['_when']) {
            if (this.when) {
                this.when.addExtendedProperties(source._when);
            }
            else {
                this.when = new fhir.FhirInstant(source._when);
            }
        }
        if (source['who']) {
            this.who = new fhir.Reference(source.who);
        }
        else {
            this.who = null;
        }
        if (source['onBehalfOf']) {
            this.onBehalfOf = new fhir.Reference(source.onBehalfOf);
        }
        if (source['targetFormat']) {
            this.targetFormat = new fhir.FhirCode({ value: source.targetFormat });
        }
        if (source['_targetFormat']) {
            if (this.targetFormat) {
                this.targetFormat.addExtendedProperties(source._targetFormat);
            }
            else {
                this.targetFormat = new fhir.FhirCode(source._targetFormat);
            }
        }
        if (source['sigFormat']) {
            this.sigFormat = new fhir.FhirCode({ value: source.sigFormat });
        }
        if (source['_sigFormat']) {
            if (this.sigFormat) {
                this.sigFormat.addExtendedProperties(source._sigFormat);
            }
            else {
                this.sigFormat = new fhir.FhirCode(source._sigFormat);
            }
        }
        if (source['data']) {
            this.data = new fhir.FhirBase64Binary({ value: source.data });
        }
        if (source['_data']) {
            if (this.data) {
                this.data.addExtendedProperties(source._data);
            }
            else {
                this.data = new fhir.FhirBase64Binary(source._data);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Signature';
        }
        iss.push(...this.vRA('type', exp));
        iss.push(...this.vRS('when', exp));
        iss.push(...this.vRS('who', exp));
        iss.push(...this.vOS('onBehalfOf', exp));
        iss.push(...this.vOS('targetFormat', exp));
        iss.push(...this.vOS('sigFormat', exp));
        iss.push(...this.vOS('data', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Signature._fts_dataType = 'Signature';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2lnbmF0dXJlLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9TaWduYXR1cmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBd0RuQzs7R0FFRztBQUNILE1BQU0sT0FBTyxTQUFVLFNBQVEsSUFBSSxDQUFDLFdBQVc7SUFpQzdDOztPQUVHO0lBQ0gsWUFBWSxTQUFnQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUN0RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUMxRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDeEIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUFFO2FBQzFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7U0FBRTtRQUMxQixJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUNuQixJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsS0FBTSxDQUFDLENBQUM7YUFBRTtpQkFDN0Q7Z0JBQUUsSUFBSSxDQUFDLElBQUks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R0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3hDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3ZDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2xDLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQzs7QUE5RUQ7O0dBRUc7QUFDNkIsdUJBQWEsR0FBVSxXQUFXLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjQuY29yZSB2ZXJzaW9uOiA0LjAuMVxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgQ29tcGxleFR5cGU6IFNpZ25hdHVyZVxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU2lnbmF0dXJlVHlwZUNvZGVzLCAgU2lnbmF0dXJlVHlwZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TaWduYXR1cmVUeXBlQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFNpZ25hdHVyZVR5cGVWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1NpZ25hdHVyZVR5cGVWc1ZhbGlkYXRpb24uanMnO1xyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgU2lnbmF0dXJlIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFNpZ25hdHVyZUFyZ3MgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogRXhhbXBsZXMgaW5jbHVkZSBhdHRlc3RpbmcgdG86IGF1dGhvcnNoaXAsIGNvcnJlY3QgdHJhbnNjcmlwdGlvbiwgYW5kIHdpdG5lc3Mgb2Ygc3BlY2lmaWMgZXZlbnQuIEFsc28ga25vd24gYXMgYSAmYW1wO3F1b3Q7Q29tbWl0bWVudCBUeXBlIEluZGljYXRpb24mYW1wO3F1b3Q7LlxyXG4gICAqL1xyXG4gIHR5cGU6IGZoaXIuQ29kaW5nQXJnc1tdfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBzaG91bGQgYWdyZWUgd2l0aCB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIHNpZ25hdHVyZS5cclxuICAgKi9cclxuICB3aGVuOiBmaGlyLkZoaXJJbnN0YW50fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFNpZ25hdHVyZS53aGVuXHJcbiAgICovXHJcbiAgX3doZW4/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgc2hvdWxkIGFncmVlIHdpdGggdGhlIGluZm9ybWF0aW9uIGluIHRoZSBzaWduYXR1cmUuXHJcbiAgICovXHJcbiAgd2hvOiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgcGFydHkgdGhhdCBjYW4ndCBzaWduLiBGb3IgZXhhbXBsZSBhIGNoaWxkLlxyXG4gICAqL1xyXG4gIG9uQmVoYWxmT2Y/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFwieG1sXCIsIFwianNvblwiIGFuZCBcInR0bFwiIGFyZSBhbGxvd2VkLCB3aGljaCBkZXNjcmliZSB0aGUgc2ltcGxlIGVuY29kaW5ncyBkZXNjcmliZWQgaW4gdGhlIHNwZWNpZmljYXRpb24gKGFuZCBpbXBseSBhcHByb3ByaWF0ZSBidW5kbGUgc3VwcG9ydCkuIE90aGVyd2lzZSwgbWltZSB0eXBlcyBhcmUgbGVnYWwgaGVyZS5cclxuICAgKi9cclxuICB0YXJnZXRGb3JtYXQ/OiBmaGlyLkZoaXJDb2RlfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFNpZ25hdHVyZS50YXJnZXRGb3JtYXRcclxuICAgKi9cclxuICBfdGFyZ2V0Rm9ybWF0PzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBBIG1pbWUgdHlwZSB0aGF0IGluZGljYXRlcyB0aGUgdGVjaG5pY2FsIGZvcm1hdCBvZiB0aGUgc2lnbmF0dXJlLiBJbXBvcnRhbnQgbWltZSB0eXBlcyBhcmUgYXBwbGljYXRpb24vc2lnbmF0dXJlK3htbCBmb3IgWCBNTCBEaWdTaWcsIGFwcGxpY2F0aW9uL2pvc2UgZm9yIEpXUywgYW5kIGltYWdlLyogZm9yIGEgZ3JhcGhpY2FsIGltYWdlIG9mIGEgc2lnbmF0dXJlLCBldGMuXHJcbiAgICovXHJcbiAgc2lnRm9ybWF0PzogZmhpci5GaGlyQ29kZXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBTaWduYXR1cmUuc2lnRm9ybWF0XHJcbiAgICovXHJcbiAgX3NpZ0Zvcm1hdD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogV2hlcmUgdGhlIHNpZ25hdHVyZSB0eXBlIGlzIGFuIFhNTCBEaWdTaWcsIHRoZSBzaWduZWQgY29udGVudCBpcyBhIEZISVIgUmVzb3VyY2UocyksIHRoZSBzaWduYXR1cmUgaXMgb2YgdGhlIFhNTCBmb3JtIG9mIHRoZSBSZXNvdXJjZShzKSB1c2luZyAgWE1MLVNpZ25hdHVyZSAoWE1MRElHKSBcIkRldGFjaGVkIFNpZ25hdHVyZVwiIGZvcm0uXHJcbiAgICovXHJcbiAgZGF0YT86IGZoaXIuRmhpckJhc2U2NEJpbmFyeXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBTaWduYXR1cmUuZGF0YVxyXG4gICAqL1xyXG4gIF9kYXRhPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxufVxyXG5cclxuLyoqXHJcbiAqIEEgc2lnbmF0dXJlIGFsb25nIHdpdGggc3VwcG9ydGluZyBjb250ZXh0LiBUaGUgc2lnbmF0dXJlIG1heSBiZSBhIGRpZ2l0YWwgc2lnbmF0dXJlIHRoYXQgaXMgY3J5cHRvZ3JhcGhpYyBpbiBuYXR1cmUsIG9yIHNvbWUgb3RoZXIgc2lnbmF0dXJlIGFjY2VwdGFibGUgdG8gdGhlIGRvbWFpbi4gVGhpcyBvdGhlciBzaWduYXR1cmUgbWF5IGJlIGFzIHNpbXBsZSBhcyBhIGdyYXBoaWNhbCBpbWFnZSByZXByZXNlbnRpbmcgYSBoYW5kLXdyaXR0ZW4gc2lnbmF0dXJlLCBvciBhIHNpZ25hdHVyZSBjZXJlbW9ueSBEaWZmZXJlbnQgc2lnbmF0dXJlIGFwcHJvYWNoZXMgaGF2ZSBkaWZmZXJlbnQgdXRpbGl0aWVzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFNpZ25hdHVyZSBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnU2lnbmF0dXJlJztcclxuICAvKipcclxuICAgKiBFeGFtcGxlcyBpbmNsdWRlIGF0dGVzdGluZyB0bzogYXV0aG9yc2hpcCwgY29ycmVjdCB0cmFuc2NyaXB0aW9uLCBhbmQgd2l0bmVzcyBvZiBzcGVjaWZpYyBldmVudC4gQWxzbyBrbm93biBhcyBhICZhbXA7cXVvdDtDb21taXRtZW50IFR5cGUgSW5kaWNhdGlvbiZhbXA7cXVvdDsuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU6IGZoaXIuQ29kaW5nW107XHJcbiAgLyoqXHJcbiAgICogVGhpcyBzaG91bGQgYWdyZWUgd2l0aCB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIHNpZ25hdHVyZS5cclxuICAgKi9cclxuICBwdWJsaWMgd2hlbjogZmhpci5GaGlySW5zdGFudHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgc2hvdWxkIGFncmVlIHdpdGggdGhlIGluZm9ybWF0aW9uIGluIHRoZSBzaWduYXR1cmUuXHJcbiAgICovXHJcbiAgcHVibGljIHdobzogZmhpci5SZWZlcmVuY2V8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgcGFydHkgdGhhdCBjYW4ndCBzaWduLiBGb3IgZXhhbXBsZSBhIGNoaWxkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkJlaGFsZk9mPzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFwieG1sXCIsIFwianNvblwiIGFuZCBcInR0bFwiIGFyZSBhbGxvd2VkLCB3aGljaCBkZXNjcmliZSB0aGUgc2ltcGxlIGVuY29kaW5ncyBkZXNjcmliZWQgaW4gdGhlIHNwZWNpZmljYXRpb24gKGFuZCBpbXBseSBhcHByb3ByaWF0ZSBidW5kbGUgc3VwcG9ydCkuIE90aGVyd2lzZSwgbWltZSB0eXBlcyBhcmUgbGVnYWwgaGVyZS5cclxuICAgKi9cclxuICBwdWJsaWMgdGFyZ2V0Rm9ybWF0PzogZmhpci5GaGlyQ29kZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQSBtaW1lIHR5cGUgdGhhdCBpbmRpY2F0ZXMgdGhlIHRlY2huaWNhbCBmb3JtYXQgb2YgdGhlIHNpZ25hdHVyZS4gSW1wb3J0YW50IG1pbWUgdHlwZXMgYXJlIGFwcGxpY2F0aW9uL3NpZ25hdHVyZSt4bWwgZm9yIFggTUwgRGlnU2lnLCBhcHBsaWNhdGlvbi9qb3NlIGZvciBKV1MsIGFuZCBpbWFnZS8qIGZvciBhIGdyYXBoaWNhbCBpbWFnZSBvZiBhIHNpZ25hdHVyZSwgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzaWdGb3JtYXQ/OiBmaGlyLkZoaXJDb2RlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBXaGVyZSB0aGUgc2lnbmF0dXJlIHR5cGUgaXMgYW4gWE1MIERpZ1NpZywgdGhlIHNpZ25lZCBjb250ZW50IGlzIGEgRkhJUiBSZXNvdXJjZShzKSwgdGhlIHNpZ25hdHVyZSBpcyBvZiB0aGUgWE1MIGZvcm0gb2YgdGhlIFJlc291cmNlKHMpIHVzaW5nICBYTUwtU2lnbmF0dXJlIChYTUxESUcpIFwiRGV0YWNoZWQgU2lnbmF0dXJlXCIgZm9ybS5cclxuICAgKi9cclxuICBwdWJsaWMgZGF0YT86IGZoaXIuRmhpckJhc2U2NEJpbmFyeXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgU2lnbmF0dXJlIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8U2lnbmF0dXJlQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3R5cGUnXSkgeyB0aGlzLnR5cGUgPSBzb3VyY2UudHlwZS5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGluZyh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnd2hlbiddKSB7IHRoaXMud2hlbiA9IG5ldyBmaGlyLkZoaXJJbnN0YW50KHt2YWx1ZTogc291cmNlLndoZW59KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMud2hlbiA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ193aGVuJ10pIHtcclxuICAgICAgaWYgKHRoaXMud2hlbikgeyB0aGlzLndoZW4uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fd2hlbiEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLndoZW4gPSBuZXcgZmhpci5GaGlySW5zdGFudChzb3VyY2UuX3doZW4gYXMgUGFydGlhbDxmaGlyLkZoaXJJbnN0YW50QXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWyd3aG8nXSkgeyB0aGlzLndobyA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2Uud2hvKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMud2hvID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnb25CZWhhbGZPZiddKSB7IHRoaXMub25CZWhhbGZPZiA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2Uub25CZWhhbGZPZik7IH1cclxuICAgIGlmIChzb3VyY2VbJ3RhcmdldEZvcm1hdCddKSB7IHRoaXMudGFyZ2V0Rm9ybWF0ID0gbmV3IGZoaXIuRmhpckNvZGUoe3ZhbHVlOiBzb3VyY2UudGFyZ2V0Rm9ybWF0fSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ190YXJnZXRGb3JtYXQnXSkge1xyXG4gICAgICBpZiAodGhpcy50YXJnZXRGb3JtYXQpIHsgdGhpcy50YXJnZXRGb3JtYXQuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdGFyZ2V0Rm9ybWF0ISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudGFyZ2V0Rm9ybWF0ID0gbmV3IGZoaXIuRmhpckNvZGUoc291cmNlLl90YXJnZXRGb3JtYXQgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydzaWdGb3JtYXQnXSkgeyB0aGlzLnNpZ0Zvcm1hdCA9IG5ldyBmaGlyLkZoaXJDb2RlKHt2YWx1ZTogc291cmNlLnNpZ0Zvcm1hdH0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfc2lnRm9ybWF0J10pIHtcclxuICAgICAgaWYgKHRoaXMuc2lnRm9ybWF0KSB7IHRoaXMuc2lnRm9ybWF0LmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3NpZ0Zvcm1hdCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnNpZ0Zvcm1hdCA9IG5ldyBmaGlyLkZoaXJDb2RlKHNvdXJjZS5fc2lnRm9ybWF0IGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZUFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnZGF0YSddKSB7IHRoaXMuZGF0YSA9IG5ldyBmaGlyLkZoaXJCYXNlNjRCaW5hcnkoe3ZhbHVlOiBzb3VyY2UuZGF0YX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfZGF0YSddKSB7XHJcbiAgICAgIGlmICh0aGlzLmRhdGEpIHsgdGhpcy5kYXRhLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2RhdGEhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5kYXRhID0gbmV3IGZoaXIuRmhpckJhc2U2NEJpbmFyeShzb3VyY2UuX2RhdGEgYXMgUGFydGlhbDxmaGlyLkZoaXJCYXNlNjRCaW5hcnlBcmdzPik7IH1cclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdTaWduYXR1cmUnIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJBKCd0eXBlJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJTKCd3aGVuJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJTKCd3aG8nLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ29uQmVoYWxmT2YnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ3RhcmdldEZvcm1hdCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnc2lnRm9ybWF0JyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdkYXRhJyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbiJdfQ==