// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: Signature
import * as fhir from '../fhir.js';
// @ts-ignore
import { SignatureTypeCodings, } from '../fhirValueSets/SignatureTypeCodings.js';
/**
 * A signature along with supporting context. The signature may be a digital signature that is cryptographic in nature, or some other signature acceptable to the domain. This other signature may be as simple as a graphical image representing a hand-written signature, or a signature ceremony Different signature approaches have different utilities.
 */
export class Signature extends fhir.FhirElement {
    /**
     * Default constructor for Signature - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = source.type.map((x) => new fhir.Coding(x));
        }
        else {
            this.type = [];
        }
        if (source['when']) {
            this.when = new fhir.FhirInstant({ value: source.when });
        }
        else {
            this.when = null;
        }
        if (source['_when']) {
            if (this.when) {
                this.when.addExtendedProperties(source._when);
            }
            else {
                this.when = new fhir.FhirInstant(source._when);
            }
        }
        if (source['who']) {
            this.who = new fhir.Reference(source.who);
        }
        else {
            this.who = null;
        }
        if (source['onBehalfOf']) {
            this.onBehalfOf = new fhir.Reference(source.onBehalfOf);
        }
        if (source['targetFormat']) {
            this.targetFormat = new fhir.FhirCode({ value: source.targetFormat });
        }
        if (source['_targetFormat']) {
            if (this.targetFormat) {
                this.targetFormat.addExtendedProperties(source._targetFormat);
            }
            else {
                this.targetFormat = new fhir.FhirCode(source._targetFormat);
            }
        }
        if (source['sigFormat']) {
            this.sigFormat = new fhir.FhirCode({ value: source.sigFormat });
        }
        if (source['_sigFormat']) {
            if (this.sigFormat) {
                this.sigFormat.addExtendedProperties(source._sigFormat);
            }
            else {
                this.sigFormat = new fhir.FhirCode(source._sigFormat);
            }
        }
        if (source['data']) {
            this.data = new fhir.FhirBase64Binary({ value: source.data });
        }
        if (source['_data']) {
            if (this.data) {
                this.data.addExtendedProperties(source._data);
            }
            else {
                this.data = new fhir.FhirBase64Binary(source._data);
            }
        }
    }
    /**
     * Preferred-bound Value Set for type (Signature.type)
     */
    static get typePreferredCodings() {
        return SignatureTypeCodings;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (!this['type']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property type:fhir.Coding[] fhir: Signature.type:Coding' });
        }
        else if (!Array.isArray(this.type)) {
            issues.push({ severity: 'error', code: 'structure', diagnostics: 'Found scalar in array property type:fhir.Coding[] fhir: Signature.type:Coding' });
        }
        else if (this.type.length === 0) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property type:fhir.Coding[] fhir: Signature.type:Coding' });
        }
        if (this["type"]) {
            this.type.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (!this['when']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property when:fhir.FhirInstant fhir: Signature.when:instant' });
        }
        if (this["when"]) {
            issues.push(...this.when.doModelValidation());
        }
        if (!this['who']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property who:fhir.Reference fhir: Signature.who:Reference' });
        }
        if (this["who"]) {
            issues.push(...this.who.doModelValidation());
        }
        if (this["onBehalfOf"]) {
            issues.push(...this.onBehalfOf.doModelValidation());
        }
        if (this["targetFormat"]) {
            issues.push(...this.targetFormat.doModelValidation());
        }
        if (this["sigFormat"]) {
            issues.push(...this.sigFormat.doModelValidation());
        }
        if (this["data"]) {
            issues.push(...this.data.doModelValidation());
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Signature._fts_dataType = 'Signature';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2lnbmF0dXJlLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9TaWduYXR1cmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBRW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsb0JBQW9CLEdBQTJCLE1BQU0sMENBQTBDLENBQUM7QUFxRHpHOztHQUVHO0FBQ0gsTUFBTSxPQUFPLFNBQVUsU0FBUSxJQUFJLENBQUMsV0FBVztJQWlDN0M7O09BRUc7SUFDSCxZQUFZLFNBQWdDLEVBQUUsRUFBRSxVQUFzQyxFQUFFO1FBQ3RGLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUFFO2FBQzFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7U0FBRTtRQUN4QixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDMUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzFCLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1B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Q0FBQyxDQUFDO1NBQ2pKO1FBQ0QsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUNsRSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQztTQUFFO1FBQ2hGLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO1NBQUU7UUFDcEYsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUM5RSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQztTQUFFO1FBQ3BFLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7O0FBaEdEOztHQUVHO0FBQzZCLHVCQUFhLEdBQVUsV0FBVyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0LmNvcmUgdmVyc2lvbjogNC4wLjFcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIENvbXBsZXhUeXBlOiBTaWduYXR1cmVcclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFNpZ25hdHVyZVR5cGVDb2RpbmdzLCBTaWduYXR1cmVUeXBlQ29kaW5nVHlwZSx9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvU2lnbmF0dXJlVHlwZUNvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFNpZ25hdHVyZVR5cGVDb2RlcywgIFNpZ25hdHVyZVR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvU2lnbmF0dXJlVHlwZUNvZGVzLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFNpZ25hdHVyZSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTaWduYXR1cmVBcmdzIGV4dGVuZHMgZmhpci5GaGlyRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIEV4YW1wbGVzIGluY2x1ZGUgYXR0ZXN0aW5nIHRvOiBhdXRob3JzaGlwLCBjb3JyZWN0IHRyYW5zY3JpcHRpb24sIGFuZCB3aXRuZXNzIG9mIHNwZWNpZmljIGV2ZW50LiBBbHNvIGtub3duIGFzIGEgJmFtcDtxdW90O0NvbW1pdG1lbnQgVHlwZSBJbmRpY2F0aW9uJmFtcDtxdW90Oy5cclxuICAgKi9cclxuICB0eXBlOiBmaGlyLkNvZGluZ0FyZ3NbXXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgc2hvdWxkIGFncmVlIHdpdGggdGhlIGluZm9ybWF0aW9uIGluIHRoZSBzaWduYXR1cmUuXHJcbiAgICovXHJcbiAgd2hlbjogZmhpci5GaGlySW5zdGFudHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBTaWduYXR1cmUud2hlblxyXG4gICAqL1xyXG4gIF93aGVuPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGlzIHNob3VsZCBhZ3JlZSB3aXRoIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2lnbmF0dXJlLlxyXG4gICAqL1xyXG4gIHdobzogZmhpci5SZWZlcmVuY2VBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhcnR5IHRoYXQgY2FuJ3Qgc2lnbi4gRm9yIGV4YW1wbGUgYSBjaGlsZC5cclxuICAgKi9cclxuICBvbkJlaGFsZk9mPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBcInhtbFwiLCBcImpzb25cIiBhbmQgXCJ0dGxcIiBhcmUgYWxsb3dlZCwgd2hpY2ggZGVzY3JpYmUgdGhlIHNpbXBsZSBlbmNvZGluZ3MgZGVzY3JpYmVkIGluIHRoZSBzcGVjaWZpY2F0aW9uIChhbmQgaW1wbHkgYXBwcm9wcmlhdGUgYnVuZGxlIHN1cHBvcnQpLiBPdGhlcndpc2UsIG1pbWUgdHlwZXMgYXJlIGxlZ2FsIGhlcmUuXHJcbiAgICovXHJcbiAgdGFyZ2V0Rm9ybWF0PzogZmhpci5GaGlyQ29kZXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBTaWduYXR1cmUudGFyZ2V0Rm9ybWF0XHJcbiAgICovXHJcbiAgX3RhcmdldEZvcm1hdD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogQSBtaW1lIHR5cGUgdGhhdCBpbmRpY2F0ZXMgdGhlIHRlY2huaWNhbCBmb3JtYXQgb2YgdGhlIHNpZ25hdHVyZS4gSW1wb3J0YW50IG1pbWUgdHlwZXMgYXJlIGFwcGxpY2F0aW9uL3NpZ25hdHVyZSt4bWwgZm9yIFggTUwgRGlnU2lnLCBhcHBsaWNhdGlvbi9qb3NlIGZvciBKV1MsIGFuZCBpbWFnZS8qIGZvciBhIGdyYXBoaWNhbCBpbWFnZSBvZiBhIHNpZ25hdHVyZSwgZXRjLlxyXG4gICAqL1xyXG4gIHNpZ0Zvcm1hdD86IGZoaXIuRmhpckNvZGV8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogU2lnbmF0dXJlLnNpZ0Zvcm1hdFxyXG4gICAqL1xyXG4gIF9zaWdGb3JtYXQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFdoZXJlIHRoZSBzaWduYXR1cmUgdHlwZSBpcyBhbiBYTUwgRGlnU2lnLCB0aGUgc2lnbmVkIGNvbnRlbnQgaXMgYSBGSElSIFJlc291cmNlKHMpLCB0aGUgc2lnbmF0dXJlIGlzIG9mIHRoZSBYTUwgZm9ybSBvZiB0aGUgUmVzb3VyY2UocykgdXNpbmcgIFhNTC1TaWduYXR1cmUgKFhNTERJRykgXCJEZXRhY2hlZCBTaWduYXR1cmVcIiBmb3JtLlxyXG4gICAqL1xyXG4gIGRhdGE/OiBmaGlyLkZoaXJCYXNlNjRCaW5hcnl8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogU2lnbmF0dXJlLmRhdGFcclxuICAgKi9cclxuICBfZGF0YT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIHNpZ25hdHVyZSBhbG9uZyB3aXRoIHN1cHBvcnRpbmcgY29udGV4dC4gVGhlIHNpZ25hdHVyZSBtYXkgYmUgYSBkaWdpdGFsIHNpZ25hdHVyZSB0aGF0IGlzIGNyeXB0b2dyYXBoaWMgaW4gbmF0dXJlLCBvciBzb21lIG90aGVyIHNpZ25hdHVyZSBhY2NlcHRhYmxlIHRvIHRoZSBkb21haW4uIFRoaXMgb3RoZXIgc2lnbmF0dXJlIG1heSBiZSBhcyBzaW1wbGUgYXMgYSBncmFwaGljYWwgaW1hZ2UgcmVwcmVzZW50aW5nIGEgaGFuZC13cml0dGVuIHNpZ25hdHVyZSwgb3IgYSBzaWduYXR1cmUgY2VyZW1vbnkgRGlmZmVyZW50IHNpZ25hdHVyZSBhcHByb2FjaGVzIGhhdmUgZGlmZmVyZW50IHV0aWxpdGllcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTaWduYXR1cmUgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ1NpZ25hdHVyZSc7XHJcbiAgLyoqXHJcbiAgICogRXhhbXBsZXMgaW5jbHVkZSBhdHRlc3RpbmcgdG86IGF1dGhvcnNoaXAsIGNvcnJlY3QgdHJhbnNjcmlwdGlvbiwgYW5kIHdpdG5lc3Mgb2Ygc3BlY2lmaWMgZXZlbnQuIEFsc28ga25vd24gYXMgYSAmYW1wO3F1b3Q7Q29tbWl0bWVudCBUeXBlIEluZGljYXRpb24mYW1wO3F1b3Q7LlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0eXBlOiBmaGlyLkNvZGluZ1tdO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgc2hvdWxkIGFncmVlIHdpdGggdGhlIGluZm9ybWF0aW9uIGluIHRoZSBzaWduYXR1cmUuXHJcbiAgICovXHJcbiAgcHVibGljIHdoZW46IGZoaXIuRmhpckluc3RhbnR8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGlzIHNob3VsZCBhZ3JlZSB3aXRoIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2lnbmF0dXJlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB3aG86IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhcnR5IHRoYXQgY2FuJ3Qgc2lnbi4gRm9yIGV4YW1wbGUgYSBjaGlsZC5cclxuICAgKi9cclxuICBwdWJsaWMgb25CZWhhbGZPZj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBcInhtbFwiLCBcImpzb25cIiBhbmQgXCJ0dGxcIiBhcmUgYWxsb3dlZCwgd2hpY2ggZGVzY3JpYmUgdGhlIHNpbXBsZSBlbmNvZGluZ3MgZGVzY3JpYmVkIGluIHRoZSBzcGVjaWZpY2F0aW9uIChhbmQgaW1wbHkgYXBwcm9wcmlhdGUgYnVuZGxlIHN1cHBvcnQpLiBPdGhlcndpc2UsIG1pbWUgdHlwZXMgYXJlIGxlZ2FsIGhlcmUuXHJcbiAgICovXHJcbiAgcHVibGljIHRhcmdldEZvcm1hdD86IGZoaXIuRmhpckNvZGV8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEEgbWltZSB0eXBlIHRoYXQgaW5kaWNhdGVzIHRoZSB0ZWNobmljYWwgZm9ybWF0IG9mIHRoZSBzaWduYXR1cmUuIEltcG9ydGFudCBtaW1lIHR5cGVzIGFyZSBhcHBsaWNhdGlvbi9zaWduYXR1cmUreG1sIGZvciBYIE1MIERpZ1NpZywgYXBwbGljYXRpb24vam9zZSBmb3IgSldTLCBhbmQgaW1hZ2UvKiBmb3IgYSBncmFwaGljYWwgaW1hZ2Ugb2YgYSBzaWduYXR1cmUsIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgc2lnRm9ybWF0PzogZmhpci5GaGlyQ29kZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogV2hlcmUgdGhlIHNpZ25hdHVyZSB0eXBlIGlzIGFuIFhNTCBEaWdTaWcsIHRoZSBzaWduZWQgY29udGVudCBpcyBhIEZISVIgUmVzb3VyY2UocyksIHRoZSBzaWduYXR1cmUgaXMgb2YgdGhlIFhNTCBmb3JtIG9mIHRoZSBSZXNvdXJjZShzKSB1c2luZyAgWE1MLVNpZ25hdHVyZSAoWE1MRElHKSBcIkRldGFjaGVkIFNpZ25hdHVyZVwiIGZvcm0uXHJcbiAgICovXHJcbiAgcHVibGljIGRhdGE/OiBmaGlyLkZoaXJCYXNlNjRCaW5hcnl8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFNpZ25hdHVyZSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFNpZ25hdHVyZUFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWyd0eXBlJ10pIHsgdGhpcy50eXBlID0gc291cmNlLnR5cGUubWFwKCh4KSA9PiBuZXcgZmhpci5Db2RpbmcoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50eXBlID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ3doZW4nXSkgeyB0aGlzLndoZW4gPSBuZXcgZmhpci5GaGlySW5zdGFudCh7dmFsdWU6IHNvdXJjZS53aGVufSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLndoZW4gPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfd2hlbiddKSB7XHJcbiAgICAgIGlmICh0aGlzLndoZW4pIHsgdGhpcy53aGVuLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3doZW4hKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy53aGVuID0gbmV3IGZoaXIuRmhpckluc3RhbnQoc291cmNlLl93aGVuIGFzIFBhcnRpYWw8Zmhpci5GaGlySW5zdGFudEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnd2hvJ10pIHsgdGhpcy53aG8gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLndobyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLndobyA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ29uQmVoYWxmT2YnXSkgeyB0aGlzLm9uQmVoYWxmT2YgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLm9uQmVoYWxmT2YpOyB9XHJcbiAgICBpZiAoc291cmNlWyd0YXJnZXRGb3JtYXQnXSkgeyB0aGlzLnRhcmdldEZvcm1hdCA9IG5ldyBmaGlyLkZoaXJDb2RlKHt2YWx1ZTogc291cmNlLnRhcmdldEZvcm1hdH0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfdGFyZ2V0Rm9ybWF0J10pIHtcclxuICAgICAgaWYgKHRoaXMudGFyZ2V0Rm9ybWF0KSB7IHRoaXMudGFyZ2V0Rm9ybWF0LmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3RhcmdldEZvcm1hdCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnRhcmdldEZvcm1hdCA9IG5ldyBmaGlyLkZoaXJDb2RlKHNvdXJjZS5fdGFyZ2V0Rm9ybWF0IGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZUFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnc2lnRm9ybWF0J10pIHsgdGhpcy5zaWdGb3JtYXQgPSBuZXcgZmhpci5GaGlyQ29kZSh7dmFsdWU6IHNvdXJjZS5zaWdGb3JtYXR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3NpZ0Zvcm1hdCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnNpZ0Zvcm1hdCkgeyB0aGlzLnNpZ0Zvcm1hdC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9zaWdGb3JtYXQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zaWdGb3JtYXQgPSBuZXcgZmhpci5GaGlyQ29kZShzb3VyY2UuX3NpZ0Zvcm1hdCBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGVBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2RhdGEnXSkgeyB0aGlzLmRhdGEgPSBuZXcgZmhpci5GaGlyQmFzZTY0QmluYXJ5KHt2YWx1ZTogc291cmNlLmRhdGF9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2RhdGEnXSkge1xyXG4gICAgICBpZiAodGhpcy5kYXRhKSB7IHRoaXMuZGF0YS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9kYXRhISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuZGF0YSA9IG5ldyBmaGlyLkZoaXJCYXNlNjRCaW5hcnkoc291cmNlLl9kYXRhIGFzIFBhcnRpYWw8Zmhpci5GaGlyQmFzZTY0QmluYXJ5QXJncz4pOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFByZWZlcnJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIHR5cGUgKFNpZ25hdHVyZS50eXBlKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IHR5cGVQcmVmZXJyZWRDb2RpbmdzKCk6U2lnbmF0dXJlVHlwZUNvZGluZ1R5cGUge1xyXG4gICAgcmV0dXJuIFNpZ25hdHVyZVR5cGVDb2RpbmdzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbigpO1xyXG4gICAgaWYgKCF0aGlzWyd0eXBlJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHR5cGU6Zmhpci5Db2RpbmdbXSBmaGlyOiBTaWduYXR1cmUudHlwZTpDb2RpbmcnIH0pO1xyXG4gICAgfSBlbHNlIGlmICghQXJyYXkuaXNBcnJheSh0aGlzLnR5cGUpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdzdHJ1Y3R1cmUnLCBkaWFnbm9zdGljczogJ0ZvdW5kIHNjYWxhciBpbiBhcnJheSBwcm9wZXJ0eSB0eXBlOmZoaXIuQ29kaW5nW10gZmhpcjogU2lnbmF0dXJlLnR5cGU6Q29kaW5nJyB9KTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy50eXBlLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgdHlwZTpmaGlyLkNvZGluZ1tdIGZoaXI6IFNpZ25hdHVyZS50eXBlOkNvZGluZycgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInR5cGVcIl0pIHsgdGhpcy50eXBlLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgaWYgKCF0aGlzWyd3aGVuJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHdoZW46Zmhpci5GaGlySW5zdGFudCBmaGlyOiBTaWduYXR1cmUud2hlbjppbnN0YW50JyB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wid2hlblwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLndoZW4uZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICghdGhpc1snd2hvJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHdobzpmaGlyLlJlZmVyZW5jZSBmaGlyOiBTaWduYXR1cmUud2hvOlJlZmVyZW5jZScgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcIndob1wiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLndoby5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJvbkJlaGFsZk9mXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMub25CZWhhbGZPZi5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJ0YXJnZXRGb3JtYXRcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy50YXJnZXRGb3JtYXQuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzW1wic2lnRm9ybWF0XCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMuc2lnRm9ybWF0LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1tcImRhdGFcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5kYXRhLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4iXX0=