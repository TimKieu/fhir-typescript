// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: Signature
import * as fhir from '../fhir.js';
/**
 * A signature along with supporting context. The signature may be a digital signature that is cryptographic in nature, or some other signature acceptable to the domain. This other signature may be as simple as a graphical image representing a hand-written signature, or a signature ceremony Different signature approaches have different utilities.
 */
export class Signature extends fhir.FhirElement {
    /**
     * Default constructor for Signature - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = source.type.map((x) => new fhir.Coding(x));
        }
        else {
            this.type = [];
        }
        if (source['when']) {
            this.when = new fhir.FhirInstant({ value: source.when });
        }
        else {
            this.when = null;
        }
        if (source['_when']) {
            if (this.when) {
                this.when.addExtendedProperties(source._when);
            }
            else {
                this.when = new fhir.FhirInstant(source._when);
            }
        }
        if (source['who']) {
            this.who = new fhir.Reference(source.who);
        }
        else {
            this.who = null;
        }
        if (source['onBehalfOf']) {
            this.onBehalfOf = new fhir.Reference(source.onBehalfOf);
        }
        if (source['targetFormat']) {
            this.targetFormat = new fhir.FhirCode({ value: source.targetFormat });
        }
        if (source['_targetFormat']) {
            if (this.targetFormat) {
                this.targetFormat.addExtendedProperties(source._targetFormat);
            }
            else {
                this.targetFormat = new fhir.FhirCode(source._targetFormat);
            }
        }
        if (source['sigFormat']) {
            this.sigFormat = new fhir.FhirCode({ value: source.sigFormat });
        }
        if (source['_sigFormat']) {
            if (this.sigFormat) {
                this.sigFormat.addExtendedProperties(source._sigFormat);
            }
            else {
                this.sigFormat = new fhir.FhirCode(source._sigFormat);
            }
        }
        if (source['data']) {
            this.data = new fhir.FhirBase64Binary({ value: source.data });
        }
        if (source['_data']) {
            if (this.data) {
                this.data.addExtendedProperties(source._data);
            }
            else {
                this.data = new fhir.FhirBase64Binary(source._data);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Signature';
        }
        this.vRA('type', exp);
        this.vRS('when', exp);
        this.vRS('who', exp);
        this.vOS('onBehalfOf', exp);
        this.vOS('targetFormat', exp);
        this.vOS('sigFormat', exp);
        this.vOS('data', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Signature._fts_dataType = 'Signature';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2lnbmF0dXJlLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9TaWduYXR1cmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBd0RuQzs7R0FFRztBQUNILE1BQU0sT0FBTyxTQUFVLFNBQVEsSUFBSSxDQUFDLFdBQVc7SUFpQzdDOztPQUVHO0lBQ0gsWUFBWSxTQUFnQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUN0RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUMxRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDeEIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUFFO2FBQzFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7U0FBRTtRQUMxQixJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUNuQixJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsS0FBTSxDQUFDLENBQUM7YUFBRTtpQkFDN0Q7Z0JBQUUsSUFBSSxDQUFDLElBQUks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LEdBQUcsQ0FBQyxDQUFBO1FBQzFCLElBQUksQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzVCLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3pCLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3BCLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7O0FBOUVEOztHQUVHO0FBQzZCLHVCQUFhLEdBQVUsV0FBVyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0LmNvcmUgdmVyc2lvbjogNC4wLjFcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIENvbXBsZXhUeXBlOiBTaWduYXR1cmVcclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFNpZ25hdHVyZVR5cGVDb2RlcywgIFNpZ25hdHVyZVR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvU2lnbmF0dXJlVHlwZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBTaWduYXR1cmVUeXBlVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TaWduYXR1cmVUeXBlVnNWYWxpZGF0aW9uLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFNpZ25hdHVyZSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTaWduYXR1cmVBcmdzIGV4dGVuZHMgZmhpci5GaGlyRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIEV4YW1wbGVzIGluY2x1ZGUgYXR0ZXN0aW5nIHRvOiBhdXRob3JzaGlwLCBjb3JyZWN0IHRyYW5zY3JpcHRpb24sIGFuZCB3aXRuZXNzIG9mIHNwZWNpZmljIGV2ZW50LiBBbHNvIGtub3duIGFzIGEgJmFtcDtxdW90O0NvbW1pdG1lbnQgVHlwZSBJbmRpY2F0aW9uJmFtcDtxdW90Oy5cclxuICAgKi9cclxuICB0eXBlOiBmaGlyLkNvZGluZ0FyZ3NbXXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgc2hvdWxkIGFncmVlIHdpdGggdGhlIGluZm9ybWF0aW9uIGluIHRoZSBzaWduYXR1cmUuXHJcbiAgICovXHJcbiAgd2hlbjogZmhpci5GaGlySW5zdGFudHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBTaWduYXR1cmUud2hlblxyXG4gICAqL1xyXG4gIF93aGVuPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGlzIHNob3VsZCBhZ3JlZSB3aXRoIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2lnbmF0dXJlLlxyXG4gICAqL1xyXG4gIHdobzogZmhpci5SZWZlcmVuY2VBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhcnR5IHRoYXQgY2FuJ3Qgc2lnbi4gRm9yIGV4YW1wbGUgYSBjaGlsZC5cclxuICAgKi9cclxuICBvbkJlaGFsZk9mPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBcInhtbFwiLCBcImpzb25cIiBhbmQgXCJ0dGxcIiBhcmUgYWxsb3dlZCwgd2hpY2ggZGVzY3JpYmUgdGhlIHNpbXBsZSBlbmNvZGluZ3MgZGVzY3JpYmVkIGluIHRoZSBzcGVjaWZpY2F0aW9uIChhbmQgaW1wbHkgYXBwcm9wcmlhdGUgYnVuZGxlIHN1cHBvcnQpLiBPdGhlcndpc2UsIG1pbWUgdHlwZXMgYXJlIGxlZ2FsIGhlcmUuXHJcbiAgICovXHJcbiAgdGFyZ2V0Rm9ybWF0PzogZmhpci5GaGlyQ29kZXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBTaWduYXR1cmUudGFyZ2V0Rm9ybWF0XHJcbiAgICovXHJcbiAgX3RhcmdldEZvcm1hdD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogQSBtaW1lIHR5cGUgdGhhdCBpbmRpY2F0ZXMgdGhlIHRlY2huaWNhbCBmb3JtYXQgb2YgdGhlIHNpZ25hdHVyZS4gSW1wb3J0YW50IG1pbWUgdHlwZXMgYXJlIGFwcGxpY2F0aW9uL3NpZ25hdHVyZSt4bWwgZm9yIFggTUwgRGlnU2lnLCBhcHBsaWNhdGlvbi9qb3NlIGZvciBKV1MsIGFuZCBpbWFnZS8qIGZvciBhIGdyYXBoaWNhbCBpbWFnZSBvZiBhIHNpZ25hdHVyZSwgZXRjLlxyXG4gICAqL1xyXG4gIHNpZ0Zvcm1hdD86IGZoaXIuRmhpckNvZGV8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogU2lnbmF0dXJlLnNpZ0Zvcm1hdFxyXG4gICAqL1xyXG4gIF9zaWdGb3JtYXQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFdoZXJlIHRoZSBzaWduYXR1cmUgdHlwZSBpcyBhbiBYTUwgRGlnU2lnLCB0aGUgc2lnbmVkIGNvbnRlbnQgaXMgYSBGSElSIFJlc291cmNlKHMpLCB0aGUgc2lnbmF0dXJlIGlzIG9mIHRoZSBYTUwgZm9ybSBvZiB0aGUgUmVzb3VyY2UocykgdXNpbmcgIFhNTC1TaWduYXR1cmUgKFhNTERJRykgXCJEZXRhY2hlZCBTaWduYXR1cmVcIiBmb3JtLlxyXG4gICAqL1xyXG4gIGRhdGE/OiBmaGlyLkZoaXJCYXNlNjRCaW5hcnl8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogU2lnbmF0dXJlLmRhdGFcclxuICAgKi9cclxuICBfZGF0YT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIHNpZ25hdHVyZSBhbG9uZyB3aXRoIHN1cHBvcnRpbmcgY29udGV4dC4gVGhlIHNpZ25hdHVyZSBtYXkgYmUgYSBkaWdpdGFsIHNpZ25hdHVyZSB0aGF0IGlzIGNyeXB0b2dyYXBoaWMgaW4gbmF0dXJlLCBvciBzb21lIG90aGVyIHNpZ25hdHVyZSBhY2NlcHRhYmxlIHRvIHRoZSBkb21haW4uIFRoaXMgb3RoZXIgc2lnbmF0dXJlIG1heSBiZSBhcyBzaW1wbGUgYXMgYSBncmFwaGljYWwgaW1hZ2UgcmVwcmVzZW50aW5nIGEgaGFuZC13cml0dGVuIHNpZ25hdHVyZSwgb3IgYSBzaWduYXR1cmUgY2VyZW1vbnkgRGlmZmVyZW50IHNpZ25hdHVyZSBhcHByb2FjaGVzIGhhdmUgZGlmZmVyZW50IHV0aWxpdGllcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTaWduYXR1cmUgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ1NpZ25hdHVyZSc7XHJcbiAgLyoqXHJcbiAgICogRXhhbXBsZXMgaW5jbHVkZSBhdHRlc3RpbmcgdG86IGF1dGhvcnNoaXAsIGNvcnJlY3QgdHJhbnNjcmlwdGlvbiwgYW5kIHdpdG5lc3Mgb2Ygc3BlY2lmaWMgZXZlbnQuIEFsc28ga25vd24gYXMgYSAmYW1wO3F1b3Q7Q29tbWl0bWVudCBUeXBlIEluZGljYXRpb24mYW1wO3F1b3Q7LlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0eXBlOiBmaGlyLkNvZGluZ1tdO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgc2hvdWxkIGFncmVlIHdpdGggdGhlIGluZm9ybWF0aW9uIGluIHRoZSBzaWduYXR1cmUuXHJcbiAgICovXHJcbiAgcHVibGljIHdoZW46IGZoaXIuRmhpckluc3RhbnR8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGlzIHNob3VsZCBhZ3JlZSB3aXRoIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2lnbmF0dXJlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB3aG86IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhcnR5IHRoYXQgY2FuJ3Qgc2lnbi4gRm9yIGV4YW1wbGUgYSBjaGlsZC5cclxuICAgKi9cclxuICBwdWJsaWMgb25CZWhhbGZPZj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBcInhtbFwiLCBcImpzb25cIiBhbmQgXCJ0dGxcIiBhcmUgYWxsb3dlZCwgd2hpY2ggZGVzY3JpYmUgdGhlIHNpbXBsZSBlbmNvZGluZ3MgZGVzY3JpYmVkIGluIHRoZSBzcGVjaWZpY2F0aW9uIChhbmQgaW1wbHkgYXBwcm9wcmlhdGUgYnVuZGxlIHN1cHBvcnQpLiBPdGhlcndpc2UsIG1pbWUgdHlwZXMgYXJlIGxlZ2FsIGhlcmUuXHJcbiAgICovXHJcbiAgcHVibGljIHRhcmdldEZvcm1hdD86IGZoaXIuRmhpckNvZGV8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEEgbWltZSB0eXBlIHRoYXQgaW5kaWNhdGVzIHRoZSB0ZWNobmljYWwgZm9ybWF0IG9mIHRoZSBzaWduYXR1cmUuIEltcG9ydGFudCBtaW1lIHR5cGVzIGFyZSBhcHBsaWNhdGlvbi9zaWduYXR1cmUreG1sIGZvciBYIE1MIERpZ1NpZywgYXBwbGljYXRpb24vam9zZSBmb3IgSldTLCBhbmQgaW1hZ2UvKiBmb3IgYSBncmFwaGljYWwgaW1hZ2Ugb2YgYSBzaWduYXR1cmUsIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgc2lnRm9ybWF0PzogZmhpci5GaGlyQ29kZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogV2hlcmUgdGhlIHNpZ25hdHVyZSB0eXBlIGlzIGFuIFhNTCBEaWdTaWcsIHRoZSBzaWduZWQgY29udGVudCBpcyBhIEZISVIgUmVzb3VyY2UocyksIHRoZSBzaWduYXR1cmUgaXMgb2YgdGhlIFhNTCBmb3JtIG9mIHRoZSBSZXNvdXJjZShzKSB1c2luZyAgWE1MLVNpZ25hdHVyZSAoWE1MRElHKSBcIkRldGFjaGVkIFNpZ25hdHVyZVwiIGZvcm0uXHJcbiAgICovXHJcbiAgcHVibGljIGRhdGE/OiBmaGlyLkZoaXJCYXNlNjRCaW5hcnl8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFNpZ25hdHVyZSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFNpZ25hdHVyZUFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWyd0eXBlJ10pIHsgdGhpcy50eXBlID0gc291cmNlLnR5cGUubWFwKCh4KSA9PiBuZXcgZmhpci5Db2RpbmcoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50eXBlID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ3doZW4nXSkgeyB0aGlzLndoZW4gPSBuZXcgZmhpci5GaGlySW5zdGFudCh7dmFsdWU6IHNvdXJjZS53aGVufSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLndoZW4gPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfd2hlbiddKSB7XHJcbiAgICAgIGlmICh0aGlzLndoZW4pIHsgdGhpcy53aGVuLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3doZW4hKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy53aGVuID0gbmV3IGZoaXIuRmhpckluc3RhbnQoc291cmNlLl93aGVuIGFzIFBhcnRpYWw8Zmhpci5GaGlySW5zdGFudEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnd2hvJ10pIHsgdGhpcy53aG8gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLndobyk7IH1cclxuICAgIGVsc2UgeyB0aGlzLndobyA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ29uQmVoYWxmT2YnXSkgeyB0aGlzLm9uQmVoYWxmT2YgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLm9uQmVoYWxmT2YpOyB9XHJcbiAgICBpZiAoc291cmNlWyd0YXJnZXRGb3JtYXQnXSkgeyB0aGlzLnRhcmdldEZvcm1hdCA9IG5ldyBmaGlyLkZoaXJDb2RlKHt2YWx1ZTogc291cmNlLnRhcmdldEZvcm1hdH0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfdGFyZ2V0Rm9ybWF0J10pIHtcclxuICAgICAgaWYgKHRoaXMudGFyZ2V0Rm9ybWF0KSB7IHRoaXMudGFyZ2V0Rm9ybWF0LmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3RhcmdldEZvcm1hdCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnRhcmdldEZvcm1hdCA9IG5ldyBmaGlyLkZoaXJDb2RlKHNvdXJjZS5fdGFyZ2V0Rm9ybWF0IGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZUFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnc2lnRm9ybWF0J10pIHsgdGhpcy5zaWdGb3JtYXQgPSBuZXcgZmhpci5GaGlyQ29kZSh7dmFsdWU6IHNvdXJjZS5zaWdGb3JtYXR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3NpZ0Zvcm1hdCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnNpZ0Zvcm1hdCkgeyB0aGlzLnNpZ0Zvcm1hdC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9zaWdGb3JtYXQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zaWdGb3JtYXQgPSBuZXcgZmhpci5GaGlyQ29kZShzb3VyY2UuX3NpZ0Zvcm1hdCBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGVBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2RhdGEnXSkgeyB0aGlzLmRhdGEgPSBuZXcgZmhpci5GaGlyQmFzZTY0QmluYXJ5KHt2YWx1ZTogc291cmNlLmRhdGF9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2RhdGEnXSkge1xyXG4gICAgICBpZiAodGhpcy5kYXRhKSB7IHRoaXMuZGF0YS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9kYXRhISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuZGF0YSA9IG5ldyBmaGlyLkZoaXJCYXNlNjRCaW5hcnkoc291cmNlLl9kYXRhIGFzIFBhcnRpYWw8Zmhpci5GaGlyQmFzZTY0QmluYXJ5QXJncz4pOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnU2lnbmF0dXJlJyB9XHJcbiAgICB0aGlzLnZSQSgndHlwZScsZXhwKVxyXG4gICAgdGhpcy52UlMoJ3doZW4nLGV4cClcclxuICAgIHRoaXMudlJTKCd3aG8nLGV4cClcclxuICAgIHRoaXMudk9TKCdvbkJlaGFsZk9mJyxleHApXHJcbiAgICB0aGlzLnZPUygndGFyZ2V0Rm9ybWF0JyxleHApXHJcbiAgICB0aGlzLnZPUygnc2lnRm9ybWF0JyxleHApXHJcbiAgICB0aGlzLnZPUygnZGF0YScsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuIl19