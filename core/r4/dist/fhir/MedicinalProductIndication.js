// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: MedicinalProductIndication
import * as fhir from '../fhir.js';
/**
 * Information about the use of the medicinal product in relation to other therapies described as part of the indication.
 */
export class MedicinalProductIndicationOtherTherapy extends fhir.BackboneElement {
    /**
     * Default constructor for MedicinalProductIndicationOtherTherapy - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['therapyRelationshipType']) {
            this.therapyRelationshipType = new fhir.CodeableConcept(source.therapyRelationshipType);
        }
        else {
            this.therapyRelationshipType = null;
        }
        if (source['medication']) {
            this.medication = source.medication;
        }
        else if (source['medicationCodeableConcept']) {
            this.medication = new fhir.CodeableConcept(source.medicationCodeableConcept);
        }
        else if (source['medicationReference']) {
            this.medication = new fhir.Reference(source.medicationReference);
        }
        else {
            this.medication = null;
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'MedicinalProductIndication.otherTherapy';
        }
        if (!this['therapyRelationshipType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property therapyRelationshipType fhir: MedicinalProductIndication.otherTherapy.therapyRelationshipType:CodeableConcept', expression: [expression] });
        }
        if (this["therapyRelationshipType"]) {
            issues.push(...this.therapyRelationshipType.doModelValidation(expression + '.therapyRelationshipType'));
        }
        if (!this['medication']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property medication fhir: MedicinalProductIndication.otherTherapy.medication[x]:', expression: [expression] });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
MedicinalProductIndicationOtherTherapy._fts_dataType = 'MedicinalProductIndicationOtherTherapy';
/**
 * Internal flag to properly serialize choice-type element MedicinalProductIndication.otherTherapy.medication[x]
 */
MedicinalProductIndicationOtherTherapy._fts_medicationIsChoice = true;
/**
 * Indication for the Medicinal Product.
 */
export class MedicinalProductIndication extends fhir.DomainResource {
    /**
     * Default constructor for MedicinalProductIndication - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'MedicinalProductIndication';
        if (source['subject']) {
            this.subject = source.subject.map((x) => new fhir.Reference(x));
        }
        else {
            this.subject = [];
        }
        if (source['diseaseSymptomProcedure']) {
            this.diseaseSymptomProcedure = new fhir.CodeableConcept(source.diseaseSymptomProcedure);
        }
        if (source['diseaseStatus']) {
            this.diseaseStatus = new fhir.CodeableConcept(source.diseaseStatus);
        }
        if (source['comorbidity']) {
            this.comorbidity = source.comorbidity.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.comorbidity = [];
        }
        if (source['intendedEffect']) {
            this.intendedEffect = new fhir.CodeableConcept(source.intendedEffect);
        }
        if (source['duration']) {
            this.duration = new fhir.Quantity(source.duration);
        }
        if (source['otherTherapy']) {
            this.otherTherapy = source.otherTherapy.map((x) => new fhir.MedicinalProductIndicationOtherTherapy(x));
        }
        else {
            this.otherTherapy = [];
        }
        if (source['undesirableEffect']) {
            this.undesirableEffect = source.undesirableEffect.map((x) => new fhir.Reference(x));
        }
        else {
            this.undesirableEffect = [];
        }
        if (source['population']) {
            this.population = source.population.map((x) => new fhir.Population(x));
        }
        else {
            this.population = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'MedicinalProductIndication';
        }
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType fhir: MedicinalProductIndication.resourceType:"MedicinalProductIndication"', expression: [expression] });
        }
        if (this["subject"]) {
            this.subject.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.subject[${i}]`)); });
        }
        if (this["diseaseSymptomProcedure"]) {
            issues.push(...this.diseaseSymptomProcedure.doModelValidation(expression + '.diseaseSymptomProcedure'));
        }
        if (this["diseaseStatus"]) {
            issues.push(...this.diseaseStatus.doModelValidation(expression + '.diseaseStatus'));
        }
        if (this["comorbidity"]) {
            this.comorbidity.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.comorbidity[${i}]`)); });
        }
        if (this["intendedEffect"]) {
            issues.push(...this.intendedEffect.doModelValidation(expression + '.intendedEffect'));
        }
        if (this["duration"]) {
            issues.push(...this.duration.doModelValidation(expression + '.duration'));
        }
        if (this["otherTherapy"]) {
            this.otherTherapy.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.otherTherapy[${i}]`)); });
        }
        if (this["undesirableEffect"]) {
            this.undesirableEffect.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.undesirableEffect[${i}]`)); });
        }
        if (this["population"]) {
            this.population.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.population[${i}]`)); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
MedicinalProductIndication._fts_dataType = 'MedicinalProductIndication';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb24uanMiLCJzb3VyY2VSb290IjoiLi9zcmMvIiwic291cmNlcyI6WyJmaGlyL01lZGljaW5hbFByb2R1Y3RJbmRpY2F0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLG9CQUFvQjtBQUNwQiwrQ0FBK0M7QUFDL0Msa0NBQWtDO0FBQ2xDLDRDQUE0QztBQUU1QyxPQUFPLEtBQUssSUFBSSxNQUFNLFlBQVksQ0FBQztBQXdCbkM7O0dBRUc7QUFDSCxNQUFNLE9BQU8sc0NBQXVDLFNBQVEsSUFBSSxDQUFDLGVBQWU7SUFpQjlFOztPQUVHO0lBQ0gsWUFBWSxTQUE2RCxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUNuSCxLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLHlCQUF5QixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsdUJBQXVCLEdBQUcsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1NBQUU7YUFDOUg7WUFBRSxJQUFJLENBQUMsdUJBQXVCLEdBQUcsSUFBSSxDQUFDO1NBQUU7UUFDN0MsSUFBSSxNQUFNLENBQUMsWUFBWSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsVUFBVSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUM7U0FBRTthQUM3RCxJQUFJLE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLHlCQUF5QixDQUFDLENBQUM7U0FBRTthQUMxSCxJQUFJLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUM7U0FBRTthQUN4RztZQUFFLElBQUksQ0FBQyxVQUFV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QyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQUU7UUFDdEksT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUFwRkQ7O0dBRUc7QUFDNkIsd0NBQWEsR0FBVSw0QkFBNEIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yNC5jb3JlIHZlcnNpb246IDQuMC4xXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb25cclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb25PdGhlclRoZXJhcHkgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb25PdGhlclRoZXJhcHlBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgdHlwZSBvZiByZWxhdGlvbnNoaXAgYmV0d2VlbiB0aGUgbWVkaWNpbmFsIHByb2R1Y3QgaW5kaWNhdGlvbiBvciBjb250cmFpbmRpY2F0aW9uIGFuZCBhbm90aGVyIHRoZXJhcHkuXHJcbiAgICovXHJcbiAgdGhlcmFweVJlbGF0aW9uc2hpcFR5cGU6IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIFJlZmVyZW5jZSB0byBhIHNwZWNpZmljIG1lZGljYXRpb24gKGFjdGl2ZSBzdWJzdGFuY2UsIG1lZGljaW5hbCBwcm9kdWN0IG9yIGNsYXNzIG9mIHByb2R1Y3RzKSBhcyBwYXJ0IG9mIGFuIGluZGljYXRpb24gb3IgY29udHJhaW5kaWNhdGlvbi5cclxuICAgKi9cclxuICBtZWRpY2F0aW9uPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8Zmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFJlZmVyZW5jZSB0byBhIHNwZWNpZmljIG1lZGljYXRpb24gKGFjdGl2ZSBzdWJzdGFuY2UsIG1lZGljaW5hbCBwcm9kdWN0IG9yIGNsYXNzIG9mIHByb2R1Y3RzKSBhcyBwYXJ0IG9mIGFuIGluZGljYXRpb24gb3IgY29udHJhaW5kaWNhdGlvbi5cclxuICAgKi9cclxuICBtZWRpY2F0aW9uQ29kZWFibGVDb25jZXB0PzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBSZWZlcmVuY2UgdG8gYSBzcGVjaWZpYyBtZWRpY2F0aW9uIChhY3RpdmUgc3Vic3RhbmNlLCBtZWRpY2luYWwgcHJvZHVjdCBvciBjbGFzcyBvZiBwcm9kdWN0cykgYXMgcGFydCBvZiBhbiBpbmRpY2F0aW9uIG9yIGNvbnRyYWluZGljYXRpb24uXHJcbiAgICovXHJcbiAgbWVkaWNhdGlvblJlZmVyZW5jZT86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlIG9mIHRoZSBtZWRpY2luYWwgcHJvZHVjdCBpbiByZWxhdGlvbiB0byBvdGhlciB0aGVyYXBpZXMgZGVzY3JpYmVkIGFzIHBhcnQgb2YgdGhlIGluZGljYXRpb24uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb25PdGhlclRoZXJhcHkgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdNZWRpY2luYWxQcm9kdWN0SW5kaWNhdGlvbk90aGVyVGhlcmFweSc7XHJcbiAgLyoqXHJcbiAgICogVGhlIHR5cGUgb2YgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlIG1lZGljaW5hbCBwcm9kdWN0IGluZGljYXRpb24gb3IgY29udHJhaW5kaWNhdGlvbiBhbmQgYW5vdGhlciB0aGVyYXB5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0aGVyYXB5UmVsYXRpb25zaGlwVHlwZTogZmhpci5Db2RlYWJsZUNvbmNlcHR8bnVsbDtcclxuICAvKipcclxuICAgKiBSZWZlcmVuY2UgdG8gYSBzcGVjaWZpYyBtZWRpY2F0aW9uIChhY3RpdmUgc3Vic3RhbmNlLCBtZWRpY2luYWwgcHJvZHVjdCBvciBjbGFzcyBvZiBwcm9kdWN0cykgYXMgcGFydCBvZiBhbiBpbmRpY2F0aW9uIG9yIGNvbnRyYWluZGljYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIG1lZGljYXRpb246IChmaGlyLkNvZGVhYmxlQ29uY2VwdHxmaGlyLlJlZmVyZW5jZSl8bnVsbDtcclxuICAvKipcclxuICAgKiBJbnRlcm5hbCBmbGFnIHRvIHByb3Blcmx5IHNlcmlhbGl6ZSBjaG9pY2UtdHlwZSBlbGVtZW50IE1lZGljaW5hbFByb2R1Y3RJbmRpY2F0aW9uLm90aGVyVGhlcmFweS5tZWRpY2F0aW9uW3hdXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIHN0YXRpYyByZWFkb25seSBfZnRzX21lZGljYXRpb25Jc0Nob2ljZTp0cnVlID0gdHJ1ZTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBNZWRpY2luYWxQcm9kdWN0SW5kaWNhdGlvbk90aGVyVGhlcmFweSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPE1lZGljaW5hbFByb2R1Y3RJbmRpY2F0aW9uT3RoZXJUaGVyYXB5QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3RoZXJhcHlSZWxhdGlvbnNoaXBUeXBlJ10pIHsgdGhpcy50aGVyYXB5UmVsYXRpb25zaGlwVHlwZSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UudGhlcmFweVJlbGF0aW9uc2hpcFR5cGUpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50aGVyYXB5UmVsYXRpb25zaGlwVHlwZSA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ21lZGljYXRpb24nXSkgeyB0aGlzLm1lZGljYXRpb24gPSBzb3VyY2UubWVkaWNhdGlvbjsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWydtZWRpY2F0aW9uQ29kZWFibGVDb25jZXB0J10pIHsgdGhpcy5tZWRpY2F0aW9uID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5tZWRpY2F0aW9uQ29kZWFibGVDb25jZXB0KTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWydtZWRpY2F0aW9uUmVmZXJlbmNlJ10pIHsgdGhpcy5tZWRpY2F0aW9uID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5tZWRpY2F0aW9uUmVmZXJlbmNlKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMubWVkaWNhdGlvbiA9IG51bGw7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb246c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24pO1xyXG4gICAgaWYgKGV4cHJlc3Npb24gPT09ICcnKSB7IGV4cHJlc3Npb24gPSAnTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb24ub3RoZXJUaGVyYXB5JyB9XHJcbiAgICBpZiAoIXRoaXNbJ3RoZXJhcHlSZWxhdGlvbnNoaXBUeXBlJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHRoZXJhcHlSZWxhdGlvbnNoaXBUeXBlIGZoaXI6IE1lZGljaW5hbFByb2R1Y3RJbmRpY2F0aW9uLm90aGVyVGhlcmFweS50aGVyYXB5UmVsYXRpb25zaGlwVHlwZTpDb2RlYWJsZUNvbmNlcHQnLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInRoZXJhcHlSZWxhdGlvbnNoaXBUeXBlXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMudGhlcmFweVJlbGF0aW9uc2hpcFR5cGUuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLnRoZXJhcHlSZWxhdGlvbnNoaXBUeXBlJykpOyB9XHJcbiAgICBpZiAoIXRoaXNbJ21lZGljYXRpb24nXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgbWVkaWNhdGlvbiBmaGlyOiBNZWRpY2luYWxQcm9kdWN0SW5kaWNhdGlvbi5vdGhlclRoZXJhcHkubWVkaWNhdGlvblt4XTonLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb24gdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb25BcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJNZWRpY2luYWxQcm9kdWN0SW5kaWNhdGlvblwifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgbWVkaWNhdGlvbiBmb3Igd2hpY2ggdGhpcyBpcyBhbiBpbmRpY2F0aW9uLlxyXG4gICAqL1xyXG4gIHN1YmplY3Q/OiBmaGlyLlJlZmVyZW5jZUFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGRpc2Vhc2UsIHN5bXB0b20gb3IgcHJvY2VkdXJlIHRoYXQgaXMgdGhlIGluZGljYXRpb24gZm9yIHRyZWF0bWVudC5cclxuICAgKi9cclxuICBkaXNlYXNlU3ltcHRvbVByb2NlZHVyZT86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHN0YXR1cyBvZiB0aGUgZGlzZWFzZSBvciBzeW1wdG9tIGZvciB3aGljaCB0aGUgaW5kaWNhdGlvbiBhcHBsaWVzLlxyXG4gICAqL1xyXG4gIGRpc2Vhc2VTdGF0dXM/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIENvbW9yYmlkaXR5IChjb25jdXJyZW50IGNvbmRpdGlvbikgb3IgY28taW5mZWN0aW9uIGFzIHBhcnQgb2YgdGhlIGluZGljYXRpb24uXHJcbiAgICovXHJcbiAgY29tb3JiaWRpdHk/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGludGVuZGVkIGVmZmVjdCwgYWltIG9yIHN0cmF0ZWd5IHRvIGJlIGFjaGlldmVkIGJ5IHRoZSBpbmRpY2F0aW9uLlxyXG4gICAqL1xyXG4gIGludGVuZGVkRWZmZWN0PzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaW1pbmcgb3IgZHVyYXRpb24gaW5mb3JtYXRpb24gYXMgcGFydCBvZiB0aGUgaW5kaWNhdGlvbi5cclxuICAgKi9cclxuICBkdXJhdGlvbj86IGZoaXIuUXVhbnRpdHlBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlIG9mIHRoZSBtZWRpY2luYWwgcHJvZHVjdCBpbiByZWxhdGlvbiB0byBvdGhlciB0aGVyYXBpZXMgZGVzY3JpYmVkIGFzIHBhcnQgb2YgdGhlIGluZGljYXRpb24uXHJcbiAgICovXHJcbiAgb3RoZXJUaGVyYXB5PzogZmhpci5NZWRpY2luYWxQcm9kdWN0SW5kaWNhdGlvbk90aGVyVGhlcmFweUFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmUgdGhlIHVuZGVzaXJhYmxlIGVmZmVjdHMgb2YgdGhlIG1lZGljaW5hbCBwcm9kdWN0LlxyXG4gICAqL1xyXG4gIHVuZGVzaXJhYmxlRWZmZWN0PzogZmhpci5SZWZlcmVuY2VBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwb3B1bGF0aW9uIGdyb3VwIHRvIHdoaWNoIHRoaXMgYXBwbGllcy5cclxuICAgKi9cclxuICBwb3B1bGF0aW9uPzogZmhpci5Qb3B1bGF0aW9uQXJnc1tdfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluZGljYXRpb24gZm9yIHRoZSBNZWRpY2luYWwgUHJvZHVjdC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBNZWRpY2luYWxQcm9kdWN0SW5kaWNhdGlvbiBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2Uge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb24nO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb25cIjtcclxuICAvKipcclxuICAgKiBUaGUgbWVkaWNhdGlvbiBmb3Igd2hpY2ggdGhpcyBpcyBhbiBpbmRpY2F0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdWJqZWN0OiBmaGlyLlJlZmVyZW5jZVtdO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBkaXNlYXNlLCBzeW1wdG9tIG9yIHByb2NlZHVyZSB0aGF0IGlzIHRoZSBpbmRpY2F0aW9uIGZvciB0cmVhdG1lbnQuXHJcbiAgICovXHJcbiAgcHVibGljIGRpc2Vhc2VTeW1wdG9tUHJvY2VkdXJlPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBzdGF0dXMgb2YgdGhlIGRpc2Vhc2Ugb3Igc3ltcHRvbSBmb3Igd2hpY2ggdGhlIGluZGljYXRpb24gYXBwbGllcy5cclxuICAgKi9cclxuICBwdWJsaWMgZGlzZWFzZVN0YXR1cz86IGZoaXIuQ29kZWFibGVDb25jZXB0fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBDb21vcmJpZGl0eSAoY29uY3VycmVudCBjb25kaXRpb24pIG9yIGNvLWluZmVjdGlvbiBhcyBwYXJ0IG9mIHRoZSBpbmRpY2F0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb21vcmJpZGl0eTogZmhpci5Db2RlYWJsZUNvbmNlcHRbXTtcclxuICAvKipcclxuICAgKiBUaGUgaW50ZW5kZWQgZWZmZWN0LCBhaW0gb3Igc3RyYXRlZ3kgdG8gYmUgYWNoaWV2ZWQgYnkgdGhlIGluZGljYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIGludGVuZGVkRWZmZWN0PzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRpbWluZyBvciBkdXJhdGlvbiBpbmZvcm1hdGlvbiBhcyBwYXJ0IG9mIHRoZSBpbmRpY2F0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBkdXJhdGlvbj86IGZoaXIuUXVhbnRpdHl8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEluZm9ybWF0aW9uIGFib3V0IHRoZSB1c2Ugb2YgdGhlIG1lZGljaW5hbCBwcm9kdWN0IGluIHJlbGF0aW9uIHRvIG90aGVyIHRoZXJhcGllcyBkZXNjcmliZWQgYXMgcGFydCBvZiB0aGUgaW5kaWNhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgb3RoZXJUaGVyYXB5OiBmaGlyLk1lZGljaW5hbFByb2R1Y3RJbmRpY2F0aW9uT3RoZXJUaGVyYXB5W107XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmUgdGhlIHVuZGVzaXJhYmxlIGVmZmVjdHMgb2YgdGhlIG1lZGljaW5hbCBwcm9kdWN0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1bmRlc2lyYWJsZUVmZmVjdDogZmhpci5SZWZlcmVuY2VbXTtcclxuICAvKipcclxuICAgKiBUaGUgcG9wdWxhdGlvbiBncm91cCB0byB3aGljaCB0aGlzIGFwcGxpZXMuXHJcbiAgICovXHJcbiAgcHVibGljIHBvcHVsYXRpb246IGZoaXIuUG9wdWxhdGlvbltdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIE1lZGljaW5hbFByb2R1Y3RJbmRpY2F0aW9uIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8TWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb25BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb24nO1xyXG4gICAgaWYgKHNvdXJjZVsnc3ViamVjdCddKSB7IHRoaXMuc3ViamVjdCA9IHNvdXJjZS5zdWJqZWN0Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuc3ViamVjdCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydkaXNlYXNlU3ltcHRvbVByb2NlZHVyZSddKSB7IHRoaXMuZGlzZWFzZVN5bXB0b21Qcm9jZWR1cmUgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLmRpc2Vhc2VTeW1wdG9tUHJvY2VkdXJlKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZGlzZWFzZVN0YXR1cyddKSB7IHRoaXMuZGlzZWFzZVN0YXR1cyA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UuZGlzZWFzZVN0YXR1cyk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2NvbW9yYmlkaXR5J10pIHsgdGhpcy5jb21vcmJpZGl0eSA9IHNvdXJjZS5jb21vcmJpZGl0eS5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmNvbW9yYmlkaXR5ID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2ludGVuZGVkRWZmZWN0J10pIHsgdGhpcy5pbnRlbmRlZEVmZmVjdCA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UuaW50ZW5kZWRFZmZlY3QpOyB9XHJcbiAgICBpZiAoc291cmNlWydkdXJhdGlvbiddKSB7IHRoaXMuZHVyYXRpb24gPSBuZXcgZmhpci5RdWFudGl0eShzb3VyY2UuZHVyYXRpb24pOyB9XHJcbiAgICBpZiAoc291cmNlWydvdGhlclRoZXJhcHknXSkgeyB0aGlzLm90aGVyVGhlcmFweSA9IHNvdXJjZS5vdGhlclRoZXJhcHkubWFwKCh4KSA9PiBuZXcgZmhpci5NZWRpY2luYWxQcm9kdWN0SW5kaWNhdGlvbk90aGVyVGhlcmFweSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLm90aGVyVGhlcmFweSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWyd1bmRlc2lyYWJsZUVmZmVjdCddKSB7IHRoaXMudW5kZXNpcmFibGVFZmZlY3QgPSBzb3VyY2UudW5kZXNpcmFibGVFZmZlY3QubWFwKCh4KSA9PiBuZXcgZmhpci5SZWZlcmVuY2UoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy51bmRlc2lyYWJsZUVmZmVjdCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydwb3B1bGF0aW9uJ10pIHsgdGhpcy5wb3B1bGF0aW9uID0gc291cmNlLnBvcHVsYXRpb24ubWFwKCh4KSA9PiBuZXcgZmhpci5Qb3B1bGF0aW9uKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucG9wdWxhdGlvbiA9IFtdOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKTtcclxuICAgIGlmIChleHByZXNzaW9uID09PSAnJykgeyBleHByZXNzaW9uID0gJ01lZGljaW5hbFByb2R1Y3RJbmRpY2F0aW9uJyB9XHJcbiAgICBpZiAoIXRoaXNbJ3Jlc291cmNlVHlwZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSByZXNvdXJjZVR5cGUgZmhpcjogTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb24ucmVzb3VyY2VUeXBlOlwiTWVkaWNpbmFsUHJvZHVjdEluZGljYXRpb25cIicsIGV4cHJlc3Npb246IFtleHByZXNzaW9uXSB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wic3ViamVjdFwiXSkgeyB0aGlzLnN1YmplY3QuZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLnN1YmplY3RbJHtpfV1gKSk7IH0pIH1cclxuICAgIGlmICh0aGlzW1wiZGlzZWFzZVN5bXB0b21Qcm9jZWR1cmVcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5kaXNlYXNlU3ltcHRvbVByb2NlZHVyZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycuZGlzZWFzZVN5bXB0b21Qcm9jZWR1cmUnKSk7IH1cclxuICAgIGlmICh0aGlzW1wiZGlzZWFzZVN0YXR1c1wiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmRpc2Vhc2VTdGF0dXMuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLmRpc2Vhc2VTdGF0dXMnKSk7IH1cclxuICAgIGlmICh0aGlzW1wiY29tb3JiaWRpdHlcIl0pIHsgdGhpcy5jb21vcmJpZGl0eS5mb3JFYWNoKCh4LGkpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uK2AuY29tb3JiaWRpdHlbJHtpfV1gKSk7IH0pIH1cclxuICAgIGlmICh0aGlzW1wiaW50ZW5kZWRFZmZlY3RcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5pbnRlbmRlZEVmZmVjdC5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycuaW50ZW5kZWRFZmZlY3QnKSk7IH1cclxuICAgIGlmICh0aGlzW1wiZHVyYXRpb25cIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5kdXJhdGlvbi5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycuZHVyYXRpb24nKSk7IH1cclxuICAgIGlmICh0aGlzW1wib3RoZXJUaGVyYXB5XCJdKSB7IHRoaXMub3RoZXJUaGVyYXB5LmZvckVhY2goKHgsaSkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rYC5vdGhlclRoZXJhcHlbJHtpfV1gKSk7IH0pIH1cclxuICAgIGlmICh0aGlzW1widW5kZXNpcmFibGVFZmZlY3RcIl0pIHsgdGhpcy51bmRlc2lyYWJsZUVmZmVjdC5mb3JFYWNoKCh4LGkpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uK2AudW5kZXNpcmFibGVFZmZlY3RbJHtpfV1gKSk7IH0pIH1cclxuICAgIGlmICh0aGlzW1wicG9wdWxhdGlvblwiXSkgeyB0aGlzLnBvcHVsYXRpb24uZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLnBvcHVsYXRpb25bJHtpfV1gKSk7IH0pIH1cclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbiJdfQ==