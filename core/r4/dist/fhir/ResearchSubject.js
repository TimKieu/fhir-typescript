// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: ResearchSubject
import * as fhir from '../fhir.js';
// @ts-ignore
import { ResearchSubjectStatusCodings, } from '../fhirValueSets/ResearchSubjectStatusCodings.js';
/**
 * A physical entity which is the primary unit of operational and/or administrative interest in a study.
 */
export class ResearchSubject extends fhir.DomainResource {
    /**
     * Default constructor for ResearchSubject - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'ResearchSubject';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['status']) {
            this.status = source.status;
        }
        else {
            this.status = null;
        }
        if (source['period']) {
            this.period = new fhir.Period(source.period);
        }
        if (source['study']) {
            this.study = new fhir.Reference(source.study);
        }
        else {
            this.study = null;
        }
        if (source['individual']) {
            this.individual = new fhir.Reference(source.individual);
        }
        else {
            this.individual = null;
        }
        if (source['assignedArm']) {
            this.assignedArm = new fhir.FhirString({ value: source.assignedArm });
        }
        if (source['actualArm']) {
            this.actualArm = new fhir.FhirString({ value: source.actualArm });
        }
        if (source['consent']) {
            this.consent = new fhir.Reference(source.consent);
        }
    }
    /**
     * Required-bound Value Set for status (ResearchSubject.status)
     */
    static statusRequiredCoding() {
        return ResearchSubjectStatusCodings;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType:"ResearchSubject" fhir: ResearchSubject.resourceType:"ResearchSubject"', });
        }
        if (this["identifier"]) {
            this.identifier.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (!this['status']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property status:ResearchSubjectStatusCodeType fhir: ResearchSubject.status:code', });
        }
        if (this["period"]) {
            issues.push(...this.period.doModelValidation());
        }
        if (!this['study']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property study:fhir.Reference fhir: ResearchSubject.study:Reference', });
        }
        if (this["study"]) {
            issues.push(...this.study.doModelValidation());
        }
        if (!this['individual']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property individual:fhir.Reference fhir: ResearchSubject.individual:Reference', });
        }
        if (this["individual"]) {
            issues.push(...this.individual.doModelValidation());
        }
        if (this["assignedArm"]) {
            issues.push(...this.assignedArm.doModelValidation());
        }
        if (this["actualArm"]) {
            issues.push(...this.actualArm.doModelValidation());
        }
        if (this["consent"]) {
            issues.push(...this.consent.doModelValidation());
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ResearchSubject._fts_dataType = 'ResearchSubject';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVzZWFyY2hTdWJqZWN0LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9SZXNlYXJjaFN1YmplY3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsaUNBQWlDO0FBRWpDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBRW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsNEJBQTRCLEdBQW1DLE1BQU0sa0RBQWtELENBQUM7QUE2Q2pJOztHQUVHO0FBQ0gsTUFBTSxPQUFPLGVBQWdCLFNBQVEsSUFBSSxDQUFDLGNBQWM7SUF5Q3REOztPQUVHO0lBQ0gsWUFBWSxTQUFzQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUM1RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxZQUFZLEdBQUcsaUJBQWlCLENBQUM7UUFDdEMsSUFBSSxNQUFNLENBQUMsWUFBWSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsVUFBVSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUFFO2FBQ2hHO1lBQUUsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUM7U0FBRTtRQUM5QixJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztTQUFFO2FBQ2pEO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7U0FBRTtRQUM1QixJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMs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RUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRyxXQUFXLEVBQUUsZ0dBQWdHLEdBQUcsQ0FBQyxDQUFDO1NBQ3ZLO1FBQ0QsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUNoRixJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQztTQUFFO1FBQ2xGLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO1NBQUU7UUFDOUUsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUMxRSxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDOztBQTFGRDs7R0FFRztBQUM2Qiw2QkFBYSxHQUFVLGlCQUFpQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0LmNvcmUgdmVyc2lvbjogNC4wLjFcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIFJlc291cmNlOiBSZXNlYXJjaFN1YmplY3RcclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFJlc2VhcmNoU3ViamVjdFN0YXR1c0NvZGluZ3MsIFJlc2VhcmNoU3ViamVjdFN0YXR1c0NvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Jlc2VhcmNoU3ViamVjdFN0YXR1c0NvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFJlc2VhcmNoU3ViamVjdFN0YXR1c0NvZGVzLCAgUmVzZWFyY2hTdWJqZWN0U3RhdHVzQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1Jlc2VhcmNoU3ViamVjdFN0YXR1c0NvZGVzLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIFJlc2VhcmNoU3ViamVjdCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBSZXNlYXJjaFN1YmplY3RBcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJSZXNlYXJjaFN1YmplY3RcInx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWRlbnRpZmllcnMgYXNzaWduZWQgdG8gdGhpcyByZXNlYXJjaCBzdWJqZWN0IGZvciBhIHN0dWR5LlxyXG4gICAqL1xyXG4gIGlkZW50aWZpZXI/OiBmaGlyLklkZW50aWZpZXJBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBzdWJqZWN0LlxyXG4gICAqL1xyXG4gIHN0YXR1czogUmVzZWFyY2hTdWJqZWN0U3RhdHVzQ29kZVR5cGV8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgZGF0ZXMgdGhlIHN1YmplY3QgYmVnYW4gYW5kIGVuZGVkIHRoZWlyIHBhcnRpY2lwYXRpb24gaW4gdGhlIHN0dWR5LlxyXG4gICAqL1xyXG4gIHBlcmlvZD86IGZoaXIuUGVyaW9kQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogUmVmZXJlbmNlIHRvIHRoZSBzdHVkeSB0aGUgc3ViamVjdCBpcyBwYXJ0aWNpcGF0aW5nIGluLlxyXG4gICAqL1xyXG4gIHN0dWR5OiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgcmVjb3JkIG9mIHRoZSBwZXJzb24gb3IgYW5pbWFsIHdobyBpcyBpbnZvbHZlZCBpbiB0aGUgc3R1ZHkuXHJcbiAgICovXHJcbiAgaW5kaXZpZHVhbDogZmhpci5SZWZlcmVuY2VBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIG5hbWUgb2YgdGhlIGFybSBpbiB0aGUgc3R1ZHkgdGhlIHN1YmplY3QgaXMgZXhwZWN0ZWQgdG8gZm9sbG93IGFzIHBhcnQgb2YgdGhpcyBzdHVkeS5cclxuICAgKi9cclxuICBhc3NpZ25lZEFybT86IGZoaXIuRmhpclN0cmluZ3xzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBhcm0gaW4gdGhlIHN0dWR5IHRoZSBzdWJqZWN0IGFjdHVhbGx5IGZvbGxvd2VkIGFzIHBhcnQgb2YgdGhpcyBzdHVkeS5cclxuICAgKi9cclxuICBhY3R1YWxBcm0/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIHJlY29yZCBvZiB0aGUgcGF0aWVudCdzIGluZm9ybWVkIGFncmVlbWVudCB0byBwYXJ0aWNpcGF0ZSBpbiB0aGUgc3R1ZHkuXHJcbiAgICovXHJcbiAgY29uc2VudD86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIHBoeXNpY2FsIGVudGl0eSB3aGljaCBpcyB0aGUgcHJpbWFyeSB1bml0IG9mIG9wZXJhdGlvbmFsIGFuZC9vciBhZG1pbmlzdHJhdGl2ZSBpbnRlcmVzdCBpbiBhIHN0dWR5LlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJlc2VhcmNoU3ViamVjdCBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2Uge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnUmVzZWFyY2hTdWJqZWN0JztcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzb3VyY2VUeXBlOiBcIlJlc2VhcmNoU3ViamVjdFwiO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXJzIGFzc2lnbmVkIHRvIHRoaXMgcmVzZWFyY2ggc3ViamVjdCBmb3IgYSBzdHVkeS5cclxuICAgKi9cclxuICBwdWJsaWMgaWRlbnRpZmllcj86IGZoaXIuSWRlbnRpZmllcltdO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBzdWJqZWN0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0dXM6IFJlc2VhcmNoU3ViamVjdFN0YXR1c0NvZGVUeXBlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIGRhdGVzIHRoZSBzdWJqZWN0IGJlZ2FuIGFuZCBlbmRlZCB0aGVpciBwYXJ0aWNpcGF0aW9uIGluIHRoZSBzdHVkeS5cclxuICAgKi9cclxuICBwdWJsaWMgcGVyaW9kPzogZmhpci5QZXJpb2R8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFJlZmVyZW5jZSB0byB0aGUgc3R1ZHkgdGhlIHN1YmplY3QgaXMgcGFydGljaXBhdGluZyBpbi5cclxuICAgKi9cclxuICBwdWJsaWMgc3R1ZHk6IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHJlY29yZCBvZiB0aGUgcGVyc29uIG9yIGFuaW1hbCB3aG8gaXMgaW52b2x2ZWQgaW4gdGhlIHN0dWR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbmRpdmlkdWFsOiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBhcm0gaW4gdGhlIHN0dWR5IHRoZSBzdWJqZWN0IGlzIGV4cGVjdGVkIHRvIGZvbGxvdyBhcyBwYXJ0IG9mIHRoaXMgc3R1ZHkuXHJcbiAgICovXHJcbiAgcHVibGljIGFzc2lnbmVkQXJtPzogZmhpci5GaGlyU3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgbmFtZSBvZiB0aGUgYXJtIGluIHRoZSBzdHVkeSB0aGUgc3ViamVjdCBhY3R1YWxseSBmb2xsb3dlZCBhcyBwYXJ0IG9mIHRoaXMgc3R1ZHkuXHJcbiAgICovXHJcbiAgcHVibGljIGFjdHVhbEFybT86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQSByZWNvcmQgb2YgdGhlIHBhdGllbnQncyBpbmZvcm1lZCBhZ3JlZW1lbnQgdG8gcGFydGljaXBhdGUgaW4gdGhlIHN0dWR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zZW50PzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFJlc2VhcmNoU3ViamVjdCAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFJlc2VhcmNoU3ViamVjdEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdSZXNlYXJjaFN1YmplY3QnO1xyXG4gICAgaWYgKHNvdXJjZVsnaWRlbnRpZmllciddKSB7IHRoaXMuaWRlbnRpZmllciA9IHNvdXJjZS5pZGVudGlmaWVyLm1hcCgoeCkgPT4gbmV3IGZoaXIuSWRlbnRpZmllcih4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmlkZW50aWZpZXIgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3RhdHVzJ10pIHsgdGhpcy5zdGF0dXMgPSBzb3VyY2Uuc3RhdHVzOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5zdGF0dXMgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydwZXJpb2QnXSkgeyB0aGlzLnBlcmlvZCA9IG5ldyBmaGlyLlBlcmlvZChzb3VyY2UucGVyaW9kKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3R1ZHknXSkgeyB0aGlzLnN0dWR5ID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5zdHVkeSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnN0dWR5ID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaW5kaXZpZHVhbCddKSB7IHRoaXMuaW5kaXZpZHVhbCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuaW5kaXZpZHVhbCk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmluZGl2aWR1YWwgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydhc3NpZ25lZEFybSddKSB7IHRoaXMuYXNzaWduZWRBcm0gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLmFzc2lnbmVkQXJtfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2FjdHVhbEFybSddKSB7IHRoaXMuYWN0dWFsQXJtID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS5hY3R1YWxBcm19KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnY29uc2VudCddKSB7IHRoaXMuY29uc2VudCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuY29uc2VudCk7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogUmVxdWlyZWQtYm91bmQgVmFsdWUgU2V0IGZvciBzdGF0dXMgKFJlc2VhcmNoU3ViamVjdC5zdGF0dXMpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBzdGF0dXNSZXF1aXJlZENvZGluZygpOlJlc2VhcmNoU3ViamVjdFN0YXR1c0NvZGluZ1R5cGUge1xyXG4gICAgcmV0dXJuIFJlc2VhcmNoU3ViamVjdFN0YXR1c0NvZGluZ3M7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbigpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKCk7XHJcbiAgICBpZiAoIXRoaXNbJ3Jlc291cmNlVHlwZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsICBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgcmVzb3VyY2VUeXBlOlwiUmVzZWFyY2hTdWJqZWN0XCIgZmhpcjogUmVzZWFyY2hTdWJqZWN0LnJlc291cmNlVHlwZTpcIlJlc2VhcmNoU3ViamVjdFwiJywgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcImlkZW50aWZpZXJcIl0pIHsgdGhpcy5pZGVudGlmaWVyLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgaWYgKCF0aGlzWydzdGF0dXMnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCAgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHN0YXR1czpSZXNlYXJjaFN1YmplY3RTdGF0dXNDb2RlVHlwZSBmaGlyOiBSZXNlYXJjaFN1YmplY3Quc3RhdHVzOmNvZGUnLCB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wicGVyaW9kXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMucGVyaW9kLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAoIXRoaXNbJ3N0dWR5J10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSBzdHVkeTpmaGlyLlJlZmVyZW5jZSBmaGlyOiBSZXNlYXJjaFN1YmplY3Quc3R1ZHk6UmVmZXJlbmNlJywgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInN0dWR5XCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMuc3R1ZHkuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICghdGhpc1snaW5kaXZpZHVhbCddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsICBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgaW5kaXZpZHVhbDpmaGlyLlJlZmVyZW5jZSBmaGlyOiBSZXNlYXJjaFN1YmplY3QuaW5kaXZpZHVhbDpSZWZlcmVuY2UnLCB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wiaW5kaXZpZHVhbFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmluZGl2aWR1YWwuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzW1wiYXNzaWduZWRBcm1cIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5hc3NpZ25lZEFybS5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJhY3R1YWxBcm1cIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5hY3R1YWxBcm0uZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzW1wiY29uc2VudFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmNvbnNlbnQuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbiJdfQ==