// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: Invoice
import * as fhir from '../fhir.js';
// @ts-ignore
import { InvoicePriceComponentTypeVsValidation } from '../fhirValueSets/InvoicePriceComponentTypeVsValidation.js';
// @ts-ignore
import { InvoiceStatusVsValidation } from '../fhirValueSets/InvoiceStatusVsValidation.js';
/**
 * Indicates who or what performed or participated in the charged service.
 */
export class InvoiceParticipant extends fhir.BackboneElement {
    /**
     * Default constructor for InvoiceParticipant - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['role']) {
            this.role = new fhir.CodeableConcept(source.role);
        }
        if (source['actor']) {
            this.actor = new fhir.Reference(source.actor);
        }
        else {
            this.actor = null;
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Invoice.participant';
        }
        this.vOS('role', exp);
        this.vRS('actor', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
InvoiceParticipant._fts_dataType = 'InvoiceParticipant';
/**
 * The price for a ChargeItem may be calculated as a base price with surcharges/deductions that apply in certain conditions. A ChargeItemDefinition resource that defines the prices, factors and conditions that apply to a billing code is currently under development. The priceComponent element can be used to offer transparency to the recipient of the Invoice as to how the prices have been calculated.
 */
export class InvoiceLineItemPriceComponent extends fhir.BackboneElement {
    /**
     * Default constructor for InvoiceLineItemPriceComponent - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.FhirCode({ value: source.type });
        }
        else {
            this.type = null;
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirCode(source._type);
            }
        }
        if (source['code']) {
            this.code = new fhir.CodeableConcept(source.code);
        }
        if (source['factor']) {
            this.factor = new fhir.FhirDecimal({ value: source.factor });
        }
        if (source['_factor']) {
            if (this.factor) {
                this.factor.addExtendedProperties(source._factor);
            }
            else {
                this.factor = new fhir.FhirDecimal(source._factor);
            }
        }
        if (source['amount']) {
            this.amount = new fhir.Money(source.amount);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Invoice.lineItem.priceComponent';
        }
        this.vRSV('type', exp, 'InvoicePriceComponentType', InvoicePriceComponentTypeVsValidation, 'r');
        this.vOS('code', exp);
        this.vOS('factor', exp);
        this.vOS('amount', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
InvoiceLineItemPriceComponent._fts_dataType = 'InvoiceLineItemPriceComponent';
/**
 * Each line item represents one charge for goods and services rendered. Details such as date, code and amount are found in the referenced ChargeItem resource.
 */
export class InvoiceLineItem extends fhir.BackboneElement {
    /**
     * Default constructor for InvoiceLineItem - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['sequence']) {
            this.sequence = new fhir.FhirPositiveInt({ value: source.sequence });
        }
        if (source['_sequence']) {
            if (this.sequence) {
                this.sequence.addExtendedProperties(source._sequence);
            }
            else {
                this.sequence = new fhir.FhirPositiveInt(source._sequence);
            }
        }
        if (source['chargeItem']) {
            this.chargeItem = source.chargeItem;
        }
        else if (source['chargeItemReference']) {
            this.chargeItem = new fhir.Reference(source.chargeItemReference);
        }
        else if (source['chargeItemCodeableConcept']) {
            this.chargeItem = new fhir.CodeableConcept(source.chargeItemCodeableConcept);
        }
        else {
            this.chargeItem = null;
        }
        if (source['priceComponent']) {
            this.priceComponent = source.priceComponent.map((x) => new fhir.InvoiceLineItemPriceComponent(x));
        }
        else {
            this.priceComponent = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Invoice.lineItem';
        }
        this.vOS('sequence', exp);
        this.vRS('chargeItem', exp);
        this.vOA('priceComponent', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
InvoiceLineItem._fts_dataType = 'InvoiceLineItem';
/**
 * Internal flag to properly serialize choice-type element Invoice.lineItem.chargeItem[x]
 */
InvoiceLineItem._fts_chargeItemIsChoice = true;
/**
 * Invoice containing collected ChargeItems from an Account with calculated individual and total price for Billing purpose.
 */
export class Invoice extends fhir.DomainResource {
    /**
     * Default constructor for Invoice - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Invoice';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['status']) {
            this.status = new fhir.FhirCode({ value: source.status });
        }
        else {
            this.status = null;
        }
        if (source['_status']) {
            if (this.status) {
                this.status.addExtendedProperties(source._status);
            }
            else {
                this.status = new fhir.FhirCode(source._status);
            }
        }
        if (source['cancelledReason']) {
            this.cancelledReason = new fhir.FhirString({ value: source.cancelledReason });
        }
        if (source['_cancelledReason']) {
            if (this.cancelledReason) {
                this.cancelledReason.addExtendedProperties(source._cancelledReason);
            }
            else {
                this.cancelledReason = new fhir.FhirString(source._cancelledReason);
            }
        }
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        if (source['subject']) {
            this.subject = new fhir.Reference(source.subject);
        }
        if (source['recipient']) {
            this.recipient = new fhir.Reference(source.recipient);
        }
        if (source['date']) {
            this.date = new fhir.FhirDateTime({ value: source.date });
        }
        if (source['_date']) {
            if (this.date) {
                this.date.addExtendedProperties(source._date);
            }
            else {
                this.date = new fhir.FhirDateTime(source._date);
            }
        }
        if (source['participant']) {
            this.participant = source.participant.map((x) => new fhir.InvoiceParticipant(x));
        }
        else {
            this.participant = [];
        }
        if (source['issuer']) {
            this.issuer = new fhir.Reference(source.issuer);
        }
        if (source['account']) {
            this.account = new fhir.Reference(source.account);
        }
        if (source['lineItem']) {
            this.lineItem = source.lineItem.map((x) => new fhir.InvoiceLineItem(x));
        }
        else {
            this.lineItem = [];
        }
        if (source['totalPriceComponent']) {
            this.totalPriceComponent = source.totalPriceComponent.map((x) => new fhir.InvoiceLineItemPriceComponent(x));
        }
        else {
            this.totalPriceComponent = [];
        }
        if (source['totalNet']) {
            this.totalNet = new fhir.Money(source.totalNet);
        }
        if (source['totalGross']) {
            this.totalGross = new fhir.Money(source.totalGross);
        }
        if (source['paymentTerms']) {
            this.paymentTerms = new fhir.FhirMarkdown({ value: source.paymentTerms });
        }
        if (source['_paymentTerms']) {
            if (this.paymentTerms) {
                this.paymentTerms.addExtendedProperties(source._paymentTerms);
            }
            else {
                this.paymentTerms = new fhir.FhirMarkdown(source._paymentTerms);
            }
        }
        if (source['note']) {
            this.note = source.note.map((x) => new fhir.Annotation(x));
        }
        else {
            this.note = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Invoice';
        }
        this.vRS('resourceType', exp);
        this.vOA('identifier', exp);
        this.vRSV('status', exp, 'InvoiceStatus', InvoiceStatusVsValidation, 'r');
        this.vOS('cancelledReason', exp);
        this.vOS('type', exp);
        this.vOS('subject', exp);
        this.vOS('recipient', exp);
        this.vOS('date', exp);
        this.vOA('participant', exp);
        this.vOS('issuer', exp);
        this.vOS('account', exp);
        this.vOA('lineItem', exp);
        this.vOA('totalPriceComponent', exp);
        this.vOS('totalNet', exp);
        this.vOS('totalGross', exp);
        this.vOS('paymentTerms', exp);
        this.vOA('note', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Invoice._fts_dataType = 'Invoice';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSW52b2ljZS5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvSW52b2ljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQyx5QkFBeUI7QUFFekIsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFJbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSxxQ0FBcUMsRUFBRSxNQUFNLDJEQUEyRCxDQUFDO0FBR2xILGFBQWE7QUFDYixPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSwrQ0FBK0MsQ0FBQztBQWUxRjs7R0FFRztBQUNILE1BQU0sT0FBTyxrQkFBbUIsU0FBUSxJQUFJLENBQUMsZUFBZTtJQWExRDs7T0FFRztJQUNILFlBQVksU0FBeUMsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDL0YsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUFFO1FBQzFFLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQUU7YUFDbEU7WUFBRSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztTQUFFO0lBQzdCLENBQUM7SUFDRDs7T0FFRztJQUNhLGlCQUFpQixDQUFDLE1BQWEsRUFBRTtRQUMvQyxJQUFJLE1BQU0sR0FBbUIsS0FBSyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQzFELElBQUksR0FBRyxLQUFLLEVBQUUsRUFBRTtZQUFFLEdBQUcsR0FBRyxxQkFBcUIsQ0FBQTtTQUFFO1FB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QUFDO1NBQUU7YUFDM0c7WUFBRSxJQUFJLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQy9CLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQUU7UUFDMUUsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7U0FBRTtRQUM3RSxJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDL0Y7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQzVCLElBQUksTUFBTSxDQUFDLHFCQUFxQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsbUJBQW1CLEdBQUcsTUFBTSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsNkJBQTZCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUFFO2FBQzlJO1lBQUUsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQ3ZDLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQUU7UUFDNUUsSUFBSSxNQUFNLENBQUMsWUFBWSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsVUFBVSxHQUFHLElB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dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0LmNvcmUgdmVyc2lvbjogNC4wLjFcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIFJlc291cmNlOiBJbnZvaWNlXHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBJbnZvaWNlUHJpY2VDb21wb25lbnRUeXBlQ29kZXMsICBJbnZvaWNlUHJpY2VDb21wb25lbnRUeXBlQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0ludm9pY2VQcmljZUNvbXBvbmVudFR5cGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgSW52b2ljZVByaWNlQ29tcG9uZW50VHlwZVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvSW52b2ljZVByaWNlQ29tcG9uZW50VHlwZVZzVmFsaWRhdGlvbi5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgSW52b2ljZVN0YXR1c0NvZGVzLCAgSW52b2ljZVN0YXR1c0NvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9JbnZvaWNlU3RhdHVzQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IEludm9pY2VTdGF0dXNWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0ludm9pY2VTdGF0dXNWc1ZhbGlkYXRpb24uanMnO1xyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgSW52b2ljZVBhcnRpY2lwYW50IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEludm9pY2VQYXJ0aWNpcGFudEFyZ3MgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdHlwZSBvZiBpbnZvbHZlbWVudCAoZS5nLiB0cmFuc2NyaXB0aW9uaXN0LCBjcmVhdG9yIGV0Yy4pLiBJZiB0aGUgaW52b2ljZSBoYXMgYmVlbiBjcmVhdGVkIGF1dG9tYXRpY2FsbHksIHRoZSBQYXJ0aWNpcGFudCBtYXkgYmUgYSBiaWxsaW5nIGVuZ2luZSBvciBhbm90aGVyIGtpbmQgb2YgZGV2aWNlLlxyXG4gICAqL1xyXG4gIHJvbGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBkZXZpY2UsIHByYWN0aXRpb25lciwgZXRjLiB3aG8gcGVyZm9ybWVkIG9yIHBhcnRpY2lwYXRlZCBpbiB0aGUgc2VydmljZS5cclxuICAgKi9cclxuICBhY3RvcjogZmhpci5SZWZlcmVuY2VBcmdzfG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbmRpY2F0ZXMgd2hvIG9yIHdoYXQgcGVyZm9ybWVkIG9yIHBhcnRpY2lwYXRlZCBpbiB0aGUgY2hhcmdlZCBzZXJ2aWNlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEludm9pY2VQYXJ0aWNpcGFudCBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0ludm9pY2VQYXJ0aWNpcGFudCc7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB0eXBlIG9mIGludm9sdmVtZW50IChlLmcuIHRyYW5zY3JpcHRpb25pc3QsIGNyZWF0b3IgZXRjLikuIElmIHRoZSBpbnZvaWNlIGhhcyBiZWVuIGNyZWF0ZWQgYXV0b21hdGljYWxseSwgdGhlIFBhcnRpY2lwYW50IG1heSBiZSBhIGJpbGxpbmcgZW5naW5lIG9yIGFub3RoZXIga2luZCBvZiBkZXZpY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHJvbGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGRldmljZSwgcHJhY3RpdGlvbmVyLCBldGMuIHdobyBwZXJmb3JtZWQgb3IgcGFydGljaXBhdGVkIGluIHRoZSBzZXJ2aWNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhY3RvcjogZmhpci5SZWZlcmVuY2V8bnVsbDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBJbnZvaWNlUGFydGljaXBhbnQgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxJbnZvaWNlUGFydGljaXBhbnRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsncm9sZSddKSB7IHRoaXMucm9sZSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2Uucm9sZSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2FjdG9yJ10pIHsgdGhpcy5hY3RvciA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuYWN0b3IpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5hY3RvciA9IG51bGw7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbnZvaWNlLnBhcnRpY2lwYW50JyB9XHJcbiAgICB0aGlzLnZPUygncm9sZScsZXhwKVxyXG4gICAgdGhpcy52UlMoJ2FjdG9yJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgSW52b2ljZUxpbmVJdGVtUHJpY2VDb21wb25lbnQgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW52b2ljZUxpbmVJdGVtUHJpY2VDb21wb25lbnRBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGlzIGNvZGUgaWRlbnRpZmllcyB0aGUgdHlwZSBvZiB0aGUgY29tcG9uZW50LlxyXG4gICAqL1xyXG4gIHR5cGU6IGZoaXIuRmhpckNvZGU8SW52b2ljZVByaWNlQ29tcG9uZW50VHlwZUNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbnZvaWNlLmxpbmVJdGVtLnByaWNlQ29tcG9uZW50LnR5cGVcclxuICAgKi9cclxuICBfdHlwZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogQSBjb2RlIHRoYXQgaWRlbnRpZmllcyB0aGUgY29tcG9uZW50LiBDb2RlcyBtYXkgYmUgdXNlZCB0byBkaWZmZXJlbnRpYXRlIGJldHdlZW4ga2luZHMgb2YgdGF4ZXMsIHN1cmNoYXJnZXMsIGRpc2NvdW50cyBldGMuXHJcbiAgICovXHJcbiAgY29kZT86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlcmUgaXMgbm8gcmVhc29uIHRvIGNhcnJ5IHRoZSBwcmljZSBpbiB0aGUgaW5zdGFuY2Ugb2YgYSBDaGFyZ2VJdGVtIHVubGVzcyBjaXJjdW1zdGFuY2VzIHJlcXVpcmUgYSBtYW51YWwgb3ZlcnJpZGUuIFRoZSBsaXN0IHByaWNlcyBvciBhcmUgdXN1YWxseSBkZWZpbmVkIGluIGEgYmFjayBjYXRhbG9ndWUgb2YgdGhlIGJpbGxpbmcgY29kZXMgIChzZWUgQ2hhcmdlSXRlbS5kZWZpbml0aW9uKS4gRGVyaXZlZCBwcm9maWxlcyBtYXkgcmVxdWlyZSBhIENoYXJnZUl0ZW0ub3ZlcnJpZGVSZWFzb24gdG8gYmUgcHJvdmlkZWQgaWYgZWl0aGVyIGZhY3RvciBvciBwcmljZSBhcmUgbWFudWFsbHkgb3ZlcnJpZGRlbi5cclxuICAgKi9cclxuICBmYWN0b3I/OiBmaGlyLkZoaXJEZWNpbWFsfG51bWJlcnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEludm9pY2UubGluZUl0ZW0ucHJpY2VDb21wb25lbnQuZmFjdG9yXHJcbiAgICovXHJcbiAgX2ZhY3Rvcj86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVGhlcmUgaXMgbm8gcmVhc29uIHRvIGNhcnJ5IHRoZSBwcmljZSBpbiB0aGUgaW5zdGFuY2Ugb2YgYSBDaGFyZ2VJdGVtIHVubGVzcyBjaXJjdW1zdGFuY2VzIHJlcXVpcmUgYSBtYW51YWwgb3ZlcnJpZGUuIFRoZSBsaXN0IHByaWNlcyBvciBhcmUgdXN1YWxseSBkZWZpbmVkIGluIGEgYmFjayBjYXRhbG9ndWUgb2YgdGhlIGJpbGxpbmcgY29kZXMgIChzZWUgQ2hhcmdlSXRlbS5kZWZpbml0aW9uKS4gRGVyaXZlZCBwcm9maWxlcyBtYXkgcmVxdWlyZSBhIENoYXJnZUl0ZW0ub3ZlcnJpZGVSZWFzb24gdG8gYmUgcHJvdmlkZWQgaWYgZWl0aGVyIGZhY3RvciBvciBwcmljZSBhcmUgbWFudWFsbHkgb3ZlcnJpZGRlbi5cclxuICAgKi9cclxuICBhbW91bnQ/OiBmaGlyLk1vbmV5QXJnc3x1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgcHJpY2UgZm9yIGEgQ2hhcmdlSXRlbSBtYXkgYmUgY2FsY3VsYXRlZCBhcyBhIGJhc2UgcHJpY2Ugd2l0aCBzdXJjaGFyZ2VzL2RlZHVjdGlvbnMgdGhhdCBhcHBseSBpbiBjZXJ0YWluIGNvbmRpdGlvbnMuIEEgQ2hhcmdlSXRlbURlZmluaXRpb24gcmVzb3VyY2UgdGhhdCBkZWZpbmVzIHRoZSBwcmljZXMsIGZhY3RvcnMgYW5kIGNvbmRpdGlvbnMgdGhhdCBhcHBseSB0byBhIGJpbGxpbmcgY29kZSBpcyBjdXJyZW50bHkgdW5kZXIgZGV2ZWxvcG1lbnQuIFRoZSBwcmljZUNvbXBvbmVudCBlbGVtZW50IGNhbiBiZSB1c2VkIHRvIG9mZmVyIHRyYW5zcGFyZW5jeSB0byB0aGUgcmVjaXBpZW50IG9mIHRoZSBJbnZvaWNlIGFzIHRvIGhvdyB0aGUgcHJpY2VzIGhhdmUgYmVlbiBjYWxjdWxhdGVkLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEludm9pY2VMaW5lSXRlbVByaWNlQ29tcG9uZW50IGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnSW52b2ljZUxpbmVJdGVtUHJpY2VDb21wb25lbnQnO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgY29kZSBpZGVudGlmaWVzIHRoZSB0eXBlIG9mIHRoZSBjb21wb25lbnQuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU6IGZoaXIuRmhpckNvZGU8SW52b2ljZVByaWNlQ29tcG9uZW50VHlwZUNvZGVUeXBlPnxudWxsO1xyXG4gIC8qKlxyXG4gICAqIEEgY29kZSB0aGF0IGlkZW50aWZpZXMgdGhlIGNvbXBvbmVudC4gQ29kZXMgbWF5IGJlIHVzZWQgdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIGtpbmRzIG9mIHRheGVzLCBzdXJjaGFyZ2VzLCBkaXNjb3VudHMgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb2RlPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZXJlIGlzIG5vIHJlYXNvbiB0byBjYXJyeSB0aGUgcHJpY2UgaW4gdGhlIGluc3RhbmNlIG9mIGEgQ2hhcmdlSXRlbSB1bmxlc3MgY2lyY3Vtc3RhbmNlcyByZXF1aXJlIGEgbWFudWFsIG92ZXJyaWRlLiBUaGUgbGlzdCBwcmljZXMgb3IgYXJlIHVzdWFsbHkgZGVmaW5lZCBpbiBhIGJhY2sgY2F0YWxvZ3VlIG9mIHRoZSBiaWxsaW5nIGNvZGVzICAoc2VlIENoYXJnZUl0ZW0uZGVmaW5pdGlvbikuIERlcml2ZWQgcHJvZmlsZXMgbWF5IHJlcXVpcmUgYSBDaGFyZ2VJdGVtLm92ZXJyaWRlUmVhc29uIHRvIGJlIHByb3ZpZGVkIGlmIGVpdGhlciBmYWN0b3Igb3IgcHJpY2UgYXJlIG1hbnVhbGx5IG92ZXJyaWRkZW4uXHJcbiAgICovXHJcbiAgcHVibGljIGZhY3Rvcj86IGZoaXIuRmhpckRlY2ltYWx8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZXJlIGlzIG5vIHJlYXNvbiB0byBjYXJyeSB0aGUgcHJpY2UgaW4gdGhlIGluc3RhbmNlIG9mIGEgQ2hhcmdlSXRlbSB1bmxlc3MgY2lyY3Vtc3RhbmNlcyByZXF1aXJlIGEgbWFudWFsIG92ZXJyaWRlLiBUaGUgbGlzdCBwcmljZXMgb3IgYXJlIHVzdWFsbHkgZGVmaW5lZCBpbiBhIGJhY2sgY2F0YWxvZ3VlIG9mIHRoZSBiaWxsaW5nIGNvZGVzICAoc2VlIENoYXJnZUl0ZW0uZGVmaW5pdGlvbikuIERlcml2ZWQgcHJvZmlsZXMgbWF5IHJlcXVpcmUgYSBDaGFyZ2VJdGVtLm92ZXJyaWRlUmVhc29uIHRvIGJlIHByb3ZpZGVkIGlmIGVpdGhlciBmYWN0b3Igb3IgcHJpY2UgYXJlIG1hbnVhbGx5IG92ZXJyaWRkZW4uXHJcbiAgICovXHJcbiAgcHVibGljIGFtb3VudD86IGZoaXIuTW9uZXl8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIEludm9pY2VMaW5lSXRlbVByaWNlQ29tcG9uZW50IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8SW52b2ljZUxpbmVJdGVtUHJpY2VDb21wb25lbnRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkZoaXJDb2RlPEludm9pY2VQcmljZUNvbXBvbmVudFR5cGVDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2UudHlwZX0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50eXBlID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3R5cGUnXSkge1xyXG4gICAgICBpZiAodGhpcy50eXBlKSB7IHRoaXMudHlwZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl90eXBlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkZoaXJDb2RlPEludm9pY2VQcmljZUNvbXBvbmVudFR5cGVDb2RlVHlwZT4oc291cmNlLl90eXBlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydjb2RlJ10pIHsgdGhpcy5jb2RlID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5jb2RlKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZmFjdG9yJ10pIHsgdGhpcy5mYWN0b3IgPSBuZXcgZmhpci5GaGlyRGVjaW1hbCh7dmFsdWU6IHNvdXJjZS5mYWN0b3J9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2ZhY3RvciddKSB7XHJcbiAgICAgIGlmICh0aGlzLmZhY3RvcikgeyB0aGlzLmZhY3Rvci5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9mYWN0b3IhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5mYWN0b3IgPSBuZXcgZmhpci5GaGlyRGVjaW1hbChzb3VyY2UuX2ZhY3RvciBhcyBQYXJ0aWFsPGZoaXIuRmhpckRlY2ltYWxBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2Ftb3VudCddKSB7IHRoaXMuYW1vdW50ID0gbmV3IGZoaXIuTW9uZXkoc291cmNlLmFtb3VudCk7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbnZvaWNlLmxpbmVJdGVtLnByaWNlQ29tcG9uZW50JyB9XHJcbiAgICB0aGlzLnZSU1YoJ3R5cGUnLGV4cCwnSW52b2ljZVByaWNlQ29tcG9uZW50VHlwZScsSW52b2ljZVByaWNlQ29tcG9uZW50VHlwZVZzVmFsaWRhdGlvbiwncicpXHJcbiAgICB0aGlzLnZPUygnY29kZScsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2ZhY3RvcicsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2Ftb3VudCcsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIEludm9pY2VMaW5lSXRlbSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBJbnZvaWNlTGluZUl0ZW1BcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBTZXF1ZW5jZSBpbiB3aGljaCB0aGUgaXRlbXMgYXBwZWFyIG9uIHRoZSBpbnZvaWNlLlxyXG4gICAqL1xyXG4gIHNlcXVlbmNlPzogZmhpci5GaGlyUG9zaXRpdmVJbnR8bnVtYmVyfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW52b2ljZS5saW5lSXRlbS5zZXF1ZW5jZVxyXG4gICAqL1xyXG4gIF9zZXF1ZW5jZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVGhlIENoYXJnZUl0ZW0gY29udGFpbnMgaW5mb3JtYXRpb24gc3VjaCBhcyB0aGUgYmlsbGluZyBjb2RlLCBkYXRlLCBhbW91bnQgZXRjLiBJZiBubyBmdXJ0aGVyIGRldGFpbHMgYXJlIHJlcXVpcmVkIGZvciB0aGUgbGluZUl0ZW0sIGlubGluZSBiaWxsaW5nIGNvZGVzIGNhbiBiZSBhZGRlZCB1c2luZyB0aGUgQ29kZWFibGVDb25jZXB0IGRhdGEgdHlwZSBpbnN0ZWFkIG9mIHRoZSBSZWZlcmVuY2UuXHJcbiAgICovXHJcbiAgY2hhcmdlSXRlbT86IGZoaXIuUmVmZXJlbmNlfGZoaXIuQ29kZWFibGVDb25jZXB0fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgQ2hhcmdlSXRlbSBjb250YWlucyBpbmZvcm1hdGlvbiBzdWNoIGFzIHRoZSBiaWxsaW5nIGNvZGUsIGRhdGUsIGFtb3VudCBldGMuIElmIG5vIGZ1cnRoZXIgZGV0YWlscyBhcmUgcmVxdWlyZWQgZm9yIHRoZSBsaW5lSXRlbSwgaW5saW5lIGJpbGxpbmcgY29kZXMgY2FuIGJlIGFkZGVkIHVzaW5nIHRoZSBDb2RlYWJsZUNvbmNlcHQgZGF0YSB0eXBlIGluc3RlYWQgb2YgdGhlIFJlZmVyZW5jZS5cclxuICAgKi9cclxuICBjaGFyZ2VJdGVtUmVmZXJlbmNlPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgQ2hhcmdlSXRlbSBjb250YWlucyBpbmZvcm1hdGlvbiBzdWNoIGFzIHRoZSBiaWxsaW5nIGNvZGUsIGRhdGUsIGFtb3VudCBldGMuIElmIG5vIGZ1cnRoZXIgZGV0YWlscyBhcmUgcmVxdWlyZWQgZm9yIHRoZSBsaW5lSXRlbSwgaW5saW5lIGJpbGxpbmcgY29kZXMgY2FuIGJlIGFkZGVkIHVzaW5nIHRoZSBDb2RlYWJsZUNvbmNlcHQgZGF0YSB0eXBlIGluc3RlYWQgb2YgdGhlIFJlZmVyZW5jZS5cclxuICAgKi9cclxuICBjaGFyZ2VJdGVtQ29kZWFibGVDb25jZXB0PzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcHJpY2UgZm9yIGEgQ2hhcmdlSXRlbSBtYXkgYmUgY2FsY3VsYXRlZCBhcyBhIGJhc2UgcHJpY2Ugd2l0aCBzdXJjaGFyZ2VzL2RlZHVjdGlvbnMgdGhhdCBhcHBseSBpbiBjZXJ0YWluIGNvbmRpdGlvbnMuIEEgQ2hhcmdlSXRlbURlZmluaXRpb24gcmVzb3VyY2UgdGhhdCBkZWZpbmVzIHRoZSBwcmljZXMsIGZhY3RvcnMgYW5kIGNvbmRpdGlvbnMgdGhhdCBhcHBseSB0byBhIGJpbGxpbmcgY29kZSBpcyBjdXJyZW50bHkgdW5kZXIgZGV2ZWxvcG1lbnQuIFRoZSBwcmljZUNvbXBvbmVudCBlbGVtZW50IGNhbiBiZSB1c2VkIHRvIG9mZmVyIHRyYW5zcGFyZW5jeSB0byB0aGUgcmVjaXBpZW50IG9mIHRoZSBJbnZvaWNlIGFzIHRvIGhvdyB0aGUgcHJpY2VzIGhhdmUgYmVlbiBjYWxjdWxhdGVkLlxyXG4gICAqL1xyXG4gIHByaWNlQ29tcG9uZW50PzogZmhpci5JbnZvaWNlTGluZUl0ZW1QcmljZUNvbXBvbmVudEFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFYWNoIGxpbmUgaXRlbSByZXByZXNlbnRzIG9uZSBjaGFyZ2UgZm9yIGdvb2RzIGFuZCBzZXJ2aWNlcyByZW5kZXJlZC4gRGV0YWlscyBzdWNoIGFzIGRhdGUsIGNvZGUgYW5kIGFtb3VudCBhcmUgZm91bmQgaW4gdGhlIHJlZmVyZW5jZWQgQ2hhcmdlSXRlbSByZXNvdXJjZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBJbnZvaWNlTGluZUl0ZW0gZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdJbnZvaWNlTGluZUl0ZW0nO1xyXG4gIC8qKlxyXG4gICAqIFNlcXVlbmNlIGluIHdoaWNoIHRoZSBpdGVtcyBhcHBlYXIgb24gdGhlIGludm9pY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHNlcXVlbmNlPzogZmhpci5GaGlyUG9zaXRpdmVJbnR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBDaGFyZ2VJdGVtIGNvbnRhaW5zIGluZm9ybWF0aW9uIHN1Y2ggYXMgdGhlIGJpbGxpbmcgY29kZSwgZGF0ZSwgYW1vdW50IGV0Yy4gSWYgbm8gZnVydGhlciBkZXRhaWxzIGFyZSByZXF1aXJlZCBmb3IgdGhlIGxpbmVJdGVtLCBpbmxpbmUgYmlsbGluZyBjb2RlcyBjYW4gYmUgYWRkZWQgdXNpbmcgdGhlIENvZGVhYmxlQ29uY2VwdCBkYXRhIHR5cGUgaW5zdGVhZCBvZiB0aGUgUmVmZXJlbmNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjaGFyZ2VJdGVtOiAoZmhpci5SZWZlcmVuY2V8Zmhpci5Db2RlYWJsZUNvbmNlcHQpfG51bGw7XHJcbiAgLyoqXHJcbiAgICogSW50ZXJuYWwgZmxhZyB0byBwcm9wZXJseSBzZXJpYWxpemUgY2hvaWNlLXR5cGUgZWxlbWVudCBJbnZvaWNlLmxpbmVJdGVtLmNoYXJnZUl0ZW1beF1cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgc3RhdGljIHJlYWRvbmx5IF9mdHNfY2hhcmdlSXRlbUlzQ2hvaWNlOnRydWUgPSB0cnVlO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwcmljZSBmb3IgYSBDaGFyZ2VJdGVtIG1heSBiZSBjYWxjdWxhdGVkIGFzIGEgYmFzZSBwcmljZSB3aXRoIHN1cmNoYXJnZXMvZGVkdWN0aW9ucyB0aGF0IGFwcGx5IGluIGNlcnRhaW4gY29uZGl0aW9ucy4gQSBDaGFyZ2VJdGVtRGVmaW5pdGlvbiByZXNvdXJjZSB0aGF0IGRlZmluZXMgdGhlIHByaWNlcywgZmFjdG9ycyBhbmQgY29uZGl0aW9ucyB0aGF0IGFwcGx5IHRvIGEgYmlsbGluZyBjb2RlIGlzIGN1cnJlbnRseSB1bmRlciBkZXZlbG9wbWVudC4gVGhlIHByaWNlQ29tcG9uZW50IGVsZW1lbnQgY2FuIGJlIHVzZWQgdG8gb2ZmZXIgdHJhbnNwYXJlbmN5IHRvIHRoZSByZWNpcGllbnQgb2YgdGhlIEludm9pY2UgYXMgdG8gaG93IHRoZSBwcmljZXMgaGF2ZSBiZWVuIGNhbGN1bGF0ZWQuXHJcbiAgICovXHJcbiAgcHVibGljIHByaWNlQ29tcG9uZW50OiBmaGlyLkludm9pY2VMaW5lSXRlbVByaWNlQ29tcG9uZW50W107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgSW52b2ljZUxpbmVJdGVtIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8SW52b2ljZUxpbmVJdGVtQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3NlcXVlbmNlJ10pIHsgdGhpcy5zZXF1ZW5jZSA9IG5ldyBmaGlyLkZoaXJQb3NpdGl2ZUludCh7dmFsdWU6IHNvdXJjZS5zZXF1ZW5jZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfc2VxdWVuY2UnXSkge1xyXG4gICAgICBpZiAodGhpcy5zZXF1ZW5jZSkgeyB0aGlzLnNlcXVlbmNlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3NlcXVlbmNlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuc2VxdWVuY2UgPSBuZXcgZmhpci5GaGlyUG9zaXRpdmVJbnQoc291cmNlLl9zZXF1ZW5jZSBhcyBQYXJ0aWFsPGZoaXIuRmhpclBvc2l0aXZlSW50QXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydjaGFyZ2VJdGVtJ10pIHsgdGhpcy5jaGFyZ2VJdGVtID0gc291cmNlLmNoYXJnZUl0ZW07IH1cclxuICAgIGVsc2UgaWYgKHNvdXJjZVsnY2hhcmdlSXRlbVJlZmVyZW5jZSddKSB7IHRoaXMuY2hhcmdlSXRlbSA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuY2hhcmdlSXRlbVJlZmVyZW5jZSk7IH1cclxuICAgIGVsc2UgaWYgKHNvdXJjZVsnY2hhcmdlSXRlbUNvZGVhYmxlQ29uY2VwdCddKSB7IHRoaXMuY2hhcmdlSXRlbSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UuY2hhcmdlSXRlbUNvZGVhYmxlQ29uY2VwdCk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmNoYXJnZUl0ZW0gPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydwcmljZUNvbXBvbmVudCddKSB7IHRoaXMucHJpY2VDb21wb25lbnQgPSBzb3VyY2UucHJpY2VDb21wb25lbnQubWFwKCh4KSA9PiBuZXcgZmhpci5JbnZvaWNlTGluZUl0ZW1QcmljZUNvbXBvbmVudCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnByaWNlQ29tcG9uZW50ID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbnZvaWNlLmxpbmVJdGVtJyB9XHJcbiAgICB0aGlzLnZPUygnc2VxdWVuY2UnLGV4cClcclxuICAgIHRoaXMudlJTKCdjaGFyZ2VJdGVtJyxleHApXHJcbiAgICB0aGlzLnZPQSgncHJpY2VDb21wb25lbnQnLGV4cClcclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBJbnZvaWNlIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEludm9pY2VBcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJJbnZvaWNlXCJ8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXIgb2YgdGhpcyBJbnZvaWNlLCBvZnRlbiB1c2VkIGZvciByZWZlcmVuY2UgaW4gY29ycmVzcG9uZGVuY2UgYWJvdXQgdGhpcyBpbnZvaWNlIG9yIGZvciB0cmFja2luZyBvZiBwYXltZW50cy5cclxuICAgKi9cclxuICBpZGVudGlmaWVyPzogZmhpci5JZGVudGlmaWVyQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgSW52b2ljZS5cclxuICAgKi9cclxuICBzdGF0dXM6IGZoaXIuRmhpckNvZGU8SW52b2ljZVN0YXR1c0NvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbnZvaWNlLnN0YXR1c1xyXG4gICAqL1xyXG4gIF9zdGF0dXM/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIERlcml2ZWQgUHJvZmlsZXMgbWF5IGNob29zZSB0byBhZGQgaW52YXJpYW50cyByZXF1aXJpbmcgdGhpcyBmaWVsZCB0byBiZSBwb3B1bGF0ZWQgaWYgZWl0aGVyIHByaWNlT3ZlcnJpZGUgb3IgZmFjdG9yT3ZlcnJpZGUgaGF2ZSBiZWVuIGZpbGxlZC5cclxuICAgKi9cclxuICBjYW5jZWxsZWRSZWFzb24/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW52b2ljZS5jYW5jZWxsZWRSZWFzb25cclxuICAgKi9cclxuICBfY2FuY2VsbGVkUmVhc29uPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUeXBlIG9mIEludm9pY2UgZGVwZW5kaW5nIG9uIGRvbWFpbiwgcmVhbG0gYW4gdXNhZ2UgKGUuZy4gaW50ZXJuYWwvZXh0ZXJuYWwsIGRlbnRhbCwgcHJlbGltaW5hcnkpLlxyXG4gICAqL1xyXG4gIHR5cGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBpbmRpdmlkdWFsIG9yIHNldCBvZiBpbmRpdmlkdWFscyByZWNlaXZpbmcgdGhlIGdvb2RzIGFuZCBzZXJ2aWNlcyBiaWxsZWQgaW4gdGhpcyBpbnZvaWNlLlxyXG4gICAqL1xyXG4gIHN1YmplY3Q/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBpbmRpdmlkdWFsIG9yIE9yZ2FuaXphdGlvbiByZXNwb25zaWJsZSBmb3IgYmFsYW5jaW5nIG9mIHRoaXMgaW52b2ljZS5cclxuICAgKi9cclxuICByZWNpcGllbnQ/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBsaXN0IG9mIHR5cGVzIG1heSBiZSBjb25zdHJhaW5lZCBhcyBhcHByb3ByaWF0ZSBmb3IgdGhlIHR5cGUgb2YgY2hhcmdlIGl0ZW0uXHJcbiAgICovXHJcbiAgZGF0ZT86IGZoaXIuRmhpckRhdGVUaW1lfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEludm9pY2UuZGF0ZVxyXG4gICAqL1xyXG4gIF9kYXRlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgd2hvIG9yIHdoYXQgcGVyZm9ybWVkIG9yIHBhcnRpY2lwYXRlZCBpbiB0aGUgY2hhcmdlZCBzZXJ2aWNlLlxyXG4gICAqL1xyXG4gIHBhcnRpY2lwYW50PzogZmhpci5JbnZvaWNlUGFydGljaXBhbnRBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFByYWN0aXRpb25lcnMgYW5kIERldmljZXMgY2FuIGJlIGFzc29jaWF0ZWQgd2l0aCBtdWx0aXBsZSBvcmdhbml6YXRpb25zLiBJdCBoYXMgdG8gYmUgbWFkZSBjbGVhciwgb24gYmVoYWxmIG9mIHdoaWNoIE9yZ2FuaXphdGlvbiB0aGUgc2VydmljZXMgaGF2ZSBiZWVuIHJlbmRlcmVkLlxyXG4gICAqL1xyXG4gIGlzc3Vlcj86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogU3lzdGVtcyBwb3N0aW5nIHRoZSBDaGFyZ2VJdGVtcyBtaWdodCBub3QgYWx3YXlzIGJlIGFibGUgdG8gZGV0ZXJtaW5lLCB3aGljaCBhY2NvdW50cyB0aGUgSXRlbXMgbmVlZCB0byBiZSBwbGFjZXMgaW50by4gSXQgaXMgdXAgdG8gdGhlIHBvdHByb2Nlc3NpbmcgRmluYW5jaWFsIFN5c3RlbSB0byBhcHBseSBpbnRlcm5hbCBydWxlcyB0byBkZWNpZGUgYmFzZWQgb24gdGhlIEVuY291bnRlci9FcGlzb2RlT2ZDYXJlL1BhdGllbnQvQ292ZXJhZ2UgY29udGV4dCBhbmQgdGhlIHR5cGUgb2YgQ2hhcmdlSXRlbSwgd2hpY2ggQWNjb3VudCBpcyBhcHByb3ByaWF0ZS5cclxuICAgKi9cclxuICBhY2NvdW50PzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFYWNoIGxpbmUgaXRlbSByZXByZXNlbnRzIG9uZSBjaGFyZ2UgZm9yIGdvb2RzIGFuZCBzZXJ2aWNlcyByZW5kZXJlZC4gRGV0YWlscyBzdWNoIGFzIGRhdGUsIGNvZGUgYW5kIGFtb3VudCBhcmUgZm91bmQgaW4gdGhlIHJlZmVyZW5jZWQgQ2hhcmdlSXRlbSByZXNvdXJjZS5cclxuICAgKi9cclxuICBsaW5lSXRlbT86IGZoaXIuSW52b2ljZUxpbmVJdGVtQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgdG90YWwgYW1vdW50IGZvciB0aGUgSW52b2ljZSBtYXkgYmUgY2FsY3VsYXRlZCBhcyB0aGUgc3VtIG9mIHRoZSBsaW5lIGl0ZW1zIHdpdGggc3VyY2hhcmdlcy9kZWR1Y3Rpb25zIHRoYXQgYXBwbHkgaW4gY2VydGFpbiBjb25kaXRpb25zLiAgVGhlIHByaWNlQ29tcG9uZW50IGVsZW1lbnQgY2FuIGJlIHVzZWQgdG8gb2ZmZXIgdHJhbnNwYXJlbmN5IHRvIHRoZSByZWNpcGllbnQgb2YgdGhlIEludm9pY2Ugb2YgaG93IHRoZSB0b3RhbCBwcmljZSB3YXMgY2FsY3VsYXRlZC5cclxuICAgKi9cclxuICB0b3RhbFByaWNlQ29tcG9uZW50PzogZmhpci5JbnZvaWNlTGluZUl0ZW1QcmljZUNvbXBvbmVudEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlcmUgaXMgbm8gcmVhc29uIHRvIGNhcnJ5IHRoZSBwcmljZSBpbiB0aGUgaW5zdGFuY2Ugb2YgYSBDaGFyZ2VJdGVtIHVubGVzcyBjaXJjdW1zdGFuY2VzIHJlcXVpcmUgYSBtYW51YWwgb3ZlcnJpZGUuIFRoZSBsaXN0IHByaWNlcyBvciBhcmUgdXN1YWxseSBkZWZpbmVkIGluIGEgYmFjayBjYXRhbG9ndWUgb2YgdGhlIGJpbGxpbmcgY29kZXMgIChzZWUgQ2hhcmdlSXRlbS5kZWZpbml0aW9uKS4gRGVyaXZlZCBwcm9maWxlcyBtYXkgcmVxdWlyZSBhIENoYXJnZUl0ZW0ub3ZlcnJpZGVSZWFzb24gdG8gYmUgcHJvdmlkZWQgaWYgZWl0aGVyIGZhY3RvciBvciBwcmljZSBhcmUgbWFudWFsbHkgb3ZlcnJpZGRlbi5cclxuICAgKi9cclxuICB0b3RhbE5ldD86IGZoaXIuTW9uZXlBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGVyZSBpcyBubyByZWFzb24gdG8gY2FycnkgdGhlIHByaWNlIGluIHRoZSBpbnN0YW5jZSBvZiBhIENoYXJnZUl0ZW0gdW5sZXNzIGNpcmN1bXN0YW5jZXMgcmVxdWlyZSBhIG1hbnVhbCBvdmVycmlkZS4gVGhlIGxpc3QgcHJpY2VzIG9yIGFyZSB1c3VhbGx5IGRlZmluZWQgaW4gYSBiYWNrIGNhdGFsb2d1ZSBvZiB0aGUgYmlsbGluZyBjb2RlcyAgKHNlZSBDaGFyZ2VJdGVtLmRlZmluaXRpb24pLiBEZXJpdmVkIHByb2ZpbGVzIG1heSByZXF1aXJlIGEgQ2hhcmdlSXRlbS5vdmVycmlkZVJlYXNvbiB0byBiZSBwcm92aWRlZCBpZiBlaXRoZXIgZmFjdG9yIG9yIHByaWNlIGFyZSBtYW51YWxseSBvdmVycmlkZGVuLlxyXG4gICAqL1xyXG4gIHRvdGFsR3Jvc3M/OiBmaGlyLk1vbmV5QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVyaXZlZCBQcm9maWxlcyBtYXkgY2hvc2UgdG8gYWRkIGludmFyaWFudHMgcmVxdWlyaW5nIHRoaXMgZmllbGQgdG8gYmUgcG9wdWxhdGVkIGlmIGVpdGhlciBwcmljZU92ZXJyaWRlIG9yIGZhY3Rvck92ZXJyaWRlIGhhdmUgYmVlbiBmaWxsZWQuXHJcbiAgICovXHJcbiAgcGF5bWVudFRlcm1zPzogZmhpci5GaGlyTWFya2Rvd258c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW52b2ljZS5wYXltZW50VGVybXNcclxuICAgKi9cclxuICBfcGF5bWVudFRlcm1zPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBDb21tZW50cyBtYWRlIGFib3V0IHRoZSBpbnZvaWNlIGJ5IHRoZSBpc3N1ZXIsIHN1YmplY3QsIG9yIG90aGVyIHBhcnRpY2lwYW50cy5cclxuICAgKi9cclxuICBub3RlPzogZmhpci5Bbm5vdGF0aW9uQXJnc1tdfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEludm9pY2UgY29udGFpbmluZyBjb2xsZWN0ZWQgQ2hhcmdlSXRlbXMgZnJvbSBhbiBBY2NvdW50IHdpdGggY2FsY3VsYXRlZCBpbmRpdmlkdWFsIGFuZCB0b3RhbCBwcmljZSBmb3IgQmlsbGluZyBwdXJwb3NlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEludm9pY2UgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0ludm9pY2UnO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiSW52b2ljZVwiO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXIgb2YgdGhpcyBJbnZvaWNlLCBvZnRlbiB1c2VkIGZvciByZWZlcmVuY2UgaW4gY29ycmVzcG9uZGVuY2UgYWJvdXQgdGhpcyBpbnZvaWNlIG9yIGZvciB0cmFja2luZyBvZiBwYXltZW50cy5cclxuICAgKi9cclxuICBwdWJsaWMgaWRlbnRpZmllcjogZmhpci5JZGVudGlmaWVyW107XHJcbiAgLyoqXHJcbiAgICogVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIEludm9pY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXR1czogZmhpci5GaGlyQ29kZTxJbnZvaWNlU3RhdHVzQ29kZVR5cGU+fG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGVyaXZlZCBQcm9maWxlcyBtYXkgY2hvb3NlIHRvIGFkZCBpbnZhcmlhbnRzIHJlcXVpcmluZyB0aGlzIGZpZWxkIHRvIGJlIHBvcHVsYXRlZCBpZiBlaXRoZXIgcHJpY2VPdmVycmlkZSBvciBmYWN0b3JPdmVycmlkZSBoYXZlIGJlZW4gZmlsbGVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjYW5jZWxsZWRSZWFzb24/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFR5cGUgb2YgSW52b2ljZSBkZXBlbmRpbmcgb24gZG9tYWluLCByZWFsbSBhbiB1c2FnZSAoZS5nLiBpbnRlcm5hbC9leHRlcm5hbCwgZGVudGFsLCBwcmVsaW1pbmFyeSkuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGluZGl2aWR1YWwgb3Igc2V0IG9mIGluZGl2aWR1YWxzIHJlY2VpdmluZyB0aGUgZ29vZHMgYW5kIHNlcnZpY2VzIGJpbGxlZCBpbiB0aGlzIGludm9pY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHN1YmplY3Q/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGluZGl2aWR1YWwgb3IgT3JnYW5pemF0aW9uIHJlc3BvbnNpYmxlIGZvciBiYWxhbmNpbmcgb2YgdGhpcyBpbnZvaWNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWNpcGllbnQ/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGxpc3Qgb2YgdHlwZXMgbWF5IGJlIGNvbnN0cmFpbmVkIGFzIGFwcHJvcHJpYXRlIGZvciB0aGUgdHlwZSBvZiBjaGFyZ2UgaXRlbS5cclxuICAgKi9cclxuICBwdWJsaWMgZGF0ZT86IGZoaXIuRmhpckRhdGVUaW1lfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgd2hvIG9yIHdoYXQgcGVyZm9ybWVkIG9yIHBhcnRpY2lwYXRlZCBpbiB0aGUgY2hhcmdlZCBzZXJ2aWNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXJ0aWNpcGFudDogZmhpci5JbnZvaWNlUGFydGljaXBhbnRbXTtcclxuICAvKipcclxuICAgKiBQcmFjdGl0aW9uZXJzIGFuZCBEZXZpY2VzIGNhbiBiZSBhc3NvY2lhdGVkIHdpdGggbXVsdGlwbGUgb3JnYW5pemF0aW9ucy4gSXQgaGFzIHRvIGJlIG1hZGUgY2xlYXIsIG9uIGJlaGFsZiBvZiB3aGljaCBPcmdhbml6YXRpb24gdGhlIHNlcnZpY2VzIGhhdmUgYmVlbiByZW5kZXJlZC5cclxuICAgKi9cclxuICBwdWJsaWMgaXNzdWVyPzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFN5c3RlbXMgcG9zdGluZyB0aGUgQ2hhcmdlSXRlbXMgbWlnaHQgbm90IGFsd2F5cyBiZSBhYmxlIHRvIGRldGVybWluZSwgd2hpY2ggYWNjb3VudHMgdGhlIEl0ZW1zIG5lZWQgdG8gYmUgcGxhY2VzIGludG8uIEl0IGlzIHVwIHRvIHRoZSBwb3Rwcm9jZXNzaW5nIEZpbmFuY2lhbCBTeXN0ZW0gdG8gYXBwbHkgaW50ZXJuYWwgcnVsZXMgdG8gZGVjaWRlIGJhc2VkIG9uIHRoZSBFbmNvdW50ZXIvRXBpc29kZU9mQ2FyZS9QYXRpZW50L0NvdmVyYWdlIGNvbnRleHQgYW5kIHRoZSB0eXBlIG9mIENoYXJnZUl0ZW0sIHdoaWNoIEFjY291bnQgaXMgYXBwcm9wcmlhdGUuXHJcbiAgICovXHJcbiAgcHVibGljIGFjY291bnQ/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRWFjaCBsaW5lIGl0ZW0gcmVwcmVzZW50cyBvbmUgY2hhcmdlIGZvciBnb29kcyBhbmQgc2VydmljZXMgcmVuZGVyZWQuIERldGFpbHMgc3VjaCBhcyBkYXRlLCBjb2RlIGFuZCBhbW91bnQgYXJlIGZvdW5kIGluIHRoZSByZWZlcmVuY2VkIENoYXJnZUl0ZW0gcmVzb3VyY2UuXHJcbiAgICovXHJcbiAgcHVibGljIGxpbmVJdGVtOiBmaGlyLkludm9pY2VMaW5lSXRlbVtdO1xyXG4gIC8qKlxyXG4gICAqIFRoZSB0b3RhbCBhbW91bnQgZm9yIHRoZSBJbnZvaWNlIG1heSBiZSBjYWxjdWxhdGVkIGFzIHRoZSBzdW0gb2YgdGhlIGxpbmUgaXRlbXMgd2l0aCBzdXJjaGFyZ2VzL2RlZHVjdGlvbnMgdGhhdCBhcHBseSBpbiBjZXJ0YWluIGNvbmRpdGlvbnMuICBUaGUgcHJpY2VDb21wb25lbnQgZWxlbWVudCBjYW4gYmUgdXNlZCB0byBvZmZlciB0cmFuc3BhcmVuY3kgdG8gdGhlIHJlY2lwaWVudCBvZiB0aGUgSW52b2ljZSBvZiBob3cgdGhlIHRvdGFsIHByaWNlIHdhcyBjYWxjdWxhdGVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0b3RhbFByaWNlQ29tcG9uZW50OiBmaGlyLkludm9pY2VMaW5lSXRlbVByaWNlQ29tcG9uZW50W107XHJcbiAgLyoqXHJcbiAgICogVGhlcmUgaXMgbm8gcmVhc29uIHRvIGNhcnJ5IHRoZSBwcmljZSBpbiB0aGUgaW5zdGFuY2Ugb2YgYSBDaGFyZ2VJdGVtIHVubGVzcyBjaXJjdW1zdGFuY2VzIHJlcXVpcmUgYSBtYW51YWwgb3ZlcnJpZGUuIFRoZSBsaXN0IHByaWNlcyBvciBhcmUgdXN1YWxseSBkZWZpbmVkIGluIGEgYmFjayBjYXRhbG9ndWUgb2YgdGhlIGJpbGxpbmcgY29kZXMgIChzZWUgQ2hhcmdlSXRlbS5kZWZpbml0aW9uKS4gRGVyaXZlZCBwcm9maWxlcyBtYXkgcmVxdWlyZSBhIENoYXJnZUl0ZW0ub3ZlcnJpZGVSZWFzb24gdG8gYmUgcHJvdmlkZWQgaWYgZWl0aGVyIGZhY3RvciBvciBwcmljZSBhcmUgbWFudWFsbHkgb3ZlcnJpZGRlbi5cclxuICAgKi9cclxuICBwdWJsaWMgdG90YWxOZXQ/OiBmaGlyLk1vbmV5fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGVyZSBpcyBubyByZWFzb24gdG8gY2FycnkgdGhlIHByaWNlIGluIHRoZSBpbnN0YW5jZSBvZiBhIENoYXJnZUl0ZW0gdW5sZXNzIGNpcmN1bXN0YW5jZXMgcmVxdWlyZSBhIG1hbnVhbCBvdmVycmlkZS4gVGhlIGxpc3QgcHJpY2VzIG9yIGFyZSB1c3VhbGx5IGRlZmluZWQgaW4gYSBiYWNrIGNhdGFsb2d1ZSBvZiB0aGUgYmlsbGluZyBjb2RlcyAgKHNlZSBDaGFyZ2VJdGVtLmRlZmluaXRpb24pLiBEZXJpdmVkIHByb2ZpbGVzIG1heSByZXF1aXJlIGEgQ2hhcmdlSXRlbS5vdmVycmlkZVJlYXNvbiB0byBiZSBwcm92aWRlZCBpZiBlaXRoZXIgZmFjdG9yIG9yIHByaWNlIGFyZSBtYW51YWxseSBvdmVycmlkZGVuLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0b3RhbEdyb3NzPzogZmhpci5Nb25leXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVyaXZlZCBQcm9maWxlcyBtYXkgY2hvc2UgdG8gYWRkIGludmFyaWFudHMgcmVxdWlyaW5nIHRoaXMgZmllbGQgdG8gYmUgcG9wdWxhdGVkIGlmIGVpdGhlciBwcmljZU92ZXJyaWRlIG9yIGZhY3Rvck92ZXJyaWRlIGhhdmUgYmVlbiBmaWxsZWQuXHJcbiAgICovXHJcbiAgcHVibGljIHBheW1lbnRUZXJtcz86IGZoaXIuRmhpck1hcmtkb3dufHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBDb21tZW50cyBtYWRlIGFib3V0IHRoZSBpbnZvaWNlIGJ5IHRoZSBpc3N1ZXIsIHN1YmplY3QsIG9yIG90aGVyIHBhcnRpY2lwYW50cy5cclxuICAgKi9cclxuICBwdWJsaWMgbm90ZTogZmhpci5Bbm5vdGF0aW9uW107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgSW52b2ljZSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPEludm9pY2VBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnSW52b2ljZSc7XHJcbiAgICBpZiAoc291cmNlWydpZGVudGlmaWVyJ10pIHsgdGhpcy5pZGVudGlmaWVyID0gc291cmNlLmlkZW50aWZpZXIubWFwKCh4KSA9PiBuZXcgZmhpci5JZGVudGlmaWVyKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaWRlbnRpZmllciA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydzdGF0dXMnXSkgeyB0aGlzLnN0YXR1cyA9IG5ldyBmaGlyLkZoaXJDb2RlPEludm9pY2VTdGF0dXNDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2Uuc3RhdHVzfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnN0YXR1cyA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ19zdGF0dXMnXSkge1xyXG4gICAgICBpZiAodGhpcy5zdGF0dXMpIHsgdGhpcy5zdGF0dXMuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fc3RhdHVzISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuc3RhdHVzID0gbmV3IGZoaXIuRmhpckNvZGU8SW52b2ljZVN0YXR1c0NvZGVUeXBlPihzb3VyY2UuX3N0YXR1cyBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnY2FuY2VsbGVkUmVhc29uJ10pIHsgdGhpcy5jYW5jZWxsZWRSZWFzb24gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLmNhbmNlbGxlZFJlYXNvbn0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfY2FuY2VsbGVkUmVhc29uJ10pIHtcclxuICAgICAgaWYgKHRoaXMuY2FuY2VsbGVkUmVhc29uKSB7IHRoaXMuY2FuY2VsbGVkUmVhc29uLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2NhbmNlbGxlZFJlYXNvbiEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmNhbmNlbGxlZFJlYXNvbiA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9jYW5jZWxsZWRSZWFzb24gYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3R5cGUnXSkgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLnR5cGUpOyB9XHJcbiAgICBpZiAoc291cmNlWydzdWJqZWN0J10pIHsgdGhpcy5zdWJqZWN0ID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5zdWJqZWN0KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncmVjaXBpZW50J10pIHsgdGhpcy5yZWNpcGllbnQgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnJlY2lwaWVudCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2RhdGUnXSkgeyB0aGlzLmRhdGUgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoe3ZhbHVlOiBzb3VyY2UuZGF0ZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfZGF0ZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLmRhdGUpIHsgdGhpcy5kYXRlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2RhdGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5kYXRlID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHNvdXJjZS5fZGF0ZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckRhdGVUaW1lQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydwYXJ0aWNpcGFudCddKSB7IHRoaXMucGFydGljaXBhbnQgPSBzb3VyY2UucGFydGljaXBhbnQubWFwKCh4KSA9PiBuZXcgZmhpci5JbnZvaWNlUGFydGljaXBhbnQoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5wYXJ0aWNpcGFudCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydpc3N1ZXInXSkgeyB0aGlzLmlzc3VlciA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuaXNzdWVyKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnYWNjb3VudCddKSB7IHRoaXMuYWNjb3VudCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuYWNjb3VudCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2xpbmVJdGVtJ10pIHsgdGhpcy5saW5lSXRlbSA9IHNvdXJjZS5saW5lSXRlbS5tYXAoKHgpID0+IG5ldyBmaGlyLkludm9pY2VMaW5lSXRlbSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmxpbmVJdGVtID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ3RvdGFsUHJpY2VDb21wb25lbnQnXSkgeyB0aGlzLnRvdGFsUHJpY2VDb21wb25lbnQgPSBzb3VyY2UudG90YWxQcmljZUNvbXBvbmVudC5tYXAoKHgpID0+IG5ldyBmaGlyLkludm9pY2VMaW5lSXRlbVByaWNlQ29tcG9uZW50KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudG90YWxQcmljZUNvbXBvbmVudCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWyd0b3RhbE5ldCddKSB7IHRoaXMudG90YWxOZXQgPSBuZXcgZmhpci5Nb25leShzb3VyY2UudG90YWxOZXQpOyB9XHJcbiAgICBpZiAoc291cmNlWyd0b3RhbEdyb3NzJ10pIHsgdGhpcy50b3RhbEdyb3NzID0gbmV3IGZoaXIuTW9uZXkoc291cmNlLnRvdGFsR3Jvc3MpOyB9XHJcbiAgICBpZiAoc291cmNlWydwYXltZW50VGVybXMnXSkgeyB0aGlzLnBheW1lbnRUZXJtcyA9IG5ldyBmaGlyLkZoaXJNYXJrZG93bih7dmFsdWU6IHNvdXJjZS5wYXltZW50VGVybXN9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3BheW1lbnRUZXJtcyddKSB7XHJcbiAgICAgIGlmICh0aGlzLnBheW1lbnRUZXJtcykgeyB0aGlzLnBheW1lbnRUZXJtcy5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9wYXltZW50VGVybXMhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5wYXltZW50VGVybXMgPSBuZXcgZmhpci5GaGlyTWFya2Rvd24oc291cmNlLl9wYXltZW50VGVybXMgYXMgUGFydGlhbDxmaGlyLkZoaXJNYXJrZG93bkFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnbm90ZSddKSB7IHRoaXMubm90ZSA9IHNvdXJjZS5ub3RlLm1hcCgoeCkgPT4gbmV3IGZoaXIuQW5ub3RhdGlvbih4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLm5vdGUgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ0ludm9pY2UnIH1cclxuICAgIHRoaXMudlJTKCdyZXNvdXJjZVR5cGUnLGV4cClcclxuICAgIHRoaXMudk9BKCdpZGVudGlmaWVyJyxleHApXHJcbiAgICB0aGlzLnZSU1YoJ3N0YXR1cycsZXhwLCdJbnZvaWNlU3RhdHVzJyxJbnZvaWNlU3RhdHVzVnNWYWxpZGF0aW9uLCdyJylcclxuICAgIHRoaXMudk9TKCdjYW5jZWxsZWRSZWFzb24nLGV4cClcclxuICAgIHRoaXMudk9TKCd0eXBlJyxleHApXHJcbiAgICB0aGlzLnZPUygnc3ViamVjdCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ3JlY2lwaWVudCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2RhdGUnLGV4cClcclxuICAgIHRoaXMudk9BKCdwYXJ0aWNpcGFudCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2lzc3VlcicsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2FjY291bnQnLGV4cClcclxuICAgIHRoaXMudk9BKCdsaW5lSXRlbScsZXhwKVxyXG4gICAgdGhpcy52T0EoJ3RvdGFsUHJpY2VDb21wb25lbnQnLGV4cClcclxuICAgIHRoaXMudk9TKCd0b3RhbE5ldCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ3RvdGFsR3Jvc3MnLGV4cClcclxuICAgIHRoaXMudk9TKCdwYXltZW50VGVybXMnLGV4cClcclxuICAgIHRoaXMudk9BKCdub3RlJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4iXX0=