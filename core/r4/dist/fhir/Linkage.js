// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: Linkage
import * as fhir from '../fhir.js';
// @ts-ignore
import { LinkageTypeCodes } from '../fhirValueSets/LinkageTypeCodes.js';
/**
 * Identifies which record considered as the reference to the same real-world occurrence as well as how the items should be evaluated within the collection of linked items.
 */
export class LinkageItem extends fhir.BackboneElement {
    /**
     * Default constructor for LinkageItem - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.FhirCode({ value: source.type });
        }
        else {
            this.type = null;
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirCode(source._type);
            }
        }
        if (source['resource']) {
            this.resource = new fhir.Reference(source.resource);
        }
        else {
            this.resource = null;
        }
    }
    /**
     * Required-bound Value Set for type (Linkage.item.type)
     */
    static get typeRequiredCodes() {
        return LinkageTypeCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'Linkage.item';
        }
        if (!this['type']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property type fhir: Linkage.item.type:code', expression: [expression] });
        }
        if (this['type'] && (!Object.values(LinkageTypeCodes).includes(this.type.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'type (Linkage.item.type) of type code is missing code for Required binding to: LinkageType', expression: [expression] });
        }
        if (this["type"]) {
            issues.push(...this.type.doModelValidation(expression + '.type'));
        }
        if (!this['resource']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resource fhir: Linkage.item.resource:Reference', expression: [expression] });
        }
        if (this["resource"]) {
            issues.push(...this.resource.doModelValidation(expression + '.resource'));
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
LinkageItem._fts_dataType = 'LinkageItem';
/**
 * Identifies two or more records (resource instances) that refer to the same real-world "occurrence".
 */
export class Linkage extends fhir.DomainResource {
    /**
     * Default constructor for Linkage - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Linkage';
        if (source['active']) {
            this.active = new fhir.FhirBoolean({ value: source.active });
        }
        if (source['_active']) {
            if (this.active) {
                this.active.addExtendedProperties(source._active);
            }
            else {
                this.active = new fhir.FhirBoolean(source._active);
            }
        }
        if (source['author']) {
            this.author = new fhir.Reference(source.author);
        }
        if (source['item']) {
            this.item = source.item.map((x) => new fhir.LinkageItem(x));
        }
        else {
            this.item = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'Linkage';
        }
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType fhir: Linkage.resourceType:"Linkage"', expression: [expression] });
        }
        if (this["active"]) {
            issues.push(...this.active.doModelValidation(expression + '.active'));
        }
        if (this["author"]) {
            issues.push(...this.author.doModelValidation(expression + '.author'));
        }
        if (!this['item']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property item fhir: Linkage.item:item', expression: [expression] });
        }
        else if (!Array.isArray(this.item)) {
            issues.push({ severity: 'error', code: 'structure', diagnostics: 'Found scalar in array property item fhir: Linkage.item:item', expression: [expression] });
        }
        else if (this.item.length === 0) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property item fhir: Linkage.item:item', expression: [expression] });
        }
        if (this["item"]) {
            this.item.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.item[${i}]`)); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Linkage._fts_dataType = 'Linkage';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTGlua2FnZS5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvTGlua2FnZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQyx5QkFBeUI7QUFFekIsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFJbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSxnQkFBZ0IsRUFBd0IsTUFBTSxzQ0FBc0MsQ0FBQztBQW1COUY7O0dBRUc7QUFDSCxNQUFNLE9BQU8sV0FBWSxTQUFRLElBQUksQ0FBQyxlQUFlO0lBYW5EOztPQUVHO0lBQ0gsWUFBWSxTQUFrQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUN4RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQXNCLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDNUY7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzFCLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxLQUFNLENBQUMsQ0FBQzthQUFFO2lCQUM3RDtnQkFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBc0IsTUFBTSxDQUFDLEtBQStCLENBQUMsQ0FBQzthQUFFO1NBQ3JHO1FBQ0QsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7U0FBRTthQUMzRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1NBQUU7SUFDaEMsQ0FBQztJQUNEOztPQUVHO0lBQ0ksTUFBTSxLQUFLLGlCQUFpQjtRQUNqQyxPQUFPLGdCQUFnQixDQUFDO0lBQzFCLENBQUM7SUFDRDs7T0FFRztJQUNhLGlCQUFpQixDQUFDLGFBQW9CLEVBQUU7UUFDdEQsSUFBSSxNQUFNLEdBQW1CLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNqRSxJQUFJLFVBQVUsS0FBSyxFQUFFLEVBQUU7WUFBRSxVQUFVLEdBQUcsY0FBYyxDQUFBO1NBQUU7UUFDdEQsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUNqQixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSw2REFBNkQsRUFBRSxVQUFVLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDNUo7UUFDRCxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQVksQ0FBQyxDQUFDLEVBQUU7WUFDdkYsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLGNBQWMsRUFBRSxXQUFXLEVBQUUsNEZBQTRGLEVBQUUsVUFBVSxFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQy9MO1FBQ0QsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUFFO1FBQ3RGLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFDckIsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsMEVBQTBFLEVBQUUsVUFBVSxFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQ3pLO1FBQ0QsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztTQUFFO1FBQ2xHLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7O0FBbEREOztHQUVHO0FBQzZCLHlCQUFhLEdBQVUsYUFBYSxDQUFDO0FBMkV2RTs7R0FFRztBQUNILE1BQU0sT0FBTyxPQUFRLFNBQVEsSUFBSSxDQUFDLGNBQWM7SUFxQjlDOztPQUVHO0lBQ0gsWUFBWSxTQUE4QixFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUNwRixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxZQUFZLEdBQUcsU0FBUyxDQUFDO1FBQzlCLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLE1BQU0sRUFBQyxDQUFDLENBQUM7U0FBRTtRQUNyRixJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUNyQixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsT0FBUSxDQUFDLENBQUM7YUFBRTtpQkFDbkU7Z0JBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQXdDLENBQUMsQ0FBQzthQUFFO1NBQzlGO1FBQ0QsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7U0FBRTtRQUMxRSxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDL0U7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztTQUFFO0lBQzFCLENBQUM7SUFDRDs7T0FFRztJQUNhLGlCQUFpQixDQUFDLGFBQW9CLEVBQUU7UUFDdEQsSUFBSSxNQUFNLEdBQW1CLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNqRSxJQUFJLFVBQVUsS0FBSyxFQUFFLEVBQUU7WUFBRSxVQUFVLEdBQUcsU0FBUyxDQUFBO1NBQUU7UUFDakQsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRTtZQUN6QixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSw2RUFBNkUsRUFBRSxVQUFVLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDNUs7UUFDRCxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsR0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDNUYsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztTQUFFO1FBQzVGLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDakIsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsd0RBQXdELEVBQUUsVUFBVSxFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQ3ZKO2FBQU0sSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3BDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLDZEQUE2RCxFQUFFLFVBQVUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUM3SjthQUFNLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQ2pDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLHdEQUF3RCxFQUFFLFVBQVUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUN2SjtRQUNELElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsR0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQUU7UUFDcEgsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUF2REQ7O0dBRUc7QUFDNkIscUJBQWEsR0FBVSxTQUFTLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjQuY29yZSB2ZXJzaW9uOiA0LjAuMVxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgUmVzb3VyY2U6IExpbmthZ2VcclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IExpbmthZ2VUeXBlQ29kaW5ncywgTGlua2FnZVR5cGVDb2RpbmdUeXBlLH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9MaW5rYWdlVHlwZUNvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IExpbmthZ2VUeXBlQ29kZXMsICBMaW5rYWdlVHlwZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9MaW5rYWdlVHlwZUNvZGVzLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIExpbmthZ2VJdGVtIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIExpbmthZ2VJdGVtQXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogRGlzdGluZ3Vpc2hlcyB3aGljaCBpdGVtIGlzIFwic291cmNlIG9mIHRydXRoXCIgKGlmIGFueSkgYW5kIHdoaWNoIGl0ZW1zIGFyZSBubyBsb25nZXIgY29uc2lkZXJlZCB0byBiZSBjdXJyZW50IHJlcHJlc2VudGF0aW9ucy5cclxuICAgKi9cclxuICB0eXBlOiBmaGlyLkZoaXJDb2RlPExpbmthZ2VUeXBlQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IExpbmthZ2UuaXRlbS50eXBlXHJcbiAgICovXHJcbiAgX3R5cGU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSByZXNvdXJjZSBpbnN0YW5jZSBiZWluZyBsaW5rZWQgYXMgcGFydCBvZiB0aGUgZ3JvdXAuXHJcbiAgICovXHJcbiAgcmVzb3VyY2U6IGZoaXIuUmVmZXJlbmNlQXJnc3xudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogSWRlbnRpZmllcyB3aGljaCByZWNvcmQgY29uc2lkZXJlZCBhcyB0aGUgcmVmZXJlbmNlIHRvIHRoZSBzYW1lIHJlYWwtd29ybGQgb2NjdXJyZW5jZSBhcyB3ZWxsIGFzIGhvdyB0aGUgaXRlbXMgc2hvdWxkIGJlIGV2YWx1YXRlZCB3aXRoaW4gdGhlIGNvbGxlY3Rpb24gb2YgbGlua2VkIGl0ZW1zLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIExpbmthZ2VJdGVtIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnTGlua2FnZUl0ZW0nO1xyXG4gIC8qKlxyXG4gICAqIERpc3Rpbmd1aXNoZXMgd2hpY2ggaXRlbSBpcyBcInNvdXJjZSBvZiB0cnV0aFwiIChpZiBhbnkpIGFuZCB3aGljaCBpdGVtcyBhcmUgbm8gbG9uZ2VyIGNvbnNpZGVyZWQgdG8gYmUgY3VycmVudCByZXByZXNlbnRhdGlvbnMuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU6IGZoaXIuRmhpckNvZGU8TGlua2FnZVR5cGVDb2RlVHlwZT58bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgcmVzb3VyY2UgaW5zdGFuY2UgYmVpbmcgbGlua2VkIGFzIHBhcnQgb2YgdGhlIGdyb3VwLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZXNvdXJjZTogZmhpci5SZWZlcmVuY2V8bnVsbDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBMaW5rYWdlSXRlbSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPExpbmthZ2VJdGVtQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3R5cGUnXSkgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5GaGlyQ29kZTxMaW5rYWdlVHlwZUNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS50eXBlfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfdHlwZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnR5cGUpIHsgdGhpcy50eXBlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3R5cGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy50eXBlID0gbmV3IGZoaXIuRmhpckNvZGU8TGlua2FnZVR5cGVDb2RlVHlwZT4oc291cmNlLl90eXBlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydyZXNvdXJjZSddKSB7IHRoaXMucmVzb3VyY2UgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnJlc291cmNlKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucmVzb3VyY2UgPSBudWxsOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFJlcXVpcmVkLWJvdW5kIFZhbHVlIFNldCBmb3IgdHlwZSAoTGlua2FnZS5pdGVtLnR5cGUpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXQgdHlwZVJlcXVpcmVkQ29kZXMoKSB7XHJcbiAgICByZXR1cm4gTGlua2FnZVR5cGVDb2RlcztcclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb246c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24pO1xyXG4gICAgaWYgKGV4cHJlc3Npb24gPT09ICcnKSB7IGV4cHJlc3Npb24gPSAnTGlua2FnZS5pdGVtJyB9XHJcbiAgICBpZiAoIXRoaXNbJ3R5cGUnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgdHlwZSBmaGlyOiBMaW5rYWdlLml0ZW0udHlwZTpjb2RlJywgZXhwcmVzc2lvbjogW2V4cHJlc3Npb25dIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbJ3R5cGUnXSAmJiAoIU9iamVjdC52YWx1ZXMoTGlua2FnZVR5cGVDb2RlcykuaW5jbHVkZXModGhpcy50eXBlLnZhbHVlIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ3R5cGUgKExpbmthZ2UuaXRlbS50eXBlKSBvZiB0eXBlIGNvZGUgaXMgbWlzc2luZyBjb2RlIGZvciBSZXF1aXJlZCBiaW5kaW5nIHRvOiBMaW5rYWdlVHlwZScsIGV4cHJlc3Npb246IFtleHByZXNzaW9uXSB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1widHlwZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnR5cGUuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLnR5cGUnKSk7IH1cclxuICAgIGlmICghdGhpc1sncmVzb3VyY2UnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgcmVzb3VyY2UgZmhpcjogTGlua2FnZS5pdGVtLnJlc291cmNlOlJlZmVyZW5jZScsIGV4cHJlc3Npb246IFtleHByZXNzaW9uXSB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wicmVzb3VyY2VcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5yZXNvdXJjZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycucmVzb3VyY2UnKSk7IH1cclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBMaW5rYWdlIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIExpbmthZ2VBcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJMaW5rYWdlXCJ8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElmIGZhbHNlLCBhbnkgYXNzZXJ0ZWQgbGlua2FnZXMgc2hvdWxkIG5vdCBiZSBjb25zaWRlcmVkIGN1cnJlbnQvcmVsZXZhbnQvYXBwbGljYWJsZS5cclxuICAgKi9cclxuICBhY3RpdmU/OiBmaGlyLkZoaXJCb29sZWFufGJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBMaW5rYWdlLmFjdGl2ZVxyXG4gICAqL1xyXG4gIF9hY3RpdmU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXMgdGhlIHVzZXIgb3Igb3JnYW5pemF0aW9uIHJlc3BvbnNpYmxlIGZvciBhc3NlcnRpbmcgdGhlIGxpbmthZ2VzIGFzIHdlbGwgYXMgdGhlIHVzZXIgb3Igb3JnYW5pemF0aW9uIHdobyBlc3RhYmxpc2hlcyB0aGUgY29udGV4dCBpbiB3aGljaCB0aGUgbmF0dXJlIG9mIGVhY2ggbGlua2FnZSBpcyBldmFsdWF0ZWQuXHJcbiAgICovXHJcbiAgYXV0aG9yPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJZGVudGlmaWVzIHdoaWNoIHJlY29yZCBjb25zaWRlcmVkIGFzIHRoZSByZWZlcmVuY2UgdG8gdGhlIHNhbWUgcmVhbC13b3JsZCBvY2N1cnJlbmNlIGFzIHdlbGwgYXMgaG93IHRoZSBpdGVtcyBzaG91bGQgYmUgZXZhbHVhdGVkIHdpdGhpbiB0aGUgY29sbGVjdGlvbiBvZiBsaW5rZWQgaXRlbXMuXHJcbiAgICovXHJcbiAgaXRlbTogZmhpci5MaW5rYWdlSXRlbUFyZ3NbXXxudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogSWRlbnRpZmllcyB0d28gb3IgbW9yZSByZWNvcmRzIChyZXNvdXJjZSBpbnN0YW5jZXMpIHRoYXQgcmVmZXIgdG8gdGhlIHNhbWUgcmVhbC13b3JsZCBcIm9jY3VycmVuY2VcIi5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBMaW5rYWdlIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdMaW5rYWdlJztcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzb3VyY2VUeXBlOiBcIkxpbmthZ2VcIjtcclxuICAvKipcclxuICAgKiBJZiBmYWxzZSwgYW55IGFzc2VydGVkIGxpbmthZ2VzIHNob3VsZCBub3QgYmUgY29uc2lkZXJlZCBjdXJyZW50L3JlbGV2YW50L2FwcGxpY2FibGUuXHJcbiAgICovXHJcbiAgcHVibGljIGFjdGl2ZT86IGZoaXIuRmhpckJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXMgdGhlIHVzZXIgb3Igb3JnYW5pemF0aW9uIHJlc3BvbnNpYmxlIGZvciBhc3NlcnRpbmcgdGhlIGxpbmthZ2VzIGFzIHdlbGwgYXMgdGhlIHVzZXIgb3Igb3JnYW5pemF0aW9uIHdobyBlc3RhYmxpc2hlcyB0aGUgY29udGV4dCBpbiB3aGljaCB0aGUgbmF0dXJlIG9mIGVhY2ggbGlua2FnZSBpcyBldmFsdWF0ZWQuXHJcbiAgICovXHJcbiAgcHVibGljIGF1dGhvcj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJZGVudGlmaWVzIHdoaWNoIHJlY29yZCBjb25zaWRlcmVkIGFzIHRoZSByZWZlcmVuY2UgdG8gdGhlIHNhbWUgcmVhbC13b3JsZCBvY2N1cnJlbmNlIGFzIHdlbGwgYXMgaG93IHRoZSBpdGVtcyBzaG91bGQgYmUgZXZhbHVhdGVkIHdpdGhpbiB0aGUgY29sbGVjdGlvbiBvZiBsaW5rZWQgaXRlbXMuXHJcbiAgICovXHJcbiAgcHVibGljIGl0ZW06IGZoaXIuTGlua2FnZUl0ZW1bXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBMaW5rYWdlIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8TGlua2FnZUFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdMaW5rYWdlJztcclxuICAgIGlmIChzb3VyY2VbJ2FjdGl2ZSddKSB7IHRoaXMuYWN0aXZlID0gbmV3IGZoaXIuRmhpckJvb2xlYW4oe3ZhbHVlOiBzb3VyY2UuYWN0aXZlfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19hY3RpdmUnXSkge1xyXG4gICAgICBpZiAodGhpcy5hY3RpdmUpIHsgdGhpcy5hY3RpdmUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fYWN0aXZlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuYWN0aXZlID0gbmV3IGZoaXIuRmhpckJvb2xlYW4oc291cmNlLl9hY3RpdmUgYXMgUGFydGlhbDxmaGlyLkZoaXJCb29sZWFuQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydhdXRob3InXSkgeyB0aGlzLmF1dGhvciA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuYXV0aG9yKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaXRlbSddKSB7IHRoaXMuaXRlbSA9IHNvdXJjZS5pdGVtLm1hcCgoeCkgPT4gbmV3IGZoaXIuTGlua2FnZUl0ZW0oeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5pdGVtID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb246c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24pO1xyXG4gICAgaWYgKGV4cHJlc3Npb24gPT09ICcnKSB7IGV4cHJlc3Npb24gPSAnTGlua2FnZScgfVxyXG4gICAgaWYgKCF0aGlzWydyZXNvdXJjZVR5cGUnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgcmVzb3VyY2VUeXBlIGZoaXI6IExpbmthZ2UucmVzb3VyY2VUeXBlOlwiTGlua2FnZVwiJywgZXhwcmVzc2lvbjogW2V4cHJlc3Npb25dIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJhY3RpdmVcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5hY3RpdmUuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLmFjdGl2ZScpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJhdXRob3JcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5hdXRob3IuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLmF1dGhvcicpKTsgfVxyXG4gICAgaWYgKCF0aGlzWydpdGVtJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IGl0ZW0gZmhpcjogTGlua2FnZS5pdGVtOml0ZW0nLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9IGVsc2UgaWYgKCFBcnJheS5pc0FycmF5KHRoaXMuaXRlbSkpIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3N0cnVjdHVyZScsIGRpYWdub3N0aWNzOiAnRm91bmQgc2NhbGFyIGluIGFycmF5IHByb3BlcnR5IGl0ZW0gZmhpcjogTGlua2FnZS5pdGVtOml0ZW0nLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXRlbS5sZW5ndGggPT09IDApIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IGl0ZW0gZmhpcjogTGlua2FnZS5pdGVtOml0ZW0nLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcIml0ZW1cIl0pIHsgdGhpcy5pdGVtLmZvckVhY2goKHgsaSkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rYC5pdGVtWyR7aX1dYCkpOyB9KSB9XHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4iXX0=