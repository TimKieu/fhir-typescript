// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: Linkage
import * as fhir from '../fhir.js';
// @ts-ignore
import { LinkageTypeCodes } from '../fhirValueSets/LinkageTypeCodes.js';
/**
 * Identifies which record considered as the reference to the same real-world occurrence as well as how the items should be evaluated within the collection of linked items.
 */
export class LinkageItem extends fhir.BackboneElement {
    /**
     * Default constructor for LinkageItem - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.FhirCode({ value: source.type });
        }
        else {
            this.type = null;
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirCode(source._type);
            }
        }
        if (source['resource']) {
            this.resource = new fhir.Reference(source.resource);
        }
        else {
            this.resource = null;
        }
    }
    /**
     * Required-bound Value Set for type (Linkage.item.type)
     */
    static get typeRequiredCodes() {
        return LinkageTypeCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (!this['type']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property type:fhir.FhirCode<LinkageTypeCodeType> fhir: Linkage.item.type:code' });
        }
        if (this['type'] && (!Object.values(LinkageTypeCodes).includes(this.type))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property type:fhir.FhirCode<LinkageTypeCodeType> fhir: Linkage.item.type:code Required binding to: LinkageType' });
        }
        if (this["type"]) {
            issues.push(...this.type.doModelValidation());
        }
        if (!this['resource']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resource:fhir.Reference fhir: Linkage.item.resource:Reference' });
        }
        if (this["resource"]) {
            issues.push(...this.resource.doModelValidation());
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
LinkageItem._fts_dataType = 'LinkageItem';
/**
 * Identifies two or more records (resource instances) that refer to the same real-world "occurrence".
 */
export class Linkage extends fhir.DomainResource {
    /**
     * Default constructor for Linkage - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Linkage';
        if (source['active']) {
            this.active = new fhir.FhirBoolean({ value: source.active });
        }
        if (source['_active']) {
            if (this.active) {
                this.active.addExtendedProperties(source._active);
            }
            else {
                this.active = new fhir.FhirBoolean(source._active);
            }
        }
        if (source['author']) {
            this.author = new fhir.Reference(source.author);
        }
        if (source['item']) {
            this.item = source.item.map((x) => new fhir.LinkageItem(x));
        }
        else {
            this.item = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType:"Linkage" fhir: Linkage.resourceType:"Linkage"' });
        }
        if (this["active"]) {
            issues.push(...this.active.doModelValidation());
        }
        if (this["author"]) {
            issues.push(...this.author.doModelValidation());
        }
        if (!this['item']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property item:fhir.LinkageItem[] fhir: Linkage.item:item' });
        }
        else if (!Array.isArray(this.item)) {
            issues.push({ severity: 'error', code: 'structure', diagnostics: 'Found scalar in array property item:fhir.LinkageItem[] fhir: Linkage.item:item' });
        }
        else if (this.item.length === 0) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property item:fhir.LinkageItem[] fhir: Linkage.item:item' });
        }
        if (this["item"]) {
            this.item.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Linkage._fts_dataType = 'Linkage';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTGlua2FnZS5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvTGlua2FnZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQyx5QkFBeUI7QUFFekIsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFJbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSxnQkFBZ0IsRUFBd0IsTUFBTSxzQ0FBc0MsQ0FBQztBQW1COUY7O0dBRUc7QUFDSCxNQUFNLE9BQU8sV0FBWSxTQUFRLElBQUksQ0FBQyxlQUFlO0lBYW5EOztPQUVHO0lBQ0gsWUFBWSxTQUFrQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUN4RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQXNCLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDNUY7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzFCLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxLQUFNLENBQUMsQ0FBQzthQUFFO2lCQUM3RDtnQkFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBc0IsTUFBTSxDQUFDLEtBQStCLENBQUMsQ0FBQzthQUFFO1NBQ3JHO1FBQ0QsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENB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LElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQ2pDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLDJFQUEyRSxFQUFFLENBQUMsQ0FBQztTQUNoSjtRQUNELElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7U0FBRTtRQUMxRixPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDOztBQXRERDs7R0FFRztBQUM2QixxQkFBYSxHQUFVLFNBQVMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yNC5jb3JlIHZlcnNpb246IDQuMC4xXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogTGlua2FnZVxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTGlua2FnZVR5cGVDb2RpbmdzLCBMaW5rYWdlVHlwZUNvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0xpbmthZ2VUeXBlQ29kaW5ncy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTGlua2FnZVR5cGVDb2RlcywgIExpbmthZ2VUeXBlQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0xpbmthZ2VUeXBlQ29kZXMuanMnO1xyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgTGlua2FnZUl0ZW0gdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGlua2FnZUl0ZW1BcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBEaXN0aW5ndWlzaGVzIHdoaWNoIGl0ZW0gaXMgXCJzb3VyY2Ugb2YgdHJ1dGhcIiAoaWYgYW55KSBhbmQgd2hpY2ggaXRlbXMgYXJlIG5vIGxvbmdlciBjb25zaWRlcmVkIHRvIGJlIGN1cnJlbnQgcmVwcmVzZW50YXRpb25zLlxyXG4gICAqL1xyXG4gIHR5cGU6IGZoaXIuRmhpckNvZGU8TGlua2FnZVR5cGVDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogTGlua2FnZS5pdGVtLnR5cGVcclxuICAgKi9cclxuICBfdHlwZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVGhlIHJlc291cmNlIGluc3RhbmNlIGJlaW5nIGxpbmtlZCBhcyBwYXJ0IG9mIHRoZSBncm91cC5cclxuICAgKi9cclxuICByZXNvdXJjZTogZmhpci5SZWZlcmVuY2VBcmdzfG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJZGVudGlmaWVzIHdoaWNoIHJlY29yZCBjb25zaWRlcmVkIGFzIHRoZSByZWZlcmVuY2UgdG8gdGhlIHNhbWUgcmVhbC13b3JsZCBvY2N1cnJlbmNlIGFzIHdlbGwgYXMgaG93IHRoZSBpdGVtcyBzaG91bGQgYmUgZXZhbHVhdGVkIHdpdGhpbiB0aGUgY29sbGVjdGlvbiBvZiBsaW5rZWQgaXRlbXMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTGlua2FnZUl0ZW0gZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdMaW5rYWdlSXRlbSc7XHJcbiAgLyoqXHJcbiAgICogRGlzdGluZ3Vpc2hlcyB3aGljaCBpdGVtIGlzIFwic291cmNlIG9mIHRydXRoXCIgKGlmIGFueSkgYW5kIHdoaWNoIGl0ZW1zIGFyZSBubyBsb25nZXIgY29uc2lkZXJlZCB0byBiZSBjdXJyZW50IHJlcHJlc2VudGF0aW9ucy5cclxuICAgKi9cclxuICBwdWJsaWMgdHlwZTogZmhpci5GaGlyQ29kZTxMaW5rYWdlVHlwZUNvZGVUeXBlPnxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSByZXNvdXJjZSBpbnN0YW5jZSBiZWluZyBsaW5rZWQgYXMgcGFydCBvZiB0aGUgZ3JvdXAuXHJcbiAgICovXHJcbiAgcHVibGljIHJlc291cmNlOiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIExpbmthZ2VJdGVtIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8TGlua2FnZUl0ZW1BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkZoaXJDb2RlPExpbmthZ2VUeXBlQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLnR5cGV9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudHlwZSA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ190eXBlJ10pIHtcclxuICAgICAgaWYgKHRoaXMudHlwZSkgeyB0aGlzLnR5cGUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdHlwZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5GaGlyQ29kZTxMaW5rYWdlVHlwZUNvZGVUeXBlPihzb3VyY2UuX3R5cGUgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3Jlc291cmNlJ10pIHsgdGhpcy5yZXNvdXJjZSA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UucmVzb3VyY2UpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5yZXNvdXJjZSA9IG51bGw7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogUmVxdWlyZWQtYm91bmQgVmFsdWUgU2V0IGZvciB0eXBlIChMaW5rYWdlLml0ZW0udHlwZSlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCB0eXBlUmVxdWlyZWRDb2RlcygpIHtcclxuICAgIHJldHVybiBMaW5rYWdlVHlwZUNvZGVzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbigpO1xyXG4gICAgaWYgKCF0aGlzWyd0eXBlJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHR5cGU6Zmhpci5GaGlyQ29kZTxMaW5rYWdlVHlwZUNvZGVUeXBlPiBmaGlyOiBMaW5rYWdlLml0ZW0udHlwZTpjb2RlJyB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzWyd0eXBlJ10gJiYgKCFPYmplY3QudmFsdWVzKExpbmthZ2VUeXBlQ29kZXMpLmluY2x1ZGVzKHRoaXMudHlwZSBhcyBhbnkpKSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAnY29kZS1pbnZhbGlkJywgZGlhZ25vc3RpY3M6ICdJbnZhbGlkIGNvZGUgcHJvcGVydHkgdHlwZTpmaGlyLkZoaXJDb2RlPExpbmthZ2VUeXBlQ29kZVR5cGU+IGZoaXI6IExpbmthZ2UuaXRlbS50eXBlOmNvZGUgUmVxdWlyZWQgYmluZGluZyB0bzogTGlua2FnZVR5cGUnIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJ0eXBlXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMudHlwZS5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKCF0aGlzWydyZXNvdXJjZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSByZXNvdXJjZTpmaGlyLlJlZmVyZW5jZSBmaGlyOiBMaW5rYWdlLml0ZW0ucmVzb3VyY2U6UmVmZXJlbmNlJyB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wicmVzb3VyY2VcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5yZXNvdXJjZS5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIExpbmthZ2UgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGlua2FnZUFyZ3MgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlQXJncyB7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcmVzb3VyY2VUeXBlOiBcIkxpbmthZ2VcInx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWYgZmFsc2UsIGFueSBhc3NlcnRlZCBsaW5rYWdlcyBzaG91bGQgbm90IGJlIGNvbnNpZGVyZWQgY3VycmVudC9yZWxldmFudC9hcHBsaWNhYmxlLlxyXG4gICAqL1xyXG4gIGFjdGl2ZT86IGZoaXIuRmhpckJvb2xlYW58Ym9vbGVhbnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IExpbmthZ2UuYWN0aXZlXHJcbiAgICovXHJcbiAgX2FjdGl2ZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogSWRlbnRpZmllcyB0aGUgdXNlciBvciBvcmdhbml6YXRpb24gcmVzcG9uc2libGUgZm9yIGFzc2VydGluZyB0aGUgbGlua2FnZXMgYXMgd2VsbCBhcyB0aGUgdXNlciBvciBvcmdhbml6YXRpb24gd2hvIGVzdGFibGlzaGVzIHRoZSBjb250ZXh0IGluIHdoaWNoIHRoZSBuYXR1cmUgb2YgZWFjaCBsaW5rYWdlIGlzIGV2YWx1YXRlZC5cclxuICAgKi9cclxuICBhdXRob3I/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXMgd2hpY2ggcmVjb3JkIGNvbnNpZGVyZWQgYXMgdGhlIHJlZmVyZW5jZSB0byB0aGUgc2FtZSByZWFsLXdvcmxkIG9jY3VycmVuY2UgYXMgd2VsbCBhcyBob3cgdGhlIGl0ZW1zIHNob3VsZCBiZSBldmFsdWF0ZWQgd2l0aGluIHRoZSBjb2xsZWN0aW9uIG9mIGxpbmtlZCBpdGVtcy5cclxuICAgKi9cclxuICBpdGVtOiBmaGlyLkxpbmthZ2VJdGVtQXJnc1tdfG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJZGVudGlmaWVzIHR3byBvciBtb3JlIHJlY29yZHMgKHJlc291cmNlIGluc3RhbmNlcykgdGhhdCByZWZlciB0byB0aGUgc2FtZSByZWFsLXdvcmxkIFwib2NjdXJyZW5jZVwiLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIExpbmthZ2UgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0xpbmthZ2UnO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiTGlua2FnZVwiO1xyXG4gIC8qKlxyXG4gICAqIElmIGZhbHNlLCBhbnkgYXNzZXJ0ZWQgbGlua2FnZXMgc2hvdWxkIG5vdCBiZSBjb25zaWRlcmVkIGN1cnJlbnQvcmVsZXZhbnQvYXBwbGljYWJsZS5cclxuICAgKi9cclxuICBwdWJsaWMgYWN0aXZlPzogZmhpci5GaGlyQm9vbGVhbnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWRlbnRpZmllcyB0aGUgdXNlciBvciBvcmdhbml6YXRpb24gcmVzcG9uc2libGUgZm9yIGFzc2VydGluZyB0aGUgbGlua2FnZXMgYXMgd2VsbCBhcyB0aGUgdXNlciBvciBvcmdhbml6YXRpb24gd2hvIGVzdGFibGlzaGVzIHRoZSBjb250ZXh0IGluIHdoaWNoIHRoZSBuYXR1cmUgb2YgZWFjaCBsaW5rYWdlIGlzIGV2YWx1YXRlZC5cclxuICAgKi9cclxuICBwdWJsaWMgYXV0aG9yPzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXMgd2hpY2ggcmVjb3JkIGNvbnNpZGVyZWQgYXMgdGhlIHJlZmVyZW5jZSB0byB0aGUgc2FtZSByZWFsLXdvcmxkIG9jY3VycmVuY2UgYXMgd2VsbCBhcyBob3cgdGhlIGl0ZW1zIHNob3VsZCBiZSBldmFsdWF0ZWQgd2l0aGluIHRoZSBjb2xsZWN0aW9uIG9mIGxpbmtlZCBpdGVtcy5cclxuICAgKi9cclxuICBwdWJsaWMgaXRlbTogZmhpci5MaW5rYWdlSXRlbVtdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIExpbmthZ2UgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxMaW5rYWdlQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIHRoaXMucmVzb3VyY2VUeXBlID0gJ0xpbmthZ2UnO1xyXG4gICAgaWYgKHNvdXJjZVsnYWN0aXZlJ10pIHsgdGhpcy5hY3RpdmUgPSBuZXcgZmhpci5GaGlyQm9vbGVhbih7dmFsdWU6IHNvdXJjZS5hY3RpdmV9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2FjdGl2ZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLmFjdGl2ZSkgeyB0aGlzLmFjdGl2ZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9hY3RpdmUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5hY3RpdmUgPSBuZXcgZmhpci5GaGlyQm9vbGVhbihzb3VyY2UuX2FjdGl2ZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckJvb2xlYW5BcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2F1dGhvciddKSB7IHRoaXMuYXV0aG9yID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5hdXRob3IpOyB9XHJcbiAgICBpZiAoc291cmNlWydpdGVtJ10pIHsgdGhpcy5pdGVtID0gc291cmNlLml0ZW0ubWFwKCh4KSA9PiBuZXcgZmhpci5MaW5rYWdlSXRlbSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLml0ZW0gPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbigpO1xyXG4gICAgaWYgKCF0aGlzWydyZXNvdXJjZVR5cGUnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgcmVzb3VyY2VUeXBlOlwiTGlua2FnZVwiIGZoaXI6IExpbmthZ2UucmVzb3VyY2VUeXBlOlwiTGlua2FnZVwiJyB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wiYWN0aXZlXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMuYWN0aXZlLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1tcImF1dGhvclwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmF1dGhvci5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKCF0aGlzWydpdGVtJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IGl0ZW06Zmhpci5MaW5rYWdlSXRlbVtdIGZoaXI6IExpbmthZ2UuaXRlbTppdGVtJyB9KTtcclxuICAgIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5pdGVtKSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAnc3RydWN0dXJlJywgZGlhZ25vc3RpY3M6ICdGb3VuZCBzY2FsYXIgaW4gYXJyYXkgcHJvcGVydHkgaXRlbTpmaGlyLkxpbmthZ2VJdGVtW10gZmhpcjogTGlua2FnZS5pdGVtOml0ZW0nIH0pO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLml0ZW0ubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSBpdGVtOmZoaXIuTGlua2FnZUl0ZW1bXSBmaGlyOiBMaW5rYWdlLml0ZW06aXRlbScgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcIml0ZW1cIl0pIHsgdGhpcy5pdGVtLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuIl19