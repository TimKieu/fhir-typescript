// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: CatalogEntry
import * as fhir from '../fhir.js';
// @ts-ignore
import { RelationTypeCodes } from '../fhirValueSets/RelationTypeCodes.js';
// @ts-ignore
import { PublicationStatusCodes } from '../fhirValueSets/PublicationStatusCodes.js';
/**
 * Used for example, to point to a substance, or to a device used to administer a medication.
 */
export class CatalogEntryRelatedEntry extends fhir.BackboneElement {
    /**
     * Default constructor for CatalogEntryRelatedEntry - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['relationtype']) {
            this.relationtype = new fhir.FhirCode({ value: source.relationtype });
        }
        else {
            this.relationtype = null;
        }
        if (source['_relationtype']) {
            if (this.relationtype) {
                this.relationtype.addExtendedProperties(source._relationtype);
            }
            else {
                this.relationtype = new fhir.FhirCode(source._relationtype);
            }
        }
        if (source['item']) {
            this.item = new fhir.Reference(source.item);
        }
        else {
            this.item = null;
        }
    }
    /**
     * Required-bound Value Set for relationtype (CatalogEntry.relatedEntry.relationtype)
     */
    static get relationtypeRequiredCodes() {
        return RelationTypeCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'CatalogEntry.relatedEntry';
        }
        if (!this['relationtype']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property relationtype fhir: CatalogEntry.relatedEntry.relationtype:code', expression: [expression] });
        }
        if (this['relationtype'] && (!Object.values(RelationTypeCodes).includes(this.relationtype.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property relationtype fhir: CatalogEntry.relatedEntry.relationtype:code Required binding to: RelationType', expression: [expression] });
        }
        if (this["relationtype"]) {
            issues.push(...this.relationtype.doModelValidation(expression + '.relationtype'));
        }
        if (!this['item']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property item fhir: CatalogEntry.relatedEntry.item:Reference', expression: [expression] });
        }
        if (this["item"]) {
            issues.push(...this.item.doModelValidation(expression + '.item'));
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
CatalogEntryRelatedEntry._fts_dataType = 'CatalogEntryRelatedEntry';
/**
 * Catalog entries are wrappers that contextualize items included in a catalog.
 */
export class CatalogEntry extends fhir.DomainResource {
    /**
     * Default constructor for CatalogEntry - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'CatalogEntry';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        if (source['orderable']) {
            this.orderable = new fhir.FhirBoolean({ value: source.orderable });
        }
        else {
            this.orderable = null;
        }
        if (source['_orderable']) {
            if (this.orderable) {
                this.orderable.addExtendedProperties(source._orderable);
            }
            else {
                this.orderable = new fhir.FhirBoolean(source._orderable);
            }
        }
        if (source['referencedItem']) {
            this.referencedItem = new fhir.Reference(source.referencedItem);
        }
        else {
            this.referencedItem = null;
        }
        if (source['additionalIdentifier']) {
            this.additionalIdentifier = source.additionalIdentifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.additionalIdentifier = [];
        }
        if (source['classification']) {
            this.classification = source.classification.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.classification = [];
        }
        if (source['status']) {
            this.status = new fhir.FhirCode({ value: source.status });
        }
        if (source['_status']) {
            if (this.status) {
                this.status.addExtendedProperties(source._status);
            }
            else {
                this.status = new fhir.FhirCode(source._status);
            }
        }
        if (source['validityPeriod']) {
            this.validityPeriod = new fhir.Period(source.validityPeriod);
        }
        if (source['validTo']) {
            this.validTo = new fhir.FhirDateTime({ value: source.validTo });
        }
        if (source['_validTo']) {
            if (this.validTo) {
                this.validTo.addExtendedProperties(source._validTo);
            }
            else {
                this.validTo = new fhir.FhirDateTime(source._validTo);
            }
        }
        if (source['lastUpdated']) {
            this.lastUpdated = new fhir.FhirDateTime({ value: source.lastUpdated });
        }
        if (source['_lastUpdated']) {
            if (this.lastUpdated) {
                this.lastUpdated.addExtendedProperties(source._lastUpdated);
            }
            else {
                this.lastUpdated = new fhir.FhirDateTime(source._lastUpdated);
            }
        }
        if (source['additionalCharacteristic']) {
            this.additionalCharacteristic = source.additionalCharacteristic.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.additionalCharacteristic = [];
        }
        if (source['additionalClassification']) {
            this.additionalClassification = source.additionalClassification.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.additionalClassification = [];
        }
        if (source['relatedEntry']) {
            this.relatedEntry = source.relatedEntry.map((x) => new fhir.CatalogEntryRelatedEntry(x));
        }
        else {
            this.relatedEntry = [];
        }
    }
    /**
     * Required-bound Value Set for status (CatalogEntry.status)
     */
    static get statusRequiredCodes() {
        return PublicationStatusCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'CatalogEntry';
        }
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType fhir: CatalogEntry.resourceType:"CatalogEntry"', expression: [expression] });
        }
        if (this["identifier"]) {
            this.identifier.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.identifier[${i}]`)); });
        }
        if (this["type"]) {
            issues.push(...this.type.doModelValidation(expression + '.type'));
        }
        if (!this['orderable']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property orderable fhir: CatalogEntry.orderable:boolean', expression: [expression] });
        }
        if (this["orderable"]) {
            issues.push(...this.orderable.doModelValidation(expression + '.orderable'));
        }
        if (!this['referencedItem']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property referencedItem fhir: CatalogEntry.referencedItem:Reference', expression: [expression] });
        }
        if (this["referencedItem"]) {
            issues.push(...this.referencedItem.doModelValidation(expression + '.referencedItem'));
        }
        if (this["additionalIdentifier"]) {
            this.additionalIdentifier.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.additionalIdentifier[${i}]`)); });
        }
        if (this["classification"]) {
            this.classification.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.classification[${i}]`)); });
        }
        if (this['status'] && (!Object.values(PublicationStatusCodes).includes(this.status.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property status fhir: CatalogEntry.status:code Required binding to: PublicationStatus', expression: [expression] });
        }
        if (this["status"]) {
            issues.push(...this.status.doModelValidation(expression + '.status'));
        }
        if (this["validityPeriod"]) {
            issues.push(...this.validityPeriod.doModelValidation(expression + '.validityPeriod'));
        }
        if (this["validTo"]) {
            issues.push(...this.validTo.doModelValidation(expression + '.validTo'));
        }
        if (this["lastUpdated"]) {
            issues.push(...this.lastUpdated.doModelValidation(expression + '.lastUpdated'));
        }
        if (this["additionalCharacteristic"]) {
            this.additionalCharacteristic.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.additionalCharacteristic[${i}]`)); });
        }
        if (this["additionalClassification"]) {
            this.additionalClassification.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.additionalClassification[${i}]`)); });
        }
        if (this["relatedEntry"]) {
            this.relatedEntry.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.relatedEntry[${i}]`)); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
CatalogEntry._fts_dataType = 'CatalogEntry';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2F0YWxvZ0VudHJ5LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9DYXRhbG9nRW50cnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsaUJBQWlCLEVBQXlCLE1BQU0sdUNBQXVDLENBQUM7QUFHakcsYUFBYTtBQUNiLE9BQU8sRUFBRSxzQkFBc0IsRUFBOEIsTUFBTSw0Q0FBNEMsQ0FBQztBQW1CaEg7O0dBRUc7QUFDSCxNQUFNLE9BQU8sd0JBQXlCLFNBQVEsSUFBSSxDQUFDLGVBQWU7SUFhaEU7O09BRUc7SUFDSCxZQUFZLFNBQStDLEVBQUUsRUFBRSxVQUFzQyxFQUFFO1FBQ3JHLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkIsSUFBSSxNQUFNLENBQUMsY0FBYyxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBdUIsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLFlBQVksRUFBQyxDQUFDLENBQUM7U0FBRTthQUNySDtZQUFFLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO1NBQUU7UUFDbEMsSUFBSSxNQUFNLENBQUMsZUFBZSxDQUFDLEVBQUU7WUFDM0IsSUFBSSxJQUFJLENBQUMsWUFBWSxFQUFFO2dCQUFFLElBQUksQ0FBQyxZQUFZLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLGFBQWMsQ0FBQyxDQUFDO2FBQUU7aUJBQ3JGO2dCQUFFLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUF1QixNQUFNLENBQUMsYUFBdUMsQ0FBQyxDQUFDO2FBQUU7U0FDdEg7UUFDRCxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUFFO2FBQy9EO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7U0FBRTtJQUM1QixDQUFDO0lBQ0Q7O09BRUc7SUFDSSxNQUFNLEtBQUsseUJBQXlCO1FBQ3pDLE9BQU8saUJBQWlCLENBQUM7SUFDM0IsQ0FBQztJQUNEOztPQUVHO0lBQ2EsaUJBQWlCLENBQUMsYUFBb0IsRUFBRTtRQUN0RCxJQUFJLE1BQU0sR0FBbUIsS0FBSyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2pFLElBQUksVUFBVSxLQUFLLEVBQUUsRUFBRTtZQUFFLFVBQVUsR0FBRywyQkFBMkIsQ0FBQTtTQUFFO1FBQ25FLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLEVBQUU7WUFDekIsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsMEZBQTBGLEVBQUUsVUFBVSxFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQ3pMO1FBQ0QsSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFZLENBQUMsQ0FBQyxFQUFFO1lBQ3hHLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxjQUFjLEVBQUUsV0FBVyxFQUFFLHdIQUF3SCxFQUFFLFVBQVUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUMzTjtRQUNELElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsaUJBQWlCLENBQUMsVUFBVSxHQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7U0FBRTtRQUM5RyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQ2pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLCtFQUErRSxFQUFFLFVBQVUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUM5SztRQUNELElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsVUFBVSxHQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FBRTtRQUN0RixPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDOztBQWxERDs7R0FFRztBQUM2QixzQ0FBYSxHQUFVLDBCQUEwQixDQUFDO0FBK0hwRjs7R0FFRztBQUNILE1BQU0sT0FBTyxZQUFhLFNBQVEsSUFBSSxDQUFDLGNBQWM7SUE2RG5EOztPQUVHO0lBQ0gsWUFBWSxTQUFtQyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUN6RixLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxZQUFZLEdBQUcsY0FBYyxDQUFDO1FBQ25DLElBQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNoRztZQUFFLElBQUksQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDOUIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7U0FBRTtRQUMxRSxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxTQUFTLEVBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDekY7WUFBRSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztTQUFFO1FBQy9CLElBQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxFQUFFO1lBQ3hCLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtnQkFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxVQUFXLENBQUMsQ0FBQzthQUFFO2lCQUM1RTtnQkFBRSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsVUFBMkMsQ0FBQyxDQUFDO2FBQUU7U0FDcEc7UUFDRCxJQUFJLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1NBQUU7YUFDN0Y7WUFBRSxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztTQUFFO1FBQ3BDLElBQUksTUFBTSxDQUFDLHNCQUFzQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsb0JBQW9CLEdBQUcsTUFBTSxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUM5SDtZQUFFLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxFQUFFLENBQUM7U0FBRTtRQUN4QyxJQUFJLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLGNBQWMsR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNqSDtZQUFFLElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO1NBQUU7UUFDbEMsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBNEIsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLE1BQU0sRUFBQyxDQUFDLENBQUM7U0FBRTtRQUM3RyxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUNyQixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsT0FBUSxDQUFDLENBQUM7YUFBRTtpQkFDbkU7Z0JBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQTRCLE1BQU0sQ0FBQyxPQUFpQyxDQUFDLENBQUM7YUFBRTtTQUMvRztRQUNELElBQUksTUFBTSxDQUFDLGdCQUFnQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7U0FBRTtRQUMvRixJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxPQUFPLEVBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDekYsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFDdEIsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO2dCQUFFLElBQUksQ0FBQyxPQUFPLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLFFBQVMsQ0FBQyxDQUFDO2FBQUU7aUJBQ3RFO2dCQUFFLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxRQUEwQyxDQUFDLENBQUM7YUFBRTtTQUNsRztRQUNELElBQUksTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLFdBQVcsRUFBQyxDQUFDLENBQUM7U0FBRTtRQUNyRyxJQUFJLE1BQU0sQ0FBQyxjQUFjLENBQUMsRUFBRTtZQUMxQixJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsWUFBYSxDQUFDLENBQUM7YUFBRTtpQkFDbEY7Z0JBQUUsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLFlBQThDLENBQUMsQ0FBQzthQUFFO1NBQzFHO1FBQ0QsSUFBSSxNQUFNLENBQUMsMEJBQTBCLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyx3QkFBd0IsR0FBRyxNQUFNLENBQUMsd0JBQXdCLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUFFO2FBQy9JO1lBQUUsSUFBSSxDQUFDLHdCQUF3QixHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQzVDLElBQUksTUFBTSxDQUFDLDBCQUEwQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsd0JBQXdCLEdBQUcsTUFBTSxDQUFDLHdCQUF3QixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUMvSTtZQUFFLElBQUksQ0FBQyx3QkFBd0IsR0FBRyxFQUFFLENBQUM7U0FBRTtRQUM1QyxJQUFJLE1BQU0sQ0FBQyxjQUFjLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLHdCQUF3QixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FBRTthQUNwSDtZQUFFLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDO1NBQUU7SUFDbEMsQ0FBQztJQUNEOztPQUVHO0lBQ0ksTUFBTSxLQUFLLG1CQUFtQjtRQUNuQyxPQUFPLHNCQUFzQixDQUFDO0lBQ2hDLENBQUM7SUFDRDs7T0FFRztJQUNhLGlCQUFpQixDQUFDLGFBQW9CLEVBQUU7UUFDdEQsSUFBSSxNQUFNLEdBQW1CLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNqRSxJQUFJLFVBQVUsS0FBSyxFQUFFLEVBQUU7WUFBRSxVQUFVLEdBQUcsY0FBYyxDQUFBO1NBQUU7UUFDdEQsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRTtZQUN6QixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSx1RkFBdUYsRUFBRSxVQUFVLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDdEw7UUFDRCxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBRSxFQUFFLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtTQUFFO1FBQ3RJLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsVUFBVSxHQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FBRTtRQUN0RixJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQ3RCLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLDBFQUEwRSxFQUFFLFVBQVUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUN6SztRQUNELElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsaUJBQWlCLENBQUMsVUFBVSxHQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7U0FBRTtRQUNyRyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEVBQUU7WUFDM0IsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsc0ZBQXNGLEVBQUUsVUFBVSxFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQ3JMO1FBQ0QsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsR0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7U0FBRTtRQUNwSCxJQUFJLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsaUJBQWlCLENBQUMsVUFBVSxHQUFDLHlCQUF5QixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtTQUFFO1FBQ3BLLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsaUJBQWlCLENBQUMsVUFBVSxHQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtTQUFFO1FBQ2xKLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBWSxDQUFDLENBQUMsRUFBRTtZQUNqRyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLFdBQVcsRUFBRSxvR0FBb0csRUFBRSxVQUFVLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDdk07UUFDRCxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsR0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDNUYsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsR0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7U0FBRTtRQUNwSCxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsR0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDL0YsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztTQUFFO1FBQzNHLElBQUksSUFBSSxDQUFDLDBCQUEwQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsd0JBQXdCLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBRSxFQUFFLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUMsNkJBQTZCLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQUU7UUFDaEwsSUFBSSxJQUFJLENBQUMsMEJBQTBCLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsR0FBQyw2QkFBNkIsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7U0FBRTtRQUNoTCxJQUFJLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBRSxFQUFFLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQUU7UUFDNUksT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUE5SUQ7O0dBRUc7QUFDNkIsMEJBQWEsR0FBVSxjQUFjLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjQuY29yZSB2ZXJzaW9uOiA0LjAuMVxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgUmVzb3VyY2U6IENhdGFsb2dFbnRyeVxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUmVsYXRpb25UeXBlQ29kaW5ncywgUmVsYXRpb25UeXBlQ29kaW5nVHlwZSx9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUmVsYXRpb25UeXBlQ29kaW5ncy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgUmVsYXRpb25UeXBlQ29kZXMsICBSZWxhdGlvblR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUmVsYXRpb25UeXBlQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFB1YmxpY2F0aW9uU3RhdHVzQ29kaW5ncywgUHVibGljYXRpb25TdGF0dXNDb2RpbmdUeXBlLH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9QdWJsaWNhdGlvblN0YXR1c0NvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFB1YmxpY2F0aW9uU3RhdHVzQ29kZXMsICBQdWJsaWNhdGlvblN0YXR1c0NvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9QdWJsaWNhdGlvblN0YXR1c0NvZGVzLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIENhdGFsb2dFbnRyeVJlbGF0ZWRFbnRyeSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBDYXRhbG9nRW50cnlSZWxhdGVkRW50cnlBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgdHlwZSBvZiByZWxhdGlvbiB0byB0aGUgcmVsYXRlZCBpdGVtOiBjaGlsZCwgcGFyZW50LCBwYWNrYWdlQ29udGVudCwgY29udGFpbmVyUGFja2FnZSwgdXNlZEluLCB1c2VzLCByZXF1aXJlcywgZXRjLlxyXG4gICAqL1xyXG4gIHJlbGF0aW9udHlwZTogZmhpci5GaGlyQ29kZTxSZWxhdGlvblR5cGVDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogQ2F0YWxvZ0VudHJ5LnJlbGF0ZWRFbnRyeS5yZWxhdGlvbnR5cGVcclxuICAgKi9cclxuICBfcmVsYXRpb250eXBlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGUgcmVmZXJlbmNlIHRvIHRoZSByZWxhdGVkIGl0ZW0uXHJcbiAgICovXHJcbiAgaXRlbTogZmhpci5SZWZlcmVuY2VBcmdzfG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVc2VkIGZvciBleGFtcGxlLCB0byBwb2ludCB0byBhIHN1YnN0YW5jZSwgb3IgdG8gYSBkZXZpY2UgdXNlZCB0byBhZG1pbmlzdGVyIGEgbWVkaWNhdGlvbi5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBDYXRhbG9nRW50cnlSZWxhdGVkRW50cnkgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdDYXRhbG9nRW50cnlSZWxhdGVkRW50cnknO1xyXG4gIC8qKlxyXG4gICAqIFRoZSB0eXBlIG9mIHJlbGF0aW9uIHRvIHRoZSByZWxhdGVkIGl0ZW06IGNoaWxkLCBwYXJlbnQsIHBhY2thZ2VDb250ZW50LCBjb250YWluZXJQYWNrYWdlLCB1c2VkSW4sIHVzZXMsIHJlcXVpcmVzLCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIHJlbGF0aW9udHlwZTogZmhpci5GaGlyQ29kZTxSZWxhdGlvblR5cGVDb2RlVHlwZT58bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgcmVmZXJlbmNlIHRvIHRoZSByZWxhdGVkIGl0ZW0uXHJcbiAgICovXHJcbiAgcHVibGljIGl0ZW06IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgQ2F0YWxvZ0VudHJ5UmVsYXRlZEVudHJ5IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8Q2F0YWxvZ0VudHJ5UmVsYXRlZEVudHJ5QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3JlbGF0aW9udHlwZSddKSB7IHRoaXMucmVsYXRpb250eXBlID0gbmV3IGZoaXIuRmhpckNvZGU8UmVsYXRpb25UeXBlQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLnJlbGF0aW9udHlwZX0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5yZWxhdGlvbnR5cGUgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfcmVsYXRpb250eXBlJ10pIHtcclxuICAgICAgaWYgKHRoaXMucmVsYXRpb250eXBlKSB7IHRoaXMucmVsYXRpb250eXBlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3JlbGF0aW9udHlwZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnJlbGF0aW9udHlwZSA9IG5ldyBmaGlyLkZoaXJDb2RlPFJlbGF0aW9uVHlwZUNvZGVUeXBlPihzb3VyY2UuX3JlbGF0aW9udHlwZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnaXRlbSddKSB7IHRoaXMuaXRlbSA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuaXRlbSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLml0ZW0gPSBudWxsOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFJlcXVpcmVkLWJvdW5kIFZhbHVlIFNldCBmb3IgcmVsYXRpb250eXBlIChDYXRhbG9nRW50cnkucmVsYXRlZEVudHJ5LnJlbGF0aW9udHlwZSlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCByZWxhdGlvbnR5cGVSZXF1aXJlZENvZGVzKCkge1xyXG4gICAgcmV0dXJuIFJlbGF0aW9uVHlwZUNvZGVzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbjpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbik7XHJcbiAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHsgZXhwcmVzc2lvbiA9ICdDYXRhbG9nRW50cnkucmVsYXRlZEVudHJ5JyB9XHJcbiAgICBpZiAoIXRoaXNbJ3JlbGF0aW9udHlwZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSByZWxhdGlvbnR5cGUgZmhpcjogQ2F0YWxvZ0VudHJ5LnJlbGF0ZWRFbnRyeS5yZWxhdGlvbnR5cGU6Y29kZScsIGV4cHJlc3Npb246IFtleHByZXNzaW9uXSB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzWydyZWxhdGlvbnR5cGUnXSAmJiAoIU9iamVjdC52YWx1ZXMoUmVsYXRpb25UeXBlQ29kZXMpLmluY2x1ZGVzKHRoaXMucmVsYXRpb250eXBlLnZhbHVlIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ0ludmFsaWQgY29kZSBwcm9wZXJ0eSByZWxhdGlvbnR5cGUgZmhpcjogQ2F0YWxvZ0VudHJ5LnJlbGF0ZWRFbnRyeS5yZWxhdGlvbnR5cGU6Y29kZSBSZXF1aXJlZCBiaW5kaW5nIHRvOiBSZWxhdGlvblR5cGUnLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInJlbGF0aW9udHlwZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnJlbGF0aW9udHlwZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycucmVsYXRpb250eXBlJykpOyB9XHJcbiAgICBpZiAoIXRoaXNbJ2l0ZW0nXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgaXRlbSBmaGlyOiBDYXRhbG9nRW50cnkucmVsYXRlZEVudHJ5Lml0ZW06UmVmZXJlbmNlJywgZXhwcmVzc2lvbjogW2V4cHJlc3Npb25dIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJpdGVtXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMuaXRlbS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycuaXRlbScpKTsgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIENhdGFsb2dFbnRyeSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBDYXRhbG9nRW50cnlBcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJDYXRhbG9nRW50cnlcInx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVXNlZCBpbiBzdXBwb3J0aW5nIGRpZmZlcmVudCBpZGVudGlmaWVycyBmb3IgdGhlIHNhbWUgcHJvZHVjdCwgZS5nLiBtYW51ZmFjdHVyZXIgY29kZSBhbmQgcmV0YWlsZXIgY29kZS5cclxuICAgKi9cclxuICBpZGVudGlmaWVyPzogZmhpci5JZGVudGlmaWVyQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgdHlwZSBvZiBpdGVtIC0gbWVkaWNhdGlvbiwgZGV2aWNlLCBzZXJ2aWNlLCBwcm90b2NvbCBvciBvdGhlci5cclxuICAgKi9cclxuICB0eXBlPzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBXaGV0aGVyIHRoZSBlbnRyeSByZXByZXNlbnRzIGFuIG9yZGVyYWJsZSBpdGVtLlxyXG4gICAqL1xyXG4gIG9yZGVyYWJsZTogZmhpci5GaGlyQm9vbGVhbnxib29sZWFufHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogQ2F0YWxvZ0VudHJ5Lm9yZGVyYWJsZVxyXG4gICAqL1xyXG4gIF9vcmRlcmFibGU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBpdGVtIGluIGEgY2F0YWxvZyBvciBkZWZpbml0aW9uLlxyXG4gICAqL1xyXG4gIHJlZmVyZW5jZWRJdGVtOiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBVc2VkIGluIHN1cHBvcnRpbmcgcmVsYXRlZCBjb25jZXB0cywgZS5nLiBOREMgdG8gUnhOb3JtLlxyXG4gICAqL1xyXG4gIGFkZGl0aW9uYWxJZGVudGlmaWVyPzogZmhpci5JZGVudGlmaWVyQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBDbGFzc2VzIG9mIGRldmljZXMsIG9yIEFUQyBmb3IgbWVkaWNhdGlvbi5cclxuICAgKi9cclxuICBjbGFzc2lmaWNhdGlvbj86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBVc2VkIHRvIHN1cHBvcnQgY2F0YWxvZyBleGNoYW5nZSBldmVuIGZvciB1bnN1cHBvcnRlZCBwcm9kdWN0cywgZS5nLiBnZXR0aW5nIGxpc3Qgb2YgbWVkaWNhdGlvbnMgZXZlbiBpZiBub3QgcHJlc2NyaWJhYmxlLlxyXG4gICAqL1xyXG4gIHN0YXR1cz86IGZoaXIuRmhpckNvZGU8UHVibGljYXRpb25TdGF0dXNDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogQ2F0YWxvZ0VudHJ5LnN0YXR1c1xyXG4gICAqL1xyXG4gIF9zdGF0dXM/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSB0aW1lIHBlcmlvZCBpbiB3aGljaCB0aGlzIGNhdGFsb2cgZW50cnkgaXMgZXhwZWN0ZWQgdG8gYmUgYWN0aXZlLlxyXG4gICAqL1xyXG4gIHZhbGlkaXR5UGVyaW9kPzogZmhpci5QZXJpb2RBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgZGF0ZSB1bnRpbCB3aGljaCB0aGlzIGNhdGFsb2cgZW50cnkgaXMgZXhwZWN0ZWQgdG8gYmUgYWN0aXZlLlxyXG4gICAqL1xyXG4gIHZhbGlkVG8/OiBmaGlyLkZoaXJEYXRlVGltZXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBDYXRhbG9nRW50cnkudmFsaWRUb1xyXG4gICAqL1xyXG4gIF92YWxpZFRvPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBQZXJoYXBzIG5vdCBuZWVkZWQgLSBpZiB3ZSB1c2UgZmhpciByZXNvdXJjZSBtZXRhZGF0YS5cclxuICAgKi9cclxuICBsYXN0VXBkYXRlZD86IGZoaXIuRmhpckRhdGVUaW1lfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IENhdGFsb2dFbnRyeS5sYXN0VXBkYXRlZFxyXG4gICAqL1xyXG4gIF9sYXN0VXBkYXRlZD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVXNlZCBmb3IgZXhhbXBsZWZvciBPdXQgb2YgRm9ybXVsYXJ5LCBvciBhbnkgc3BlY2lmaWNzLlxyXG4gICAqL1xyXG4gIGFkZGl0aW9uYWxDaGFyYWN0ZXJpc3RpYz86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBVc2VyIGZvciBleGFtcGxlIGZvciBBVEMgY2xhc3NpZmljYXRpb24sIG9yLlxyXG4gICAqL1xyXG4gIGFkZGl0aW9uYWxDbGFzc2lmaWNhdGlvbj86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBVc2VkIGZvciBleGFtcGxlLCB0byBwb2ludCB0byBhIHN1YnN0YW5jZSwgb3IgdG8gYSBkZXZpY2UgdXNlZCB0byBhZG1pbmlzdGVyIGEgbWVkaWNhdGlvbi5cclxuICAgKi9cclxuICByZWxhdGVkRW50cnk/OiBmaGlyLkNhdGFsb2dFbnRyeVJlbGF0ZWRFbnRyeUFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYXRhbG9nIGVudHJpZXMgYXJlIHdyYXBwZXJzIHRoYXQgY29udGV4dHVhbGl6ZSBpdGVtcyBpbmNsdWRlZCBpbiBhIGNhdGFsb2cuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ2F0YWxvZ0VudHJ5IGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdDYXRhbG9nRW50cnknO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiQ2F0YWxvZ0VudHJ5XCI7XHJcbiAgLyoqXHJcbiAgICogVXNlZCBpbiBzdXBwb3J0aW5nIGRpZmZlcmVudCBpZGVudGlmaWVycyBmb3IgdGhlIHNhbWUgcHJvZHVjdCwgZS5nLiBtYW51ZmFjdHVyZXIgY29kZSBhbmQgcmV0YWlsZXIgY29kZS5cclxuICAgKi9cclxuICBwdWJsaWMgaWRlbnRpZmllcjogZmhpci5JZGVudGlmaWVyW107XHJcbiAgLyoqXHJcbiAgICogVGhlIHR5cGUgb2YgaXRlbSAtIG1lZGljYXRpb24sIGRldmljZSwgc2VydmljZSwgcHJvdG9jb2wgb3Igb3RoZXIuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogV2hldGhlciB0aGUgZW50cnkgcmVwcmVzZW50cyBhbiBvcmRlcmFibGUgaXRlbS5cclxuICAgKi9cclxuICBwdWJsaWMgb3JkZXJhYmxlOiBmaGlyLkZoaXJCb29sZWFufG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIGl0ZW0gaW4gYSBjYXRhbG9nIG9yIGRlZmluaXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIHJlZmVyZW5jZWRJdGVtOiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFVzZWQgaW4gc3VwcG9ydGluZyByZWxhdGVkIGNvbmNlcHRzLCBlLmcuIE5EQyB0byBSeE5vcm0uXHJcbiAgICovXHJcbiAgcHVibGljIGFkZGl0aW9uYWxJZGVudGlmaWVyOiBmaGlyLklkZW50aWZpZXJbXTtcclxuICAvKipcclxuICAgKiBDbGFzc2VzIG9mIGRldmljZXMsIG9yIEFUQyBmb3IgbWVkaWNhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgY2xhc3NpZmljYXRpb246IGZoaXIuQ29kZWFibGVDb25jZXB0W107XHJcbiAgLyoqXHJcbiAgICogVXNlZCB0byBzdXBwb3J0IGNhdGFsb2cgZXhjaGFuZ2UgZXZlbiBmb3IgdW5zdXBwb3J0ZWQgcHJvZHVjdHMsIGUuZy4gZ2V0dGluZyBsaXN0IG9mIG1lZGljYXRpb25zIGV2ZW4gaWYgbm90IHByZXNjcmliYWJsZS5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdHVzPzogZmhpci5GaGlyQ29kZTxQdWJsaWNhdGlvblN0YXR1c0NvZGVUeXBlPnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHRpbWUgcGVyaW9kIGluIHdoaWNoIHRoaXMgY2F0YWxvZyBlbnRyeSBpcyBleHBlY3RlZCB0byBiZSBhY3RpdmUuXHJcbiAgICovXHJcbiAgcHVibGljIHZhbGlkaXR5UGVyaW9kPzogZmhpci5QZXJpb2R8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBkYXRlIHVudGlsIHdoaWNoIHRoaXMgY2F0YWxvZyBlbnRyeSBpcyBleHBlY3RlZCB0byBiZSBhY3RpdmUuXHJcbiAgICovXHJcbiAgcHVibGljIHZhbGlkVG8/OiBmaGlyLkZoaXJEYXRlVGltZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogUGVyaGFwcyBub3QgbmVlZGVkIC0gaWYgd2UgdXNlIGZoaXIgcmVzb3VyY2UgbWV0YWRhdGEuXHJcbiAgICovXHJcbiAgcHVibGljIGxhc3RVcGRhdGVkPzogZmhpci5GaGlyRGF0ZVRpbWV8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFVzZWQgZm9yIGV4YW1wbGVmb3IgT3V0IG9mIEZvcm11bGFyeSwgb3IgYW55IHNwZWNpZmljcy5cclxuICAgKi9cclxuICBwdWJsaWMgYWRkaXRpb25hbENoYXJhY3RlcmlzdGljOiBmaGlyLkNvZGVhYmxlQ29uY2VwdFtdO1xyXG4gIC8qKlxyXG4gICAqIFVzZXIgZm9yIGV4YW1wbGUgZm9yIEFUQyBjbGFzc2lmaWNhdGlvbiwgb3IuXHJcbiAgICovXHJcbiAgcHVibGljIGFkZGl0aW9uYWxDbGFzc2lmaWNhdGlvbjogZmhpci5Db2RlYWJsZUNvbmNlcHRbXTtcclxuICAvKipcclxuICAgKiBVc2VkIGZvciBleGFtcGxlLCB0byBwb2ludCB0byBhIHN1YnN0YW5jZSwgb3IgdG8gYSBkZXZpY2UgdXNlZCB0byBhZG1pbmlzdGVyIGEgbWVkaWNhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgcmVsYXRlZEVudHJ5OiBmaGlyLkNhdGFsb2dFbnRyeVJlbGF0ZWRFbnRyeVtdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIENhdGFsb2dFbnRyeSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPENhdGFsb2dFbnRyeUFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdDYXRhbG9nRW50cnknO1xyXG4gICAgaWYgKHNvdXJjZVsnaWRlbnRpZmllciddKSB7IHRoaXMuaWRlbnRpZmllciA9IHNvdXJjZS5pZGVudGlmaWVyLm1hcCgoeCkgPT4gbmV3IGZoaXIuSWRlbnRpZmllcih4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmlkZW50aWZpZXIgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UudHlwZSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ29yZGVyYWJsZSddKSB7IHRoaXMub3JkZXJhYmxlID0gbmV3IGZoaXIuRmhpckJvb2xlYW4oe3ZhbHVlOiBzb3VyY2Uub3JkZXJhYmxlfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLm9yZGVyYWJsZSA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ19vcmRlcmFibGUnXSkge1xyXG4gICAgICBpZiAodGhpcy5vcmRlcmFibGUpIHsgdGhpcy5vcmRlcmFibGUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fb3JkZXJhYmxlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMub3JkZXJhYmxlID0gbmV3IGZoaXIuRmhpckJvb2xlYW4oc291cmNlLl9vcmRlcmFibGUgYXMgUGFydGlhbDxmaGlyLkZoaXJCb29sZWFuQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydyZWZlcmVuY2VkSXRlbSddKSB7IHRoaXMucmVmZXJlbmNlZEl0ZW0gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnJlZmVyZW5jZWRJdGVtKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucmVmZXJlbmNlZEl0ZW0gPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydhZGRpdGlvbmFsSWRlbnRpZmllciddKSB7IHRoaXMuYWRkaXRpb25hbElkZW50aWZpZXIgPSBzb3VyY2UuYWRkaXRpb25hbElkZW50aWZpZXIubWFwKCh4KSA9PiBuZXcgZmhpci5JZGVudGlmaWVyKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuYWRkaXRpb25hbElkZW50aWZpZXIgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnY2xhc3NpZmljYXRpb24nXSkgeyB0aGlzLmNsYXNzaWZpY2F0aW9uID0gc291cmNlLmNsYXNzaWZpY2F0aW9uLm1hcCgoeCkgPT4gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuY2xhc3NpZmljYXRpb24gPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3RhdHVzJ10pIHsgdGhpcy5zdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxQdWJsaWNhdGlvblN0YXR1c0NvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5zdGF0dXN9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3N0YXR1cyddKSB7XHJcbiAgICAgIGlmICh0aGlzLnN0YXR1cykgeyB0aGlzLnN0YXR1cy5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9zdGF0dXMhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxQdWJsaWNhdGlvblN0YXR1c0NvZGVUeXBlPihzb3VyY2UuX3N0YXR1cyBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndmFsaWRpdHlQZXJpb2QnXSkgeyB0aGlzLnZhbGlkaXR5UGVyaW9kID0gbmV3IGZoaXIuUGVyaW9kKHNvdXJjZS52YWxpZGl0eVBlcmlvZCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3ZhbGlkVG8nXSkgeyB0aGlzLnZhbGlkVG8gPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoe3ZhbHVlOiBzb3VyY2UudmFsaWRUb30pOyB9XHJcbiAgICBpZiAoc291cmNlWydfdmFsaWRUbyddKSB7XHJcbiAgICAgIGlmICh0aGlzLnZhbGlkVG8pIHsgdGhpcy52YWxpZFRvLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3ZhbGlkVG8hKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy52YWxpZFRvID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHNvdXJjZS5fdmFsaWRUbyBhcyBQYXJ0aWFsPGZoaXIuRmhpckRhdGVUaW1lQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydsYXN0VXBkYXRlZCddKSB7IHRoaXMubGFzdFVwZGF0ZWQgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoe3ZhbHVlOiBzb3VyY2UubGFzdFVwZGF0ZWR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2xhc3RVcGRhdGVkJ10pIHtcclxuICAgICAgaWYgKHRoaXMubGFzdFVwZGF0ZWQpIHsgdGhpcy5sYXN0VXBkYXRlZC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9sYXN0VXBkYXRlZCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmxhc3RVcGRhdGVkID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHNvdXJjZS5fbGFzdFVwZGF0ZWQgYXMgUGFydGlhbDxmaGlyLkZoaXJEYXRlVGltZUFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnYWRkaXRpb25hbENoYXJhY3RlcmlzdGljJ10pIHsgdGhpcy5hZGRpdGlvbmFsQ2hhcmFjdGVyaXN0aWMgPSBzb3VyY2UuYWRkaXRpb25hbENoYXJhY3RlcmlzdGljLm1hcCgoeCkgPT4gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuYWRkaXRpb25hbENoYXJhY3RlcmlzdGljID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2FkZGl0aW9uYWxDbGFzc2lmaWNhdGlvbiddKSB7IHRoaXMuYWRkaXRpb25hbENsYXNzaWZpY2F0aW9uID0gc291cmNlLmFkZGl0aW9uYWxDbGFzc2lmaWNhdGlvbi5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmFkZGl0aW9uYWxDbGFzc2lmaWNhdGlvbiA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydyZWxhdGVkRW50cnknXSkgeyB0aGlzLnJlbGF0ZWRFbnRyeSA9IHNvdXJjZS5yZWxhdGVkRW50cnkubWFwKCh4KSA9PiBuZXcgZmhpci5DYXRhbG9nRW50cnlSZWxhdGVkRW50cnkoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5yZWxhdGVkRW50cnkgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBSZXF1aXJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIHN0YXR1cyAoQ2F0YWxvZ0VudHJ5LnN0YXR1cylcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCBzdGF0dXNSZXF1aXJlZENvZGVzKCkge1xyXG4gICAgcmV0dXJuIFB1YmxpY2F0aW9uU3RhdHVzQ29kZXM7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKTtcclxuICAgIGlmIChleHByZXNzaW9uID09PSAnJykgeyBleHByZXNzaW9uID0gJ0NhdGFsb2dFbnRyeScgfVxyXG4gICAgaWYgKCF0aGlzWydyZXNvdXJjZVR5cGUnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgcmVzb3VyY2VUeXBlIGZoaXI6IENhdGFsb2dFbnRyeS5yZXNvdXJjZVR5cGU6XCJDYXRhbG9nRW50cnlcIicsIGV4cHJlc3Npb246IFtleHByZXNzaW9uXSB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wiaWRlbnRpZmllclwiXSkgeyB0aGlzLmlkZW50aWZpZXIuZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLmlkZW50aWZpZXJbJHtpfV1gKSk7IH0pIH1cclxuICAgIGlmICh0aGlzW1widHlwZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnR5cGUuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLnR5cGUnKSk7IH1cclxuICAgIGlmICghdGhpc1snb3JkZXJhYmxlJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IG9yZGVyYWJsZSBmaGlyOiBDYXRhbG9nRW50cnkub3JkZXJhYmxlOmJvb2xlYW4nLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcIm9yZGVyYWJsZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLm9yZGVyYWJsZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycub3JkZXJhYmxlJykpOyB9XHJcbiAgICBpZiAoIXRoaXNbJ3JlZmVyZW5jZWRJdGVtJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHJlZmVyZW5jZWRJdGVtIGZoaXI6IENhdGFsb2dFbnRyeS5yZWZlcmVuY2VkSXRlbTpSZWZlcmVuY2UnLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInJlZmVyZW5jZWRJdGVtXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMucmVmZXJlbmNlZEl0ZW0uZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLnJlZmVyZW5jZWRJdGVtJykpOyB9XHJcbiAgICBpZiAodGhpc1tcImFkZGl0aW9uYWxJZGVudGlmaWVyXCJdKSB7IHRoaXMuYWRkaXRpb25hbElkZW50aWZpZXIuZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLmFkZGl0aW9uYWxJZGVudGlmaWVyWyR7aX1dYCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1tcImNsYXNzaWZpY2F0aW9uXCJdKSB7IHRoaXMuY2xhc3NpZmljYXRpb24uZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLmNsYXNzaWZpY2F0aW9uWyR7aX1dYCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1snc3RhdHVzJ10gJiYgKCFPYmplY3QudmFsdWVzKFB1YmxpY2F0aW9uU3RhdHVzQ29kZXMpLmluY2x1ZGVzKHRoaXMuc3RhdHVzLnZhbHVlIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ0ludmFsaWQgY29kZSBwcm9wZXJ0eSBzdGF0dXMgZmhpcjogQ2F0YWxvZ0VudHJ5LnN0YXR1czpjb2RlIFJlcXVpcmVkIGJpbmRpbmcgdG86IFB1YmxpY2F0aW9uU3RhdHVzJywgZXhwcmVzc2lvbjogW2V4cHJlc3Npb25dIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJzdGF0dXNcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5zdGF0dXMuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLnN0YXR1cycpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJ2YWxpZGl0eVBlcmlvZFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnZhbGlkaXR5UGVyaW9kLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy52YWxpZGl0eVBlcmlvZCcpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJ2YWxpZFRvXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMudmFsaWRUby5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycudmFsaWRUbycpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJsYXN0VXBkYXRlZFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmxhc3RVcGRhdGVkLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy5sYXN0VXBkYXRlZCcpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJhZGRpdGlvbmFsQ2hhcmFjdGVyaXN0aWNcIl0pIHsgdGhpcy5hZGRpdGlvbmFsQ2hhcmFjdGVyaXN0aWMuZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLmFkZGl0aW9uYWxDaGFyYWN0ZXJpc3RpY1ske2l9XWApKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJhZGRpdGlvbmFsQ2xhc3NpZmljYXRpb25cIl0pIHsgdGhpcy5hZGRpdGlvbmFsQ2xhc3NpZmljYXRpb24uZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLmFkZGl0aW9uYWxDbGFzc2lmaWNhdGlvblske2l9XWApKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJyZWxhdGVkRW50cnlcIl0pIHsgdGhpcy5yZWxhdGVkRW50cnkuZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLnJlbGF0ZWRFbnRyeVske2l9XWApKTsgfSkgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuIl19