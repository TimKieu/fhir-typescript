// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: DiagnosticReport
import * as fhir from '../fhir.js';
// @ts-ignore
import { DiagnosticReportStatusCodes } from '../fhirValueSets/DiagnosticReportStatusCodes.js';
// @ts-ignore
import { ReportCodings, } from '../fhirValueSets/ReportCodings.js';
/**
 * A list of key images associated with this report. The images are generally created during the diagnostic process, and may be directly of the patient, or of treated specimens (i.e. slides of interest).
 */
export class DiagnosticReportMedia extends fhir.BackboneElement {
    /**
     * Default constructor for DiagnosticReportMedia - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['comment']) {
            this.comment = new fhir.FhirString({ value: source.comment });
        }
        if (source['_comment']) {
            if (this.comment) {
                this.comment.addExtendedProperties(source._comment);
            }
            else {
                this.comment = new fhir.FhirString(source._comment);
            }
        }
        if (source['link']) {
            this.link = new fhir.Reference(source.link);
        }
        else {
            this.link = null;
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (this["comment"]) {
            issues.push(...this.comment.doModelValidation());
        }
        if (!this['link']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property link:fhir.Reference fhir: DiagnosticReport.media.link:Reference' });
        }
        if (this["link"]) {
            issues.push(...this.link.doModelValidation());
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DiagnosticReportMedia._fts_dataType = 'DiagnosticReportMedia';
/**
 * The findings and interpretation of diagnostic  tests performed on patients, groups of patients, devices, and locations, and/or specimens derived from these. The report includes clinical context such as requesting and provider information, and some mix of atomic results, images, textual and coded interpretations, and formatted representation of diagnostic reports.
 */
export class DiagnosticReport extends fhir.DomainResource {
    /**
     * Default constructor for DiagnosticReport - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'DiagnosticReport';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['basedOn']) {
            this.basedOn = source.basedOn.map((x) => new fhir.Reference(x));
        }
        else {
            this.basedOn = [];
        }
        if (source['status']) {
            this.status = new fhir.FhirCode({ value: source.status });
        }
        else {
            this.status = null;
        }
        if (source['_status']) {
            if (this.status) {
                this.status.addExtendedProperties(source._status);
            }
            else {
                this.status = new fhir.FhirCode(source._status);
            }
        }
        if (source['category']) {
            this.category = source.category.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.category = [];
        }
        if (source['code']) {
            this.code = new fhir.CodeableConcept(source.code);
        }
        else {
            this.code = null;
        }
        if (source['subject']) {
            this.subject = new fhir.Reference(source.subject);
        }
        if (source['encounter']) {
            this.encounter = new fhir.Reference(source.encounter);
        }
        if (source['effective']) {
            this.effective = source.effective;
        }
        else if (source['effectiveDateTime']) {
            this.effective = new fhir.FhirDateTime({ value: source.effectiveDateTime });
        }
        else if (source['effectivePeriod']) {
            this.effective = new fhir.Period(source.effectivePeriod);
        }
        if (source['issued']) {
            this.issued = new fhir.FhirInstant({ value: source.issued });
        }
        if (source['_issued']) {
            if (this.issued) {
                this.issued.addExtendedProperties(source._issued);
            }
            else {
                this.issued = new fhir.FhirInstant(source._issued);
            }
        }
        if (source['performer']) {
            this.performer = source.performer.map((x) => new fhir.Reference(x));
        }
        else {
            this.performer = [];
        }
        if (source['resultsInterpreter']) {
            this.resultsInterpreter = source.resultsInterpreter.map((x) => new fhir.Reference(x));
        }
        else {
            this.resultsInterpreter = [];
        }
        if (source['specimen']) {
            this.specimen = source.specimen.map((x) => new fhir.Reference(x));
        }
        else {
            this.specimen = [];
        }
        if (source['result']) {
            this.result = source.result.map((x) => new fhir.Reference(x));
        }
        else {
            this.result = [];
        }
        if (source['imagingStudy']) {
            this.imagingStudy = source.imagingStudy.map((x) => new fhir.Reference(x));
        }
        else {
            this.imagingStudy = [];
        }
        if (source['media']) {
            this.media = source.media.map((x) => new fhir.DiagnosticReportMedia(x));
        }
        else {
            this.media = [];
        }
        if (source['conclusion']) {
            this.conclusion = new fhir.FhirString({ value: source.conclusion });
        }
        if (source['_conclusion']) {
            if (this.conclusion) {
                this.conclusion.addExtendedProperties(source._conclusion);
            }
            else {
                this.conclusion = new fhir.FhirString(source._conclusion);
            }
        }
        if (source['conclusionCode']) {
            this.conclusionCode = source.conclusionCode.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.conclusionCode = [];
        }
        if (source['presentedForm']) {
            this.presentedForm = source.presentedForm.map((x) => new fhir.Attachment(x));
        }
        else {
            this.presentedForm = [];
        }
    }
    /**
     * Required-bound Value Set for status (DiagnosticReport.status)
     */
    static get statusRequiredCodes() {
        return DiagnosticReportStatusCodes;
    }
    /**
     * Preferred-bound Value Set for code (DiagnosticReport.code)
     */
    static get codePreferredCodings() {
        return ReportCodings;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType:"DiagnosticReport" fhir: DiagnosticReport.resourceType:"DiagnosticReport"' });
        }
        if (this["identifier"]) {
            this.identifier.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["basedOn"]) {
            this.basedOn.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (!this['status']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property status:fhir.FhirCode<DiagnosticReportStatusCodeType> fhir: DiagnosticReport.status:code' });
        }
        if (this['status'] && (!Object.values(DiagnosticReportStatusCodes).includes(this.status))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property status:fhir.FhirCode<DiagnosticReportStatusCodeType> fhir: DiagnosticReport.status:code Required binding to: DiagnosticReportStatus' });
        }
        if (this["status"]) {
            issues.push(...this.status.doModelValidation());
        }
        if (this["category"]) {
            this.category.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (!this['code']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property code:fhir.CodeableConcept fhir: DiagnosticReport.code:CodeableConcept' });
        }
        if (this["code"]) {
            issues.push(...this.code.doModelValidation());
        }
        if (this["subject"]) {
            issues.push(...this.subject.doModelValidation());
        }
        if (this["encounter"]) {
            issues.push(...this.encounter.doModelValidation());
        }
        if (this["issued"]) {
            issues.push(...this.issued.doModelValidation());
        }
        if (this["performer"]) {
            this.performer.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["resultsInterpreter"]) {
            this.resultsInterpreter.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["specimen"]) {
            this.specimen.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["result"]) {
            this.result.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["imagingStudy"]) {
            this.imagingStudy.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["media"]) {
            this.media.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["conclusion"]) {
            issues.push(...this.conclusion.doModelValidation());
        }
        if (this["conclusionCode"]) {
            this.conclusionCode.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["presentedForm"]) {
            this.presentedForm.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DiagnosticReport._fts_dataType = 'DiagnosticReport';
/**
 * Internal flag to properly serialize choice-type element DiagnosticReport.effective[x]
 */
DiagnosticReport._fts_effectiveIsChoice = true;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGlhZ25vc3RpY1JlcG9ydC5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvRGlhZ25vc3RpY1JlcG9ydC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQyxrQ0FBa0M7QUFFbEMsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFJbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSwyQkFBMkIsRUFBbUMsTUFBTSxpREFBaUQsQ0FBQztBQUsvSCxhQUFhO0FBQ2IsT0FBTyxFQUFFLGFBQWEsR0FBb0IsTUFBTSxtQ0FBbUMsQ0FBQztBQXlCcEY7O0dBRUc7QUFDSCxNQUFNLE9BQU8scUJBQXNCLFNBQVEsSUFBSSxDQUFDLGVBQWU7SUFhN0Q7O09BRUc7SUFDSCxZQUFZLFNBQTRDLEVBQUUsRUFBRSxVQUFzQyxFQUFFO1FBQ2xHLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkIsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsT0FBTyxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQ3ZGLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ3RCLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtnQkFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxRQUFTLENBQUMsQ0FBQzthQUFFO2lCQUN0RTtnQkFBRSxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsUUFBd0MsQ0FBQyxDQUFDO2FBQUU7U0FDOUY7UUFDRCxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJ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UUFDNUYsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUNoRixJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7U0FBRTtRQUM5RyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQUU7UUFDNUcsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUF2TEQ7O0dBRUc7QUFDNkIsOEJBQWEsR0FBVSxrQkFBa0IsQ0FBQztBQXFDMUU7O0dBRUc7QUFDdUIsdUNBQXNCLEdBQVEsSUFBSSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0LmNvcmUgdmVyc2lvbjogNC4wLjFcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIFJlc291cmNlOiBEaWFnbm9zdGljUmVwb3J0XHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kaW5ncywgRGlhZ25vc3RpY1JlcG9ydFN0YXR1c0NvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0RpYWdub3N0aWNSZXBvcnRTdGF0dXNDb2RpbmdzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kZXMsICBEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0RpYWdub3N0aWNSZXBvcnRTdGF0dXNDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgRGlhZ25vc3RpY1NlcnZpY2VTZWN0aW9uc0NvZGluZ3MsIERpYWdub3N0aWNTZXJ2aWNlU2VjdGlvbnNDb2RpbmdUeXBlLH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9EaWFnbm9zdGljU2VydmljZVNlY3Rpb25zQ29kaW5ncy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgRGlhZ25vc3RpY1NlcnZpY2VTZWN0aW9uc0NvZGVzLCAgRGlhZ25vc3RpY1NlcnZpY2VTZWN0aW9uc0NvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9EaWFnbm9zdGljU2VydmljZVNlY3Rpb25zQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFJlcG9ydENvZGluZ3MsIFJlcG9ydENvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1JlcG9ydENvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFJlcG9ydENvZGVzLCAgUmVwb3J0Q29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1JlcG9ydENvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBDbGluaWNhbEZpbmRpbmdzQ29kaW5ncywgQ2xpbmljYWxGaW5kaW5nc0NvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0NsaW5pY2FsRmluZGluZ3NDb2RpbmdzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBDbGluaWNhbEZpbmRpbmdzQ29kZXMsICBDbGluaWNhbEZpbmRpbmdzQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0NsaW5pY2FsRmluZGluZ3NDb2Rlcy5qcyc7XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBEaWFnbm9zdGljUmVwb3J0TWVkaWEgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGlhZ25vc3RpY1JlcG9ydE1lZGlhQXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogVGhlIGNvbW1lbnQgc2hvdWxkIGJlIGRpc3BsYXllZCB3aXRoIHRoZSBpbWFnZS4gSXQgd291bGQgYmUgY29tbW9uIGZvciB0aGUgcmVwb3J0IHRvIGluY2x1ZGUgYWRkaXRpb25hbCBkaXNjdXNzaW9uIG9mIHRoZSBpbWFnZSBjb250ZW50cyBpbiBvdGhlciBzZWN0aW9ucyBzdWNoIGFzIHRoZSBjb25jbHVzaW9uLlxyXG4gICAqL1xyXG4gIGNvbW1lbnQ/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGlhZ25vc3RpY1JlcG9ydC5tZWRpYS5jb21tZW50XHJcbiAgICovXHJcbiAgX2NvbW1lbnQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFJlZmVyZW5jZSB0byB0aGUgaW1hZ2Ugc291cmNlLlxyXG4gICAqL1xyXG4gIGxpbms6IGZoaXIuUmVmZXJlbmNlQXJnc3xudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogQSBsaXN0IG9mIGtleSBpbWFnZXMgYXNzb2NpYXRlZCB3aXRoIHRoaXMgcmVwb3J0LiBUaGUgaW1hZ2VzIGFyZSBnZW5lcmFsbHkgY3JlYXRlZCBkdXJpbmcgdGhlIGRpYWdub3N0aWMgcHJvY2VzcywgYW5kIG1heSBiZSBkaXJlY3RseSBvZiB0aGUgcGF0aWVudCwgb3Igb2YgdHJlYXRlZCBzcGVjaW1lbnMgKGkuZS4gc2xpZGVzIG9mIGludGVyZXN0KS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBEaWFnbm9zdGljUmVwb3J0TWVkaWEgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdEaWFnbm9zdGljUmVwb3J0TWVkaWEnO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjb21tZW50IHNob3VsZCBiZSBkaXNwbGF5ZWQgd2l0aCB0aGUgaW1hZ2UuIEl0IHdvdWxkIGJlIGNvbW1vbiBmb3IgdGhlIHJlcG9ydCB0byBpbmNsdWRlIGFkZGl0aW9uYWwgZGlzY3Vzc2lvbiBvZiB0aGUgaW1hZ2UgY29udGVudHMgaW4gb3RoZXIgc2VjdGlvbnMgc3VjaCBhcyB0aGUgY29uY2x1c2lvbi5cclxuICAgKi9cclxuICBwdWJsaWMgY29tbWVudD86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogUmVmZXJlbmNlIHRvIHRoZSBpbWFnZSBzb3VyY2UuXHJcbiAgICovXHJcbiAgcHVibGljIGxpbms6IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgRGlhZ25vc3RpY1JlcG9ydE1lZGlhIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8RGlhZ25vc3RpY1JlcG9ydE1lZGlhQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ2NvbW1lbnQnXSkgeyB0aGlzLmNvbW1lbnQgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLmNvbW1lbnR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2NvbW1lbnQnXSkge1xyXG4gICAgICBpZiAodGhpcy5jb21tZW50KSB7IHRoaXMuY29tbWVudC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9jb21tZW50ISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuY29tbWVudCA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9jb21tZW50IGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydsaW5rJ10pIHsgdGhpcy5saW5rID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5saW5rKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMubGluayA9IG51bGw7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKCk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oKTtcclxuICAgIGlmICh0aGlzW1wiY29tbWVudFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmNvbW1lbnQuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICghdGhpc1snbGluayddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSBsaW5rOmZoaXIuUmVmZXJlbmNlIGZoaXI6IERpYWdub3N0aWNSZXBvcnQubWVkaWEubGluazpSZWZlcmVuY2UnIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJsaW5rXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMubGluay5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERpYWdub3N0aWNSZXBvcnQgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGlhZ25vc3RpY1JlcG9ydEFyZ3MgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlQXJncyB7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcmVzb3VyY2VUeXBlOiBcIkRpYWdub3N0aWNSZXBvcnRcInx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVXN1YWxseSBhc3NpZ25lZCBieSB0aGUgSW5mb3JtYXRpb24gU3lzdGVtIG9mIHRoZSBkaWFnbm9zdGljIHNlcnZpY2UgcHJvdmlkZXIgKGZpbGxlciBpZCkuXHJcbiAgICovXHJcbiAgaWRlbnRpZmllcj86IGZoaXIuSWRlbnRpZmllckFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogTm90ZTogVXN1YWxseSB0aGVyZSBpcyBvbmUgdGVzdCByZXF1ZXN0IGZvciBlYWNoIHJlc3VsdCwgaG93ZXZlciBpbiBzb21lIGNpcmN1bXN0YW5jZXMgbXVsdGlwbGUgdGVzdCByZXF1ZXN0cyBtYXkgYmUgcmVwcmVzZW50ZWQgdXNpbmcgYSBzaW5nbGUgdGVzdCByZXN1bHQgcmVzb3VyY2UuIE5vdGUgdGhhdCB0aGVyZSBhcmUgYWxzbyBjYXNlcyB3aGVyZSBvbmUgcmVxdWVzdCBsZWFkcyB0byBtdWx0aXBsZSByZXBvcnRzLlxyXG4gICAqL1xyXG4gIGJhc2VkT24/OiBmaGlyLlJlZmVyZW5jZUFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHN0YXR1cyBvZiB0aGUgZGlhZ25vc3RpYyByZXBvcnQuXHJcbiAgICovXHJcbiAgc3RhdHVzOiBmaGlyLkZoaXJDb2RlPERpYWdub3N0aWNSZXBvcnRTdGF0dXNDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGlhZ25vc3RpY1JlcG9ydC5zdGF0dXNcclxuICAgKi9cclxuICBfc3RhdHVzPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBNdWx0aXBsZSBjYXRlZ29yaWVzIGFyZSBhbGxvd2VkIHVzaW5nIHZhcmlvdXMgY2F0ZWdvcml6YXRpb24gc2NoZW1lcy4gICBUaGUgbGV2ZWwgb2YgZ3JhbnVsYXJpdHkgaXMgZGVmaW5lZCBieSB0aGUgY2F0ZWdvcnkgY29uY2VwdHMgaW4gdGhlIHZhbHVlIHNldC4gTW9yZSBmaW5lLWdyYWluZWQgZmlsdGVyaW5nIGNhbiBiZSBwZXJmb3JtZWQgdXNpbmcgdGhlIG1ldGFkYXRhIGFuZC9vciB0ZXJtaW5vbG9neSBoaWVyYXJjaHkgaW4gRGlhZ25vc3RpY1JlcG9ydC5jb2RlLlxyXG4gICAqL1xyXG4gIGNhdGVnb3J5PzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEEgY29kZSBvciBuYW1lIHRoYXQgZGVzY3JpYmVzIHRoaXMgZGlhZ25vc3RpYyByZXBvcnQuXHJcbiAgICovXHJcbiAgY29kZTogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhlIHN1YmplY3Qgb2YgdGhlIHJlcG9ydC4gVXN1YWxseSwgYnV0IG5vdCBhbHdheXMsIHRoaXMgaXMgYSBwYXRpZW50LiBIb3dldmVyLCBkaWFnbm9zdGljIHNlcnZpY2VzIGFsc28gcGVyZm9ybSBhbmFseXNlcyBvbiBzcGVjaW1lbnMgY29sbGVjdGVkIGZyb20gYSB2YXJpZXR5IG9mIG90aGVyIHNvdXJjZXMuXHJcbiAgICovXHJcbiAgc3ViamVjdD86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyB3aWxsIHR5cGljYWxseSBiZSB0aGUgZW5jb3VudGVyIHRoZSBldmVudCBvY2N1cnJlZCB3aXRoaW4sIGJ1dCBzb21lIGV2ZW50cyBtYXkgYmUgaW5pdGlhdGVkIHByaW9yIHRvIG9yIGFmdGVyIHRoZSBvZmZpY2lhbCBjb21wbGV0aW9uIG9mIGFuIGVuY291bnRlciAgYnV0IHN0aWxsIGJlIHRpZWQgdG8gdGhlIGNvbnRleHQgb2YgdGhlIGVuY291bnRlciAgKGUuZy4gcHJlLWFkbWlzc2lvbiBsYWJvcmF0b3J5IHRlc3RzKS5cclxuICAgKi9cclxuICBlbmNvdW50ZXI/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElmIHRoZSBkaWFnbm9zdGljIHByb2NlZHVyZSB3YXMgcGVyZm9ybWVkIG9uIHRoZSBwYXRpZW50LCB0aGlzIGlzIHRoZSB0aW1lIGl0IHdhcyBwZXJmb3JtZWQuIElmIHRoZXJlIGFyZSBzcGVjaW1lbnMsIHRoZSBkaWFnbm9zdGljYWxseSByZWxldmFudCB0aW1lIGNhbiBiZSBkZXJpdmVkIGZyb20gdGhlIHNwZWNpbWVuIGNvbGxlY3Rpb24gdGltZXMsIGJ1dCB0aGUgc3BlY2ltZW4gaW5mb3JtYXRpb24gaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGFuZCB0aGUgZXhhY3QgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlIHNwZWNpbWVucyBhbmQgdGhlIGRpYWdub3N0aWNhbGx5IHJlbGV2YW50IHRpbWUgaXMgbm90IGFsd2F5cyBhdXRvbWF0aWMuXHJcbiAgICovXHJcbiAgZWZmZWN0aXZlPzogZmhpci5GaGlyRGF0ZVRpbWV8Zmhpci5QZXJpb2R8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElmIHRoZSBkaWFnbm9zdGljIHByb2NlZHVyZSB3YXMgcGVyZm9ybWVkIG9uIHRoZSBwYXRpZW50LCB0aGlzIGlzIHRoZSB0aW1lIGl0IHdhcyBwZXJmb3JtZWQuIElmIHRoZXJlIGFyZSBzcGVjaW1lbnMsIHRoZSBkaWFnbm9zdGljYWxseSByZWxldmFudCB0aW1lIGNhbiBiZSBkZXJpdmVkIGZyb20gdGhlIHNwZWNpbWVuIGNvbGxlY3Rpb24gdGltZXMsIGJ1dCB0aGUgc3BlY2ltZW4gaW5mb3JtYXRpb24gaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGFuZCB0aGUgZXhhY3QgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlIHNwZWNpbWVucyBhbmQgdGhlIGRpYWdub3N0aWNhbGx5IHJlbGV2YW50IHRpbWUgaXMgbm90IGFsd2F5cyBhdXRvbWF0aWMuXHJcbiAgICovXHJcbiAgZWZmZWN0aXZlRGF0ZVRpbWU/OiBmaGlyLkZoaXJEYXRlVGltZXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElmIHRoZSBkaWFnbm9zdGljIHByb2NlZHVyZSB3YXMgcGVyZm9ybWVkIG9uIHRoZSBwYXRpZW50LCB0aGlzIGlzIHRoZSB0aW1lIGl0IHdhcyBwZXJmb3JtZWQuIElmIHRoZXJlIGFyZSBzcGVjaW1lbnMsIHRoZSBkaWFnbm9zdGljYWxseSByZWxldmFudCB0aW1lIGNhbiBiZSBkZXJpdmVkIGZyb20gdGhlIHNwZWNpbWVuIGNvbGxlY3Rpb24gdGltZXMsIGJ1dCB0aGUgc3BlY2ltZW4gaW5mb3JtYXRpb24gaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGFuZCB0aGUgZXhhY3QgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlIHNwZWNpbWVucyBhbmQgdGhlIGRpYWdub3N0aWNhbGx5IHJlbGV2YW50IHRpbWUgaXMgbm90IGFsd2F5cyBhdXRvbWF0aWMuXHJcbiAgICovXHJcbiAgZWZmZWN0aXZlUGVyaW9kPzogZmhpci5QZXJpb2RBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBNYXkgYmUgZGlmZmVyZW50IGZyb20gdGhlIHVwZGF0ZSB0aW1lIG9mIHRoZSByZXNvdXJjZSBpdHNlbGYsIGJlY2F1c2UgdGhhdCBpcyB0aGUgc3RhdHVzIG9mIHRoZSByZWNvcmQgKHBvdGVudGlhbGx5IGEgc2Vjb25kYXJ5IGNvcHkpLCBub3QgdGhlIGFjdHVhbCByZWxlYXNlIHRpbWUgb2YgdGhlIHJlcG9ydC5cclxuICAgKi9cclxuICBpc3N1ZWQ/OiBmaGlyLkZoaXJJbnN0YW50fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERpYWdub3N0aWNSZXBvcnQuaXNzdWVkXHJcbiAgICovXHJcbiAgX2lzc3VlZD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBpcyBub3QgbmVjZXNzYXJpbHkgdGhlIHNvdXJjZSBvZiB0aGUgYXRvbWljIGRhdGEgaXRlbXMgb3IgdGhlIGVudGl0eSB0aGF0IGludGVycHJldGVkIHRoZSByZXN1bHRzLiBJdCBpcyB0aGUgZW50aXR5IHRoYXQgdGFrZXMgcmVzcG9uc2liaWxpdHkgZm9yIHRoZSBjbGluaWNhbCByZXBvcnQuXHJcbiAgICovXHJcbiAgcGVyZm9ybWVyPzogZmhpci5SZWZlcmVuY2VBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIE1pZ2h0IG5vdCBiZSB0aGUgc2FtZSBlbnRpdHkgdGhhdCB0YWtlcyByZXNwb25zaWJpbGl0eSBmb3IgdGhlIGNsaW5pY2FsIHJlcG9ydC5cclxuICAgKi9cclxuICByZXN1bHRzSW50ZXJwcmV0ZXI/OiBmaGlyLlJlZmVyZW5jZUFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWYgdGhlIHNwZWNpbWVuIGlzIHN1ZmZpY2llbnRseSBzcGVjaWZpZWQgd2l0aCBhIGNvZGUgaW4gdGhlIHRlc3QgcmVzdWx0IG5hbWUsIHRoZW4gdGhpcyBhZGRpdGlvbmFsIGRhdGEgbWF5IGJlIHJlZHVuZGFudC4gSWYgdGhlcmUgYXJlIG11bHRpcGxlIHNwZWNpbWVucywgdGhlc2UgbWF5IGJlIHJlcHJlc2VudGVkIHBlciBvYnNlcnZhdGlvbiBvciBncm91cC5cclxuICAgKi9cclxuICBzcGVjaW1lbj86IGZoaXIuUmVmZXJlbmNlQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBPYnNlcnZhdGlvbnMgY2FuIGNvbnRhaW4gb2JzZXJ2YXRpb25zLlxyXG4gICAqL1xyXG4gIHJlc3VsdD86IGZoaXIuUmVmZXJlbmNlQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbWFnaW5nU3R1ZHkgYW5kIHRoZSBpbWFnZSBlbGVtZW50IGFyZSBzb21ld2hhdCBvdmVybGFwcGluZyAtIHR5cGljYWxseSwgdGhlIGxpc3Qgb2YgaW1hZ2UgcmVmZXJlbmNlcyBpbiB0aGUgaW1hZ2UgZWxlbWVudCB3aWxsIGFsc28gYmUgZm91bmQgaW4gb25lIG9mIHRoZSBpbWFnaW5nIHN0dWR5IHJlc291cmNlcy4gSG93ZXZlciwgZWFjaCBjYXRlcnMgdG8gZGlmZmVyZW50IHR5cGVzIG9mIGRpc3BsYXlzIGZvciBkaWZmZXJlbnQgdHlwZXMgb2YgcHVycG9zZXMuIE5laXRoZXIsIGVpdGhlciwgb3IgYm90aCBtYXkgYmUgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgaW1hZ2luZ1N0dWR5PzogZmhpci5SZWZlcmVuY2VBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEEgbGlzdCBvZiBrZXkgaW1hZ2VzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHJlcG9ydC4gVGhlIGltYWdlcyBhcmUgZ2VuZXJhbGx5IGNyZWF0ZWQgZHVyaW5nIHRoZSBkaWFnbm9zdGljIHByb2Nlc3MsIGFuZCBtYXkgYmUgZGlyZWN0bHkgb2YgdGhlIHBhdGllbnQsIG9yIG9mIHRyZWF0ZWQgc3BlY2ltZW5zIChpLmUuIHNsaWRlcyBvZiBpbnRlcmVzdCkuXHJcbiAgICovXHJcbiAgbWVkaWE/OiBmaGlyLkRpYWdub3N0aWNSZXBvcnRNZWRpYUFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQ29uY2lzZSBhbmQgY2xpbmljYWxseSBjb250ZXh0dWFsaXplZCBzdW1tYXJ5IGNvbmNsdXNpb24gKGludGVycHJldGF0aW9uL2ltcHJlc3Npb24pIG9mIHRoZSBkaWFnbm9zdGljIHJlcG9ydC5cclxuICAgKi9cclxuICBjb25jbHVzaW9uPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERpYWdub3N0aWNSZXBvcnQuY29uY2x1c2lvblxyXG4gICAqL1xyXG4gIF9jb25jbHVzaW9uPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBPbmUgb3IgbW9yZSBjb2RlcyB0aGF0IHJlcHJlc2VudCB0aGUgc3VtbWFyeSBjb25jbHVzaW9uIChpbnRlcnByZXRhdGlvbi9pbXByZXNzaW9uKSBvZiB0aGUgZGlhZ25vc3RpYyByZXBvcnQuXHJcbiAgICovXHJcbiAgY29uY2x1c2lvbkNvZGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogXCJhcHBsaWNhdGlvbi9wZGZcIiBpcyByZWNvbW1lbmRlZCBhcyB0aGUgbW9zdCByZWxpYWJsZSBhbmQgaW50ZXJvcGVyYWJsZSBpbiB0aGlzIGNvbnRleHQuXHJcbiAgICovXHJcbiAgcHJlc2VudGVkRm9ybT86IGZoaXIuQXR0YWNobWVudEFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgZmluZGluZ3MgYW5kIGludGVycHJldGF0aW9uIG9mIGRpYWdub3N0aWMgIHRlc3RzIHBlcmZvcm1lZCBvbiBwYXRpZW50cywgZ3JvdXBzIG9mIHBhdGllbnRzLCBkZXZpY2VzLCBhbmQgbG9jYXRpb25zLCBhbmQvb3Igc3BlY2ltZW5zIGRlcml2ZWQgZnJvbSB0aGVzZS4gVGhlIHJlcG9ydCBpbmNsdWRlcyBjbGluaWNhbCBjb250ZXh0IHN1Y2ggYXMgcmVxdWVzdGluZyBhbmQgcHJvdmlkZXIgaW5mb3JtYXRpb24sIGFuZCBzb21lIG1peCBvZiBhdG9taWMgcmVzdWx0cywgaW1hZ2VzLCB0ZXh0dWFsIGFuZCBjb2RlZCBpbnRlcnByZXRhdGlvbnMsIGFuZCBmb3JtYXR0ZWQgcmVwcmVzZW50YXRpb24gb2YgZGlhZ25vc3RpYyByZXBvcnRzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIERpYWdub3N0aWNSZXBvcnQgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0RpYWdub3N0aWNSZXBvcnQnO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiRGlhZ25vc3RpY1JlcG9ydFwiO1xyXG4gIC8qKlxyXG4gICAqIFVzdWFsbHkgYXNzaWduZWQgYnkgdGhlIEluZm9ybWF0aW9uIFN5c3RlbSBvZiB0aGUgZGlhZ25vc3RpYyBzZXJ2aWNlIHByb3ZpZGVyIChmaWxsZXIgaWQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpZGVudGlmaWVyOiBmaGlyLklkZW50aWZpZXJbXTtcclxuICAvKipcclxuICAgKiBOb3RlOiBVc3VhbGx5IHRoZXJlIGlzIG9uZSB0ZXN0IHJlcXVlc3QgZm9yIGVhY2ggcmVzdWx0LCBob3dldmVyIGluIHNvbWUgY2lyY3Vtc3RhbmNlcyBtdWx0aXBsZSB0ZXN0IHJlcXVlc3RzIG1heSBiZSByZXByZXNlbnRlZCB1c2luZyBhIHNpbmdsZSB0ZXN0IHJlc3VsdCByZXNvdXJjZS4gTm90ZSB0aGF0IHRoZXJlIGFyZSBhbHNvIGNhc2VzIHdoZXJlIG9uZSByZXF1ZXN0IGxlYWRzIHRvIG11bHRpcGxlIHJlcG9ydHMuXHJcbiAgICovXHJcbiAgcHVibGljIGJhc2VkT246IGZoaXIuUmVmZXJlbmNlW107XHJcbiAgLyoqXHJcbiAgICogVGhlIHN0YXR1cyBvZiB0aGUgZGlhZ25vc3RpYyByZXBvcnQuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXR1czogZmhpci5GaGlyQ29kZTxEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kZVR5cGU+fG51bGw7XHJcbiAgLyoqXHJcbiAgICogTXVsdGlwbGUgY2F0ZWdvcmllcyBhcmUgYWxsb3dlZCB1c2luZyB2YXJpb3VzIGNhdGVnb3JpemF0aW9uIHNjaGVtZXMuICAgVGhlIGxldmVsIG9mIGdyYW51bGFyaXR5IGlzIGRlZmluZWQgYnkgdGhlIGNhdGVnb3J5IGNvbmNlcHRzIGluIHRoZSB2YWx1ZSBzZXQuIE1vcmUgZmluZS1ncmFpbmVkIGZpbHRlcmluZyBjYW4gYmUgcGVyZm9ybWVkIHVzaW5nIHRoZSBtZXRhZGF0YSBhbmQvb3IgdGVybWlub2xvZ3kgaGllcmFyY2h5IGluIERpYWdub3N0aWNSZXBvcnQuY29kZS5cclxuICAgKi9cclxuICBwdWJsaWMgY2F0ZWdvcnk6IGZoaXIuQ29kZWFibGVDb25jZXB0W107XHJcbiAgLyoqXHJcbiAgICogQSBjb2RlIG9yIG5hbWUgdGhhdCBkZXNjcmliZXMgdGhpcyBkaWFnbm9zdGljIHJlcG9ydC5cclxuICAgKi9cclxuICBwdWJsaWMgY29kZTogZmhpci5Db2RlYWJsZUNvbmNlcHR8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgc3ViamVjdCBvZiB0aGUgcmVwb3J0LiBVc3VhbGx5LCBidXQgbm90IGFsd2F5cywgdGhpcyBpcyBhIHBhdGllbnQuIEhvd2V2ZXIsIGRpYWdub3N0aWMgc2VydmljZXMgYWxzbyBwZXJmb3JtIGFuYWx5c2VzIG9uIHNwZWNpbWVucyBjb2xsZWN0ZWQgZnJvbSBhIHZhcmlldHkgb2Ygb3RoZXIgc291cmNlcy5cclxuICAgKi9cclxuICBwdWJsaWMgc3ViamVjdD86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGlzIHdpbGwgdHlwaWNhbGx5IGJlIHRoZSBlbmNvdW50ZXIgdGhlIGV2ZW50IG9jY3VycmVkIHdpdGhpbiwgYnV0IHNvbWUgZXZlbnRzIG1heSBiZSBpbml0aWF0ZWQgcHJpb3IgdG8gb3IgYWZ0ZXIgdGhlIG9mZmljaWFsIGNvbXBsZXRpb24gb2YgYW4gZW5jb3VudGVyICBidXQgc3RpbGwgYmUgdGllZCB0byB0aGUgY29udGV4dCBvZiB0aGUgZW5jb3VudGVyICAoZS5nLiBwcmUtYWRtaXNzaW9uIGxhYm9yYXRvcnkgdGVzdHMpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBlbmNvdW50ZXI/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWYgdGhlIGRpYWdub3N0aWMgcHJvY2VkdXJlIHdhcyBwZXJmb3JtZWQgb24gdGhlIHBhdGllbnQsIHRoaXMgaXMgdGhlIHRpbWUgaXQgd2FzIHBlcmZvcm1lZC4gSWYgdGhlcmUgYXJlIHNwZWNpbWVucywgdGhlIGRpYWdub3N0aWNhbGx5IHJlbGV2YW50IHRpbWUgY2FuIGJlIGRlcml2ZWQgZnJvbSB0aGUgc3BlY2ltZW4gY29sbGVjdGlvbiB0aW1lcywgYnV0IHRoZSBzcGVjaW1lbiBpbmZvcm1hdGlvbiBpcyBub3QgYWx3YXlzIGF2YWlsYWJsZSwgYW5kIHRoZSBleGFjdCByZWxhdGlvbnNoaXAgYmV0d2VlbiB0aGUgc3BlY2ltZW5zIGFuZCB0aGUgZGlhZ25vc3RpY2FsbHkgcmVsZXZhbnQgdGltZSBpcyBub3QgYWx3YXlzIGF1dG9tYXRpYy5cclxuICAgKi9cclxuICBwdWJsaWMgZWZmZWN0aXZlPzogKGZoaXIuRmhpckRhdGVUaW1lfGZoaXIuUGVyaW9kKXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW50ZXJuYWwgZmxhZyB0byBwcm9wZXJseSBzZXJpYWxpemUgY2hvaWNlLXR5cGUgZWxlbWVudCBEaWFnbm9zdGljUmVwb3J0LmVmZmVjdGl2ZVt4XVxyXG4gICAqL1xyXG4gIHByb3RlY3RlZCBzdGF0aWMgcmVhZG9ubHkgX2Z0c19lZmZlY3RpdmVJc0Nob2ljZTp0cnVlID0gdHJ1ZTtcclxuICAvKipcclxuICAgKiBNYXkgYmUgZGlmZmVyZW50IGZyb20gdGhlIHVwZGF0ZSB0aW1lIG9mIHRoZSByZXNvdXJjZSBpdHNlbGYsIGJlY2F1c2UgdGhhdCBpcyB0aGUgc3RhdHVzIG9mIHRoZSByZWNvcmQgKHBvdGVudGlhbGx5IGEgc2Vjb25kYXJ5IGNvcHkpLCBub3QgdGhlIGFjdHVhbCByZWxlYXNlIHRpbWUgb2YgdGhlIHJlcG9ydC5cclxuICAgKi9cclxuICBwdWJsaWMgaXNzdWVkPzogZmhpci5GaGlySW5zdGFudHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBpcyBub3QgbmVjZXNzYXJpbHkgdGhlIHNvdXJjZSBvZiB0aGUgYXRvbWljIGRhdGEgaXRlbXMgb3IgdGhlIGVudGl0eSB0aGF0IGludGVycHJldGVkIHRoZSByZXN1bHRzLiBJdCBpcyB0aGUgZW50aXR5IHRoYXQgdGFrZXMgcmVzcG9uc2liaWxpdHkgZm9yIHRoZSBjbGluaWNhbCByZXBvcnQuXHJcbiAgICovXHJcbiAgcHVibGljIHBlcmZvcm1lcjogZmhpci5SZWZlcmVuY2VbXTtcclxuICAvKipcclxuICAgKiBNaWdodCBub3QgYmUgdGhlIHNhbWUgZW50aXR5IHRoYXQgdGFrZXMgcmVzcG9uc2liaWxpdHkgZm9yIHRoZSBjbGluaWNhbCByZXBvcnQuXHJcbiAgICovXHJcbiAgcHVibGljIHJlc3VsdHNJbnRlcnByZXRlcjogZmhpci5SZWZlcmVuY2VbXTtcclxuICAvKipcclxuICAgKiBJZiB0aGUgc3BlY2ltZW4gaXMgc3VmZmljaWVudGx5IHNwZWNpZmllZCB3aXRoIGEgY29kZSBpbiB0aGUgdGVzdCByZXN1bHQgbmFtZSwgdGhlbiB0aGlzIGFkZGl0aW9uYWwgZGF0YSBtYXkgYmUgcmVkdW5kYW50LiBJZiB0aGVyZSBhcmUgbXVsdGlwbGUgc3BlY2ltZW5zLCB0aGVzZSBtYXkgYmUgcmVwcmVzZW50ZWQgcGVyIG9ic2VydmF0aW9uIG9yIGdyb3VwLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzcGVjaW1lbjogZmhpci5SZWZlcmVuY2VbXTtcclxuICAvKipcclxuICAgKiBPYnNlcnZhdGlvbnMgY2FuIGNvbnRhaW4gb2JzZXJ2YXRpb25zLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZXN1bHQ6IGZoaXIuUmVmZXJlbmNlW107XHJcbiAgLyoqXHJcbiAgICogSW1hZ2luZ1N0dWR5IGFuZCB0aGUgaW1hZ2UgZWxlbWVudCBhcmUgc29tZXdoYXQgb3ZlcmxhcHBpbmcgLSB0eXBpY2FsbHksIHRoZSBsaXN0IG9mIGltYWdlIHJlZmVyZW5jZXMgaW4gdGhlIGltYWdlIGVsZW1lbnQgd2lsbCBhbHNvIGJlIGZvdW5kIGluIG9uZSBvZiB0aGUgaW1hZ2luZyBzdHVkeSByZXNvdXJjZXMuIEhvd2V2ZXIsIGVhY2ggY2F0ZXJzIHRvIGRpZmZlcmVudCB0eXBlcyBvZiBkaXNwbGF5cyBmb3IgZGlmZmVyZW50IHR5cGVzIG9mIHB1cnBvc2VzLiBOZWl0aGVyLCBlaXRoZXIsIG9yIGJvdGggbWF5IGJlIHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbWFnaW5nU3R1ZHk6IGZoaXIuUmVmZXJlbmNlW107XHJcbiAgLyoqXHJcbiAgICogQSBsaXN0IG9mIGtleSBpbWFnZXMgYXNzb2NpYXRlZCB3aXRoIHRoaXMgcmVwb3J0LiBUaGUgaW1hZ2VzIGFyZSBnZW5lcmFsbHkgY3JlYXRlZCBkdXJpbmcgdGhlIGRpYWdub3N0aWMgcHJvY2VzcywgYW5kIG1heSBiZSBkaXJlY3RseSBvZiB0aGUgcGF0aWVudCwgb3Igb2YgdHJlYXRlZCBzcGVjaW1lbnMgKGkuZS4gc2xpZGVzIG9mIGludGVyZXN0KS5cclxuICAgKi9cclxuICBwdWJsaWMgbWVkaWE6IGZoaXIuRGlhZ25vc3RpY1JlcG9ydE1lZGlhW107XHJcbiAgLyoqXHJcbiAgICogQ29uY2lzZSBhbmQgY2xpbmljYWxseSBjb250ZXh0dWFsaXplZCBzdW1tYXJ5IGNvbmNsdXNpb24gKGludGVycHJldGF0aW9uL2ltcHJlc3Npb24pIG9mIHRoZSBkaWFnbm9zdGljIHJlcG9ydC5cclxuICAgKi9cclxuICBwdWJsaWMgY29uY2x1c2lvbj86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogT25lIG9yIG1vcmUgY29kZXMgdGhhdCByZXByZXNlbnQgdGhlIHN1bW1hcnkgY29uY2x1c2lvbiAoaW50ZXJwcmV0YXRpb24vaW1wcmVzc2lvbikgb2YgdGhlIGRpYWdub3N0aWMgcmVwb3J0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25jbHVzaW9uQ29kZTogZmhpci5Db2RlYWJsZUNvbmNlcHRbXTtcclxuICAvKipcclxuICAgKiBcImFwcGxpY2F0aW9uL3BkZlwiIGlzIHJlY29tbWVuZGVkIGFzIHRoZSBtb3N0IHJlbGlhYmxlIGFuZCBpbnRlcm9wZXJhYmxlIGluIHRoaXMgY29udGV4dC5cclxuICAgKi9cclxuICBwdWJsaWMgcHJlc2VudGVkRm9ybTogZmhpci5BdHRhY2htZW50W107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgRGlhZ25vc3RpY1JlcG9ydCAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPERpYWdub3N0aWNSZXBvcnRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnRGlhZ25vc3RpY1JlcG9ydCc7XHJcbiAgICBpZiAoc291cmNlWydpZGVudGlmaWVyJ10pIHsgdGhpcy5pZGVudGlmaWVyID0gc291cmNlLmlkZW50aWZpZXIubWFwKCh4KSA9PiBuZXcgZmhpci5JZGVudGlmaWVyKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaWRlbnRpZmllciA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydiYXNlZE9uJ10pIHsgdGhpcy5iYXNlZE9uID0gc291cmNlLmJhc2VkT24ubWFwKCh4KSA9PiBuZXcgZmhpci5SZWZlcmVuY2UoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5iYXNlZE9uID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ3N0YXR1cyddKSB7IHRoaXMuc3RhdHVzID0gbmV3IGZoaXIuRmhpckNvZGU8RGlhZ25vc3RpY1JlcG9ydFN0YXR1c0NvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5zdGF0dXN9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuc3RhdHVzID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3N0YXR1cyddKSB7XHJcbiAgICAgIGlmICh0aGlzLnN0YXR1cykgeyB0aGlzLnN0YXR1cy5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9zdGF0dXMhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kZVR5cGU+KHNvdXJjZS5fc3RhdHVzIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydjYXRlZ29yeSddKSB7IHRoaXMuY2F0ZWdvcnkgPSBzb3VyY2UuY2F0ZWdvcnkubWFwKCh4KSA9PiBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5jYXRlZ29yeSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydjb2RlJ10pIHsgdGhpcy5jb2RlID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5jb2RlKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuY29kZSA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ3N1YmplY3QnXSkgeyB0aGlzLnN1YmplY3QgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnN1YmplY3QpOyB9XHJcbiAgICBpZiAoc291cmNlWydlbmNvdW50ZXInXSkgeyB0aGlzLmVuY291bnRlciA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuZW5jb3VudGVyKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZWZmZWN0aXZlJ10pIHsgdGhpcy5lZmZlY3RpdmUgPSBzb3VyY2UuZWZmZWN0aXZlOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ2VmZmVjdGl2ZURhdGVUaW1lJ10pIHsgdGhpcy5lZmZlY3RpdmUgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoe3ZhbHVlOiBzb3VyY2UuZWZmZWN0aXZlRGF0ZVRpbWV9KTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWydlZmZlY3RpdmVQZXJpb2QnXSkgeyB0aGlzLmVmZmVjdGl2ZSA9IG5ldyBmaGlyLlBlcmlvZChzb3VyY2UuZWZmZWN0aXZlUGVyaW9kKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaXNzdWVkJ10pIHsgdGhpcy5pc3N1ZWQgPSBuZXcgZmhpci5GaGlySW5zdGFudCh7dmFsdWU6IHNvdXJjZS5pc3N1ZWR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2lzc3VlZCddKSB7XHJcbiAgICAgIGlmICh0aGlzLmlzc3VlZCkgeyB0aGlzLmlzc3VlZC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9pc3N1ZWQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5pc3N1ZWQgPSBuZXcgZmhpci5GaGlySW5zdGFudChzb3VyY2UuX2lzc3VlZCBhcyBQYXJ0aWFsPGZoaXIuRmhpckluc3RhbnRBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3BlcmZvcm1lciddKSB7IHRoaXMucGVyZm9ybWVyID0gc291cmNlLnBlcmZvcm1lci5tYXAoKHgpID0+IG5ldyBmaGlyLlJlZmVyZW5jZSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnBlcmZvcm1lciA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydyZXN1bHRzSW50ZXJwcmV0ZXInXSkgeyB0aGlzLnJlc3VsdHNJbnRlcnByZXRlciA9IHNvdXJjZS5yZXN1bHRzSW50ZXJwcmV0ZXIubWFwKCh4KSA9PiBuZXcgZmhpci5SZWZlcmVuY2UoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5yZXN1bHRzSW50ZXJwcmV0ZXIgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3BlY2ltZW4nXSkgeyB0aGlzLnNwZWNpbWVuID0gc291cmNlLnNwZWNpbWVuLm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuc3BlY2ltZW4gPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncmVzdWx0J10pIHsgdGhpcy5yZXN1bHQgPSBzb3VyY2UucmVzdWx0Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucmVzdWx0ID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2ltYWdpbmdTdHVkeSddKSB7IHRoaXMuaW1hZ2luZ1N0dWR5ID0gc291cmNlLmltYWdpbmdTdHVkeS5tYXAoKHgpID0+IG5ldyBmaGlyLlJlZmVyZW5jZSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmltYWdpbmdTdHVkeSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydtZWRpYSddKSB7IHRoaXMubWVkaWEgPSBzb3VyY2UubWVkaWEubWFwKCh4KSA9PiBuZXcgZmhpci5EaWFnbm9zdGljUmVwb3J0TWVkaWEoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5tZWRpYSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydjb25jbHVzaW9uJ10pIHsgdGhpcy5jb25jbHVzaW9uID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS5jb25jbHVzaW9ufSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19jb25jbHVzaW9uJ10pIHtcclxuICAgICAgaWYgKHRoaXMuY29uY2x1c2lvbikgeyB0aGlzLmNvbmNsdXNpb24uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fY29uY2x1c2lvbiEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmNvbmNsdXNpb24gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHNvdXJjZS5fY29uY2x1c2lvbiBhcyBQYXJ0aWFsPGZoaXIuRmhpclN0cmluZ0FyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnY29uY2x1c2lvbkNvZGUnXSkgeyB0aGlzLmNvbmNsdXNpb25Db2RlID0gc291cmNlLmNvbmNsdXNpb25Db2RlLm1hcCgoeCkgPT4gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuY29uY2x1c2lvbkNvZGUgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncHJlc2VudGVkRm9ybSddKSB7IHRoaXMucHJlc2VudGVkRm9ybSA9IHNvdXJjZS5wcmVzZW50ZWRGb3JtLm1hcCgoeCkgPT4gbmV3IGZoaXIuQXR0YWNobWVudCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnByZXNlbnRlZEZvcm0gPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBSZXF1aXJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIHN0YXR1cyAoRGlhZ25vc3RpY1JlcG9ydC5zdGF0dXMpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXQgc3RhdHVzUmVxdWlyZWRDb2RlcygpIHtcclxuICAgIHJldHVybiBEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kZXM7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFByZWZlcnJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIGNvZGUgKERpYWdub3N0aWNSZXBvcnQuY29kZSlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCBjb2RlUHJlZmVycmVkQ29kaW5ncygpOlJlcG9ydENvZGluZ1R5cGUge1xyXG4gICAgcmV0dXJuIFJlcG9ydENvZGluZ3M7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbigpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKCk7XHJcbiAgICBpZiAoIXRoaXNbJ3Jlc291cmNlVHlwZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSByZXNvdXJjZVR5cGU6XCJEaWFnbm9zdGljUmVwb3J0XCIgZmhpcjogRGlhZ25vc3RpY1JlcG9ydC5yZXNvdXJjZVR5cGU6XCJEaWFnbm9zdGljUmVwb3J0XCInIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJpZGVudGlmaWVyXCJdKSB7IHRoaXMuaWRlbnRpZmllci5mb3JFYWNoKCh4KSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH0pIH1cclxuICAgIGlmICh0aGlzW1wiYmFzZWRPblwiXSkgeyB0aGlzLmJhc2VkT24uZm9yRWFjaCgoeCkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9KSB9XHJcbiAgICBpZiAoIXRoaXNbJ3N0YXR1cyddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSBzdGF0dXM6Zmhpci5GaGlyQ29kZTxEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kZVR5cGU+IGZoaXI6IERpYWdub3N0aWNSZXBvcnQuc3RhdHVzOmNvZGUnIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbJ3N0YXR1cyddICYmICghT2JqZWN0LnZhbHVlcyhEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kZXMpLmluY2x1ZGVzKHRoaXMuc3RhdHVzIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ0ludmFsaWQgY29kZSBwcm9wZXJ0eSBzdGF0dXM6Zmhpci5GaGlyQ29kZTxEaWFnbm9zdGljUmVwb3J0U3RhdHVzQ29kZVR5cGU+IGZoaXI6IERpYWdub3N0aWNSZXBvcnQuc3RhdHVzOmNvZGUgUmVxdWlyZWQgYmluZGluZyB0bzogRGlhZ25vc3RpY1JlcG9ydFN0YXR1cycgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInN0YXR1c1wiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnN0YXR1cy5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJjYXRlZ29yeVwiXSkgeyB0aGlzLmNhdGVnb3J5LmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgaWYgKCF0aGlzWydjb2RlJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IGNvZGU6Zmhpci5Db2RlYWJsZUNvbmNlcHQgZmhpcjogRGlhZ25vc3RpY1JlcG9ydC5jb2RlOkNvZGVhYmxlQ29uY2VwdCcgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcImNvZGVcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5jb2RlLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1tcInN1YmplY3RcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5zdWJqZWN0LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1tcImVuY291bnRlclwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmVuY291bnRlci5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJpc3N1ZWRcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5pc3N1ZWQuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzW1wicGVyZm9ybWVyXCJdKSB7IHRoaXMucGVyZm9ybWVyLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJyZXN1bHRzSW50ZXJwcmV0ZXJcIl0pIHsgdGhpcy5yZXN1bHRzSW50ZXJwcmV0ZXIuZm9yRWFjaCgoeCkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1tcInNwZWNpbWVuXCJdKSB7IHRoaXMuc3BlY2ltZW4uZm9yRWFjaCgoeCkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1tcInJlc3VsdFwiXSkgeyB0aGlzLnJlc3VsdC5mb3JFYWNoKCh4KSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH0pIH1cclxuICAgIGlmICh0aGlzW1wiaW1hZ2luZ1N0dWR5XCJdKSB7IHRoaXMuaW1hZ2luZ1N0dWR5LmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJtZWRpYVwiXSkgeyB0aGlzLm1lZGlhLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJjb25jbHVzaW9uXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMuY29uY2x1c2lvbi5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJjb25jbHVzaW9uQ29kZVwiXSkgeyB0aGlzLmNvbmNsdXNpb25Db2RlLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJwcmVzZW50ZWRGb3JtXCJdKSB7IHRoaXMucHJlc2VudGVkRm9ybS5mb3JFYWNoKCh4KSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH0pIH1cclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbiJdfQ==