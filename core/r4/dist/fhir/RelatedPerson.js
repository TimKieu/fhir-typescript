// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: RelatedPerson
import * as fhir from '../fhir.js';
// @ts-ignore
import { LanguagesCodings, } from '../fhirValueSets/LanguagesCodings.js';
// @ts-ignore
import { RelatedpersonRelationshiptypeCodings, } from '../fhirValueSets/RelatedpersonRelationshiptypeCodings.js';
// @ts-ignore
import { AdministrativeGenderCodes } from '../fhirValueSets/AdministrativeGenderCodes.js';
/**
 * If no language is specified, this *implies* that the default local language is spoken.  If you need to convey proficiency for multiple modes, then you need multiple RelatedPerson.Communication associations.   If the RelatedPerson does not speak the default local language, then the Interpreter Required Standard can be used to explicitly declare that an interpreter is required.
 */
export class RelatedPersonCommunication extends fhir.BackboneElement {
    /**
     * Default constructor for RelatedPersonCommunication - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['language']) {
            this.language = new fhir.CodeableConcept(source.language);
        }
        else {
            this.language = null;
        }
        if (source['preferred']) {
            this.preferred = new fhir.FhirBoolean({ value: source.preferred });
        }
        if (source['_preferred']) {
            if (this.preferred) {
                this.preferred.addExtendedProperties(source._preferred);
            }
            else {
                this.preferred = new fhir.FhirBoolean(source._preferred);
            }
        }
    }
    /**
     * Preferred-bound Value Set for language (RelatedPerson.communication.language)
     */
    static get languagePreferredCodings() {
        return LanguagesCodings;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'RelatedPerson.communication';
        }
        if (!this['language']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property language fhir: RelatedPerson.communication.language:CodeableConcept', expression: [expression] });
        }
        if (this["language"]) {
            issues.push(...this.language.doModelValidation(expression + '.language'));
        }
        if (this["preferred"]) {
            issues.push(...this.preferred.doModelValidation(expression + '.preferred'));
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
RelatedPersonCommunication._fts_dataType = 'RelatedPersonCommunication';
/**
 * Information about a person that is involved in the care for a patient, but who is not the target of healthcare, nor has a formal responsibility in the care process.
 */
export class RelatedPerson extends fhir.DomainResource {
    /**
     * Default constructor for RelatedPerson - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'RelatedPerson';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['active']) {
            this.active = new fhir.FhirBoolean({ value: source.active });
        }
        if (source['_active']) {
            if (this.active) {
                this.active.addExtendedProperties(source._active);
            }
            else {
                this.active = new fhir.FhirBoolean(source._active);
            }
        }
        if (source['patient']) {
            this.patient = new fhir.Reference(source.patient);
        }
        else {
            this.patient = null;
        }
        if (source['relationship']) {
            this.relationship = source.relationship.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.relationship = [];
        }
        if (source['name']) {
            this.name = source.name.map((x) => new fhir.HumanName(x));
        }
        else {
            this.name = [];
        }
        if (source['telecom']) {
            this.telecom = source.telecom.map((x) => new fhir.ContactPoint(x));
        }
        else {
            this.telecom = [];
        }
        if (source['gender']) {
            this.gender = new fhir.FhirCode({ value: source.gender });
        }
        if (source['_gender']) {
            if (this.gender) {
                this.gender.addExtendedProperties(source._gender);
            }
            else {
                this.gender = new fhir.FhirCode(source._gender);
            }
        }
        if (source['birthDate']) {
            this.birthDate = new fhir.FhirDate({ value: source.birthDate });
        }
        if (source['_birthDate']) {
            if (this.birthDate) {
                this.birthDate.addExtendedProperties(source._birthDate);
            }
            else {
                this.birthDate = new fhir.FhirDate(source._birthDate);
            }
        }
        if (source['address']) {
            this.address = source.address.map((x) => new fhir.Address(x));
        }
        else {
            this.address = [];
        }
        if (source['photo']) {
            this.photo = source.photo.map((x) => new fhir.Attachment(x));
        }
        else {
            this.photo = [];
        }
        if (source['period']) {
            this.period = new fhir.Period(source.period);
        }
        if (source['communication']) {
            this.communication = source.communication.map((x) => new fhir.RelatedPersonCommunication(x));
        }
        else {
            this.communication = [];
        }
    }
    /**
     * Preferred-bound Value Set for relationship (RelatedPerson.relationship)
     */
    static get relationshipPreferredCodings() {
        return RelatedpersonRelationshiptypeCodings;
    }
    /**
     * Required-bound Value Set for gender (RelatedPerson.gender)
     */
    static get genderRequiredCodes() {
        return AdministrativeGenderCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'RelatedPerson';
        }
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType fhir: RelatedPerson.resourceType:"RelatedPerson"', expression: [expression] });
        }
        if (this["identifier"]) {
            this.identifier.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.identifier[${i}]`)); });
        }
        if (this["active"]) {
            issues.push(...this.active.doModelValidation(expression + '.active'));
        }
        if (!this['patient']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property patient fhir: RelatedPerson.patient:Reference', expression: [expression] });
        }
        if (this["patient"]) {
            issues.push(...this.patient.doModelValidation(expression + '.patient'));
        }
        if (this["relationship"]) {
            this.relationship.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.relationship[${i}]`)); });
        }
        if (this["name"]) {
            this.name.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.name[${i}]`)); });
        }
        if (this["telecom"]) {
            this.telecom.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.telecom[${i}]`)); });
        }
        if (this['gender'] && (!Object.values(AdministrativeGenderCodes).includes(this.gender.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property gender fhir: RelatedPerson.gender:code Required binding to: AdministrativeGender', expression: [expression] });
        }
        if (this["gender"]) {
            issues.push(...this.gender.doModelValidation(expression + '.gender'));
        }
        if (this["birthDate"]) {
            issues.push(...this.birthDate.doModelValidation(expression + '.birthDate'));
        }
        if (this["address"]) {
            this.address.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.address[${i}]`)); });
        }
        if (this["photo"]) {
            this.photo.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.photo[${i}]`)); });
        }
        if (this["period"]) {
            issues.push(...this.period.doModelValidation(expression + '.period'));
        }
        if (this["communication"]) {
            this.communication.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.communication[${i}]`)); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
RelatedPerson._fts_dataType = 'RelatedPerson';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVsYXRlZFBlcnNvbi5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvUmVsYXRlZFBlcnNvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQywrQkFBK0I7QUFFL0IsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFFbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSxnQkFBZ0IsR0FBdUIsTUFBTSxzQ0FBc0MsQ0FBQztBQUc3RixhQUFhO0FBQ2IsT0FBTyxFQUFFLG9DQUFvQyxHQUEyQyxNQUFNLDBEQUEwRCxDQUFDO0FBS3pKLGFBQWE7QUFDYixPQUFPLEVBQUUseUJBQXlCLEVBQWlDLE1BQU0sK0NBQStDLENBQUM7QUFtQnpIOztHQUVHO0FBQ0gsTUFBTSxPQUFPLDBCQUEyQixTQUFRLElBQUksQ0FBQyxlQUFlO0lBYWxFOztPQUVHO0lBQ0gsWUFBWSxTQUFpRCxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUN2RyxLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQUU7YUFDakY7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzlCLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLFNBQVMsRUFBQyxDQUFDLENBQUM7U0FBRTtRQUM5RixJQUFJLE1BQU0sQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUN4QixJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7Z0JBQUUsSUFBSSxDQUFD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cyBvZjogaGw3LmZoaXIucjQuY29yZSB2ZXJzaW9uOiA0LjAuMVxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgUmVzb3VyY2U6IFJlbGF0ZWRQZXJzb25cclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IExhbmd1YWdlc0NvZGluZ3MsIExhbmd1YWdlc0NvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0xhbmd1YWdlc0NvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IExhbmd1YWdlc0NvZGVzLCAgTGFuZ3VhZ2VzQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0xhbmd1YWdlc0NvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBSZWxhdGVkcGVyc29uUmVsYXRpb25zaGlwdHlwZUNvZGluZ3MsIFJlbGF0ZWRwZXJzb25SZWxhdGlvbnNoaXB0eXBlQ29kaW5nVHlwZSx9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUmVsYXRlZHBlcnNvblJlbGF0aW9uc2hpcHR5cGVDb2RpbmdzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBSZWxhdGVkcGVyc29uUmVsYXRpb25zaGlwdHlwZUNvZGVzLCAgUmVsYXRlZHBlcnNvblJlbGF0aW9uc2hpcHR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvUmVsYXRlZHBlcnNvblJlbGF0aW9uc2hpcHR5cGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgQWRtaW5pc3RyYXRpdmVHZW5kZXJDb2RpbmdzLCBBZG1pbmlzdHJhdGl2ZUdlbmRlckNvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0FkbWluaXN0cmF0aXZlR2VuZGVyQ29kaW5ncy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgQWRtaW5pc3RyYXRpdmVHZW5kZXJDb2RlcywgIEFkbWluaXN0cmF0aXZlR2VuZGVyQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL0FkbWluaXN0cmF0aXZlR2VuZGVyQ29kZXMuanMnO1xyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgUmVsYXRlZFBlcnNvbkNvbW11bmljYXRpb24gdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmVsYXRlZFBlcnNvbkNvbW11bmljYXRpb25BcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgc3RydWN0dXJlIGFhLUJCIHdpdGggdGhpcyBleGFjdCBjYXNpbmcgaXMgb25lIHRoZSBtb3N0IHdpZGVseSB1c2VkIG5vdGF0aW9ucyBmb3IgbG9jYWxlLiBIb3dldmVyIG5vdCBhbGwgc3lzdGVtcyBhY3R1YWxseSBjb2RlIHRoaXMgYnV0IGluc3RlYWQgaGF2ZSBpdCBhcyBmcmVlIHRleHQuIEhlbmNlIENvZGVhYmxlQ29uY2VwdCBpbnN0ZWFkIG9mIGNvZGUgYXMgdGhlIGRhdGEgdHlwZS5cclxuICAgKi9cclxuICBsYW5ndWFnZTogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBsYW5ndWFnZSBpcyBzcGVjaWZpY2FsbHkgaWRlbnRpZmllZCBmb3IgY29tbXVuaWNhdGluZyBoZWFsdGhjYXJlIGluZm9ybWF0aW9uLlxyXG4gICAqL1xyXG4gIHByZWZlcnJlZD86IGZoaXIuRmhpckJvb2xlYW58Ym9vbGVhbnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFJlbGF0ZWRQZXJzb24uY29tbXVuaWNhdGlvbi5wcmVmZXJyZWRcclxuICAgKi9cclxuICBfcHJlZmVycmVkPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxufVxyXG5cclxuLyoqXHJcbiAqIElmIG5vIGxhbmd1YWdlIGlzIHNwZWNpZmllZCwgdGhpcyAqaW1wbGllcyogdGhhdCB0aGUgZGVmYXVsdCBsb2NhbCBsYW5ndWFnZSBpcyBzcG9rZW4uICBJZiB5b3UgbmVlZCB0byBjb252ZXkgcHJvZmljaWVuY3kgZm9yIG11bHRpcGxlIG1vZGVzLCB0aGVuIHlvdSBuZWVkIG11bHRpcGxlIFJlbGF0ZWRQZXJzb24uQ29tbXVuaWNhdGlvbiBhc3NvY2lhdGlvbnMuICAgSWYgdGhlIFJlbGF0ZWRQZXJzb24gZG9lcyBub3Qgc3BlYWsgdGhlIGRlZmF1bHQgbG9jYWwgbGFuZ3VhZ2UsIHRoZW4gdGhlIEludGVycHJldGVyIFJlcXVpcmVkIFN0YW5kYXJkIGNhbiBiZSB1c2VkIHRvIGV4cGxpY2l0bHkgZGVjbGFyZSB0aGF0IGFuIGludGVycHJldGVyIGlzIHJlcXVpcmVkLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJlbGF0ZWRQZXJzb25Db21tdW5pY2F0aW9uIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnUmVsYXRlZFBlcnNvbkNvbW11bmljYXRpb24nO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBzdHJ1Y3R1cmUgYWEtQkIgd2l0aCB0aGlzIGV4YWN0IGNhc2luZyBpcyBvbmUgdGhlIG1vc3Qgd2lkZWx5IHVzZWQgbm90YXRpb25zIGZvciBsb2NhbGUuIEhvd2V2ZXIgbm90IGFsbCBzeXN0ZW1zIGFjdHVhbGx5IGNvZGUgdGhpcyBidXQgaW5zdGVhZCBoYXZlIGl0IGFzIGZyZWUgdGV4dC4gSGVuY2UgQ29kZWFibGVDb25jZXB0IGluc3RlYWQgb2YgY29kZSBhcyB0aGUgZGF0YSB0eXBlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBsYW5ndWFnZTogZmhpci5Db2RlYWJsZUNvbmNlcHR8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGlzIGxhbmd1YWdlIGlzIHNwZWNpZmljYWxseSBpZGVudGlmaWVkIGZvciBjb21tdW5pY2F0aW5nIGhlYWx0aGNhcmUgaW5mb3JtYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIHByZWZlcnJlZD86IGZoaXIuRmhpckJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFJlbGF0ZWRQZXJzb25Db21tdW5pY2F0aW9uIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8UmVsYXRlZFBlcnNvbkNvbW11bmljYXRpb25BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsnbGFuZ3VhZ2UnXSkgeyB0aGlzLmxhbmd1YWdlID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5sYW5ndWFnZSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmxhbmd1YWdlID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsncHJlZmVycmVkJ10pIHsgdGhpcy5wcmVmZXJyZWQgPSBuZXcgZmhpci5GaGlyQm9vbGVhbih7dmFsdWU6IHNvdXJjZS5wcmVmZXJyZWR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3ByZWZlcnJlZCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnByZWZlcnJlZCkgeyB0aGlzLnByZWZlcnJlZC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9wcmVmZXJyZWQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5wcmVmZXJyZWQgPSBuZXcgZmhpci5GaGlyQm9vbGVhbihzb3VyY2UuX3ByZWZlcnJlZCBhcyBQYXJ0aWFsPGZoaXIuRmhpckJvb2xlYW5BcmdzPik7IH1cclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogUHJlZmVycmVkLWJvdW5kIFZhbHVlIFNldCBmb3IgbGFuZ3VhZ2UgKFJlbGF0ZWRQZXJzb24uY29tbXVuaWNhdGlvbi5sYW5ndWFnZSlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCBsYW5ndWFnZVByZWZlcnJlZENvZGluZ3MoKTpMYW5ndWFnZXNDb2RpbmdUeXBlIHtcclxuICAgIHJldHVybiBMYW5ndWFnZXNDb2RpbmdzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbjpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbik7XHJcbiAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHsgZXhwcmVzc2lvbiA9ICdSZWxhdGVkUGVyc29uLmNvbW11bmljYXRpb24nIH1cclxuICAgIGlmICghdGhpc1snbGFuZ3VhZ2UnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgbGFuZ3VhZ2UgZmhpcjogUmVsYXRlZFBlcnNvbi5jb21tdW5pY2F0aW9uLmxhbmd1YWdlOkNvZGVhYmxlQ29uY2VwdCcsIGV4cHJlc3Npb246IFtleHByZXNzaW9uXSB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1wibGFuZ3VhZ2VcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5sYW5ndWFnZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycubGFuZ3VhZ2UnKSk7IH1cclxuICAgIGlmICh0aGlzW1wicHJlZmVycmVkXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMucHJlZmVycmVkLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy5wcmVmZXJyZWQnKSk7IH1cclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBSZWxhdGVkUGVyc29uIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFJlbGF0ZWRQZXJzb25BcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJSZWxhdGVkUGVyc29uXCJ8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXIgZm9yIGEgcGVyc29uIHdpdGhpbiBhIHBhcnRpY3VsYXIgc2NvcGUuXHJcbiAgICovXHJcbiAgaWRlbnRpZmllcj86IGZoaXIuSWRlbnRpZmllckFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBlbGVtZW50IGlzIGxhYmVsZWQgYXMgYSBtb2RpZmllciBiZWNhdXNlIGl0IG1heSBiZSB1c2VkIHRvIG1hcmsgdGhhdCB0aGUgcmVzb3VyY2Ugd2FzIGNyZWF0ZWQgaW4gZXJyb3IuXHJcbiAgICovXHJcbiAgYWN0aXZlPzogZmhpci5GaGlyQm9vbGVhbnxib29sZWFufHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogUmVsYXRlZFBlcnNvbi5hY3RpdmVcclxuICAgKi9cclxuICBfYWN0aXZlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGUgcGF0aWVudCB0aGlzIHBlcnNvbiBpcyByZWxhdGVkIHRvLlxyXG4gICAqL1xyXG4gIHBhdGllbnQ6IGZoaXIuUmVmZXJlbmNlQXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBuYXR1cmUgb2YgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGEgcGF0aWVudCBhbmQgdGhlIHJlbGF0ZWQgcGVyc29uLlxyXG4gICAqL1xyXG4gIHJlbGF0aW9uc2hpcD86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIG5hbWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBwZXJzb24uXHJcbiAgICovXHJcbiAgbmFtZT86IGZoaXIuSHVtYW5OYW1lQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBQZXJzb24gbWF5IGhhdmUgbXVsdGlwbGUgd2F5cyB0byBiZSBjb250YWN0ZWQgd2l0aCBkaWZmZXJlbnQgdXNlcyBvciBhcHBsaWNhYmxlIHBlcmlvZHMuICBNYXkgbmVlZCB0byBoYXZlIG9wdGlvbnMgZm9yIGNvbnRhY3RpbmcgdGhlIHBlcnNvbiB1cmdlbnRseSwgYW5kIGFsc28gdG8gaGVscCB3aXRoIGlkZW50aWZpY2F0aW9uLlxyXG4gICAqL1xyXG4gIHRlbGVjb20/OiBmaGlyLkNvbnRhY3RQb2ludEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQWRtaW5pc3RyYXRpdmUgR2VuZGVyIC0gdGhlIGdlbmRlciB0aGF0IHRoZSBwZXJzb24gaXMgY29uc2lkZXJlZCB0byBoYXZlIGZvciBhZG1pbmlzdHJhdGlvbiBhbmQgcmVjb3JkIGtlZXBpbmcgcHVycG9zZXMuXHJcbiAgICovXHJcbiAgZ2VuZGVyPzogZmhpci5GaGlyQ29kZTxBZG1pbmlzdHJhdGl2ZUdlbmRlckNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBSZWxhdGVkUGVyc29uLmdlbmRlclxyXG4gICAqL1xyXG4gIF9nZW5kZXI/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBkYXRlIG9uIHdoaWNoIHRoZSByZWxhdGVkIHBlcnNvbiB3YXMgYm9ybi5cclxuICAgKi9cclxuICBiaXJ0aERhdGU/OiBmaGlyLkZoaXJEYXRlfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IFJlbGF0ZWRQZXJzb24uYmlydGhEYXRlXHJcbiAgICovXHJcbiAgX2JpcnRoRGF0ZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogQWRkcmVzcyB3aGVyZSB0aGUgcmVsYXRlZCBwZXJzb24gY2FuIGJlIGNvbnRhY3RlZCBvciB2aXNpdGVkLlxyXG4gICAqL1xyXG4gIGFkZHJlc3M/OiBmaGlyLkFkZHJlc3NBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEltYWdlIG9mIHRoZSBwZXJzb24uXHJcbiAgICovXHJcbiAgcGhvdG8/OiBmaGlyLkF0dGFjaG1lbnRBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwZXJpb2Qgb2YgdGltZSBkdXJpbmcgd2hpY2ggdGhpcyByZWxhdGlvbnNoaXAgaXMgb3Igd2FzIGFjdGl2ZS4gSWYgdGhlcmUgYXJlIG5vIGRhdGVzIGRlZmluZWQsIHRoZW4gdGhlIGludGVydmFsIGlzIHVua25vd24uXHJcbiAgICovXHJcbiAgcGVyaW9kPzogZmhpci5QZXJpb2RBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJZiBubyBsYW5ndWFnZSBpcyBzcGVjaWZpZWQsIHRoaXMgKmltcGxpZXMqIHRoYXQgdGhlIGRlZmF1bHQgbG9jYWwgbGFuZ3VhZ2UgaXMgc3Bva2VuLiAgSWYgeW91IG5lZWQgdG8gY29udmV5IHByb2ZpY2llbmN5IGZvciBtdWx0aXBsZSBtb2RlcywgdGhlbiB5b3UgbmVlZCBtdWx0aXBsZSBSZWxhdGVkUGVyc29uLkNvbW11bmljYXRpb24gYXNzb2NpYXRpb25zLiAgIElmIHRoZSBSZWxhdGVkUGVyc29uIGRvZXMgbm90IHNwZWFrIHRoZSBkZWZhdWx0IGxvY2FsIGxhbmd1YWdlLCB0aGVuIHRoZSBJbnRlcnByZXRlciBSZXF1aXJlZCBTdGFuZGFyZCBjYW4gYmUgdXNlZCB0byBleHBsaWNpdGx5IGRlY2xhcmUgdGhhdCBhbiBpbnRlcnByZXRlciBpcyByZXF1aXJlZC5cclxuICAgKi9cclxuICBjb21tdW5pY2F0aW9uPzogZmhpci5SZWxhdGVkUGVyc29uQ29tbXVuaWNhdGlvbkFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbmZvcm1hdGlvbiBhYm91dCBhIHBlcnNvbiB0aGF0IGlzIGludm9sdmVkIGluIHRoZSBjYXJlIGZvciBhIHBhdGllbnQsIGJ1dCB3aG8gaXMgbm90IHRoZSB0YXJnZXQgb2YgaGVhbHRoY2FyZSwgbm9yIGhhcyBhIGZvcm1hbCByZXNwb25zaWJpbGl0eSBpbiB0aGUgY2FyZSBwcm9jZXNzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJlbGF0ZWRQZXJzb24gZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ1JlbGF0ZWRQZXJzb24nO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiUmVsYXRlZFBlcnNvblwiO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXIgZm9yIGEgcGVyc29uIHdpdGhpbiBhIHBhcnRpY3VsYXIgc2NvcGUuXHJcbiAgICovXHJcbiAgcHVibGljIGlkZW50aWZpZXI6IGZoaXIuSWRlbnRpZmllcltdO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgZWxlbWVudCBpcyBsYWJlbGVkIGFzIGEgbW9kaWZpZXIgYmVjYXVzZSBpdCBtYXkgYmUgdXNlZCB0byBtYXJrIHRoYXQgdGhlIHJlc291cmNlIHdhcyBjcmVhdGVkIGluIGVycm9yLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhY3RpdmU/OiBmaGlyLkZoaXJCb29sZWFufHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcGF0aWVudCB0aGlzIHBlcnNvbiBpcyByZWxhdGVkIHRvLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXRpZW50OiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBuYXR1cmUgb2YgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGEgcGF0aWVudCBhbmQgdGhlIHJlbGF0ZWQgcGVyc29uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWxhdGlvbnNoaXA6IGZoaXIuQ29kZWFibGVDb25jZXB0W107XHJcbiAgLyoqXHJcbiAgICogQSBuYW1lIGFzc29jaWF0ZWQgd2l0aCB0aGUgcGVyc29uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBuYW1lOiBmaGlyLkh1bWFuTmFtZVtdO1xyXG4gIC8qKlxyXG4gICAqIFBlcnNvbiBtYXkgaGF2ZSBtdWx0aXBsZSB3YXlzIHRvIGJlIGNvbnRhY3RlZCB3aXRoIGRpZmZlcmVudCB1c2VzIG9yIGFwcGxpY2FibGUgcGVyaW9kcy4gIE1heSBuZWVkIHRvIGhhdmUgb3B0aW9ucyBmb3IgY29udGFjdGluZyB0aGUgcGVyc29uIHVyZ2VudGx5LCBhbmQgYWxzbyB0byBoZWxwIHdpdGggaWRlbnRpZmljYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIHRlbGVjb206IGZoaXIuQ29udGFjdFBvaW50W107XHJcbiAgLyoqXHJcbiAgICogQWRtaW5pc3RyYXRpdmUgR2VuZGVyIC0gdGhlIGdlbmRlciB0aGF0IHRoZSBwZXJzb24gaXMgY29uc2lkZXJlZCB0byBoYXZlIGZvciBhZG1pbmlzdHJhdGlvbiBhbmQgcmVjb3JkIGtlZXBpbmcgcHVycG9zZXMuXHJcbiAgICovXHJcbiAgcHVibGljIGdlbmRlcj86IGZoaXIuRmhpckNvZGU8QWRtaW5pc3RyYXRpdmVHZW5kZXJDb2RlVHlwZT58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBkYXRlIG9uIHdoaWNoIHRoZSByZWxhdGVkIHBlcnNvbiB3YXMgYm9ybi5cclxuICAgKi9cclxuICBwdWJsaWMgYmlydGhEYXRlPzogZmhpci5GaGlyRGF0ZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQWRkcmVzcyB3aGVyZSB0aGUgcmVsYXRlZCBwZXJzb24gY2FuIGJlIGNvbnRhY3RlZCBvciB2aXNpdGVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhZGRyZXNzOiBmaGlyLkFkZHJlc3NbXTtcclxuICAvKipcclxuICAgKiBJbWFnZSBvZiB0aGUgcGVyc29uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwaG90bzogZmhpci5BdHRhY2htZW50W107XHJcbiAgLyoqXHJcbiAgICogVGhlIHBlcmlvZCBvZiB0aW1lIGR1cmluZyB3aGljaCB0aGlzIHJlbGF0aW9uc2hpcCBpcyBvciB3YXMgYWN0aXZlLiBJZiB0aGVyZSBhcmUgbm8gZGF0ZXMgZGVmaW5lZCwgdGhlbiB0aGUgaW50ZXJ2YWwgaXMgdW5rbm93bi5cclxuICAgKi9cclxuICBwdWJsaWMgcGVyaW9kPzogZmhpci5QZXJpb2R8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElmIG5vIGxhbmd1YWdlIGlzIHNwZWNpZmllZCwgdGhpcyAqaW1wbGllcyogdGhhdCB0aGUgZGVmYXVsdCBsb2NhbCBsYW5ndWFnZSBpcyBzcG9rZW4uICBJZiB5b3UgbmVlZCB0byBjb252ZXkgcHJvZmljaWVuY3kgZm9yIG11bHRpcGxlIG1vZGVzLCB0aGVuIHlvdSBuZWVkIG11bHRpcGxlIFJlbGF0ZWRQZXJzb24uQ29tbXVuaWNhdGlvbiBhc3NvY2lhdGlvbnMuICAgSWYgdGhlIFJlbGF0ZWRQZXJzb24gZG9lcyBub3Qgc3BlYWsgdGhlIGRlZmF1bHQgbG9jYWwgbGFuZ3VhZ2UsIHRoZW4gdGhlIEludGVycHJldGVyIFJlcXVpcmVkIFN0YW5kYXJkIGNhbiBiZSB1c2VkIHRvIGV4cGxpY2l0bHkgZGVjbGFyZSB0aGF0IGFuIGludGVycHJldGVyIGlzIHJlcXVpcmVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb21tdW5pY2F0aW9uOiBmaGlyLlJlbGF0ZWRQZXJzb25Db21tdW5pY2F0aW9uW107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgUmVsYXRlZFBlcnNvbiAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFJlbGF0ZWRQZXJzb25BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnUmVsYXRlZFBlcnNvbic7XHJcbiAgICBpZiAoc291cmNlWydpZGVudGlmaWVyJ10pIHsgdGhpcy5pZGVudGlmaWVyID0gc291cmNlLmlkZW50aWZpZXIubWFwKCh4KSA9PiBuZXcgZmhpci5JZGVudGlmaWVyKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaWRlbnRpZmllciA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydhY3RpdmUnXSkgeyB0aGlzLmFjdGl2ZSA9IG5ldyBmaGlyLkZoaXJCb29sZWFuKHt2YWx1ZTogc291cmNlLmFjdGl2ZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfYWN0aXZlJ10pIHtcclxuICAgICAgaWYgKHRoaXMuYWN0aXZlKSB7IHRoaXMuYWN0aXZlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2FjdGl2ZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmFjdGl2ZSA9IG5ldyBmaGlyLkZoaXJCb29sZWFuKHNvdXJjZS5fYWN0aXZlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQm9vbGVhbkFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsncGF0aWVudCddKSB7IHRoaXMucGF0aWVudCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UucGF0aWVudCk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnBhdGllbnQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydyZWxhdGlvbnNoaXAnXSkgeyB0aGlzLnJlbGF0aW9uc2hpcCA9IHNvdXJjZS5yZWxhdGlvbnNoaXAubWFwKCh4KSA9PiBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5yZWxhdGlvbnNoaXAgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnbmFtZSddKSB7IHRoaXMubmFtZSA9IHNvdXJjZS5uYW1lLm1hcCgoeCkgPT4gbmV3IGZoaXIuSHVtYW5OYW1lKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMubmFtZSA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWyd0ZWxlY29tJ10pIHsgdGhpcy50ZWxlY29tID0gc291cmNlLnRlbGVjb20ubWFwKCh4KSA9PiBuZXcgZmhpci5Db250YWN0UG9pbnQoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50ZWxlY29tID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2dlbmRlciddKSB7IHRoaXMuZ2VuZGVyID0gbmV3IGZoaXIuRmhpckNvZGU8QWRtaW5pc3RyYXRpdmVHZW5kZXJDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2UuZ2VuZGVyfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19nZW5kZXInXSkge1xyXG4gICAgICBpZiAodGhpcy5nZW5kZXIpIHsgdGhpcy5nZW5kZXIuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fZ2VuZGVyISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuZ2VuZGVyID0gbmV3IGZoaXIuRmhpckNvZGU8QWRtaW5pc3RyYXRpdmVHZW5kZXJDb2RlVHlwZT4oc291cmNlLl9nZW5kZXIgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2JpcnRoRGF0ZSddKSB7IHRoaXMuYmlydGhEYXRlID0gbmV3IGZoaXIuRmhpckRhdGUoe3ZhbHVlOiBzb3VyY2UuYmlydGhEYXRlfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19iaXJ0aERhdGUnXSkge1xyXG4gICAgICBpZiAodGhpcy5iaXJ0aERhdGUpIHsgdGhpcy5iaXJ0aERhdGUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fYmlydGhEYXRlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuYmlydGhEYXRlID0gbmV3IGZoaXIuRmhpckRhdGUoc291cmNlLl9iaXJ0aERhdGUgYXMgUGFydGlhbDxmaGlyLkZoaXJEYXRlQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydhZGRyZXNzJ10pIHsgdGhpcy5hZGRyZXNzID0gc291cmNlLmFkZHJlc3MubWFwKCh4KSA9PiBuZXcgZmhpci5BZGRyZXNzKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuYWRkcmVzcyA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydwaG90byddKSB7IHRoaXMucGhvdG8gPSBzb3VyY2UucGhvdG8ubWFwKCh4KSA9PiBuZXcgZmhpci5BdHRhY2htZW50KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucGhvdG8gPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncGVyaW9kJ10pIHsgdGhpcy5wZXJpb2QgPSBuZXcgZmhpci5QZXJpb2Qoc291cmNlLnBlcmlvZCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2NvbW11bmljYXRpb24nXSkgeyB0aGlzLmNvbW11bmljYXRpb24gPSBzb3VyY2UuY29tbXVuaWNhdGlvbi5tYXAoKHgpID0+IG5ldyBmaGlyLlJlbGF0ZWRQZXJzb25Db21tdW5pY2F0aW9uKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuY29tbXVuaWNhdGlvbiA9IFtdOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFByZWZlcnJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIHJlbGF0aW9uc2hpcCAoUmVsYXRlZFBlcnNvbi5yZWxhdGlvbnNoaXApXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXQgcmVsYXRpb25zaGlwUHJlZmVycmVkQ29kaW5ncygpOlJlbGF0ZWRwZXJzb25SZWxhdGlvbnNoaXB0eXBlQ29kaW5nVHlwZSB7XHJcbiAgICByZXR1cm4gUmVsYXRlZHBlcnNvblJlbGF0aW9uc2hpcHR5cGVDb2RpbmdzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBSZXF1aXJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIGdlbmRlciAoUmVsYXRlZFBlcnNvbi5nZW5kZXIpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXQgZ2VuZGVyUmVxdWlyZWRDb2RlcygpIHtcclxuICAgIHJldHVybiBBZG1pbmlzdHJhdGl2ZUdlbmRlckNvZGVzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbjpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbik7XHJcbiAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHsgZXhwcmVzc2lvbiA9ICdSZWxhdGVkUGVyc29uJyB9XHJcbiAgICBpZiAoIXRoaXNbJ3Jlc291cmNlVHlwZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSByZXNvdXJjZVR5cGUgZmhpcjogUmVsYXRlZFBlcnNvbi5yZXNvdXJjZVR5cGU6XCJSZWxhdGVkUGVyc29uXCInLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcImlkZW50aWZpZXJcIl0pIHsgdGhpcy5pZGVudGlmaWVyLmZvckVhY2goKHgsaSkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rYC5pZGVudGlmaWVyWyR7aX1dYCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1tcImFjdGl2ZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmFjdGl2ZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycuYWN0aXZlJykpOyB9XHJcbiAgICBpZiAoIXRoaXNbJ3BhdGllbnQnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgcGF0aWVudCBmaGlyOiBSZWxhdGVkUGVyc29uLnBhdGllbnQ6UmVmZXJlbmNlJywgZXhwcmVzc2lvbjogW2V4cHJlc3Npb25dIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJwYXRpZW50XCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMucGF0aWVudC5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycucGF0aWVudCcpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJyZWxhdGlvbnNoaXBcIl0pIHsgdGhpcy5yZWxhdGlvbnNoaXAuZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLnJlbGF0aW9uc2hpcFske2l9XWApKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJuYW1lXCJdKSB7IHRoaXMubmFtZS5mb3JFYWNoKCh4LGkpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uK2AubmFtZVske2l9XWApKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJ0ZWxlY29tXCJdKSB7IHRoaXMudGVsZWNvbS5mb3JFYWNoKCh4LGkpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uK2AudGVsZWNvbVske2l9XWApKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbJ2dlbmRlciddICYmICghT2JqZWN0LnZhbHVlcyhBZG1pbmlzdHJhdGl2ZUdlbmRlckNvZGVzKS5pbmNsdWRlcyh0aGlzLmdlbmRlci52YWx1ZSBhcyBhbnkpKSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAnY29kZS1pbnZhbGlkJywgZGlhZ25vc3RpY3M6ICdJbnZhbGlkIGNvZGUgcHJvcGVydHkgZ2VuZGVyIGZoaXI6IFJlbGF0ZWRQZXJzb24uZ2VuZGVyOmNvZGUgUmVxdWlyZWQgYmluZGluZyB0bzogQWRtaW5pc3RyYXRpdmVHZW5kZXInLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcImdlbmRlclwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmdlbmRlci5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycuZ2VuZGVyJykpOyB9XHJcbiAgICBpZiAodGhpc1tcImJpcnRoRGF0ZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmJpcnRoRGF0ZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycuYmlydGhEYXRlJykpOyB9XHJcbiAgICBpZiAodGhpc1tcImFkZHJlc3NcIl0pIHsgdGhpcy5hZGRyZXNzLmZvckVhY2goKHgsaSkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rYC5hZGRyZXNzWyR7aX1dYCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1tcInBob3RvXCJdKSB7IHRoaXMucGhvdG8uZm9yRWFjaCgoeCxpKSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbitgLnBob3RvWyR7aX1dYCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1tcInBlcmlvZFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnBlcmlvZC5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycucGVyaW9kJykpOyB9XHJcbiAgICBpZiAodGhpc1tcImNvbW11bmljYXRpb25cIl0pIHsgdGhpcy5jb21tdW5pY2F0aW9uLmZvckVhY2goKHgsaSkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rYC5jb21tdW5pY2F0aW9uWyR7aX1dYCkpOyB9KSB9XHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4iXX0=