// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: DeviceMetric
import * as fhir from '../fhir.js';
// @ts-ignore
import { MetricCalibrationTypeCodes } from '../fhirValueSets/MetricCalibrationTypeCodes.js';
// @ts-ignore
import { MetricCalibrationStateCodes } from '../fhirValueSets/MetricCalibrationStateCodes.js';
// @ts-ignore
import { MetricOperationalStatusCodes } from '../fhirValueSets/MetricOperationalStatusCodes.js';
// @ts-ignore
import { MetricColorCodes } from '../fhirValueSets/MetricColorCodes.js';
// @ts-ignore
import { MetricCategoryCodes } from '../fhirValueSets/MetricCategoryCodes.js';
/**
 * Describes the calibrations that have been performed or that are required to be performed.
 */
export class DeviceMetricCalibration extends fhir.BackboneElement {
    /**
     * Default constructor for DeviceMetricCalibration - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.FhirCode({ value: source.type });
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirCode(source._type);
            }
        }
        if (source['state']) {
            this.state = new fhir.FhirCode({ value: source.state });
        }
        if (source['_state']) {
            if (this.state) {
                this.state.addExtendedProperties(source._state);
            }
            else {
                this.state = new fhir.FhirCode(source._state);
            }
        }
        if (source['time']) {
            this.time = new fhir.FhirInstant({ value: source.time });
        }
        if (source['_time']) {
            if (this.time) {
                this.time.addExtendedProperties(source._time);
            }
            else {
                this.time = new fhir.FhirInstant(source._time);
            }
        }
    }
    /**
     * Required-bound Value Set for type (DeviceMetric.calibration.type)
     */
    static get typeRequiredCodes() {
        return MetricCalibrationTypeCodes;
    }
    /**
     * Required-bound Value Set for state (DeviceMetric.calibration.state)
     */
    static get stateRequiredCodes() {
        return MetricCalibrationStateCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'DeviceMetric.calibration';
        }
        if (this['type'] && (!Object.values(MetricCalibrationTypeCodes).includes(this.type.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property type fhir: DeviceMetric.calibration.type:code Required binding to: MetricCalibrationType', expression: [expression] });
        }
        if (this["type"]) {
            issues.push(...this.type.doModelValidation(expression + '.type'));
        }
        if (this['state'] && (!Object.values(MetricCalibrationStateCodes).includes(this.state.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property state fhir: DeviceMetric.calibration.state:code Required binding to: MetricCalibrationState', expression: [expression] });
        }
        if (this["state"]) {
            issues.push(...this.state.doModelValidation(expression + '.state'));
        }
        if (this["time"]) {
            issues.push(...this.time.doModelValidation(expression + '.time'));
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DeviceMetricCalibration._fts_dataType = 'DeviceMetricCalibration';
/**
 * Describes a measurement, calculation or setting capability of a medical device.
 */
export class DeviceMetric extends fhir.DomainResource {
    /**
     * Default constructor for DeviceMetric - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'DeviceMetric';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        else {
            this.type = null;
        }
        if (source['unit']) {
            this.unit = new fhir.CodeableConcept(source.unit);
        }
        if (source['source']) {
            this.source = new fhir.Reference(source.source);
        }
        if (source['parent']) {
            this.parent = new fhir.Reference(source.parent);
        }
        if (source['operationalStatus']) {
            this.operationalStatus = new fhir.FhirCode({ value: source.operationalStatus });
        }
        if (source['_operationalStatus']) {
            if (this.operationalStatus) {
                this.operationalStatus.addExtendedProperties(source._operationalStatus);
            }
            else {
                this.operationalStatus = new fhir.FhirCode(source._operationalStatus);
            }
        }
        if (source['color']) {
            this.color = new fhir.FhirCode({ value: source.color });
        }
        if (source['_color']) {
            if (this.color) {
                this.color.addExtendedProperties(source._color);
            }
            else {
                this.color = new fhir.FhirCode(source._color);
            }
        }
        if (source['category']) {
            this.category = new fhir.FhirCode({ value: source.category });
        }
        else {
            this.category = null;
        }
        if (source['_category']) {
            if (this.category) {
                this.category.addExtendedProperties(source._category);
            }
            else {
                this.category = new fhir.FhirCode(source._category);
            }
        }
        if (source['measurementPeriod']) {
            this.measurementPeriod = new fhir.Timing(source.measurementPeriod);
        }
        if (source['calibration']) {
            this.calibration = source.calibration.map((x) => new fhir.DeviceMetricCalibration(x));
        }
        else {
            this.calibration = [];
        }
    }
    /**
     * Required-bound Value Set for operationalStatus (DeviceMetric.operationalStatus)
     */
    static get operationalStatusRequiredCodes() {
        return MetricOperationalStatusCodes;
    }
    /**
     * Required-bound Value Set for color (DeviceMetric.color)
     */
    static get colorRequiredCodes() {
        return MetricColorCodes;
    }
    /**
     * Required-bound Value Set for category (DeviceMetric.category)
     */
    static get categoryRequiredCodes() {
        return MetricCategoryCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'DeviceMetric';
        }
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType fhir: DeviceMetric.resourceType:"DeviceMetric"', expression: [expression] });
        }
        if (this["identifier"]) {
            this.identifier.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.identifier[${i}]`)); });
        }
        if (!this['type']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property type fhir: DeviceMetric.type:CodeableConcept', expression: [expression] });
        }
        if (this["type"]) {
            issues.push(...this.type.doModelValidation(expression + '.type'));
        }
        if (this["unit"]) {
            issues.push(...this.unit.doModelValidation(expression + '.unit'));
        }
        if (this["source"]) {
            issues.push(...this.source.doModelValidation(expression + '.source'));
        }
        if (this["parent"]) {
            issues.push(...this.parent.doModelValidation(expression + '.parent'));
        }
        if (this['operationalStatus'] && (!Object.values(MetricOperationalStatusCodes).includes(this.operationalStatus.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property operationalStatus fhir: DeviceMetric.operationalStatus:code Required binding to: MetricOperationalStatus', expression: [expression] });
        }
        if (this["operationalStatus"]) {
            issues.push(...this.operationalStatus.doModelValidation(expression + '.operationalStatus'));
        }
        if (this['color'] && (!Object.values(MetricColorCodes).includes(this.color.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property color fhir: DeviceMetric.color:code Required binding to: MetricColor', expression: [expression] });
        }
        if (this["color"]) {
            issues.push(...this.color.doModelValidation(expression + '.color'));
        }
        if (!this['category']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property category fhir: DeviceMetric.category:code', expression: [expression] });
        }
        if (this['category'] && (!Object.values(MetricCategoryCodes).includes(this.category.value))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property category fhir: DeviceMetric.category:code Required binding to: MetricCategory', expression: [expression] });
        }
        if (this["category"]) {
            issues.push(...this.category.doModelValidation(expression + '.category'));
        }
        if (this["measurementPeriod"]) {
            issues.push(...this.measurementPeriod.doModelValidation(expression + '.measurementPeriod'));
        }
        if (this["calibration"]) {
            this.calibration.forEach((x, i) => { issues.push(...x.doModelValidation(expression + `.calibration[${i}]`)); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DeviceMetric._fts_dataType = 'DeviceMetric';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGV2aWNlTWV0cmljLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9EZXZpY2VNZXRyaWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsMEJBQTBCLEVBQWtDLE1BQU0sZ0RBQWdELENBQUM7QUFHNUgsYUFBYTtBQUNiLE9BQU8sRUFBRSwyQkFBMkIsRUFBbUMsTUFBTSxpREFBaUQsQ0FBQztBQUcvSCxhQUFhO0FBQ2IsT0FBTyxFQUFFLDRCQUE0QixFQUFvQyxNQUFNLGtEQUFrRCxDQUFDO0FBR2xJLGFBQWE7QUFDYixPQUFPLEVBQUUsZ0JBQWdCLEVBQXdCLE1BQU0sc0NBQXNDLENBQUM7QUFHOUYsYUFBYTtBQUNiLE9BQU8sRUFBRSxtQkFBbUIsRUFBMkIsTUFBTSx5Q0FBeUMsQ0FBQztBQStCdkc7O0dBRUc7QUFDSCxNQUFNLE9BQU8sdUJBQXdCLFNBQVEsSUFBSSxDQUFDLGVBQWU7SUFpQi9EOztPQUVHO0lBQ0gsWUFBWSxTQUE4QyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUNwRyxLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQWdDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDM0csSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDbkIsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFO2dCQUFFLElBQUksQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLEtBQU0sQ0FBQyxDQUFDO2FB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QUUsT0FBTyxFQUFFLElBQUksRUFBRSxjQUFjLEVBQUUsV0FBVyxFQUFFLHFHQUFxRyxFQUFFLFVBQVUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUN4TTtRQUNELElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsVUFBVSxHQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7U0FBRTtRQUNsRyxJQUFJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDN0gsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsaUJBQWlCLENBQUMsVUFBVSxHQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtTQUFFO1FBQ3pJLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7O0FBdElEOztHQUVHO0FBQzZCLDBCQUFhLEdBQVUsY0FBYyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gPGF1dG8tZ2VuZXJhdGVkLz5cclxuLy8gQ29udGVudHMgb2Y6IGhsNy5maGlyLnI0LmNvcmUgdmVyc2lvbjogNC4wLjFcclxuLy8gTWluaW11bSBUeXBlU2NyaXB0IFZlcnNpb246IDMuN1xyXG4vLyBGSElSIFJlc291cmNlOiBEZXZpY2VNZXRyaWNcclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGluZ3MsIE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVzLCAgTWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kaW5ncywgTWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RpbmdzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZXMsICBNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RpbmdzLCBNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kaW5ncy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlcywgIE1ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NvbG9yQ29kaW5ncywgTWV0cmljQ29sb3JDb2RpbmdUeXBlLH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZXRyaWNDb2xvckNvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NvbG9yQ29kZXMsICBNZXRyaWNDb2xvckNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZXRyaWNDb2xvckNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNDYXRlZ29yeUNvZGluZ3MsIE1ldHJpY0NhdGVnb3J5Q29kaW5nVHlwZSx9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ2F0ZWdvcnlDb2RpbmdzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNDYXRlZ29yeUNvZGVzLCAgTWV0cmljQ2F0ZWdvcnlDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ2F0ZWdvcnlDb2Rlcy5qcyc7XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBEZXZpY2VNZXRyaWNDYWxpYnJhdGlvbiB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBEZXZpY2VNZXRyaWNDYWxpYnJhdGlvbkFyZ3MgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdHlwZSBvZiB0aGUgY2FsaWJyYXRpb24gbWV0aG9kLlxyXG4gICAqL1xyXG4gIHR5cGU/OiBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBEZXZpY2VNZXRyaWMuY2FsaWJyYXRpb24udHlwZVxyXG4gICAqL1xyXG4gIF90eXBlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHN0YXRlIG9mIHRoZSBjYWxpYnJhdGlvbi5cclxuICAgKi9cclxuICBzdGF0ZT86IGZoaXIuRmhpckNvZGU8TWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBEZXZpY2VNZXRyaWMuY2FsaWJyYXRpb24uc3RhdGVcclxuICAgKi9cclxuICBfc3RhdGU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdGltZSBsYXN0IGNhbGlicmF0aW9uIGhhcyBiZWVuIHBlcmZvcm1lZC5cclxuICAgKi9cclxuICB0aW1lPzogZmhpci5GaGlySW5zdGFudHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBEZXZpY2VNZXRyaWMuY2FsaWJyYXRpb24udGltZVxyXG4gICAqL1xyXG4gIF90aW1lPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxufVxyXG5cclxuLyoqXHJcbiAqIERlc2NyaWJlcyB0aGUgY2FsaWJyYXRpb25zIHRoYXQgaGF2ZSBiZWVuIHBlcmZvcm1lZCBvciB0aGF0IGFyZSByZXF1aXJlZCB0byBiZSBwZXJmb3JtZWQuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGV2aWNlTWV0cmljQ2FsaWJyYXRpb24gZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdEZXZpY2VNZXRyaWNDYWxpYnJhdGlvbic7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB0eXBlIG9mIHRoZSBjYWxpYnJhdGlvbiBtZXRob2QuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU/OiBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVUeXBlPnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBzdGF0ZSBvZiB0aGUgY2FsaWJyYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRlPzogZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZVR5cGU+fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHRpbWUgbGFzdCBjYWxpYnJhdGlvbiBoYXMgYmVlbiBwZXJmb3JtZWQuXHJcbiAgICovXHJcbiAgcHVibGljIHRpbWU/OiBmaGlyLkZoaXJJbnN0YW50fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBEZXZpY2VNZXRyaWNDYWxpYnJhdGlvbiAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPERldmljZU1ldHJpY0NhbGlicmF0aW9uQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3R5cGUnXSkgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblR5cGVDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2UudHlwZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfdHlwZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnR5cGUpIHsgdGhpcy50eXBlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3R5cGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy50eXBlID0gbmV3IGZoaXIuRmhpckNvZGU8TWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZVR5cGU+KHNvdXJjZS5fdHlwZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3RhdGUnXSkgeyB0aGlzLnN0YXRlID0gbmV3IGZoaXIuRmhpckNvZGU8TWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5zdGF0ZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfc3RhdGUnXSkge1xyXG4gICAgICBpZiAodGhpcy5zdGF0ZSkgeyB0aGlzLnN0YXRlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3N0YXRlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuc3RhdGUgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZVR5cGU+KHNvdXJjZS5fc3RhdGUgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3RpbWUnXSkgeyB0aGlzLnRpbWUgPSBuZXcgZmhpci5GaGlySW5zdGFudCh7dmFsdWU6IHNvdXJjZS50aW1lfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ190aW1lJ10pIHtcclxuICAgICAgaWYgKHRoaXMudGltZSkgeyB0aGlzLnRpbWUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdGltZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnRpbWUgPSBuZXcgZmhpci5GaGlySW5zdGFudChzb3VyY2UuX3RpbWUgYXMgUGFydGlhbDxmaGlyLkZoaXJJbnN0YW50QXJncz4pOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFJlcXVpcmVkLWJvdW5kIFZhbHVlIFNldCBmb3IgdHlwZSAoRGV2aWNlTWV0cmljLmNhbGlicmF0aW9uLnR5cGUpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXQgdHlwZVJlcXVpcmVkQ29kZXMoKSB7XHJcbiAgICByZXR1cm4gTWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZXM7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFJlcXVpcmVkLWJvdW5kIFZhbHVlIFNldCBmb3Igc3RhdGUgKERldmljZU1ldHJpYy5jYWxpYnJhdGlvbi5zdGF0ZSlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCBzdGF0ZVJlcXVpcmVkQ29kZXMoKSB7XHJcbiAgICByZXR1cm4gTWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGVzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbjpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbik7XHJcbiAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHsgZXhwcmVzc2lvbiA9ICdEZXZpY2VNZXRyaWMuY2FsaWJyYXRpb24nIH1cclxuICAgIGlmICh0aGlzWyd0eXBlJ10gJiYgKCFPYmplY3QudmFsdWVzKE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVzKS5pbmNsdWRlcyh0aGlzLnR5cGUudmFsdWUgYXMgYW55KSkpIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ2NvZGUtaW52YWxpZCcsIGRpYWdub3N0aWNzOiAnSW52YWxpZCBjb2RlIHByb3BlcnR5IHR5cGUgZmhpcjogRGV2aWNlTWV0cmljLmNhbGlicmF0aW9uLnR5cGU6Y29kZSBSZXF1aXJlZCBiaW5kaW5nIHRvOiBNZXRyaWNDYWxpYnJhdGlvblR5cGUnLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInR5cGVcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy50eXBlLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy50eXBlJykpOyB9XHJcbiAgICBpZiAodGhpc1snc3RhdGUnXSAmJiAoIU9iamVjdC52YWx1ZXMoTWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGVzKS5pbmNsdWRlcyh0aGlzLnN0YXRlLnZhbHVlIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ0ludmFsaWQgY29kZSBwcm9wZXJ0eSBzdGF0ZSBmaGlyOiBEZXZpY2VNZXRyaWMuY2FsaWJyYXRpb24uc3RhdGU6Y29kZSBSZXF1aXJlZCBiaW5kaW5nIHRvOiBNZXRyaWNDYWxpYnJhdGlvblN0YXRlJywgZXhwcmVzc2lvbjogW2V4cHJlc3Npb25dIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJzdGF0ZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnN0YXRlLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy5zdGF0ZScpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJ0aW1lXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMudGltZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycudGltZScpKTsgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERldmljZU1ldHJpYyB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBEZXZpY2VNZXRyaWNBcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJEZXZpY2VNZXRyaWNcInx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRm9yIGlkZW50aWZpZXJzIGFzc2lnbmVkIHRvIGEgZGV2aWNlIGJ5IHRoZSBkZXZpY2Ugb3IgZ2F0ZXdheSBzb2Z0d2FyZSwgdGhlIGBzeXN0ZW1gIGVsZW1lbnQgb2YgdGhlIGlkZW50aWZpZXIgc2hvdWxkIGJlIHNldCB0byB0aGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGRldmljZS5cclxuICAgKi9cclxuICBpZGVudGlmaWVyPzogZmhpci5JZGVudGlmaWVyQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXZpY2VNZXRyaWMudHlwZSBjYW4gYmUgcmVmZXJyZWQgdG8gZWl0aGVyIElFRUUgMTEwNzMtMTAxMDEgb3IgTE9JTkMuXHJcbiAgICovXHJcbiAgdHlwZTogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGV2aWNlTWV0cmljLnVuaXQgY2FuIHJlZmVyIHRvIGVpdGhlciBVQ1VNIG9yIHByZWZlcmFibGUgYSBSVE1NUyBjb2Rpbmcgc3lzdGVtLlxyXG4gICAqL1xyXG4gIHVuaXQ/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbGluayB0byB0aGUgIERldmljZSB0aGF0IHRoaXMgRGV2aWNlTWV0cmljIGJlbG9uZ3MgdG8gYW5kIHRoYXQgY29udGFpbnMgYWRtaW5pc3RyYXRpdmUgZGV2aWNlIGluZm9ybWF0aW9uIHN1Y2ggYXMgbWFudWZhY3R1cmVyLCBzZXJpYWwgbnVtYmVyLCBldGMuXHJcbiAgICovXHJcbiAgc291cmNlPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxpbmsgdG8gdGhlICBEZXZpY2UgdGhhdCB0aGlzIERldmljZU1ldHJpYyBiZWxvbmdzIHRvIGFuZCB0aGF0IHByb3ZpZGUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGxvY2F0aW9uIG9mIHRoaXMgRGV2aWNlTWV0cmljIGluIHRoZSBjb250YWlubWVudCBzdHJ1Y3R1cmUgb2YgdGhlIHBhcmVudCBEZXZpY2UuIEFuIGV4YW1wbGUgd291bGQgYmUgYSBEZXZpY2UgdGhhdCByZXByZXNlbnRzIGEgQ2hhbm5lbC4gVGhpcyByZWZlcmVuY2UgY2FuIGJlIHVzZWQgYnkgYSBjbGllbnQgYXBwbGljYXRpb24gdG8gZGlzdGluZ3Vpc2ggRGV2aWNlTWV0cmljcyB0aGF0IGhhdmUgdGhlIHNhbWUgdHlwZSwgYnV0IHNob3VsZCBiZSBpbnRlcnByZXRlZCBiYXNlZCBvbiB0aGVpciBjb250YWlubWVudCBsb2NhdGlvbi5cclxuICAgKi9cclxuICBwYXJlbnQ/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRlcyBjdXJyZW50IG9wZXJhdGlvbmFsIHN0YXRlIG9mIHRoZSBkZXZpY2UuIEZvciBleGFtcGxlOiBPbiwgT2ZmLCBTdGFuZGJ5LCBldGMuXHJcbiAgICovXHJcbiAgb3BlcmF0aW9uYWxTdGF0dXM/OiBmaGlyLkZoaXJDb2RlPE1ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5vcGVyYXRpb25hbFN0YXR1c1xyXG4gICAqL1xyXG4gIF9vcGVyYXRpb25hbFN0YXR1cz86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBjb2xvciByZXByZXNlbnRhdGlvbiBmb3IgdGhlIG1ldHJpYy4gVGhpcyBpcyBvZnRlbiB1c2VkIHRvIGFpZCBjbGluaWNpYW5zIHRvIHRyYWNrIGFuZCBpZGVudGlmeSBwYXJhbWV0ZXIgdHlwZXMgYnkgY29sb3IuIEluIHByYWN0aWNlLCBjb25zaWRlciBhIFBhdGllbnQgTW9uaXRvciB0aGF0IGhhcyBFQ0cvSFIgYW5kIFBsZXRoIGZvciBleGFtcGxlOyB0aGUgcGFyYW1ldGVycyBhcmUgZGlzcGxheWVkIGluIGRpZmZlcmVudCBjaGFyYWN0ZXJpc3RpYyBjb2xvcnMsIHN1Y2ggYXMgSFItYmx1ZSwgQlAtZ3JlZW4sIGFuZCBQUiBhbmQgU3BPMi0gbWFnZW50YS5cclxuICAgKi9cclxuICBjb2xvcj86IGZoaXIuRmhpckNvZGU8TWV0cmljQ29sb3JDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGV2aWNlTWV0cmljLmNvbG9yXHJcbiAgICovXHJcbiAgX2NvbG9yPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgdGhlIGNhdGVnb3J5IG9mIHRoZSBvYnNlcnZhdGlvbiBnZW5lcmF0aW9uIHByb2Nlc3MuIEEgRGV2aWNlTWV0cmljIGNhbiBiZSBmb3IgZXhhbXBsZSBhIHNldHRpbmcsIG1lYXN1cmVtZW50LCBvciBjYWxjdWxhdGlvbi5cclxuICAgKi9cclxuICBjYXRlZ29yeTogZmhpci5GaGlyQ29kZTxNZXRyaWNDYXRlZ29yeUNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBEZXZpY2VNZXRyaWMuY2F0ZWdvcnlcclxuICAgKi9cclxuICBfY2F0ZWdvcnk/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lLiBUaGlzIGlzIG5vdCBuZWNlc3NhcmlseSB0aGUgc2FtZSBhcyB0aGUgdXBkYXRlIHBlcmlvZC4gVGhlIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSBjYW4gcmFuZ2UgZnJvbSBtaWxsaXNlY29uZHMgdXAgdG8gaG91cnMuIEFuIGV4YW1wbGUgZm9yIGEgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lIGluIHRoZSByYW5nZSBvZiBtaWxsaXNlY29uZHMgaXMgdGhlIHNhbXBsaW5nIHJhdGUgb2YgYW4gRUNHLiBBbiBleGFtcGxlIGZvciBhIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSBpbiB0aGUgcmFuZ2Ugb2YgaG91cnMgaXMgYSBOSUJQIHRoYXQgaXMgdHJpZ2dlcmVkIGF1dG9tYXRpY2FsbHkgZXZlcnkgaG91ci4gVGhlIHVwZGF0ZSBwZXJpb2QgbWF5IGJlIGRpZmZlcmVudCB0aGFuIHRoZSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUsIGlmIHRoZSBkZXZpY2UgZG9lcyBub3QgdXBkYXRlIHRoZSBwdWJsaXNoZWQgb2JzZXJ2ZWQgdmFsdWUgd2l0aCB0aGUgc2FtZSBmcmVxdWVuY3kgYXMgaXQgd2FzIG1lYXN1cmVkLlxyXG4gICAqL1xyXG4gIG1lYXN1cmVtZW50UGVyaW9kPzogZmhpci5UaW1pbmdBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGNhbGlicmF0aW9ucyB0aGF0IGhhdmUgYmVlbiBwZXJmb3JtZWQgb3IgdGhhdCBhcmUgcmVxdWlyZWQgdG8gYmUgcGVyZm9ybWVkLlxyXG4gICAqL1xyXG4gIGNhbGlicmF0aW9uPzogZmhpci5EZXZpY2VNZXRyaWNDYWxpYnJhdGlvbkFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXNjcmliZXMgYSBtZWFzdXJlbWVudCwgY2FsY3VsYXRpb24gb3Igc2V0dGluZyBjYXBhYmlsaXR5IG9mIGEgbWVkaWNhbCBkZXZpY2UuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGV2aWNlTWV0cmljIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdEZXZpY2VNZXRyaWMnO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiRGV2aWNlTWV0cmljXCI7XHJcbiAgLyoqXHJcbiAgICogRm9yIGlkZW50aWZpZXJzIGFzc2lnbmVkIHRvIGEgZGV2aWNlIGJ5IHRoZSBkZXZpY2Ugb3IgZ2F0ZXdheSBzb2Z0d2FyZSwgdGhlIGBzeXN0ZW1gIGVsZW1lbnQgb2YgdGhlIGlkZW50aWZpZXIgc2hvdWxkIGJlIHNldCB0byB0aGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGRldmljZS5cclxuICAgKi9cclxuICBwdWJsaWMgaWRlbnRpZmllcjogZmhpci5JZGVudGlmaWVyW107XHJcbiAgLyoqXHJcbiAgICogRGV2aWNlTWV0cmljLnR5cGUgY2FuIGJlIHJlZmVycmVkIHRvIGVpdGhlciBJRUVFIDExMDczLTEwMTAxIG9yIExPSU5DLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0eXBlOiBmaGlyLkNvZGVhYmxlQ29uY2VwdHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIERldmljZU1ldHJpYy51bml0IGNhbiByZWZlciB0byBlaXRoZXIgVUNVTSBvciBwcmVmZXJhYmxlIGEgUlRNTVMgY29kaW5nIHN5c3RlbS5cclxuICAgKi9cclxuICBwdWJsaWMgdW5pdD86IGZoaXIuQ29kZWFibGVDb25jZXB0fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxpbmsgdG8gdGhlICBEZXZpY2UgdGhhdCB0aGlzIERldmljZU1ldHJpYyBiZWxvbmdzIHRvIGFuZCB0aGF0IGNvbnRhaW5zIGFkbWluaXN0cmF0aXZlIGRldmljZSBpbmZvcm1hdGlvbiBzdWNoIGFzIG1hbnVmYWN0dXJlciwgc2VyaWFsIG51bWJlciwgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzb3VyY2U/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBsaW5rIHRvIHRoZSAgRGV2aWNlIHRoYXQgdGhpcyBEZXZpY2VNZXRyaWMgYmVsb25ncyB0byBhbmQgdGhhdCBwcm92aWRlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBsb2NhdGlvbiBvZiB0aGlzIERldmljZU1ldHJpYyBpbiB0aGUgY29udGFpbm1lbnQgc3RydWN0dXJlIG9mIHRoZSBwYXJlbnQgRGV2aWNlLiBBbiBleGFtcGxlIHdvdWxkIGJlIGEgRGV2aWNlIHRoYXQgcmVwcmVzZW50cyBhIENoYW5uZWwuIFRoaXMgcmVmZXJlbmNlIGNhbiBiZSB1c2VkIGJ5IGEgY2xpZW50IGFwcGxpY2F0aW9uIHRvIGRpc3Rpbmd1aXNoIERldmljZU1ldHJpY3MgdGhhdCBoYXZlIHRoZSBzYW1lIHR5cGUsIGJ1dCBzaG91bGQgYmUgaW50ZXJwcmV0ZWQgYmFzZWQgb24gdGhlaXIgY29udGFpbm1lbnQgbG9jYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIHBhcmVudD86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgY3VycmVudCBvcGVyYXRpb25hbCBzdGF0ZSBvZiB0aGUgZGV2aWNlLiBGb3IgZXhhbXBsZTogT24sIE9mZiwgU3RhbmRieSwgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvcGVyYXRpb25hbFN0YXR1cz86IGZoaXIuRmhpckNvZGU8TWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlVHlwZT58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgY29sb3IgcmVwcmVzZW50YXRpb24gZm9yIHRoZSBtZXRyaWMuIFRoaXMgaXMgb2Z0ZW4gdXNlZCB0byBhaWQgY2xpbmljaWFucyB0byB0cmFjayBhbmQgaWRlbnRpZnkgcGFyYW1ldGVyIHR5cGVzIGJ5IGNvbG9yLiBJbiBwcmFjdGljZSwgY29uc2lkZXIgYSBQYXRpZW50IE1vbml0b3IgdGhhdCBoYXMgRUNHL0hSIGFuZCBQbGV0aCBmb3IgZXhhbXBsZTsgdGhlIHBhcmFtZXRlcnMgYXJlIGRpc3BsYXllZCBpbiBkaWZmZXJlbnQgY2hhcmFjdGVyaXN0aWMgY29sb3JzLCBzdWNoIGFzIEhSLWJsdWUsIEJQLWdyZWVuLCBhbmQgUFIgYW5kIFNwTzItIG1hZ2VudGEuXHJcbiAgICovXHJcbiAgcHVibGljIGNvbG9yPzogZmhpci5GaGlyQ29kZTxNZXRyaWNDb2xvckNvZGVUeXBlPnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIHRoZSBjYXRlZ29yeSBvZiB0aGUgb2JzZXJ2YXRpb24gZ2VuZXJhdGlvbiBwcm9jZXNzLiBBIERldmljZU1ldHJpYyBjYW4gYmUgZm9yIGV4YW1wbGUgYSBzZXR0aW5nLCBtZWFzdXJlbWVudCwgb3IgY2FsY3VsYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIGNhdGVnb3J5OiBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhdGVnb3J5Q29kZVR5cGU+fG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUuIFRoaXMgaXMgbm90IG5lY2Vzc2FyaWx5IHRoZSBzYW1lIGFzIHRoZSB1cGRhdGUgcGVyaW9kLiBUaGUgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lIGNhbiByYW5nZSBmcm9tIG1pbGxpc2Vjb25kcyB1cCB0byBob3Vycy4gQW4gZXhhbXBsZSBmb3IgYSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUgaW4gdGhlIHJhbmdlIG9mIG1pbGxpc2Vjb25kcyBpcyB0aGUgc2FtcGxpbmcgcmF0ZSBvZiBhbiBFQ0cuIEFuIGV4YW1wbGUgZm9yIGEgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lIGluIHRoZSByYW5nZSBvZiBob3VycyBpcyBhIE5JQlAgdGhhdCBpcyB0cmlnZ2VyZWQgYXV0b21hdGljYWxseSBldmVyeSBob3VyLiBUaGUgdXBkYXRlIHBlcmlvZCBtYXkgYmUgZGlmZmVyZW50IHRoYW4gdGhlIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSwgaWYgdGhlIGRldmljZSBkb2VzIG5vdCB1cGRhdGUgdGhlIHB1Ymxpc2hlZCBvYnNlcnZlZCB2YWx1ZSB3aXRoIHRoZSBzYW1lIGZyZXF1ZW5jeSBhcyBpdCB3YXMgbWVhc3VyZWQuXHJcbiAgICovXHJcbiAgcHVibGljIG1lYXN1cmVtZW50UGVyaW9kPzogZmhpci5UaW1pbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgY2FsaWJyYXRpb25zIHRoYXQgaGF2ZSBiZWVuIHBlcmZvcm1lZCBvciB0aGF0IGFyZSByZXF1aXJlZCB0byBiZSBwZXJmb3JtZWQuXHJcbiAgICovXHJcbiAgcHVibGljIGNhbGlicmF0aW9uOiBmaGlyLkRldmljZU1ldHJpY0NhbGlicmF0aW9uW107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgRGV2aWNlTWV0cmljIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8RGV2aWNlTWV0cmljQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIHRoaXMucmVzb3VyY2VUeXBlID0gJ0RldmljZU1ldHJpYyc7XHJcbiAgICBpZiAoc291cmNlWydpZGVudGlmaWVyJ10pIHsgdGhpcy5pZGVudGlmaWVyID0gc291cmNlLmlkZW50aWZpZXIubWFwKCh4KSA9PiBuZXcgZmhpci5JZGVudGlmaWVyKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaWRlbnRpZmllciA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWyd0eXBlJ10pIHsgdGhpcy50eXBlID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS50eXBlKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudHlwZSA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ3VuaXQnXSkgeyB0aGlzLnVuaXQgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLnVuaXQpOyB9XHJcbiAgICBpZiAoc291cmNlWydzb3VyY2UnXSkgeyB0aGlzLnNvdXJjZSA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2Uuc291cmNlKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncGFyZW50J10pIHsgdGhpcy5wYXJlbnQgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnBhcmVudCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ29wZXJhdGlvbmFsU3RhdHVzJ10pIHsgdGhpcy5vcGVyYXRpb25hbFN0YXR1cyA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLm9wZXJhdGlvbmFsU3RhdHVzfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19vcGVyYXRpb25hbFN0YXR1cyddKSB7XHJcbiAgICAgIGlmICh0aGlzLm9wZXJhdGlvbmFsU3RhdHVzKSB7IHRoaXMub3BlcmF0aW9uYWxTdGF0dXMuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fb3BlcmF0aW9uYWxTdGF0dXMhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5vcGVyYXRpb25hbFN0YXR1cyA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kZVR5cGU+KHNvdXJjZS5fb3BlcmF0aW9uYWxTdGF0dXMgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2NvbG9yJ10pIHsgdGhpcy5jb2xvciA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY0NvbG9yQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLmNvbG9yfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19jb2xvciddKSB7XHJcbiAgICAgIGlmICh0aGlzLmNvbG9yKSB7IHRoaXMuY29sb3IuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fY29sb3IhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5jb2xvciA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY0NvbG9yQ29kZVR5cGU+KHNvdXJjZS5fY29sb3IgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2NhdGVnb3J5J10pIHsgdGhpcy5jYXRlZ29yeSA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhdGVnb3J5Q29kZVR5cGU+KHt2YWx1ZTogc291cmNlLmNhdGVnb3J5fSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmNhdGVnb3J5ID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2NhdGVnb3J5J10pIHtcclxuICAgICAgaWYgKHRoaXMuY2F0ZWdvcnkpIHsgdGhpcy5jYXRlZ29yeS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9jYXRlZ29yeSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmNhdGVnb3J5ID0gbmV3IGZoaXIuRmhpckNvZGU8TWV0cmljQ2F0ZWdvcnlDb2RlVHlwZT4oc291cmNlLl9jYXRlZ29yeSBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnbWVhc3VyZW1lbnRQZXJpb2QnXSkgeyB0aGlzLm1lYXN1cmVtZW50UGVyaW9kID0gbmV3IGZoaXIuVGltaW5nKHNvdXJjZS5tZWFzdXJlbWVudFBlcmlvZCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2NhbGlicmF0aW9uJ10pIHsgdGhpcy5jYWxpYnJhdGlvbiA9IHNvdXJjZS5jYWxpYnJhdGlvbi5tYXAoKHgpID0+IG5ldyBmaGlyLkRldmljZU1ldHJpY0NhbGlicmF0aW9uKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuY2FsaWJyYXRpb24gPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBSZXF1aXJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIG9wZXJhdGlvbmFsU3RhdHVzIChEZXZpY2VNZXRyaWMub3BlcmF0aW9uYWxTdGF0dXMpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXQgb3BlcmF0aW9uYWxTdGF0dXNSZXF1aXJlZENvZGVzKCkge1xyXG4gICAgcmV0dXJuIE1ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kZXM7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFJlcXVpcmVkLWJvdW5kIFZhbHVlIFNldCBmb3IgY29sb3IgKERldmljZU1ldHJpYy5jb2xvcilcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCBjb2xvclJlcXVpcmVkQ29kZXMoKSB7XHJcbiAgICByZXR1cm4gTWV0cmljQ29sb3JDb2RlcztcclxuICB9XHJcbiAgLyoqXHJcbiAgICogUmVxdWlyZWQtYm91bmQgVmFsdWUgU2V0IGZvciBjYXRlZ29yeSAoRGV2aWNlTWV0cmljLmNhdGVnb3J5KVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IGNhdGVnb3J5UmVxdWlyZWRDb2RlcygpIHtcclxuICAgIHJldHVybiBNZXRyaWNDYXRlZ29yeUNvZGVzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbjpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbik7XHJcbiAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHsgZXhwcmVzc2lvbiA9ICdEZXZpY2VNZXRyaWMnIH1cclxuICAgIGlmICghdGhpc1sncmVzb3VyY2VUeXBlJ10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHJlc291cmNlVHlwZSBmaGlyOiBEZXZpY2VNZXRyaWMucmVzb3VyY2VUeXBlOlwiRGV2aWNlTWV0cmljXCInLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcImlkZW50aWZpZXJcIl0pIHsgdGhpcy5pZGVudGlmaWVyLmZvckVhY2goKHgsaSkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rYC5pZGVudGlmaWVyWyR7aX1dYCkpOyB9KSB9XHJcbiAgICBpZiAoIXRoaXNbJ3R5cGUnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgdHlwZSBmaGlyOiBEZXZpY2VNZXRyaWMudHlwZTpDb2RlYWJsZUNvbmNlcHQnLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInR5cGVcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy50eXBlLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy50eXBlJykpOyB9XHJcbiAgICBpZiAodGhpc1tcInVuaXRcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy51bml0LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy51bml0JykpOyB9XHJcbiAgICBpZiAodGhpc1tcInNvdXJjZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnNvdXJjZS5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycuc291cmNlJykpOyB9XHJcbiAgICBpZiAodGhpc1tcInBhcmVudFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnBhcmVudC5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKycucGFyZW50JykpOyB9XHJcbiAgICBpZiAodGhpc1snb3BlcmF0aW9uYWxTdGF0dXMnXSAmJiAoIU9iamVjdC52YWx1ZXMoTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlcykuaW5jbHVkZXModGhpcy5vcGVyYXRpb25hbFN0YXR1cy52YWx1ZSBhcyBhbnkpKSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAnY29kZS1pbnZhbGlkJywgZGlhZ25vc3RpY3M6ICdJbnZhbGlkIGNvZGUgcHJvcGVydHkgb3BlcmF0aW9uYWxTdGF0dXMgZmhpcjogRGV2aWNlTWV0cmljLm9wZXJhdGlvbmFsU3RhdHVzOmNvZGUgUmVxdWlyZWQgYmluZGluZyB0bzogTWV0cmljT3BlcmF0aW9uYWxTdGF0dXMnLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcIm9wZXJhdGlvbmFsU3RhdHVzXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMub3BlcmF0aW9uYWxTdGF0dXMuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLm9wZXJhdGlvbmFsU3RhdHVzJykpOyB9XHJcbiAgICBpZiAodGhpc1snY29sb3InXSAmJiAoIU9iamVjdC52YWx1ZXMoTWV0cmljQ29sb3JDb2RlcykuaW5jbHVkZXModGhpcy5jb2xvci52YWx1ZSBhcyBhbnkpKSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAnY29kZS1pbnZhbGlkJywgZGlhZ25vc3RpY3M6ICdJbnZhbGlkIGNvZGUgcHJvcGVydHkgY29sb3IgZmhpcjogRGV2aWNlTWV0cmljLmNvbG9yOmNvZGUgUmVxdWlyZWQgYmluZGluZyB0bzogTWV0cmljQ29sb3InLCBleHByZXNzaW9uOiBbZXhwcmVzc2lvbl0gfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcImNvbG9yXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMuY29sb3IuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbisnLmNvbG9yJykpOyB9XHJcbiAgICBpZiAoIXRoaXNbJ2NhdGVnb3J5J10pIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ3JlcXVpcmVkJywgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IGNhdGVnb3J5IGZoaXI6IERldmljZU1ldHJpYy5jYXRlZ29yeTpjb2RlJywgZXhwcmVzc2lvbjogW2V4cHJlc3Npb25dIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbJ2NhdGVnb3J5J10gJiYgKCFPYmplY3QudmFsdWVzKE1ldHJpY0NhdGVnb3J5Q29kZXMpLmluY2x1ZGVzKHRoaXMuY2F0ZWdvcnkudmFsdWUgYXMgYW55KSkpIHtcclxuICAgICAgaXNzdWVzLnB1c2goeyBzZXZlcml0eTogJ2Vycm9yJywgY29kZTogJ2NvZGUtaW52YWxpZCcsIGRpYWdub3N0aWNzOiAnSW52YWxpZCBjb2RlIHByb3BlcnR5IGNhdGVnb3J5IGZoaXI6IERldmljZU1ldHJpYy5jYXRlZ29yeTpjb2RlIFJlcXVpcmVkIGJpbmRpbmcgdG86IE1ldHJpY0NhdGVnb3J5JywgZXhwcmVzc2lvbjogW2V4cHJlc3Npb25dIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJjYXRlZ29yeVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLmNhdGVnb3J5LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy5jYXRlZ29yeScpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJtZWFzdXJlbWVudFBlcmlvZFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLm1lYXN1cmVtZW50UGVyaW9kLmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rJy5tZWFzdXJlbWVudFBlcmlvZCcpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJjYWxpYnJhdGlvblwiXSkgeyB0aGlzLmNhbGlicmF0aW9uLmZvckVhY2goKHgsaSkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKGV4cHJlc3Npb24rYC5jYWxpYnJhdGlvblske2l9XWApKTsgfSkgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuIl19