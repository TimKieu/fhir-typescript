// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR Resource: DeviceMetric
import * as fhir from '../fhir.js';
// @ts-ignore
import { MetricCalibrationTypeCodes } from '../fhirValueSets/MetricCalibrationTypeCodes.js';
// @ts-ignore
import { MetricCalibrationStateCodes } from '../fhirValueSets/MetricCalibrationStateCodes.js';
// @ts-ignore
import { MetricOperationalStatusCodes } from '../fhirValueSets/MetricOperationalStatusCodes.js';
// @ts-ignore
import { MetricColorCodes } from '../fhirValueSets/MetricColorCodes.js';
// @ts-ignore
import { MetricCategoryCodes } from '../fhirValueSets/MetricCategoryCodes.js';
/**
 * Describes the calibrations that have been performed or that are required to be performed.
 */
export class DeviceMetricCalibration extends fhir.BackboneElement {
    /**
     * Default constructor for DeviceMetricCalibration - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.FhirCode({ value: source.type });
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirCode(source._type);
            }
        }
        if (source['state']) {
            this.state = new fhir.FhirCode({ value: source.state });
        }
        if (source['_state']) {
            if (this.state) {
                this.state.addExtendedProperties(source._state);
            }
            else {
                this.state = new fhir.FhirCode(source._state);
            }
        }
        if (source['time']) {
            this.time = new fhir.FhirInstant({ value: source.time });
        }
        if (source['_time']) {
            if (this.time) {
                this.time.addExtendedProperties(source._time);
            }
            else {
                this.time = new fhir.FhirInstant(source._time);
            }
        }
    }
    /**
     * Required-bound Value Set for type (DeviceMetric.calibration.type)
     */
    static get typeRequiredCodes() {
        return MetricCalibrationTypeCodes;
    }
    /**
     * Required-bound Value Set for state (DeviceMetric.calibration.state)
     */
    static get stateRequiredCodes() {
        return MetricCalibrationStateCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (this['type'] && (!Object.values(MetricCalibrationTypeCodes).includes(this.type))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property type?:fhir.FhirCode<MetricCalibrationTypeCodeType> fhir: DeviceMetric.calibration.type:code Required binding to: MetricCalibrationType' });
        }
        if (this["type"]) {
            issues.push(...this.type.doModelValidation());
        }
        if (this['state'] && (!Object.values(MetricCalibrationStateCodes).includes(this.state))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property state?:fhir.FhirCode<MetricCalibrationStateCodeType> fhir: DeviceMetric.calibration.state:code Required binding to: MetricCalibrationState' });
        }
        if (this["state"]) {
            issues.push(...this.state.doModelValidation());
        }
        if (this["time"]) {
            issues.push(...this.time.doModelValidation());
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DeviceMetricCalibration._fts_dataType = 'DeviceMetricCalibration';
/**
 * Describes a measurement, calculation or setting capability of a medical device.
 */
export class DeviceMetric extends fhir.DomainResource {
    /**
     * Default constructor for DeviceMetric - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'DeviceMetric';
        if (source['identifier']) {
            this.identifier = source.identifier.map((x) => new fhir.Identifier(x));
        }
        else {
            this.identifier = [];
        }
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        else {
            this.type = null;
        }
        if (source['unit']) {
            this.unit = new fhir.CodeableConcept(source.unit);
        }
        if (source['source']) {
            this.source = new fhir.Reference(source.source);
        }
        if (source['parent']) {
            this.parent = new fhir.Reference(source.parent);
        }
        if (source['operationalStatus']) {
            this.operationalStatus = new fhir.FhirCode({ value: source.operationalStatus });
        }
        if (source['_operationalStatus']) {
            if (this.operationalStatus) {
                this.operationalStatus.addExtendedProperties(source._operationalStatus);
            }
            else {
                this.operationalStatus = new fhir.FhirCode(source._operationalStatus);
            }
        }
        if (source['color']) {
            this.color = new fhir.FhirCode({ value: source.color });
        }
        if (source['_color']) {
            if (this.color) {
                this.color.addExtendedProperties(source._color);
            }
            else {
                this.color = new fhir.FhirCode(source._color);
            }
        }
        if (source['category']) {
            this.category = new fhir.FhirCode({ value: source.category });
        }
        else {
            this.category = null;
        }
        if (source['_category']) {
            if (this.category) {
                this.category.addExtendedProperties(source._category);
            }
            else {
                this.category = new fhir.FhirCode(source._category);
            }
        }
        if (source['measurementPeriod']) {
            this.measurementPeriod = new fhir.Timing(source.measurementPeriod);
        }
        if (source['calibration']) {
            this.calibration = source.calibration.map((x) => new fhir.DeviceMetricCalibration(x));
        }
        else {
            this.calibration = [];
        }
    }
    /**
     * Required-bound Value Set for operationalStatus (DeviceMetric.operationalStatus)
     */
    static get operationalStatusRequiredCodes() {
        return MetricOperationalStatusCodes;
    }
    /**
     * Required-bound Value Set for color (DeviceMetric.color)
     */
    static get colorRequiredCodes() {
        return MetricColorCodes;
    }
    /**
     * Required-bound Value Set for category (DeviceMetric.category)
     */
    static get categoryRequiredCodes() {
        return MetricCategoryCodes;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (!this['resourceType']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property resourceType:"DeviceMetric" fhir: DeviceMetric.resourceType:"DeviceMetric"' });
        }
        if (this["identifier"]) {
            this.identifier.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (!this['type']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property type:fhir.CodeableConcept fhir: DeviceMetric.type:CodeableConcept' });
        }
        if (this["type"]) {
            issues.push(...this.type.doModelValidation());
        }
        if (this["unit"]) {
            issues.push(...this.unit.doModelValidation());
        }
        if (this["source"]) {
            issues.push(...this.source.doModelValidation());
        }
        if (this["parent"]) {
            issues.push(...this.parent.doModelValidation());
        }
        if (this['operationalStatus'] && (!Object.values(MetricOperationalStatusCodes).includes(this.operationalStatus))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property operationalStatus?:fhir.FhirCode<MetricOperationalStatusCodeType> fhir: DeviceMetric.operationalStatus:code Required binding to: MetricOperationalStatus' });
        }
        if (this["operationalStatus"]) {
            issues.push(...this.operationalStatus.doModelValidation());
        }
        if (this['color'] && (!Object.values(MetricColorCodes).includes(this.color))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property color?:fhir.FhirCode<MetricColorCodeType> fhir: DeviceMetric.color:code Required binding to: MetricColor' });
        }
        if (this["color"]) {
            issues.push(...this.color.doModelValidation());
        }
        if (!this['category']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property category:fhir.FhirCode<MetricCategoryCodeType> fhir: DeviceMetric.category:code' });
        }
        if (this['category'] && (!Object.values(MetricCategoryCodes).includes(this.category))) {
            issues.push({ severity: 'error', code: 'code-invalid', diagnostics: 'Invalid code property category:fhir.FhirCode<MetricCategoryCodeType> fhir: DeviceMetric.category:code Required binding to: MetricCategory' });
        }
        if (this["category"]) {
            issues.push(...this.category.doModelValidation());
        }
        if (this["measurementPeriod"]) {
            issues.push(...this.measurementPeriod.doModelValidation());
        }
        if (this["calibration"]) {
            this.calibration.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DeviceMetric._fts_dataType = 'DeviceMetric';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGV2aWNlTWV0cmljLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9EZXZpY2VNZXRyaWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsMEJBQTBCLEVBQWtDLE1BQU0sZ0RBQWdELENBQUM7QUFHNUgsYUFBYTtBQUNiLE9BQU8sRUFBRSwyQkFBMkIsRUFBbUMsTUFBTSxpREFBaUQsQ0FBQztBQUcvSCxhQUFhO0FBQ2IsT0FBTyxFQUFFLDRCQUE0QixFQUFvQyxNQUFNLGtEQUFrRCxDQUFDO0FBR2xJLGFBQWE7QUFDYixPQUFPLEVBQUUsZ0JBQWdCLEVBQXdCLE1BQU0sc0NBQXNDLENBQUM7QUFHOUYsYUFBYTtBQUNiLE9BQU8sRUFBRSxtQkFBbUIsRUFBMkIsTUFBTSx5Q0FBeUMsQ0FBQztBQStCdkc7O0dBRUc7QUFDSCxNQUFNLE9BQU8sdUJBQXdCLFNBQVEsSUFBSSxDQUFDLGVBQWU7SUFpQi9EOztPQUVHO0lBQ0gsWUFBWSxTQUE4QyxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUNwRyxLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQWdDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDM0csSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDbkIsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFO2dCQUFFLElBQUksQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLEtBQU0sQ0FBQyxDQUFDO2FBQUU7aUJBQzdEO2dCQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFnQyxNQUFNLENBQUMsS0FBK0IsQ0FBQyxDQUFDO2FBQUU7U0FDL0c7UUFDRCxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFpQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsS0FBSyxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQy9HLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQ3BCLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRTtnQkFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxNQUFPLENBQUMsQ0FBQzthQUFFO2lCQUNoRTtnQkFBRSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBaUMsTUFBTSxDQUFDLE1BQWdDLENBQUMsQ0FBQzthQUFFO1NBQ2xIO1FBQ0QsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQy9FLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxLQUFNLENBQUMsQ0FBQzthQUFFO2lCQUM3RDtnQkFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsS0FBc0MsQ0FBQyxDQUFDO2FBQUU7U0FDMUY7SUFDSCxDQUFDO0lBQ0Q7O09BRUc7SUFDSSxNQUFNLEtBQUssaUJBQWlCO1FBQ2pDLE9BQU8sMEJBQTBCLENBQUM7SUFDcEMsQ0FBQztJQUNEOztPQUVHO0lBQ0ksTUFBTSxLQUFLLGtCQUFrQjtRQUNsQyxPQUFPLDJCQUEyQixDQUFDO0lBQ3JDLENBQUM7SUFDRDs7T0FFRztJQUNhLGlCQUFpQjtRQUMvQixJQUFJLE1BQU0sR0FBbUIsS0FBSyxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDdkQsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsMEJBQTBCLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQVcsQ0FBQyxDQUFDLEVBQUU7WUFDM0YsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLGNBQWMsRUFBRSxXQUFXLEVBQUUsOEpBQThKLEVBQUUsQ0FBQyxDQUFDO1NBQ3ZPO1FBQ0QsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUNwRSxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBWSxDQUFDLENBQUMsRUFBRTtZQUM5RixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLFdBQVcsRUFBRSxrS0FBa0ssRUFBRSxDQUFDLENBQUM7U0FDM087UUFDRCxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQztTQUFFO1FBQ3RFLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO1NBQUU7UUFDcEUsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUFoRUQ7O0dBRUc7QUFDNkIscUNBQWEsR0FBVSx5QkFBeUIsQ0FBQztBQTZIbkY7O0dBRUc7QUFDSCxNQUFNLE9BQU8sWUFBYSxTQUFRLElBQUksQ0FBQyxjQUFjO0lBaURuRDs7T0FFRztJQUNILFlBQVksU0FBbUMsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDekYsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLENBQUMsWUFBWSxHQUFHLGNBQWMsQ0FBQztRQUNuQyxJQUFJLE1BQU0sQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDaEc7WUFBRSxJQUFJLENBQUMsVUFBVSxHQUFHLEVBQUUsQ0FBQztTQUFFO1FBQzlCLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQUU7YUFDckU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzFCLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQUU7UUFDMUUsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7U0FBRTtRQUMxRSxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUFFO1FBQzFFLElBQUksTUFBTSxDQUFDLG1CQUFtQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFrQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsaUJBQWlCLEVBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDcEosSUFBSSxNQUFNLENBQUMsb0JBQW9CLENBQUMsRUFBRTtZQUNoQyxJQUFJLElBQUksQ0FBQyxpQkFBaUIsRUFBRTtnQkFBRSxJQUFJLENBQUMsaUJBQWlCLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLGtCQUFtQixDQUFDLENBQUM7YUFBRTtpQkFDcEc7Z0JBQUUsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBa0MsTUFBTSxDQUFDLGtCQUE0QyxDQUFDLENBQUM7YUFBRTtTQUMzSTtRQUNELElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQXNCLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLLEVBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDcEcsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDcEIsSUFBSSxJQUFJLENBQUMsS0FBSyxFQUFFO2dCQUFFLElBQUksQ0FBQyxLQUFLLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLE1BQU8sQ0FBQyxDQUFDO2FBQUU7aUJBQ2hFO2dCQUFFLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFzQixNQUFNLENBQUMsTUFBZ0MsQ0FBQyxDQUFDO2FBQUU7U0FDdkc7UUFDRCxJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUF5QixFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsUUFBUSxFQUFDLENBQUMsQ0FBQztTQUFFO2FBQzNHO1lBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7U0FBRTtRQUM5QixJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRTtZQUN2QixJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsU0FBVSxDQUFDLENBQUM7YUFBRTtpQkFDekU7Z0JBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQXlCLE1BQU0sQ0FBQyxTQUFtQyxDQUFDLENBQUM7YUFBRTtTQUNoSDtRQUNELElBQUksTUFBTSxDQUFDLG1CQUFtQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1NBQUU7UUFDeEcsSUFBSSxNQUFNLENBQUMsYUFBYSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsV0FBVyxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDaEg7WUFBRSxJQUFJLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztTQUFFO0lBQ2pDLENBQUM7SUFDRDs7T0FFRztJQUNJLE1BQU0sS0FBSyw4QkFBOEI7UUFDOUMsT0FBTyw0QkFBNEIsQ0FBQztJQUN0QyxDQUFDO0lBQ0Q7O09BRUc7SUFDSSxNQUFNLEtBQUssa0JBQWtCO1FBQ2xDLE9BQU8sZ0JBQWdCLENBQUM7SUFDMUIsQ0FBQztJQUNEOztPQUVHO0lBQ0ksTUFBTSxLQUFLLHFCQUFxQjtRQUNyQyxPQUFPLG1CQUFtQixDQUFDO0lBQzdCLENBQUM7SUFDRDs7T0FFRztJQUNhLGlCQUFpQjtRQUMvQixJQUFJLE1BQU0sR0FBbUIsS0FBSyxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDdkQsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRTtZQUN6QixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxzR0FBc0csRUFBRSxDQUFDLENBQUM7U0FDM0s7UUFDRCxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQUU7UUFDdEcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUNqQixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSw2RkFBNkYsRUFBRSxDQUFDLENBQUM7U0FDbEs7UUFDRCxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQztTQUFFO1FBQ3BFLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO1NBQUU7UUFDcEUsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUN4RSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQztTQUFFO1FBQ3hFLElBQUksSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsNEJBQTRCLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLGlCQUF3QixDQUFDLENBQUMsRUFBRTtZQUN2SCxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLFdBQVcsRUFBRSxnTEFBZ0wsRUFBRSxDQUFDLENBQUM7U0FDelA7UUFDRCxJQUFJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUM5RixJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBWSxDQUFDLENBQUMsRUFBRTtZQUNuRixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLFdBQVcsRUFBRSxnSUFBZ0ksRUFBRSxDQUFDLENBQUM7U0FDek07UUFDRCxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQztTQUFFO1FBQ3RFLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFDckIsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsMkdBQTJHLEVBQUUsQ0FBQyxDQUFDO1NBQ2hMO1FBQ0QsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQWUsQ0FBQyxDQUFDLEVBQUU7WUFDNUYsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLGNBQWMsRUFBRSxXQUFXLEVBQUUsMklBQTJJLEVBQUUsQ0FBQyxDQUFDO1NBQ3BOO1FBQ0QsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUM1RSxJQUFJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUM5RixJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQUU7UUFDeEcsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUFySUQ7O0dBRUc7QUFDNkIsMEJBQWEsR0FBVSxjQUFjLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjQuY29yZSB2ZXJzaW9uOiA0LjAuMVxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgUmVzb3VyY2U6IERldmljZU1ldHJpY1xyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kaW5ncywgTWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kaW5nVHlwZSx9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kaW5ncy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZXMsICBNZXRyaWNDYWxpYnJhdGlvblR5cGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RpbmdzLCBNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kaW5nVHlwZSx9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RlcywgIE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGluZ3MsIE1ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kaW5nVHlwZSx9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RpbmdzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGVzLCAgTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljQ29sb3JDb2RpbmdzLCBNZXRyaWNDb2xvckNvZGluZ1R5cGUsfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY0NvbG9yQ29kaW5ncy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljQ29sb3JDb2RlcywgIE1ldHJpY0NvbG9yQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY0NvbG9yQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NhdGVnb3J5Q29kaW5ncywgTWV0cmljQ2F0ZWdvcnlDb2RpbmdUeXBlLH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZXRyaWNDYXRlZ29yeUNvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NhdGVnb3J5Q29kZXMsICBNZXRyaWNDYXRlZ29yeUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZXRyaWNDYXRlZ29yeUNvZGVzLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERldmljZU1ldHJpY0NhbGlicmF0aW9uIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIERldmljZU1ldHJpY0NhbGlicmF0aW9uQXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB0eXBlIG9mIHRoZSBjYWxpYnJhdGlvbiBtZXRob2QuXHJcbiAgICovXHJcbiAgdHlwZT86IGZoaXIuRmhpckNvZGU8TWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5jYWxpYnJhdGlvbi50eXBlXHJcbiAgICovXHJcbiAgX3R5cGU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgc3RhdGUgb2YgdGhlIGNhbGlicmF0aW9uLlxyXG4gICAqL1xyXG4gIHN0YXRlPzogZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5jYWxpYnJhdGlvbi5zdGF0ZVxyXG4gICAqL1xyXG4gIF9zdGF0ZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB0aW1lIGxhc3QgY2FsaWJyYXRpb24gaGFzIGJlZW4gcGVyZm9ybWVkLlxyXG4gICAqL1xyXG4gIHRpbWU/OiBmaGlyLkZoaXJJbnN0YW50fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5jYWxpYnJhdGlvbi50aW1lXHJcbiAgICovXHJcbiAgX3RpbWU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG59XHJcblxyXG4vKipcclxuICogRGVzY3JpYmVzIHRoZSBjYWxpYnJhdGlvbnMgdGhhdCBoYXZlIGJlZW4gcGVyZm9ybWVkIG9yIHRoYXQgYXJlIHJlcXVpcmVkIHRvIGJlIHBlcmZvcm1lZC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBEZXZpY2VNZXRyaWNDYWxpYnJhdGlvbiBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0RldmljZU1ldHJpY0NhbGlicmF0aW9uJztcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHR5cGUgb2YgdGhlIGNhbGlicmF0aW9uIG1ldGhvZC5cclxuICAgKi9cclxuICBwdWJsaWMgdHlwZT86IGZoaXIuRmhpckNvZGU8TWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZVR5cGU+fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHN0YXRlIG9mIHRoZSBjYWxpYnJhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGU/OiBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RlVHlwZT58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdGltZSBsYXN0IGNhbGlicmF0aW9uIGhhcyBiZWVuIHBlcmZvcm1lZC5cclxuICAgKi9cclxuICBwdWJsaWMgdGltZT86IGZoaXIuRmhpckluc3RhbnR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIERldmljZU1ldHJpY0NhbGlicmF0aW9uIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8RGV2aWNlTWV0cmljQ2FsaWJyYXRpb25BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS50eXBlfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ190eXBlJ10pIHtcclxuICAgICAgaWYgKHRoaXMudHlwZSkgeyB0aGlzLnR5cGUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdHlwZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblR5cGVDb2RlVHlwZT4oc291cmNlLl90eXBlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydzdGF0ZSddKSB7IHRoaXMuc3RhdGUgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLnN0YXRlfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19zdGF0ZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnN0YXRlKSB7IHRoaXMuc3RhdGUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fc3RhdGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zdGF0ZSA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RlVHlwZT4oc291cmNlLl9zdGF0ZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndGltZSddKSB7IHRoaXMudGltZSA9IG5ldyBmaGlyLkZoaXJJbnN0YW50KHt2YWx1ZTogc291cmNlLnRpbWV9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3RpbWUnXSkge1xyXG4gICAgICBpZiAodGhpcy50aW1lKSB7IHRoaXMudGltZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl90aW1lISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudGltZSA9IG5ldyBmaGlyLkZoaXJJbnN0YW50KHNvdXJjZS5fdGltZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckluc3RhbnRBcmdzPik7IH1cclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogUmVxdWlyZWQtYm91bmQgVmFsdWUgU2V0IGZvciB0eXBlIChEZXZpY2VNZXRyaWMuY2FsaWJyYXRpb24udHlwZSlcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCB0eXBlUmVxdWlyZWRDb2RlcygpIHtcclxuICAgIHJldHVybiBNZXRyaWNDYWxpYnJhdGlvblR5cGVDb2RlcztcclxuICB9XHJcbiAgLyoqXHJcbiAgICogUmVxdWlyZWQtYm91bmQgVmFsdWUgU2V0IGZvciBzdGF0ZSAoRGV2aWNlTWV0cmljLmNhbGlicmF0aW9uLnN0YXRlKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IHN0YXRlUmVxdWlyZWRDb2RlcygpIHtcclxuICAgIHJldHVybiBNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZXM7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbigpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKCk7XHJcbiAgICBpZiAodGhpc1sndHlwZSddICYmICghT2JqZWN0LnZhbHVlcyhNZXRyaWNDYWxpYnJhdGlvblR5cGVDb2RlcykuaW5jbHVkZXModGhpcy50eXBlIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ0ludmFsaWQgY29kZSBwcm9wZXJ0eSB0eXBlPzpmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVUeXBlPiBmaGlyOiBEZXZpY2VNZXRyaWMuY2FsaWJyYXRpb24udHlwZTpjb2RlIFJlcXVpcmVkIGJpbmRpbmcgdG86IE1ldHJpY0NhbGlicmF0aW9uVHlwZScgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInR5cGVcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy50eXBlLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1snc3RhdGUnXSAmJiAoIU9iamVjdC52YWx1ZXMoTWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGVzKS5pbmNsdWRlcyh0aGlzLnN0YXRlIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ0ludmFsaWQgY29kZSBwcm9wZXJ0eSBzdGF0ZT86Zmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZVR5cGU+IGZoaXI6IERldmljZU1ldHJpYy5jYWxpYnJhdGlvbi5zdGF0ZTpjb2RlIFJlcXVpcmVkIGJpbmRpbmcgdG86IE1ldHJpY0NhbGlicmF0aW9uU3RhdGUnIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJzdGF0ZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnN0YXRlLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1tcInRpbWVcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy50aW1lLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgRGV2aWNlTWV0cmljIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIERldmljZU1ldHJpY0FyZ3MgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlQXJncyB7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcmVzb3VyY2VUeXBlOiBcIkRldmljZU1ldHJpY1wifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBGb3IgaWRlbnRpZmllcnMgYXNzaWduZWQgdG8gYSBkZXZpY2UgYnkgdGhlIGRldmljZSBvciBnYXRld2F5IHNvZnR3YXJlLCB0aGUgYHN5c3RlbWAgZWxlbWVudCBvZiB0aGUgaWRlbnRpZmllciBzaG91bGQgYmUgc2V0IHRvIHRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgZGV2aWNlLlxyXG4gICAqL1xyXG4gIGlkZW50aWZpZXI/OiBmaGlyLklkZW50aWZpZXJBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERldmljZU1ldHJpYy50eXBlIGNhbiBiZSByZWZlcnJlZCB0byBlaXRoZXIgSUVFRSAxMTA3My0xMDEwMSBvciBMT0lOQy5cclxuICAgKi9cclxuICB0eXBlOiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBEZXZpY2VNZXRyaWMudW5pdCBjYW4gcmVmZXIgdG8gZWl0aGVyIFVDVU0gb3IgcHJlZmVyYWJsZSBhIFJUTU1TIGNvZGluZyBzeXN0ZW0uXHJcbiAgICovXHJcbiAgdW5pdD86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBsaW5rIHRvIHRoZSAgRGV2aWNlIHRoYXQgdGhpcyBEZXZpY2VNZXRyaWMgYmVsb25ncyB0byBhbmQgdGhhdCBjb250YWlucyBhZG1pbmlzdHJhdGl2ZSBkZXZpY2UgaW5mb3JtYXRpb24gc3VjaCBhcyBtYW51ZmFjdHVyZXIsIHNlcmlhbCBudW1iZXIsIGV0Yy5cclxuICAgKi9cclxuICBzb3VyY2U/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbGluayB0byB0aGUgIERldmljZSB0aGF0IHRoaXMgRGV2aWNlTWV0cmljIGJlbG9uZ3MgdG8gYW5kIHRoYXQgcHJvdmlkZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgbG9jYXRpb24gb2YgdGhpcyBEZXZpY2VNZXRyaWMgaW4gdGhlIGNvbnRhaW5tZW50IHN0cnVjdHVyZSBvZiB0aGUgcGFyZW50IERldmljZS4gQW4gZXhhbXBsZSB3b3VsZCBiZSBhIERldmljZSB0aGF0IHJlcHJlc2VudHMgYSBDaGFubmVsLiBUaGlzIHJlZmVyZW5jZSBjYW4gYmUgdXNlZCBieSBhIGNsaWVudCBhcHBsaWNhdGlvbiB0byBkaXN0aW5ndWlzaCBEZXZpY2VNZXRyaWNzIHRoYXQgaGF2ZSB0aGUgc2FtZSB0eXBlLCBidXQgc2hvdWxkIGJlIGludGVycHJldGVkIGJhc2VkIG9uIHRoZWlyIGNvbnRhaW5tZW50IGxvY2F0aW9uLlxyXG4gICAqL1xyXG4gIHBhcmVudD86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIGN1cnJlbnQgb3BlcmF0aW9uYWwgc3RhdGUgb2YgdGhlIGRldmljZS4gRm9yIGV4YW1wbGU6IE9uLCBPZmYsIFN0YW5kYnksIGV0Yy5cclxuICAgKi9cclxuICBvcGVyYXRpb25hbFN0YXR1cz86IGZoaXIuRmhpckNvZGU8TWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGV2aWNlTWV0cmljLm9wZXJhdGlvbmFsU3RhdHVzXHJcbiAgICovXHJcbiAgX29wZXJhdGlvbmFsU3RhdHVzPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGNvbG9yIHJlcHJlc2VudGF0aW9uIGZvciB0aGUgbWV0cmljLiBUaGlzIGlzIG9mdGVuIHVzZWQgdG8gYWlkIGNsaW5pY2lhbnMgdG8gdHJhY2sgYW5kIGlkZW50aWZ5IHBhcmFtZXRlciB0eXBlcyBieSBjb2xvci4gSW4gcHJhY3RpY2UsIGNvbnNpZGVyIGEgUGF0aWVudCBNb25pdG9yIHRoYXQgaGFzIEVDRy9IUiBhbmQgUGxldGggZm9yIGV4YW1wbGU7IHRoZSBwYXJhbWV0ZXJzIGFyZSBkaXNwbGF5ZWQgaW4gZGlmZmVyZW50IGNoYXJhY3RlcmlzdGljIGNvbG9ycywgc3VjaCBhcyBIUi1ibHVlLCBCUC1ncmVlbiwgYW5kIFBSIGFuZCBTcE8yLSBtYWdlbnRhLlxyXG4gICAqL1xyXG4gIGNvbG9yPzogZmhpci5GaGlyQ29kZTxNZXRyaWNDb2xvckNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBEZXZpY2VNZXRyaWMuY29sb3JcclxuICAgKi9cclxuICBfY29sb3I/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRlcyB0aGUgY2F0ZWdvcnkgb2YgdGhlIG9ic2VydmF0aW9uIGdlbmVyYXRpb24gcHJvY2Vzcy4gQSBEZXZpY2VNZXRyaWMgY2FuIGJlIGZvciBleGFtcGxlIGEgc2V0dGluZywgbWVhc3VyZW1lbnQsIG9yIGNhbGN1bGF0aW9uLlxyXG4gICAqL1xyXG4gIGNhdGVnb3J5OiBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhdGVnb3J5Q29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5jYXRlZ29yeVxyXG4gICAqL1xyXG4gIF9jYXRlZ29yeT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUuIFRoaXMgaXMgbm90IG5lY2Vzc2FyaWx5IHRoZSBzYW1lIGFzIHRoZSB1cGRhdGUgcGVyaW9kLiBUaGUgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lIGNhbiByYW5nZSBmcm9tIG1pbGxpc2Vjb25kcyB1cCB0byBob3Vycy4gQW4gZXhhbXBsZSBmb3IgYSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUgaW4gdGhlIHJhbmdlIG9mIG1pbGxpc2Vjb25kcyBpcyB0aGUgc2FtcGxpbmcgcmF0ZSBvZiBhbiBFQ0cuIEFuIGV4YW1wbGUgZm9yIGEgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lIGluIHRoZSByYW5nZSBvZiBob3VycyBpcyBhIE5JQlAgdGhhdCBpcyB0cmlnZ2VyZWQgYXV0b21hdGljYWxseSBldmVyeSBob3VyLiBUaGUgdXBkYXRlIHBlcmlvZCBtYXkgYmUgZGlmZmVyZW50IHRoYW4gdGhlIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSwgaWYgdGhlIGRldmljZSBkb2VzIG5vdCB1cGRhdGUgdGhlIHB1Ymxpc2hlZCBvYnNlcnZlZCB2YWx1ZSB3aXRoIHRoZSBzYW1lIGZyZXF1ZW5jeSBhcyBpdCB3YXMgbWVhc3VyZWQuXHJcbiAgICovXHJcbiAgbWVhc3VyZW1lbnRQZXJpb2Q/OiBmaGlyLlRpbWluZ0FyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgY2FsaWJyYXRpb25zIHRoYXQgaGF2ZSBiZWVuIHBlcmZvcm1lZCBvciB0aGF0IGFyZSByZXF1aXJlZCB0byBiZSBwZXJmb3JtZWQuXHJcbiAgICovXHJcbiAgY2FsaWJyYXRpb24/OiBmaGlyLkRldmljZU1ldHJpY0NhbGlicmF0aW9uQXJnc1tdfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIERlc2NyaWJlcyBhIG1lYXN1cmVtZW50LCBjYWxjdWxhdGlvbiBvciBzZXR0aW5nIGNhcGFiaWxpdHkgb2YgYSBtZWRpY2FsIGRldmljZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBEZXZpY2VNZXRyaWMgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0RldmljZU1ldHJpYyc7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc291cmNlVHlwZTogXCJEZXZpY2VNZXRyaWNcIjtcclxuICAvKipcclxuICAgKiBGb3IgaWRlbnRpZmllcnMgYXNzaWduZWQgdG8gYSBkZXZpY2UgYnkgdGhlIGRldmljZSBvciBnYXRld2F5IHNvZnR3YXJlLCB0aGUgYHN5c3RlbWAgZWxlbWVudCBvZiB0aGUgaWRlbnRpZmllciBzaG91bGQgYmUgc2V0IHRvIHRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgZGV2aWNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpZGVudGlmaWVyOiBmaGlyLklkZW50aWZpZXJbXTtcclxuICAvKipcclxuICAgKiBEZXZpY2VNZXRyaWMudHlwZSBjYW4gYmUgcmVmZXJyZWQgdG8gZWl0aGVyIElFRUUgMTEwNzMtMTAxMDEgb3IgTE9JTkMuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU6IGZoaXIuQ29kZWFibGVDb25jZXB0fG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGV2aWNlTWV0cmljLnVuaXQgY2FuIHJlZmVyIHRvIGVpdGhlciBVQ1VNIG9yIHByZWZlcmFibGUgYSBSVE1NUyBjb2Rpbmcgc3lzdGVtLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1bml0PzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbGluayB0byB0aGUgIERldmljZSB0aGF0IHRoaXMgRGV2aWNlTWV0cmljIGJlbG9uZ3MgdG8gYW5kIHRoYXQgY29udGFpbnMgYWRtaW5pc3RyYXRpdmUgZGV2aWNlIGluZm9ybWF0aW9uIHN1Y2ggYXMgbWFudWZhY3R1cmVyLCBzZXJpYWwgbnVtYmVyLCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIHNvdXJjZT86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxpbmsgdG8gdGhlICBEZXZpY2UgdGhhdCB0aGlzIERldmljZU1ldHJpYyBiZWxvbmdzIHRvIGFuZCB0aGF0IHByb3ZpZGUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGxvY2F0aW9uIG9mIHRoaXMgRGV2aWNlTWV0cmljIGluIHRoZSBjb250YWlubWVudCBzdHJ1Y3R1cmUgb2YgdGhlIHBhcmVudCBEZXZpY2UuIEFuIGV4YW1wbGUgd291bGQgYmUgYSBEZXZpY2UgdGhhdCByZXByZXNlbnRzIGEgQ2hhbm5lbC4gVGhpcyByZWZlcmVuY2UgY2FuIGJlIHVzZWQgYnkgYSBjbGllbnQgYXBwbGljYXRpb24gdG8gZGlzdGluZ3Vpc2ggRGV2aWNlTWV0cmljcyB0aGF0IGhhdmUgdGhlIHNhbWUgdHlwZSwgYnV0IHNob3VsZCBiZSBpbnRlcnByZXRlZCBiYXNlZCBvbiB0aGVpciBjb250YWlubWVudCBsb2NhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgcGFyZW50PzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRlcyBjdXJyZW50IG9wZXJhdGlvbmFsIHN0YXRlIG9mIHRoZSBkZXZpY2UuIEZvciBleGFtcGxlOiBPbiwgT2ZmLCBTdGFuZGJ5LCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIG9wZXJhdGlvbmFsU3RhdHVzPzogZmhpci5GaGlyQ29kZTxNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGVUeXBlPnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBjb2xvciByZXByZXNlbnRhdGlvbiBmb3IgdGhlIG1ldHJpYy4gVGhpcyBpcyBvZnRlbiB1c2VkIHRvIGFpZCBjbGluaWNpYW5zIHRvIHRyYWNrIGFuZCBpZGVudGlmeSBwYXJhbWV0ZXIgdHlwZXMgYnkgY29sb3IuIEluIHByYWN0aWNlLCBjb25zaWRlciBhIFBhdGllbnQgTW9uaXRvciB0aGF0IGhhcyBFQ0cvSFIgYW5kIFBsZXRoIGZvciBleGFtcGxlOyB0aGUgcGFyYW1ldGVycyBhcmUgZGlzcGxheWVkIGluIGRpZmZlcmVudCBjaGFyYWN0ZXJpc3RpYyBjb2xvcnMsIHN1Y2ggYXMgSFItYmx1ZSwgQlAtZ3JlZW4sIGFuZCBQUiBhbmQgU3BPMi0gbWFnZW50YS5cclxuICAgKi9cclxuICBwdWJsaWMgY29sb3I/OiBmaGlyLkZoaXJDb2RlPE1ldHJpY0NvbG9yQ29kZVR5cGU+fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgdGhlIGNhdGVnb3J5IG9mIHRoZSBvYnNlcnZhdGlvbiBnZW5lcmF0aW9uIHByb2Nlc3MuIEEgRGV2aWNlTWV0cmljIGNhbiBiZSBmb3IgZXhhbXBsZSBhIHNldHRpbmcsIG1lYXN1cmVtZW50LCBvciBjYWxjdWxhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgY2F0ZWdvcnk6IGZoaXIuRmhpckNvZGU8TWV0cmljQ2F0ZWdvcnlDb2RlVHlwZT58bnVsbDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZS4gVGhpcyBpcyBub3QgbmVjZXNzYXJpbHkgdGhlIHNhbWUgYXMgdGhlIHVwZGF0ZSBwZXJpb2QuIFRoZSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUgY2FuIHJhbmdlIGZyb20gbWlsbGlzZWNvbmRzIHVwIHRvIGhvdXJzLiBBbiBleGFtcGxlIGZvciBhIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSBpbiB0aGUgcmFuZ2Ugb2YgbWlsbGlzZWNvbmRzIGlzIHRoZSBzYW1wbGluZyByYXRlIG9mIGFuIEVDRy4gQW4gZXhhbXBsZSBmb3IgYSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUgaW4gdGhlIHJhbmdlIG9mIGhvdXJzIGlzIGEgTklCUCB0aGF0IGlzIHRyaWdnZXJlZCBhdXRvbWF0aWNhbGx5IGV2ZXJ5IGhvdXIuIFRoZSB1cGRhdGUgcGVyaW9kIG1heSBiZSBkaWZmZXJlbnQgdGhhbiB0aGUgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lLCBpZiB0aGUgZGV2aWNlIGRvZXMgbm90IHVwZGF0ZSB0aGUgcHVibGlzaGVkIG9ic2VydmVkIHZhbHVlIHdpdGggdGhlIHNhbWUgZnJlcXVlbmN5IGFzIGl0IHdhcyBtZWFzdXJlZC5cclxuICAgKi9cclxuICBwdWJsaWMgbWVhc3VyZW1lbnRQZXJpb2Q/OiBmaGlyLlRpbWluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBjYWxpYnJhdGlvbnMgdGhhdCBoYXZlIGJlZW4gcGVyZm9ybWVkIG9yIHRoYXQgYXJlIHJlcXVpcmVkIHRvIGJlIHBlcmZvcm1lZC5cclxuICAgKi9cclxuICBwdWJsaWMgY2FsaWJyYXRpb246IGZoaXIuRGV2aWNlTWV0cmljQ2FsaWJyYXRpb25bXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBEZXZpY2VNZXRyaWMgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxEZXZpY2VNZXRyaWNBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnRGV2aWNlTWV0cmljJztcclxuICAgIGlmIChzb3VyY2VbJ2lkZW50aWZpZXInXSkgeyB0aGlzLmlkZW50aWZpZXIgPSBzb3VyY2UuaWRlbnRpZmllci5tYXAoKHgpID0+IG5ldyBmaGlyLklkZW50aWZpZXIoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5pZGVudGlmaWVyID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ3R5cGUnXSkgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLnR5cGUpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy50eXBlID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsndW5pdCddKSB7IHRoaXMudW5pdCA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UudW5pdCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3NvdXJjZSddKSB7IHRoaXMuc291cmNlID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5zb3VyY2UpOyB9XHJcbiAgICBpZiAoc291cmNlWydwYXJlbnQnXSkgeyB0aGlzLnBhcmVudCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UucGFyZW50KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnb3BlcmF0aW9uYWxTdGF0dXMnXSkgeyB0aGlzLm9wZXJhdGlvbmFsU3RhdHVzID0gbmV3IGZoaXIuRmhpckNvZGU8TWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2Uub3BlcmF0aW9uYWxTdGF0dXN9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX29wZXJhdGlvbmFsU3RhdHVzJ10pIHtcclxuICAgICAgaWYgKHRoaXMub3BlcmF0aW9uYWxTdGF0dXMpIHsgdGhpcy5vcGVyYXRpb25hbFN0YXR1cy5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9vcGVyYXRpb25hbFN0YXR1cyEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLm9wZXJhdGlvbmFsU3RhdHVzID0gbmV3IGZoaXIuRmhpckNvZGU8TWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlVHlwZT4oc291cmNlLl9vcGVyYXRpb25hbFN0YXR1cyBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnY29sb3InXSkgeyB0aGlzLmNvbG9yID0gbmV3IGZoaXIuRmhpckNvZGU8TWV0cmljQ29sb3JDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2UuY29sb3J9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2NvbG9yJ10pIHtcclxuICAgICAgaWYgKHRoaXMuY29sb3IpIHsgdGhpcy5jb2xvci5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9jb2xvciEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmNvbG9yID0gbmV3IGZoaXIuRmhpckNvZGU8TWV0cmljQ29sb3JDb2RlVHlwZT4oc291cmNlLl9jb2xvciBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnY2F0ZWdvcnknXSkgeyB0aGlzLmNhdGVnb3J5ID0gbmV3IGZoaXIuRmhpckNvZGU8TWV0cmljQ2F0ZWdvcnlDb2RlVHlwZT4oe3ZhbHVlOiBzb3VyY2UuY2F0ZWdvcnl9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuY2F0ZWdvcnkgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfY2F0ZWdvcnknXSkge1xyXG4gICAgICBpZiAodGhpcy5jYXRlZ29yeSkgeyB0aGlzLmNhdGVnb3J5LmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2NhdGVnb3J5ISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuY2F0ZWdvcnkgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDYXRlZ29yeUNvZGVUeXBlPihzb3VyY2UuX2NhdGVnb3J5IGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydtZWFzdXJlbWVudFBlcmlvZCddKSB7IHRoaXMubWVhc3VyZW1lbnRQZXJpb2QgPSBuZXcgZmhpci5UaW1pbmcoc291cmNlLm1lYXN1cmVtZW50UGVyaW9kKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnY2FsaWJyYXRpb24nXSkgeyB0aGlzLmNhbGlicmF0aW9uID0gc291cmNlLmNhbGlicmF0aW9uLm1hcCgoeCkgPT4gbmV3IGZoaXIuRGV2aWNlTWV0cmljQ2FsaWJyYXRpb24oeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5jYWxpYnJhdGlvbiA9IFtdOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFJlcXVpcmVkLWJvdW5kIFZhbHVlIFNldCBmb3Igb3BlcmF0aW9uYWxTdGF0dXMgKERldmljZU1ldHJpYy5vcGVyYXRpb25hbFN0YXR1cylcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldCBvcGVyYXRpb25hbFN0YXR1c1JlcXVpcmVkQ29kZXMoKSB7XHJcbiAgICByZXR1cm4gTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlcztcclxuICB9XHJcbiAgLyoqXHJcbiAgICogUmVxdWlyZWQtYm91bmQgVmFsdWUgU2V0IGZvciBjb2xvciAoRGV2aWNlTWV0cmljLmNvbG9yKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0IGNvbG9yUmVxdWlyZWRDb2RlcygpIHtcclxuICAgIHJldHVybiBNZXRyaWNDb2xvckNvZGVzO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBSZXF1aXJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIGNhdGVnb3J5IChEZXZpY2VNZXRyaWMuY2F0ZWdvcnkpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXQgY2F0ZWdvcnlSZXF1aXJlZENvZGVzKCkge1xyXG4gICAgcmV0dXJuIE1ldHJpY0NhdGVnb3J5Q29kZXM7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbigpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKCk7XHJcbiAgICBpZiAoIXRoaXNbJ3Jlc291cmNlVHlwZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSByZXNvdXJjZVR5cGU6XCJEZXZpY2VNZXRyaWNcIiBmaGlyOiBEZXZpY2VNZXRyaWMucmVzb3VyY2VUeXBlOlwiRGV2aWNlTWV0cmljXCInIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXNbXCJpZGVudGlmaWVyXCJdKSB7IHRoaXMuaWRlbnRpZmllci5mb3JFYWNoKCh4KSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH0pIH1cclxuICAgIGlmICghdGhpc1sndHlwZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eSB0eXBlOmZoaXIuQ29kZWFibGVDb25jZXB0IGZoaXI6IERldmljZU1ldHJpYy50eXBlOkNvZGVhYmxlQ29uY2VwdCcgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInR5cGVcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy50eXBlLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1tcInVuaXRcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy51bml0LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1tcInNvdXJjZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnNvdXJjZS5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJwYXJlbnRcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5wYXJlbnQuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzWydvcGVyYXRpb25hbFN0YXR1cyddICYmICghT2JqZWN0LnZhbHVlcyhNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGVzKS5pbmNsdWRlcyh0aGlzLm9wZXJhdGlvbmFsU3RhdHVzIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ0ludmFsaWQgY29kZSBwcm9wZXJ0eSBvcGVyYXRpb25hbFN0YXR1cz86Zmhpci5GaGlyQ29kZTxNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGVUeXBlPiBmaGlyOiBEZXZpY2VNZXRyaWMub3BlcmF0aW9uYWxTdGF0dXM6Y29kZSBSZXF1aXJlZCBiaW5kaW5nIHRvOiBNZXRyaWNPcGVyYXRpb25hbFN0YXR1cycgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcIm9wZXJhdGlvbmFsU3RhdHVzXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMub3BlcmF0aW9uYWxTdGF0dXMuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzWydjb2xvciddICYmICghT2JqZWN0LnZhbHVlcyhNZXRyaWNDb2xvckNvZGVzKS5pbmNsdWRlcyh0aGlzLmNvbG9yIGFzIGFueSkpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdjb2RlLWludmFsaWQnLCBkaWFnbm9zdGljczogJ0ludmFsaWQgY29kZSBwcm9wZXJ0eSBjb2xvcj86Zmhpci5GaGlyQ29kZTxNZXRyaWNDb2xvckNvZGVUeXBlPiBmaGlyOiBEZXZpY2VNZXRyaWMuY29sb3I6Y29kZSBSZXF1aXJlZCBiaW5kaW5nIHRvOiBNZXRyaWNDb2xvcicgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcImNvbG9yXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMuY29sb3IuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICghdGhpc1snY2F0ZWdvcnknXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgY2F0ZWdvcnk6Zmhpci5GaGlyQ29kZTxNZXRyaWNDYXRlZ29yeUNvZGVUeXBlPiBmaGlyOiBEZXZpY2VNZXRyaWMuY2F0ZWdvcnk6Y29kZScgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1snY2F0ZWdvcnknXSAmJiAoIU9iamVjdC52YWx1ZXMoTWV0cmljQ2F0ZWdvcnlDb2RlcykuaW5jbHVkZXModGhpcy5jYXRlZ29yeSBhcyBhbnkpKSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAnY29kZS1pbnZhbGlkJywgZGlhZ25vc3RpY3M6ICdJbnZhbGlkIGNvZGUgcHJvcGVydHkgY2F0ZWdvcnk6Zmhpci5GaGlyQ29kZTxNZXRyaWNDYXRlZ29yeUNvZGVUeXBlPiBmaGlyOiBEZXZpY2VNZXRyaWMuY2F0ZWdvcnk6Y29kZSBSZXF1aXJlZCBiaW5kaW5nIHRvOiBNZXRyaWNDYXRlZ29yeScgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcImNhdGVnb3J5XCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMuY2F0ZWdvcnkuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzW1wibWVhc3VyZW1lbnRQZXJpb2RcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5tZWFzdXJlbWVudFBlcmlvZC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJjYWxpYnJhdGlvblwiXSkgeyB0aGlzLmNhbGlicmF0aW9uLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuIl19