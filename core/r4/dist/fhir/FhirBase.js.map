{"version":3,"file":"FhirBase.js","sources":["../../src/fhir/FhirBase.ts"],"sourcesContent":["// Minimum TypeScript Version: 3.7\r\n\r\nimport { OperationOutcome } from './OperationOutcome.js';\r\n\r\nexport interface FhirConstructorOptions {\r\n  /** If instantiated objects should allow non-FHIR defined properties */\r\n  allowUnknownElements?: boolean|undefined;\r\n}\r\n\r\nexport interface FhirBaseArgs { }\r\n\r\nexport class FhirBase {\r\n  /**\r\n   * Mapping of this datatype to a FHIR equivalent\r\n   */\r\n  public readonly _fts_dataType:string='Base';\r\n\r\n  /** Default constructor */\r\n  constructor(source:Partial<FhirBaseArgs> = {}, options:FhirConstructorOptions = {}) {\r\n    if (options.allowUnknownElements === true) { Object.assign(this, source); }\r\n  }\r\n\r\n  /**\r\n   * Function to perform basic model validation (e.g., check if required elements are present).\r\n   */\r\n   public doModelValidation():OperationOutcome {\r\n    var outcome:OperationOutcome = new OperationOutcome({issue:[]});\r\n    return outcome;\r\n  }\r\n\r\n  /**\r\n   * Convert a class-structured model into JSON\r\n   * @returns JSON-compatible version of this object\r\n   */\r\n  public toJSON() {\r\n    let c:any = {};\r\n  \r\n    for (const key in this) {\r\n      if (((this as any)[key] === undefined) || \r\n          ((this as any)[key] === null) ||\r\n          ((this as any)[key] === '') ||\r\n          ((this as any)[key] === NaN)) {\r\n        continue;\r\n      }\r\n  \r\n      if (key.startsWith('_fts_')) {\r\n        continue;\r\n      }\r\n  \r\n      let dKey:string = key + ((this as any)['_fts_' + key + 'IsChoice'] ? ((this as any)[key]['_fts_dataType'] ?? '') : '');\r\n  \r\n      if (Array.isArray(this[key])) {\r\n        if ((this as any)[key].length === 0) {\r\n          continue;\r\n        }\r\n  \r\n        if ((this as any)[key][0]['_fts_isPrimitive']) {\r\n          const eName:string = '_' + dKey;\r\n          let foundAnyVal:boolean = false;\r\n          let foundAnyExt:boolean = false;\r\n          c[dKey] = [];\r\n          c[eName] = [];\r\n          (this as any)[key].forEach((av:any) => {\r\n            let addElement:boolean = false;\r\n            if ((av['value'] !== undefined) && (av['value'] !== null)) { \r\n              c[dKey].push(av.valueOf()); \r\n              foundAnyVal = true;\r\n              addElement = true;\r\n            } else { \r\n              c[dKey].push(null);\r\n            }\r\n  \r\n            let ao:object = {};\r\n            if (av.id) { (ao as any)['id'] = av.id; }\r\n            if (av.extension) {\r\n              (ao as any)['extension'] = [];\r\n              av.extension.forEach((e:any) => {\r\n                (ao as any)['extension'].push(e.toJSON());\r\n              });\r\n            }\r\n  \r\n            if (Object.keys(ao).length !== 0) { \r\n              c[eName].push(ao);\r\n              foundAnyExt = true;\r\n              addElement = true;\r\n            } else {\r\n              c[eName].push(null);\r\n            }\r\n  \r\n            if (!addElement) {\r\n              c[dKey].pop();\r\n              c[eName].pop();\r\n            }\r\n          });\r\n  \r\n          if (!foundAnyVal) { delete c[dKey]; }\r\n          if (!foundAnyExt) { delete c[eName]; }\r\n        } else if ((this as any)[key][0]['_fts_dataType']) {\r\n          c[dKey] = [];\r\n          (this as any)[key].forEach((v:any) => {\r\n            c[dKey].push(v.toJSON());\r\n          });\r\n        } else {\r\n          c[dKey] = this[key];\r\n        }\r\n      } else {\r\n        if ((this as any)[key]['_fts_isPrimitive']) {\r\n          if ((this as any)[key]['value']) { c[dKey] = (this as any)[key].valueOf(); }\r\n  \r\n          const eName:string = '_' + dKey;\r\n          c[eName] = {};\r\n          if ((this as any)[key]['id']) { c[eName]['id'] = (this as any)[key]['id']; }\r\n          if ((this as any)[key]['extension']) {\r\n            c[eName]['extension'] = [];\r\n            (this as any)[key]['extension'].forEach((e:any) => {\r\n              c[eName]['extension'].push(e.toJSON());\r\n            });\r\n          }\r\n  \r\n          if (Object.keys(c[eName]).length === 0) { delete c[eName]; }\r\n        } else if ((this as any)[key]['_fts_dataType']) {\r\n          c[dKey] = (this as any)[key].toJSON();\r\n        } else {\r\n          c[dKey] = (this as any)[key];\r\n        }\r\n      }\r\n    }\r\n  \r\n    return c;\r\n  }\r\n}"],"names":[],"mappings":"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"}