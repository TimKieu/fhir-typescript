// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: DataRequirement
import * as fhir from '../fhir.js';
// @ts-ignore
import { SortDirectionCodings, } from '../fhirValueSets/SortDirectionCodings.js';
// @ts-ignore
import { AllTypesCodings, } from '../fhirValueSets/AllTypesCodings.js';
/**
 * Code filters specify additional constraints on the data, specifying the value set of interest for a particular element of the data. Each code filter defines an additional constraint on the data, i.e. code filters are AND'ed, not OR'ed.
 */
export class DataRequirementCodeFilter extends fhir.FhirElement {
    /**
     * Default constructor for DataRequirementCodeFilter - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['path']) {
            this.path = new fhir.FhirString({ value: source.path });
        }
        if (source['searchParam']) {
            this.searchParam = new fhir.FhirString({ value: source.searchParam });
        }
        if (source['valueSet']) {
            this.valueSet = new fhir.FhirCanonical({ value: source.valueSet });
        }
        if (source['code']) {
            this.code = source.code.map((x) => new fhir.Coding(x));
        }
        else {
            this.code = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (this["path"]) {
            issues.push(...this.path.doModelValidation());
        }
        if (this["searchParam"]) {
            issues.push(...this.searchParam.doModelValidation());
        }
        if (this["valueSet"]) {
            issues.push(...this.valueSet.doModelValidation());
        }
        if (this["code"]) {
            this.code.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DataRequirementCodeFilter._fts_dataType = 'DataRequirementCodeFilter';
/**
 * Date filters specify additional constraints on the data in terms of the applicable date range for specific elements. Each date filter specifies an additional constraint on the data, i.e. date filters are AND'ed, not OR'ed.
 */
export class DataRequirementDateFilter extends fhir.FhirElement {
    /**
     * Default constructor for DataRequirementDateFilter - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['path']) {
            this.path = new fhir.FhirString({ value: source.path });
        }
        if (source['searchParam']) {
            this.searchParam = new fhir.FhirString({ value: source.searchParam });
        }
        if (source['value']) {
            this.value = source.value;
        }
        else if (source['valueDateTime']) {
            this.value = new fhir.FhirDateTime({ value: source.valueDateTime });
        }
        else if (source['valuePeriod']) {
            this.value = new fhir.Period(source.valuePeriod);
        }
        else if (source['valueDuration']) {
            this.value = new fhir.Duration(source.valueDuration);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (this["path"]) {
            issues.push(...this.path.doModelValidation());
        }
        if (this["searchParam"]) {
            issues.push(...this.searchParam.doModelValidation());
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DataRequirementDateFilter._fts_dataType = 'DataRequirementDateFilter';
/**
 * Internal flag to properly serialize choice-type element DataRequirement.dateFilter.value[x]
 */
DataRequirementDateFilter._fts_valueIsChoice = true;
/**
 * This element can be used in combination with the sort element to specify quota requirements such as "the most recent 5" or "the highest 5". When multiple sorts are specified, they are applied in the order they appear in the resource.
 */
export class DataRequirementSort extends fhir.FhirElement {
    /**
     * Default constructor for DataRequirementSort - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['path']) {
            this.path = new fhir.FhirString({ value: source.path });
        }
        else {
            this.path = null;
        }
        if (source['direction']) {
            this.direction = source.direction;
        }
        else {
            this.direction = null;
        }
    }
    /**
     * Required-bound Value Set for direction (DataRequirement.sort.direction)
     */
    static directionRequiredCoding() {
        return SortDirectionCodings;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (!this['path']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property path:fhir.FhirString fhir: DataRequirement.sort.path:string', });
        }
        if (this["path"]) {
            issues.push(...this.path.doModelValidation());
        }
        if (!this['direction']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property direction:SortDirectionCodeType fhir: DataRequirement.sort.direction:code', });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DataRequirementSort._fts_dataType = 'DataRequirementSort';
/**
 * Describes a required data item for evaluation in terms of the type of data, and optional code or date-based filters of the data.
 */
export class DataRequirement extends fhir.FhirElement {
    /**
     * Default constructor for DataRequirement - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.FhirCode({ value: source.type });
        }
        else {
            this.type = null;
        }
        if (source['profile']) {
            this.profile = source.profile.map((x) => new fhir.FhirCanonical({ value: x }));
        }
        else {
            this.profile = [];
        }
        if (source['subject']) {
            this.subject = source.subject;
        }
        else if (source['subjectCodeableConcept']) {
            this.subject = new fhir.CodeableConcept(source.subjectCodeableConcept);
        }
        else if (source['subjectReference']) {
            this.subject = new fhir.Reference(source.subjectReference);
        }
        if (source['mustSupport']) {
            this.mustSupport = source.mustSupport.map((x) => new fhir.FhirString({ value: x }));
        }
        else {
            this.mustSupport = [];
        }
        if (source['codeFilter']) {
            this.codeFilter = source.codeFilter.map((x) => new fhir.DataRequirementCodeFilter(x));
        }
        else {
            this.codeFilter = [];
        }
        if (source['dateFilter']) {
            this.dateFilter = source.dateFilter.map((x) => new fhir.DataRequirementDateFilter(x));
        }
        else {
            this.dateFilter = [];
        }
        if (source['limit']) {
            this.limit = new fhir.FhirPositiveInt({ value: source.limit });
        }
        if (source['sort']) {
            this.sort = source.sort.map((x) => new fhir.DataRequirementSort(x));
        }
        else {
            this.sort = [];
        }
    }
    /**
     * Required-bound Value Set for type (DataRequirement.type)
     */
    static typeRequiredCoding() {
        return AllTypesCodings;
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation() {
        let issues = super.doModelValidation();
        if (!this['type']) {
            issues.push({ severity: 'error', code: 'required', diagnostics: 'Missing required property type:fhir.FhirCode fhir: DataRequirement.type:code', });
        }
        if (this["type"]) {
            issues.push(...this.type.doModelValidation());
        }
        if (this["profile"]) {
            this.profile.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["mustSupport"]) {
            this.mustSupport.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["codeFilter"]) {
            this.codeFilter.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["dateFilter"]) {
            this.dateFilter.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        if (this["limit"]) {
            issues.push(...this.limit.doModelValidation());
        }
        if (this["sort"]) {
            this.sort.forEach((x) => { issues.push(...x.doModelValidation()); });
        }
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DataRequirement._fts_dataType = 'DataRequirement';
/**
 * Internal flag to properly serialize choice-type element DataRequirement.subject[x]
 */
DataRequirement._fts_subjectIsChoice = true;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGF0YVJlcXVpcmVtZW50LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9EYXRhUmVxdWlyZW1lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsb0NBQW9DO0FBRXBDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBRW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsb0JBQW9CLEdBQTJCLE1BQU0sMENBQTBDLENBQUM7QUFHekcsYUFBYTtBQUNiLE9BQU8sRUFBRSxlQUFlLEdBQXNCLE1BQU0scUNBQXFDLENBQUM7QUF5QjFGOztHQUVHO0FBQ0gsTUFBTSxPQUFPLHlCQUEwQixTQUFRLElBQUksQ0FBQyxXQUFXO0lBcUI3RDs7T0FFRztJQUNILFlBQVksU0FBZ0QsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDdEcsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDOUUsSUFBSSxNQUFNLENBQUMsYUFBYSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsV0FBVyxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQ25HLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLFFBQVEsRUFBQyxDQUFDLENBQUM7U0FBRTtRQUM3RixJQUFJLE1BQU0sQ0FBQyxNQUFN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QUU7WUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUM7U0FBRTtRQUN0RSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQUU7UUFDMUYsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUFyRkQ7O0dBRUc7QUFDNkIsNkJBQWEsR0FBVSxpQkFBaUIsQ0FBQztBQWF6RTs7R0FFRztBQUN1QixvQ0FBb0IsR0FBUSxJQUFJLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjQuY29yZSB2ZXJzaW9uOiA0LjAuMVxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgQ29tcGxleFR5cGU6IERhdGFSZXF1aXJlbWVudFxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU29ydERpcmVjdGlvbkNvZGluZ3MsIFNvcnREaXJlY3Rpb25Db2RpbmdUeXBlLH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9Tb3J0RGlyZWN0aW9uQ29kaW5ncy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU29ydERpcmVjdGlvbkNvZGVzLCAgU29ydERpcmVjdGlvbkNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9Tb3J0RGlyZWN0aW9uQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IEFsbFR5cGVzQ29kaW5ncywgQWxsVHlwZXNDb2RpbmdUeXBlLH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9BbGxUeXBlc0NvZGluZ3MuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IEFsbFR5cGVzQ29kZXMsICBBbGxUeXBlc0NvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9BbGxUeXBlc0NvZGVzLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERhdGFSZXF1aXJlbWVudENvZGVGaWx0ZXIgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlckFyZ3MgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhdGggYXR0cmlidXRlIGNvbnRhaW5zIGEgW1NpbXBsZSBGSElSUGF0aCBTdWJzZXRdKGZoaXJwYXRoLmh0bWwjc2ltcGxlKSB0aGF0IGFsbG93cyBwYXRoIHRyYXZlcnNhbCwgYnV0IG5vdCBjYWxjdWxhdGlvbi5cclxuICAgKi9cclxuICBwYXRoPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQSB0b2tlbiBwYXJhbWV0ZXIgdGhhdCByZWZlcnMgdG8gYSBzZWFyY2ggcGFyYW1ldGVyIGRlZmluZWQgb24gdGhlIHNwZWNpZmllZCB0eXBlIG9mIHRoZSBEYXRhUmVxdWlyZW1lbnQsIGFuZCB3aGljaCBzZWFyY2hlcyBvbiBlbGVtZW50cyBvZiB0eXBlIGNvZGUsIENvZGluZywgb3IgQ29kZWFibGVDb25jZXB0LlxyXG4gICAqL1xyXG4gIHNlYXJjaFBhcmFtPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlc2V0IGZvciB0aGUgY29kZSBmaWx0ZXIuIFRoZSB2YWx1ZVNldCBhbmQgY29kZSBlbGVtZW50cyBhcmUgYWRkaXRpdmUuIElmIHZhbHVlU2V0IGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgZm9yIHdoaWNoIHRoZSB2YWx1ZSBvZiB0aGUgY29kZS12YWx1ZWQgZWxlbWVudCBzcGVjaWZpZWQgaW4gdGhlIHBhdGggaXMgYSBtZW1iZXIgb2YgdGhlIHNwZWNpZmllZCB2YWx1ZXNldC5cclxuICAgKi9cclxuICB2YWx1ZVNldD86IGZoaXIuRmhpckNhbm9uaWNhbHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjb2RlcyBmb3IgdGhlIGNvZGUgZmlsdGVyLiBJZiB2YWx1ZXMgYXJlIGdpdmVuLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyBmb3Igd2hpY2ggdGhlIGNvZGUtdmFsdWVkIGF0dHJpYnV0ZSBzcGVjaWZpZWQgYnkgdGhlIHBhdGggaGFzIGEgdmFsdWUgdGhhdCBpcyBvbmUgb2YgdGhlIHNwZWNpZmllZCBjb2Rlcy4gSWYgY29kZXMgYXJlIHNwZWNpZmllZCBpbiBhZGRpdGlvbiB0byBhIHZhbHVlIHNldCwgdGhlIGZpbHRlciByZXR1cm5zIGl0ZW1zIG1hdGNoaW5nIGEgY29kZSBpbiB0aGUgdmFsdWUgc2V0IG9yIG9uZSBvZiB0aGUgc3BlY2lmaWVkIGNvZGVzLlxyXG4gICAqL1xyXG4gIGNvZGU/OiBmaGlyLkNvZGluZ0FyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb2RlIGZpbHRlcnMgc3BlY2lmeSBhZGRpdGlvbmFsIGNvbnN0cmFpbnRzIG9uIHRoZSBkYXRhLCBzcGVjaWZ5aW5nIHRoZSB2YWx1ZSBzZXQgb2YgaW50ZXJlc3QgZm9yIGEgcGFydGljdWxhciBlbGVtZW50IG9mIHRoZSBkYXRhLiBFYWNoIGNvZGUgZmlsdGVyIGRlZmluZXMgYW4gYWRkaXRpb25hbCBjb25zdHJhaW50IG9uIHRoZSBkYXRhLCBpLmUuIGNvZGUgZmlsdGVycyBhcmUgQU5EJ2VkLCBub3QgT1InZWQuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlciBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlcic7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhdGggYXR0cmlidXRlIGNvbnRhaW5zIGEgW1NpbXBsZSBGSElSUGF0aCBTdWJzZXRdKGZoaXJwYXRoLmh0bWwjc2ltcGxlKSB0aGF0IGFsbG93cyBwYXRoIHRyYXZlcnNhbCwgYnV0IG5vdCBjYWxjdWxhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgcGF0aD86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQSB0b2tlbiBwYXJhbWV0ZXIgdGhhdCByZWZlcnMgdG8gYSBzZWFyY2ggcGFyYW1ldGVyIGRlZmluZWQgb24gdGhlIHNwZWNpZmllZCB0eXBlIG9mIHRoZSBEYXRhUmVxdWlyZW1lbnQsIGFuZCB3aGljaCBzZWFyY2hlcyBvbiBlbGVtZW50cyBvZiB0eXBlIGNvZGUsIENvZGluZywgb3IgQ29kZWFibGVDb25jZXB0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZWFyY2hQYXJhbT86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlc2V0IGZvciB0aGUgY29kZSBmaWx0ZXIuIFRoZSB2YWx1ZVNldCBhbmQgY29kZSBlbGVtZW50cyBhcmUgYWRkaXRpdmUuIElmIHZhbHVlU2V0IGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgZm9yIHdoaWNoIHRoZSB2YWx1ZSBvZiB0aGUgY29kZS12YWx1ZWQgZWxlbWVudCBzcGVjaWZpZWQgaW4gdGhlIHBhdGggaXMgYSBtZW1iZXIgb2YgdGhlIHNwZWNpZmllZCB2YWx1ZXNldC5cclxuICAgKi9cclxuICBwdWJsaWMgdmFsdWVTZXQ/OiBmaGlyLkZoaXJDYW5vbmljYWx8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjb2RlcyBmb3IgdGhlIGNvZGUgZmlsdGVyLiBJZiB2YWx1ZXMgYXJlIGdpdmVuLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyBmb3Igd2hpY2ggdGhlIGNvZGUtdmFsdWVkIGF0dHJpYnV0ZSBzcGVjaWZpZWQgYnkgdGhlIHBhdGggaGFzIGEgdmFsdWUgdGhhdCBpcyBvbmUgb2YgdGhlIHNwZWNpZmllZCBjb2Rlcy4gSWYgY29kZXMgYXJlIHNwZWNpZmllZCBpbiBhZGRpdGlvbiB0byBhIHZhbHVlIHNldCwgdGhlIGZpbHRlciByZXR1cm5zIGl0ZW1zIG1hdGNoaW5nIGEgY29kZSBpbiB0aGUgdmFsdWUgc2V0IG9yIG9uZSBvZiB0aGUgc3BlY2lmaWVkIGNvZGVzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb2RlPzogZmhpci5Db2RpbmdbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBEYXRhUmVxdWlyZW1lbnRDb2RlRmlsdGVyIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8RGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlckFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWydwYXRoJ10pIHsgdGhpcy5wYXRoID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS5wYXRofSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3NlYXJjaFBhcmFtJ10pIHsgdGhpcy5zZWFyY2hQYXJhbSA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoe3ZhbHVlOiBzb3VyY2Uuc2VhcmNoUGFyYW19KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsndmFsdWVTZXQnXSkgeyB0aGlzLnZhbHVlU2V0ID0gbmV3IGZoaXIuRmhpckNhbm9uaWNhbCh7dmFsdWU6IHNvdXJjZS52YWx1ZVNldH0pOyB9XHJcbiAgICBpZiAoc291cmNlWydjb2RlJ10pIHsgdGhpcy5jb2RlID0gc291cmNlLmNvZGUubWFwKCh4KSA9PiBuZXcgZmhpci5Db2RpbmcoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5jb2RlID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKCk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oKTtcclxuICAgIGlmICh0aGlzW1wicGF0aFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnBhdGguZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzW1wic2VhcmNoUGFyYW1cIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5zZWFyY2hQYXJhbS5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJ2YWx1ZVNldFwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnZhbHVlU2V0LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAodGhpc1tcImNvZGVcIl0pIHsgdGhpcy5jb2RlLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERhdGFSZXF1aXJlbWVudERhdGVGaWx0ZXIgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVJlcXVpcmVtZW50RGF0ZUZpbHRlckFyZ3MgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhdGggYXR0cmlidXRlIGNvbnRhaW5zIGEgW1NpbXBsZSBGSElSIFN1YnNldF0oZmhpcnBhdGguaHRtbCNzaW1wbGUpIHRoYXQgYWxsb3dzIHBhdGggdHJhdmVyc2FsLCBidXQgbm90IGNhbGN1bGF0aW9uLlxyXG4gICAqL1xyXG4gIHBhdGg/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIGRhdGUgcGFyYW1ldGVyIHRoYXQgcmVmZXJzIHRvIGEgc2VhcmNoIHBhcmFtZXRlciBkZWZpbmVkIG9uIHRoZSBzcGVjaWZpZWQgdHlwZSBvZiB0aGUgRGF0YVJlcXVpcmVtZW50LCBhbmQgd2hpY2ggc2VhcmNoZXMgb24gZWxlbWVudHMgb2YgdHlwZSBkYXRlLCBkYXRlVGltZSwgUGVyaW9kLCBTY2hlZHVsZSwgb3IgVGltaW5nLlxyXG4gICAqL1xyXG4gIHNlYXJjaFBhcmFtPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlIG9mIHRoZSBmaWx0ZXIuIElmIHBlcmlvZCBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gdGhlIGJvdW5kcyBkZXRlcm1pbmVkIGJ5IHRoZSBQZXJpb2QsIGluY2x1c2l2ZSBvZiB0aGUgcGVyaW9kIGJvdW5kYXJpZXMuIElmIGRhdGVUaW1lIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBhcmUgZXF1YWwgdG8gdGhlIHNwZWNpZmllZCBkYXRlVGltZS4gSWYgYSBEdXJhdGlvbiBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gRHVyYXRpb24gYmVmb3JlIG5vdy5cclxuICAgKi9cclxuICB2YWx1ZT86IGZoaXIuRmhpckRhdGVUaW1lfGZoaXIuUGVyaW9kfGZoaXIuRHVyYXRpb258dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSB2YWx1ZSBvZiB0aGUgZmlsdGVyLiBJZiBwZXJpb2QgaXMgc3BlY2lmaWVkLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyB0aGF0IGZhbGwgd2l0aGluIHRoZSBib3VuZHMgZGV0ZXJtaW5lZCBieSB0aGUgUGVyaW9kLCBpbmNsdXNpdmUgb2YgdGhlIHBlcmlvZCBib3VuZGFyaWVzLiBJZiBkYXRlVGltZSBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgYXJlIGVxdWFsIHRvIHRoZSBzcGVjaWZpZWQgZGF0ZVRpbWUuIElmIGEgRHVyYXRpb24gaXMgc3BlY2lmaWVkLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyB0aGF0IGZhbGwgd2l0aGluIER1cmF0aW9uIGJlZm9yZSBub3cuXHJcbiAgICovXHJcbiAgdmFsdWVEYXRlVGltZT86IGZoaXIuRmhpckRhdGVUaW1lfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlIG9mIHRoZSBmaWx0ZXIuIElmIHBlcmlvZCBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gdGhlIGJvdW5kcyBkZXRlcm1pbmVkIGJ5IHRoZSBQZXJpb2QsIGluY2x1c2l2ZSBvZiB0aGUgcGVyaW9kIGJvdW5kYXJpZXMuIElmIGRhdGVUaW1lIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBhcmUgZXF1YWwgdG8gdGhlIHNwZWNpZmllZCBkYXRlVGltZS4gSWYgYSBEdXJhdGlvbiBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gRHVyYXRpb24gYmVmb3JlIG5vdy5cclxuICAgKi9cclxuICB2YWx1ZVBlcmlvZD86IGZoaXIuUGVyaW9kQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlIG9mIHRoZSBmaWx0ZXIuIElmIHBlcmlvZCBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gdGhlIGJvdW5kcyBkZXRlcm1pbmVkIGJ5IHRoZSBQZXJpb2QsIGluY2x1c2l2ZSBvZiB0aGUgcGVyaW9kIGJvdW5kYXJpZXMuIElmIGRhdGVUaW1lIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBhcmUgZXF1YWwgdG8gdGhlIHNwZWNpZmllZCBkYXRlVGltZS4gSWYgYSBEdXJhdGlvbiBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gRHVyYXRpb24gYmVmb3JlIG5vdy5cclxuICAgKi9cclxuICB2YWx1ZUR1cmF0aW9uPzogZmhpci5EdXJhdGlvbkFyZ3N8dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogRGF0ZSBmaWx0ZXJzIHNwZWNpZnkgYWRkaXRpb25hbCBjb25zdHJhaW50cyBvbiB0aGUgZGF0YSBpbiB0ZXJtcyBvZiB0aGUgYXBwbGljYWJsZSBkYXRlIHJhbmdlIGZvciBzcGVjaWZpYyBlbGVtZW50cy4gRWFjaCBkYXRlIGZpbHRlciBzcGVjaWZpZXMgYW4gYWRkaXRpb25hbCBjb25zdHJhaW50IG9uIHRoZSBkYXRhLCBpLmUuIGRhdGUgZmlsdGVycyBhcmUgQU5EJ2VkLCBub3QgT1InZWQuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGF0YVJlcXVpcmVtZW50RGF0ZUZpbHRlciBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnRGF0YVJlcXVpcmVtZW50RGF0ZUZpbHRlcic7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhdGggYXR0cmlidXRlIGNvbnRhaW5zIGEgW1NpbXBsZSBGSElSIFN1YnNldF0oZmhpcnBhdGguaHRtbCNzaW1wbGUpIHRoYXQgYWxsb3dzIHBhdGggdHJhdmVyc2FsLCBidXQgbm90IGNhbGN1bGF0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXRoPzogZmhpci5GaGlyU3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIGRhdGUgcGFyYW1ldGVyIHRoYXQgcmVmZXJzIHRvIGEgc2VhcmNoIHBhcmFtZXRlciBkZWZpbmVkIG9uIHRoZSBzcGVjaWZpZWQgdHlwZSBvZiB0aGUgRGF0YVJlcXVpcmVtZW50LCBhbmQgd2hpY2ggc2VhcmNoZXMgb24gZWxlbWVudHMgb2YgdHlwZSBkYXRlLCBkYXRlVGltZSwgUGVyaW9kLCBTY2hlZHVsZSwgb3IgVGltaW5nLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZWFyY2hQYXJhbT86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlIG9mIHRoZSBmaWx0ZXIuIElmIHBlcmlvZCBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gdGhlIGJvdW5kcyBkZXRlcm1pbmVkIGJ5IHRoZSBQZXJpb2QsIGluY2x1c2l2ZSBvZiB0aGUgcGVyaW9kIGJvdW5kYXJpZXMuIElmIGRhdGVUaW1lIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBhcmUgZXF1YWwgdG8gdGhlIHNwZWNpZmllZCBkYXRlVGltZS4gSWYgYSBEdXJhdGlvbiBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gRHVyYXRpb24gYmVmb3JlIG5vdy5cclxuICAgKi9cclxuICBwdWJsaWMgdmFsdWU/OiAoZmhpci5GaGlyRGF0ZVRpbWV8Zmhpci5QZXJpb2R8Zmhpci5EdXJhdGlvbil8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEludGVybmFsIGZsYWcgdG8gcHJvcGVybHkgc2VyaWFsaXplIGNob2ljZS10eXBlIGVsZW1lbnQgRGF0YVJlcXVpcmVtZW50LmRhdGVGaWx0ZXIudmFsdWVbeF1cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgc3RhdGljIHJlYWRvbmx5IF9mdHNfdmFsdWVJc0Nob2ljZTp0cnVlID0gdHJ1ZTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBEYXRhUmVxdWlyZW1lbnREYXRlRmlsdGVyIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8RGF0YVJlcXVpcmVtZW50RGF0ZUZpbHRlckFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWydwYXRoJ10pIHsgdGhpcy5wYXRoID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS5wYXRofSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3NlYXJjaFBhcmFtJ10pIHsgdGhpcy5zZWFyY2hQYXJhbSA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoe3ZhbHVlOiBzb3VyY2Uuc2VhcmNoUGFyYW19KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsndmFsdWUnXSkgeyB0aGlzLnZhbHVlID0gc291cmNlLnZhbHVlOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ3ZhbHVlRGF0ZVRpbWUnXSkgeyB0aGlzLnZhbHVlID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHt2YWx1ZTogc291cmNlLnZhbHVlRGF0ZVRpbWV9KTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWyd2YWx1ZVBlcmlvZCddKSB7IHRoaXMudmFsdWUgPSBuZXcgZmhpci5QZXJpb2Qoc291cmNlLnZhbHVlUGVyaW9kKTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWyd2YWx1ZUR1cmF0aW9uJ10pIHsgdGhpcy52YWx1ZSA9IG5ldyBmaGlyLkR1cmF0aW9uKHNvdXJjZS52YWx1ZUR1cmF0aW9uKTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbigpO1xyXG4gICAgaWYgKHRoaXNbXCJwYXRoXCJdKSB7IGlzc3Vlcy5wdXNoKC4uLnRoaXMucGF0aC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJzZWFyY2hQYXJhbVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnNlYXJjaFBhcmFtLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgRGF0YVJlcXVpcmVtZW50U29ydCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBEYXRhUmVxdWlyZW1lbnRTb3J0QXJncyBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgYXR0cmlidXRlIG9mIHRoZSBzb3J0LiBUaGUgc3BlY2lmaWVkIHBhdGggbXVzdCBiZSByZXNvbHZhYmxlIGZyb20gdGhlIHR5cGUgb2YgdGhlIHJlcXVpcmVkIGRhdGEuIFRoZSBwYXRoIGlzIGFsbG93ZWQgdG8gY29udGFpbiBxdWFsaWZpZXJzICguKSB0byB0cmF2ZXJzZSBzdWItZWxlbWVudHMsIGFzIHdlbGwgYXMgaW5kZXhlcnMgKFt4XSkgdG8gdHJhdmVyc2UgbXVsdGlwbGUtY2FyZGluYWxpdHkgc3ViLWVsZW1lbnRzLiBOb3RlIHRoYXQgdGhlIGluZGV4IG11c3QgYmUgYW4gaW50ZWdlciBjb25zdGFudC5cclxuICAgKi9cclxuICBwYXRoOiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgZGlyZWN0aW9uIG9mIHRoZSBzb3J0LCBhc2NlbmRpbmcgb3IgZGVzY2VuZGluZy5cclxuICAgKi9cclxuICBkaXJlY3Rpb246IFNvcnREaXJlY3Rpb25Db2RlVHlwZXxudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogVGhpcyBlbGVtZW50IGNhbiBiZSB1c2VkIGluIGNvbWJpbmF0aW9uIHdpdGggdGhlIHNvcnQgZWxlbWVudCB0byBzcGVjaWZ5IHF1b3RhIHJlcXVpcmVtZW50cyBzdWNoIGFzIFwidGhlIG1vc3QgcmVjZW50IDVcIiBvciBcInRoZSBoaWdoZXN0IDVcIi4gV2hlbiBtdWx0aXBsZSBzb3J0cyBhcmUgc3BlY2lmaWVkLCB0aGV5IGFyZSBhcHBsaWVkIGluIHRoZSBvcmRlciB0aGV5IGFwcGVhciBpbiB0aGUgcmVzb3VyY2UuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGF0YVJlcXVpcmVtZW50U29ydCBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnRGF0YVJlcXVpcmVtZW50U29ydCc7XHJcbiAgLyoqXHJcbiAgICogVGhlIGF0dHJpYnV0ZSBvZiB0aGUgc29ydC4gVGhlIHNwZWNpZmllZCBwYXRoIG11c3QgYmUgcmVzb2x2YWJsZSBmcm9tIHRoZSB0eXBlIG9mIHRoZSByZXF1aXJlZCBkYXRhLiBUaGUgcGF0aCBpcyBhbGxvd2VkIHRvIGNvbnRhaW4gcXVhbGlmaWVycyAoLikgdG8gdHJhdmVyc2Ugc3ViLWVsZW1lbnRzLCBhcyB3ZWxsIGFzIGluZGV4ZXJzIChbeF0pIHRvIHRyYXZlcnNlIG11bHRpcGxlLWNhcmRpbmFsaXR5IHN1Yi1lbGVtZW50cy4gTm90ZSB0aGF0IHRoZSBpbmRleCBtdXN0IGJlIGFuIGludGVnZXIgY29uc3RhbnQuXHJcbiAgICovXHJcbiAgcHVibGljIHBhdGg6IGZoaXIuRmhpclN0cmluZ3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBkaXJlY3Rpb24gb2YgdGhlIHNvcnQsIGFzY2VuZGluZyBvciBkZXNjZW5kaW5nLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBkaXJlY3Rpb246IFNvcnREaXJlY3Rpb25Db2RlVHlwZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIERhdGFSZXF1aXJlbWVudFNvcnQgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxEYXRhUmVxdWlyZW1lbnRTb3J0QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3BhdGgnXSkgeyB0aGlzLnBhdGggPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLnBhdGh9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucGF0aCA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ2RpcmVjdGlvbiddKSB7IHRoaXMuZGlyZWN0aW9uID0gc291cmNlLmRpcmVjdGlvbjsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZGlyZWN0aW9uID0gbnVsbDsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBSZXF1aXJlZC1ib3VuZCBWYWx1ZSBTZXQgZm9yIGRpcmVjdGlvbiAoRGF0YVJlcXVpcmVtZW50LnNvcnQuZGlyZWN0aW9uKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZGlyZWN0aW9uUmVxdWlyZWRDb2RpbmcoKTpTb3J0RGlyZWN0aW9uQ29kaW5nVHlwZSB7XHJcbiAgICByZXR1cm4gU29ydERpcmVjdGlvbkNvZGluZ3M7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbigpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKCk7XHJcbiAgICBpZiAoIXRoaXNbJ3BhdGgnXSkge1xyXG4gICAgICBpc3N1ZXMucHVzaCh7IHNldmVyaXR5OiAnZXJyb3InLCBjb2RlOiAncmVxdWlyZWQnLCAgZGlhZ25vc3RpY3M6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5IHBhdGg6Zmhpci5GaGlyU3RyaW5nIGZoaXI6IERhdGFSZXF1aXJlbWVudC5zb3J0LnBhdGg6c3RyaW5nJywgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpc1tcInBhdGhcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5wYXRoLmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9XHJcbiAgICBpZiAoIXRoaXNbJ2RpcmVjdGlvbiddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsICBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgZGlyZWN0aW9uOlNvcnREaXJlY3Rpb25Db2RlVHlwZSBmaGlyOiBEYXRhUmVxdWlyZW1lbnQuc29ydC5kaXJlY3Rpb246Y29kZScsIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERhdGFSZXF1aXJlbWVudCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBEYXRhUmVxdWlyZW1lbnRBcmdzIGV4dGVuZHMgZmhpci5GaGlyRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFRoZSB0eXBlIG9mIHRoZSByZXF1aXJlZCBkYXRhLCBzcGVjaWZpZWQgYXMgdGhlIHR5cGUgbmFtZSBvZiBhIHJlc291cmNlLiBGb3IgcHJvZmlsZXMsIHRoaXMgdmFsdWUgaXMgc2V0IHRvIHRoZSB0eXBlIG9mIHRoZSBiYXNlIHJlc291cmNlIG9mIHRoZSBwcm9maWxlLlxyXG4gICAqL1xyXG4gIHR5cGU6IGZoaXIuRmhpckNvZGV8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgcHJvZmlsZSBvZiB0aGUgcmVxdWlyZWQgZGF0YSwgc3BlY2lmaWVkIGFzIHRoZSB1cmkgb2YgdGhlIHByb2ZpbGUgZGVmaW5pdGlvbi5cclxuICAgKi9cclxuICBwcm9maWxlPzogZmhpci5GaGlyQ2Fub25pY2FsW118c3RyaW5nW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBzdWJqZWN0IG9mIGEgZGF0YSByZXF1aXJlbWVudCBpcyBjcml0aWNhbCwgYXMgdGhlIGRhdGEgYmVpbmcgc3BlY2lmaWVkIGlzIGRldGVybWluZWQgd2l0aCByZXNwZWN0IHRvIGEgcGFydGljdWxhciBzdWJqZWN0LiBUaGlzIGNvcnJlc3BvbmRzIHJvdWdobHkgdG8gdGhlIG5vdGlvbiBvZiBhIENvbXBhcnRtZW50IGluIHRoYXQgaXQgbGltaXRzIHdoYXQgZGF0YSBpcyBhdmFpbGFibGUgYmFzZWQgb24gaXRzIHJlbGF0aW9uc2hpcCB0byB0aGUgc3ViamVjdC4gSW4gQ1FMLCB0aGlzIGNvcnJlc3BvbmRzIHRvIHRoZSBjb250ZXh0IGRlY2xhcmF0aW9uLlxyXG4gICAqL1xyXG4gIHN1YmplY3Q/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHxmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHN1YmplY3Qgb2YgYSBkYXRhIHJlcXVpcmVtZW50IGlzIGNyaXRpY2FsLCBhcyB0aGUgZGF0YSBiZWluZyBzcGVjaWZpZWQgaXMgZGV0ZXJtaW5lZCB3aXRoIHJlc3BlY3QgdG8gYSBwYXJ0aWN1bGFyIHN1YmplY3QuIFRoaXMgY29ycmVzcG9uZHMgcm91Z2hseSB0byB0aGUgbm90aW9uIG9mIGEgQ29tcGFydG1lbnQgaW4gdGhhdCBpdCBsaW1pdHMgd2hhdCBkYXRhIGlzIGF2YWlsYWJsZSBiYXNlZCBvbiBpdHMgcmVsYXRpb25zaGlwIHRvIHRoZSBzdWJqZWN0LiBJbiBDUUwsIHRoaXMgY29ycmVzcG9uZHMgdG8gdGhlIGNvbnRleHQgZGVjbGFyYXRpb24uXHJcbiAgICovXHJcbiAgc3ViamVjdENvZGVhYmxlQ29uY2VwdD86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHN1YmplY3Qgb2YgYSBkYXRhIHJlcXVpcmVtZW50IGlzIGNyaXRpY2FsLCBhcyB0aGUgZGF0YSBiZWluZyBzcGVjaWZpZWQgaXMgZGV0ZXJtaW5lZCB3aXRoIHJlc3BlY3QgdG8gYSBwYXJ0aWN1bGFyIHN1YmplY3QuIFRoaXMgY29ycmVzcG9uZHMgcm91Z2hseSB0byB0aGUgbm90aW9uIG9mIGEgQ29tcGFydG1lbnQgaW4gdGhhdCBpdCBsaW1pdHMgd2hhdCBkYXRhIGlzIGF2YWlsYWJsZSBiYXNlZCBvbiBpdHMgcmVsYXRpb25zaGlwIHRvIHRoZSBzdWJqZWN0LiBJbiBDUUwsIHRoaXMgY29ycmVzcG9uZHMgdG8gdGhlIGNvbnRleHQgZGVjbGFyYXRpb24uXHJcbiAgICovXHJcbiAgc3ViamVjdFJlZmVyZW5jZT86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIHRoYXQgc3BlY2lmaWMgZWxlbWVudHMgb2YgdGhlIHR5cGUgYXJlIHJlZmVyZW5jZWQgYnkgdGhlIGtub3dsZWRnZSBtb2R1bGUgYW5kIG11c3QgYmUgc3VwcG9ydGVkIGJ5IHRoZSBjb25zdW1lciBpbiBvcmRlciB0byBvYnRhaW4gYW4gZWZmZWN0aXZlIGV2YWx1YXRpb24uIFRoaXMgZG9lcyBub3QgbWVhbiB0aGF0IGEgdmFsdWUgaXMgcmVxdWlyZWQgZm9yIHRoaXMgZWxlbWVudCwgb25seSB0aGF0IHRoZSBjb25zdW1pbmcgc3lzdGVtIG11c3QgdW5kZXJzdGFuZCB0aGUgZWxlbWVudCBhbmQgYmUgYWJsZSB0byBwcm92aWRlIHZhbHVlcyBmb3IgaXQgaWYgdGhleSBhcmUgYXZhaWxhYmxlLiBcclxuICAgKiBUaGUgdmFsdWUgb2YgbXVzdFN1cHBvcnQgU0hBTEwgYmUgYSBGSElSUGF0aCByZXNvbHZlYWJsZSBvbiB0aGUgdHlwZSBvZiB0aGUgRGF0YVJlcXVpcmVtZW50LiBUaGUgcGF0aCBTSEFMTCBjb25zaXN0IG9ubHkgb2YgaWRlbnRpZmllcnMsIGNvbnN0YW50IGluZGV4ZXJzLCBhbmQgLnJlc29sdmUoKSAoc2VlIHRoZSBbU2ltcGxlIEZISVJQYXRoIFByb2ZpbGVdKGZoaXJwYXRoLmh0bWwjc2ltcGxlKSBmb3IgZnVsbCBkZXRhaWxzKS5cclxuICAgKi9cclxuICBtdXN0U3VwcG9ydD86IGZoaXIuRmhpclN0cmluZ1tdfHN0cmluZ1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBDb2RlIGZpbHRlcnMgc3BlY2lmeSBhZGRpdGlvbmFsIGNvbnN0cmFpbnRzIG9uIHRoZSBkYXRhLCBzcGVjaWZ5aW5nIHRoZSB2YWx1ZSBzZXQgb2YgaW50ZXJlc3QgZm9yIGEgcGFydGljdWxhciBlbGVtZW50IG9mIHRoZSBkYXRhLiBFYWNoIGNvZGUgZmlsdGVyIGRlZmluZXMgYW4gYWRkaXRpb25hbCBjb25zdHJhaW50IG9uIHRoZSBkYXRhLCBpLmUuIGNvZGUgZmlsdGVycyBhcmUgQU5EJ2VkLCBub3QgT1InZWQuXHJcbiAgICovXHJcbiAgY29kZUZpbHRlcj86IGZoaXIuRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlckFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGF0ZSBmaWx0ZXJzIHNwZWNpZnkgYWRkaXRpb25hbCBjb25zdHJhaW50cyBvbiB0aGUgZGF0YSBpbiB0ZXJtcyBvZiB0aGUgYXBwbGljYWJsZSBkYXRlIHJhbmdlIGZvciBzcGVjaWZpYyBlbGVtZW50cy4gRWFjaCBkYXRlIGZpbHRlciBzcGVjaWZpZXMgYW4gYWRkaXRpb25hbCBjb25zdHJhaW50IG9uIHRoZSBkYXRhLCBpLmUuIGRhdGUgZmlsdGVycyBhcmUgQU5EJ2VkLCBub3QgT1InZWQuXHJcbiAgICovXHJcbiAgZGF0ZUZpbHRlcj86IGZoaXIuRGF0YVJlcXVpcmVtZW50RGF0ZUZpbHRlckFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBlbGVtZW50IGNhbiBiZSB1c2VkIGluIGNvbWJpbmF0aW9uIHdpdGggdGhlIHNvcnQgZWxlbWVudCB0byBzcGVjaWZ5IHF1b3RhIHJlcXVpcmVtZW50cyBzdWNoIGFzIFwidGhlIG1vc3QgcmVjZW50IDVcIiBvciBcInRoZSBoaWdoZXN0IDVcIi5cclxuICAgKi9cclxuICBsaW1pdD86IGZoaXIuRmhpclBvc2l0aXZlSW50fG51bWJlcnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBlbGVtZW50IGNhbiBiZSB1c2VkIGluIGNvbWJpbmF0aW9uIHdpdGggdGhlIHNvcnQgZWxlbWVudCB0byBzcGVjaWZ5IHF1b3RhIHJlcXVpcmVtZW50cyBzdWNoIGFzIFwidGhlIG1vc3QgcmVjZW50IDVcIiBvciBcInRoZSBoaWdoZXN0IDVcIi4gV2hlbiBtdWx0aXBsZSBzb3J0cyBhcmUgc3BlY2lmaWVkLCB0aGV5IGFyZSBhcHBsaWVkIGluIHRoZSBvcmRlciB0aGV5IGFwcGVhciBpbiB0aGUgcmVzb3VyY2UuXHJcbiAgICovXHJcbiAgc29ydD86IGZoaXIuRGF0YVJlcXVpcmVtZW50U29ydEFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXNjcmliZXMgYSByZXF1aXJlZCBkYXRhIGl0ZW0gZm9yIGV2YWx1YXRpb24gaW4gdGVybXMgb2YgdGhlIHR5cGUgb2YgZGF0YSwgYW5kIG9wdGlvbmFsIGNvZGUgb3IgZGF0ZS1iYXNlZCBmaWx0ZXJzIG9mIHRoZSBkYXRhLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIERhdGFSZXF1aXJlbWVudCBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnRGF0YVJlcXVpcmVtZW50JztcclxuICAvKipcclxuICAgKiBUaGUgdHlwZSBvZiB0aGUgcmVxdWlyZWQgZGF0YSwgc3BlY2lmaWVkIGFzIHRoZSB0eXBlIG5hbWUgb2YgYSByZXNvdXJjZS4gRm9yIHByb2ZpbGVzLCB0aGlzIHZhbHVlIGlzIHNldCB0byB0aGUgdHlwZSBvZiB0aGUgYmFzZSByZXNvdXJjZSBvZiB0aGUgcHJvZmlsZS5cclxuICAgKi9cclxuICBwdWJsaWMgdHlwZTogZmhpci5GaGlyQ29kZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwcm9maWxlIG9mIHRoZSByZXF1aXJlZCBkYXRhLCBzcGVjaWZpZWQgYXMgdGhlIHVyaSBvZiB0aGUgcHJvZmlsZSBkZWZpbml0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwcm9maWxlPzogZmhpci5GaGlyQ2Fub25pY2FsW107XHJcbiAgLyoqXHJcbiAgICogVGhlIHN1YmplY3Qgb2YgYSBkYXRhIHJlcXVpcmVtZW50IGlzIGNyaXRpY2FsLCBhcyB0aGUgZGF0YSBiZWluZyBzcGVjaWZpZWQgaXMgZGV0ZXJtaW5lZCB3aXRoIHJlc3BlY3QgdG8gYSBwYXJ0aWN1bGFyIHN1YmplY3QuIFRoaXMgY29ycmVzcG9uZHMgcm91Z2hseSB0byB0aGUgbm90aW9uIG9mIGEgQ29tcGFydG1lbnQgaW4gdGhhdCBpdCBsaW1pdHMgd2hhdCBkYXRhIGlzIGF2YWlsYWJsZSBiYXNlZCBvbiBpdHMgcmVsYXRpb25zaGlwIHRvIHRoZSBzdWJqZWN0LiBJbiBDUUwsIHRoaXMgY29ycmVzcG9uZHMgdG8gdGhlIGNvbnRleHQgZGVjbGFyYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIHN1YmplY3Q/OiAoZmhpci5Db2RlYWJsZUNvbmNlcHR8Zmhpci5SZWZlcmVuY2UpfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbnRlcm5hbCBmbGFnIHRvIHByb3Blcmx5IHNlcmlhbGl6ZSBjaG9pY2UtdHlwZSBlbGVtZW50IERhdGFSZXF1aXJlbWVudC5zdWJqZWN0W3hdXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIHN0YXRpYyByZWFkb25seSBfZnRzX3N1YmplY3RJc0Nob2ljZTp0cnVlID0gdHJ1ZTtcclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgdGhhdCBzcGVjaWZpYyBlbGVtZW50cyBvZiB0aGUgdHlwZSBhcmUgcmVmZXJlbmNlZCBieSB0aGUga25vd2xlZGdlIG1vZHVsZSBhbmQgbXVzdCBiZSBzdXBwb3J0ZWQgYnkgdGhlIGNvbnN1bWVyIGluIG9yZGVyIHRvIG9idGFpbiBhbiBlZmZlY3RpdmUgZXZhbHVhdGlvbi4gVGhpcyBkb2VzIG5vdCBtZWFuIHRoYXQgYSB2YWx1ZSBpcyByZXF1aXJlZCBmb3IgdGhpcyBlbGVtZW50LCBvbmx5IHRoYXQgdGhlIGNvbnN1bWluZyBzeXN0ZW0gbXVzdCB1bmRlcnN0YW5kIHRoZSBlbGVtZW50IGFuZCBiZSBhYmxlIHRvIHByb3ZpZGUgdmFsdWVzIGZvciBpdCBpZiB0aGV5IGFyZSBhdmFpbGFibGUuIFxyXG4gICAqIFRoZSB2YWx1ZSBvZiBtdXN0U3VwcG9ydCBTSEFMTCBiZSBhIEZISVJQYXRoIHJlc29sdmVhYmxlIG9uIHRoZSB0eXBlIG9mIHRoZSBEYXRhUmVxdWlyZW1lbnQuIFRoZSBwYXRoIFNIQUxMIGNvbnNpc3Qgb25seSBvZiBpZGVudGlmaWVycywgY29uc3RhbnQgaW5kZXhlcnMsIGFuZCAucmVzb2x2ZSgpIChzZWUgdGhlIFtTaW1wbGUgRkhJUlBhdGggUHJvZmlsZV0oZmhpcnBhdGguaHRtbCNzaW1wbGUpIGZvciBmdWxsIGRldGFpbHMpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBtdXN0U3VwcG9ydD86IGZoaXIuRmhpclN0cmluZ1tdO1xyXG4gIC8qKlxyXG4gICAqIENvZGUgZmlsdGVycyBzcGVjaWZ5IGFkZGl0aW9uYWwgY29uc3RyYWludHMgb24gdGhlIGRhdGEsIHNwZWNpZnlpbmcgdGhlIHZhbHVlIHNldCBvZiBpbnRlcmVzdCBmb3IgYSBwYXJ0aWN1bGFyIGVsZW1lbnQgb2YgdGhlIGRhdGEuIEVhY2ggY29kZSBmaWx0ZXIgZGVmaW5lcyBhbiBhZGRpdGlvbmFsIGNvbnN0cmFpbnQgb24gdGhlIGRhdGEsIGkuZS4gY29kZSBmaWx0ZXJzIGFyZSBBTkQnZWQsIG5vdCBPUidlZC5cclxuICAgKi9cclxuICBwdWJsaWMgY29kZUZpbHRlcj86IGZoaXIuRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlcltdO1xyXG4gIC8qKlxyXG4gICAqIERhdGUgZmlsdGVycyBzcGVjaWZ5IGFkZGl0aW9uYWwgY29uc3RyYWludHMgb24gdGhlIGRhdGEgaW4gdGVybXMgb2YgdGhlIGFwcGxpY2FibGUgZGF0ZSByYW5nZSBmb3Igc3BlY2lmaWMgZWxlbWVudHMuIEVhY2ggZGF0ZSBmaWx0ZXIgc3BlY2lmaWVzIGFuIGFkZGl0aW9uYWwgY29uc3RyYWludCBvbiB0aGUgZGF0YSwgaS5lLiBkYXRlIGZpbHRlcnMgYXJlIEFORCdlZCwgbm90IE9SJ2VkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBkYXRlRmlsdGVyPzogZmhpci5EYXRhUmVxdWlyZW1lbnREYXRlRmlsdGVyW107XHJcbiAgLyoqXHJcbiAgICogVGhpcyBlbGVtZW50IGNhbiBiZSB1c2VkIGluIGNvbWJpbmF0aW9uIHdpdGggdGhlIHNvcnQgZWxlbWVudCB0byBzcGVjaWZ5IHF1b3RhIHJlcXVpcmVtZW50cyBzdWNoIGFzIFwidGhlIG1vc3QgcmVjZW50IDVcIiBvciBcInRoZSBoaWdoZXN0IDVcIi5cclxuICAgKi9cclxuICBwdWJsaWMgbGltaXQ/OiBmaGlyLkZoaXJQb3NpdGl2ZUludHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBlbGVtZW50IGNhbiBiZSB1c2VkIGluIGNvbWJpbmF0aW9uIHdpdGggdGhlIHNvcnQgZWxlbWVudCB0byBzcGVjaWZ5IHF1b3RhIHJlcXVpcmVtZW50cyBzdWNoIGFzIFwidGhlIG1vc3QgcmVjZW50IDVcIiBvciBcInRoZSBoaWdoZXN0IDVcIi4gV2hlbiBtdWx0aXBsZSBzb3J0cyBhcmUgc3BlY2lmaWVkLCB0aGV5IGFyZSBhcHBsaWVkIGluIHRoZSBvcmRlciB0aGV5IGFwcGVhciBpbiB0aGUgcmVzb3VyY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHNvcnQ/OiBmaGlyLkRhdGFSZXF1aXJlbWVudFNvcnRbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBEYXRhUmVxdWlyZW1lbnQgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxEYXRhUmVxdWlyZW1lbnRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkZoaXJDb2RlKHt2YWx1ZTogc291cmNlLnR5cGV9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudHlwZSA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ3Byb2ZpbGUnXSkgeyB0aGlzLnByb2ZpbGUgPSBzb3VyY2UucHJvZmlsZS5tYXAoKHgpID0+IG5ldyBmaGlyLkZoaXJDYW5vbmljYWwoe3ZhbHVlOiB4fSkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5wcm9maWxlID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ3N1YmplY3QnXSkgeyB0aGlzLnN1YmplY3QgPSBzb3VyY2Uuc3ViamVjdDsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWydzdWJqZWN0Q29kZWFibGVDb25jZXB0J10pIHsgdGhpcy5zdWJqZWN0ID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5zdWJqZWN0Q29kZWFibGVDb25jZXB0KTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWydzdWJqZWN0UmVmZXJlbmNlJ10pIHsgdGhpcy5zdWJqZWN0ID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5zdWJqZWN0UmVmZXJlbmNlKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnbXVzdFN1cHBvcnQnXSkgeyB0aGlzLm11c3RTdXBwb3J0ID0gc291cmNlLm11c3RTdXBwb3J0Lm1hcCgoeCkgPT4gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHh9KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLm11c3RTdXBwb3J0ID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2NvZGVGaWx0ZXInXSkgeyB0aGlzLmNvZGVGaWx0ZXIgPSBzb3VyY2UuY29kZUZpbHRlci5tYXAoKHgpID0+IG5ldyBmaGlyLkRhdGFSZXF1aXJlbWVudENvZGVGaWx0ZXIoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5jb2RlRmlsdGVyID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2RhdGVGaWx0ZXInXSkgeyB0aGlzLmRhdGVGaWx0ZXIgPSBzb3VyY2UuZGF0ZUZpbHRlci5tYXAoKHgpID0+IG5ldyBmaGlyLkRhdGFSZXF1aXJlbWVudERhdGVGaWx0ZXIoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5kYXRlRmlsdGVyID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ2xpbWl0J10pIHsgdGhpcy5saW1pdCA9IG5ldyBmaGlyLkZoaXJQb3NpdGl2ZUludCh7dmFsdWU6IHNvdXJjZS5saW1pdH0pOyB9XHJcbiAgICBpZiAoc291cmNlWydzb3J0J10pIHsgdGhpcy5zb3J0ID0gc291cmNlLnNvcnQubWFwKCh4KSA9PiBuZXcgZmhpci5EYXRhUmVxdWlyZW1lbnRTb3J0KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuc29ydCA9IFtdOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFJlcXVpcmVkLWJvdW5kIFZhbHVlIFNldCBmb3IgdHlwZSAoRGF0YVJlcXVpcmVtZW50LnR5cGUpXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyB0eXBlUmVxdWlyZWRDb2RpbmcoKTpBbGxUeXBlc0NvZGluZ1R5cGUge1xyXG4gICAgcmV0dXJuIEFsbFR5cGVzQ29kaW5ncztcclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKCk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oKTtcclxuICAgIGlmICghdGhpc1sndHlwZSddKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKHsgc2V2ZXJpdHk6ICdlcnJvcicsIGNvZGU6ICdyZXF1aXJlZCcsICBkaWFnbm9zdGljczogJ01pc3NpbmcgcmVxdWlyZWQgcHJvcGVydHkgdHlwZTpmaGlyLkZoaXJDb2RlIGZoaXI6IERhdGFSZXF1aXJlbWVudC50eXBlOmNvZGUnLCB9KTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzW1widHlwZVwiXSkgeyBpc3N1ZXMucHVzaCguLi50aGlzLnR5cGUuZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH1cclxuICAgIGlmICh0aGlzW1wicHJvZmlsZVwiXSkgeyB0aGlzLnByb2ZpbGUuZm9yRWFjaCgoeCkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1tcIm11c3RTdXBwb3J0XCJdKSB7IHRoaXMubXVzdFN1cHBvcnQuZm9yRWFjaCgoeCkgPT4geyBpc3N1ZXMucHVzaCguLi54LmRvTW9kZWxWYWxpZGF0aW9uKCkpOyB9KSB9XHJcbiAgICBpZiAodGhpc1tcImNvZGVGaWx0ZXJcIl0pIHsgdGhpcy5jb2RlRmlsdGVyLmZvckVhY2goKHgpID0+IHsgaXNzdWVzLnB1c2goLi4ueC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfSkgfVxyXG4gICAgaWYgKHRoaXNbXCJkYXRlRmlsdGVyXCJdKSB7IHRoaXMuZGF0ZUZpbHRlci5mb3JFYWNoKCh4KSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH0pIH1cclxuICAgIGlmICh0aGlzW1wibGltaXRcIl0pIHsgaXNzdWVzLnB1c2goLi4udGhpcy5saW1pdC5kb01vZGVsVmFsaWRhdGlvbigpKTsgfVxyXG4gICAgaWYgKHRoaXNbXCJzb3J0XCJdKSB7IHRoaXMuc29ydC5mb3JFYWNoKCh4KSA9PiB7IGlzc3Vlcy5wdXNoKC4uLnguZG9Nb2RlbFZhbGlkYXRpb24oKSk7IH0pIH1cclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbiJdfQ==