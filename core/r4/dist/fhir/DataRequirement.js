// <auto-generated/>
// Contents of: hl7.fhir.r4.core version: 4.0.1
// Minimum TypeScript Version: 3.7
// FHIR ComplexType: DataRequirement
import * as fhir from '../fhir.js';
// @ts-ignore
import { SortDirectionVsValidation } from '../fhirValueSets/SortDirectionVsValidation.js';
// @ts-ignore
import { AllTypesVsValidation } from '../fhirValueSets/AllTypesVsValidation.js';
/**
 * Code filters specify additional constraints on the data, specifying the value set of interest for a particular element of the data. Each code filter defines an additional constraint on the data, i.e. code filters are AND'ed, not OR'ed.
 */
export class DataRequirementCodeFilter extends fhir.FhirElement {
    /**
     * Default constructor for DataRequirementCodeFilter - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['path']) {
            this.path = new fhir.FhirString({ value: source.path });
        }
        if (source['_path']) {
            if (this.path) {
                this.path.addExtendedProperties(source._path);
            }
            else {
                this.path = new fhir.FhirString(source._path);
            }
        }
        if (source['searchParam']) {
            this.searchParam = new fhir.FhirString({ value: source.searchParam });
        }
        if (source['_searchParam']) {
            if (this.searchParam) {
                this.searchParam.addExtendedProperties(source._searchParam);
            }
            else {
                this.searchParam = new fhir.FhirString(source._searchParam);
            }
        }
        if (source['valueSet']) {
            this.valueSet = new fhir.FhirCanonical({ value: source.valueSet });
        }
        if (source['_valueSet']) {
            if (this.valueSet) {
                this.valueSet.addExtendedProperties(source._valueSet);
            }
            else {
                this.valueSet = new fhir.FhirCanonical(source._valueSet);
            }
        }
        if (source['code']) {
            this.code = source.code.map((x) => new fhir.Coding(x));
        }
        else {
            this.code = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'DataRequirement.codeFilter';
        }
        this.vOptS('path', expression);
        this.vOptS('searchParam', expression);
        this.vOptS('valueSet', expression);
        this.vOptA('code', expression);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DataRequirementCodeFilter._fts_dataType = 'DataRequirementCodeFilter';
/**
 * Date filters specify additional constraints on the data in terms of the applicable date range for specific elements. Each date filter specifies an additional constraint on the data, i.e. date filters are AND'ed, not OR'ed.
 */
export class DataRequirementDateFilter extends fhir.FhirElement {
    /**
     * Default constructor for DataRequirementDateFilter - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['path']) {
            this.path = new fhir.FhirString({ value: source.path });
        }
        if (source['_path']) {
            if (this.path) {
                this.path.addExtendedProperties(source._path);
            }
            else {
                this.path = new fhir.FhirString(source._path);
            }
        }
        if (source['searchParam']) {
            this.searchParam = new fhir.FhirString({ value: source.searchParam });
        }
        if (source['_searchParam']) {
            if (this.searchParam) {
                this.searchParam.addExtendedProperties(source._searchParam);
            }
            else {
                this.searchParam = new fhir.FhirString(source._searchParam);
            }
        }
        if (source['value']) {
            this.value = source.value;
        }
        else if (source['valueDateTime']) {
            this.value = new fhir.FhirDateTime({ value: source.valueDateTime });
        }
        else if (source['valuePeriod']) {
            this.value = new fhir.Period(source.valuePeriod);
        }
        else if (source['valueDuration']) {
            this.value = new fhir.Duration(source.valueDuration);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'DataRequirement.dateFilter';
        }
        this.vOptS('path', expression);
        this.vOptS('searchParam', expression);
        this.vOptS('value', expression);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DataRequirementDateFilter._fts_dataType = 'DataRequirementDateFilter';
/**
 * Internal flag to properly serialize choice-type element DataRequirement.dateFilter.value[x]
 */
DataRequirementDateFilter._fts_valueIsChoice = true;
/**
 * This element can be used in combination with the sort element to specify quota requirements such as "the most recent 5" or "the highest 5". When multiple sorts are specified, they are applied in the order they appear in the resource.
 */
export class DataRequirementSort extends fhir.FhirElement {
    /**
     * Default constructor for DataRequirementSort - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['path']) {
            this.path = new fhir.FhirString({ value: source.path });
        }
        else {
            this.path = null;
        }
        if (source['_path']) {
            if (this.path) {
                this.path.addExtendedProperties(source._path);
            }
            else {
                this.path = new fhir.FhirString(source._path);
            }
        }
        if (source['direction']) {
            this.direction = new fhir.FhirCode({ value: source.direction });
        }
        else {
            this.direction = null;
        }
        if (source['_direction']) {
            if (this.direction) {
                this.direction.addExtendedProperties(source._direction);
            }
            else {
                this.direction = new fhir.FhirCode(source._direction);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'DataRequirement.sort';
        }
        this.vReqS('path', expression);
        this.vReqSV('direction', expression, 'SortDirection', SortDirectionVsValidation, 'r');
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DataRequirementSort._fts_dataType = 'DataRequirementSort';
/**
 * Describes a required data item for evaluation in terms of the type of data, and optional code or date-based filters of the data.
 */
export class DataRequirement extends fhir.FhirElement {
    /**
     * Default constructor for DataRequirement - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.FhirCode({ value: source.type });
        }
        else {
            this.type = null;
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirCode(source._type);
            }
        }
        if (source['profile']) {
            this.profile = source.profile.map((x) => new fhir.FhirCanonical({ value: x }));
        }
        else {
            this.profile = [];
        }
        if (source['_profile']) {
            source._profile.forEach((x, i) => {
                if (this.profile.length >= i) {
                    if (x) {
                        this.profile[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.profile.push(new fhir.FhirCanonical(x));
                    }
                }
            });
        }
        if (source['subject']) {
            this.subject = source.subject;
        }
        else if (source['subjectCodeableConcept']) {
            this.subject = new fhir.CodeableConcept(source.subjectCodeableConcept);
        }
        else if (source['subjectReference']) {
            this.subject = new fhir.Reference(source.subjectReference);
        }
        if (source['mustSupport']) {
            this.mustSupport = source.mustSupport.map((x) => new fhir.FhirString({ value: x }));
        }
        else {
            this.mustSupport = [];
        }
        if (source['_mustSupport']) {
            source._mustSupport.forEach((x, i) => {
                if (this.mustSupport.length >= i) {
                    if (x) {
                        this.mustSupport[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.mustSupport.push(new fhir.FhirString(x));
                    }
                }
            });
        }
        if (source['codeFilter']) {
            this.codeFilter = source.codeFilter.map((x) => new fhir.DataRequirementCodeFilter(x));
        }
        else {
            this.codeFilter = [];
        }
        if (source['dateFilter']) {
            this.dateFilter = source.dateFilter.map((x) => new fhir.DataRequirementDateFilter(x));
        }
        else {
            this.dateFilter = [];
        }
        if (source['limit']) {
            this.limit = new fhir.FhirPositiveInt({ value: source.limit });
        }
        if (source['_limit']) {
            if (this.limit) {
                this.limit.addExtendedProperties(source._limit);
            }
            else {
                this.limit = new fhir.FhirPositiveInt(source._limit);
            }
        }
        if (source['sort']) {
            this.sort = source.sort.map((x) => new fhir.DataRequirementSort(x));
        }
        else {
            this.sort = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(expression = '') {
        let issues = super.doModelValidation(expression);
        if (expression === '') {
            expression = 'DataRequirement';
        }
        this.vReqSV('type', expression, 'AllTypes', AllTypesVsValidation, 'r');
        this.vOptA('profile', expression);
        this.vOptS('subject', expression);
        this.vOptA('mustSupport', expression);
        this.vOptA('codeFilter', expression);
        this.vOptA('dateFilter', expression);
        this.vOptS('limit', expression);
        this.vOptA('sort', expression);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DataRequirement._fts_dataType = 'DataRequirement';
/**
 * Internal flag to properly serialize choice-type element DataRequirement.subject[x]
 */
DataRequirement._fts_subjectIsChoice = true;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGF0YVJlcXVpcmVtZW50LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9EYXRhUmVxdWlyZW1lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsb0NBQW9DO0FBRXBDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSwrQ0FBK0MsQ0FBQztBQUcxRixhQUFhO0FBQ2IsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFtQ2hGOztHQUVHO0FBQ0gsTUFBTSxPQUFPLHlCQUEwQixTQUFRLElBQUksQ0FBQyxXQUFXO0lBcUI3RDs7T0FFRztJQUNILFlBQVksU0FBZ0QsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDdEcsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDO1NBQUU7UUFDOUUsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDbkIsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFO2dCQUFFLElBQUksQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLEtBQU0sQ0FBQyxDQUFDO2FBQUU7aUJBQzdEO2dCQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFxQyxDQUFDLENBQUM7YUFBRTtTQUN4RjtRQUNELElBQUksTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLElB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QUFDLENBQUE7UUFDbkMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUMsVUFBVSxDQUFDLENBQUE7UUFDOUIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUMsVUFBVSxDQUFDLENBQUE7UUFDN0IsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7QUFsR0Q7O0dBRUc7QUFDNkIsNkJBQWEsR0FBVSxpQkFBaUIsQ0FBQztBQWF6RTs7R0FFRztBQUN1QixvQ0FBb0IsR0FBUSxJQUFJLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjQuY29yZSB2ZXJzaW9uOiA0LjAuMVxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgQ29tcGxleFR5cGU6IERhdGFSZXF1aXJlbWVudFxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU29ydERpcmVjdGlvbkNvZGVzLCAgU29ydERpcmVjdGlvbkNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9Tb3J0RGlyZWN0aW9uQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFNvcnREaXJlY3Rpb25Wc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1NvcnREaXJlY3Rpb25Wc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IEFsbFR5cGVzQ29kZXMsICBBbGxUeXBlc0NvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9BbGxUeXBlc0NvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBBbGxUeXBlc1ZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvQWxsVHlwZXNWc1ZhbGlkYXRpb24uanMnO1xyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlciB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBEYXRhUmVxdWlyZW1lbnRDb2RlRmlsdGVyQXJncyBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgcGF0aCBhdHRyaWJ1dGUgY29udGFpbnMgYSBbU2ltcGxlIEZISVJQYXRoIFN1YnNldF0oZmhpcnBhdGguaHRtbCNzaW1wbGUpIHRoYXQgYWxsb3dzIHBhdGggdHJhdmVyc2FsLCBidXQgbm90IGNhbGN1bGF0aW9uLlxyXG4gICAqL1xyXG4gIHBhdGg/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGF0YVJlcXVpcmVtZW50LmNvZGVGaWx0ZXIucGF0aFxyXG4gICAqL1xyXG4gIF9wYXRoPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBBIHRva2VuIHBhcmFtZXRlciB0aGF0IHJlZmVycyB0byBhIHNlYXJjaCBwYXJhbWV0ZXIgZGVmaW5lZCBvbiB0aGUgc3BlY2lmaWVkIHR5cGUgb2YgdGhlIERhdGFSZXF1aXJlbWVudCwgYW5kIHdoaWNoIHNlYXJjaGVzIG9uIGVsZW1lbnRzIG9mIHR5cGUgY29kZSwgQ29kaW5nLCBvciBDb2RlYWJsZUNvbmNlcHQuXHJcbiAgICovXHJcbiAgc2VhcmNoUGFyYW0/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGF0YVJlcXVpcmVtZW50LmNvZGVGaWx0ZXIuc2VhcmNoUGFyYW1cclxuICAgKi9cclxuICBfc2VhcmNoUGFyYW0/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSB2YWx1ZXNldCBmb3IgdGhlIGNvZGUgZmlsdGVyLiBUaGUgdmFsdWVTZXQgYW5kIGNvZGUgZWxlbWVudHMgYXJlIGFkZGl0aXZlLiBJZiB2YWx1ZVNldCBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIGZvciB3aGljaCB0aGUgdmFsdWUgb2YgdGhlIGNvZGUtdmFsdWVkIGVsZW1lbnQgc3BlY2lmaWVkIGluIHRoZSBwYXRoIGlzIGEgbWVtYmVyIG9mIHRoZSBzcGVjaWZpZWQgdmFsdWVzZXQuXHJcbiAgICovXHJcbiAgdmFsdWVTZXQ/OiBmaGlyLkZoaXJDYW5vbmljYWx8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGF0YVJlcXVpcmVtZW50LmNvZGVGaWx0ZXIudmFsdWVTZXRcclxuICAgKi9cclxuICBfdmFsdWVTZXQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjb2RlcyBmb3IgdGhlIGNvZGUgZmlsdGVyLiBJZiB2YWx1ZXMgYXJlIGdpdmVuLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyBmb3Igd2hpY2ggdGhlIGNvZGUtdmFsdWVkIGF0dHJpYnV0ZSBzcGVjaWZpZWQgYnkgdGhlIHBhdGggaGFzIGEgdmFsdWUgdGhhdCBpcyBvbmUgb2YgdGhlIHNwZWNpZmllZCBjb2Rlcy4gSWYgY29kZXMgYXJlIHNwZWNpZmllZCBpbiBhZGRpdGlvbiB0byBhIHZhbHVlIHNldCwgdGhlIGZpbHRlciByZXR1cm5zIGl0ZW1zIG1hdGNoaW5nIGEgY29kZSBpbiB0aGUgdmFsdWUgc2V0IG9yIG9uZSBvZiB0aGUgc3BlY2lmaWVkIGNvZGVzLlxyXG4gICAqL1xyXG4gIGNvZGU/OiBmaGlyLkNvZGluZ0FyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb2RlIGZpbHRlcnMgc3BlY2lmeSBhZGRpdGlvbmFsIGNvbnN0cmFpbnRzIG9uIHRoZSBkYXRhLCBzcGVjaWZ5aW5nIHRoZSB2YWx1ZSBzZXQgb2YgaW50ZXJlc3QgZm9yIGEgcGFydGljdWxhciBlbGVtZW50IG9mIHRoZSBkYXRhLiBFYWNoIGNvZGUgZmlsdGVyIGRlZmluZXMgYW4gYWRkaXRpb25hbCBjb25zdHJhaW50IG9uIHRoZSBkYXRhLCBpLmUuIGNvZGUgZmlsdGVycyBhcmUgQU5EJ2VkLCBub3QgT1InZWQuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlciBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlcic7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhdGggYXR0cmlidXRlIGNvbnRhaW5zIGEgW1NpbXBsZSBGSElSUGF0aCBTdWJzZXRdKGZoaXJwYXRoLmh0bWwjc2ltcGxlKSB0aGF0IGFsbG93cyBwYXRoIHRyYXZlcnNhbCwgYnV0IG5vdCBjYWxjdWxhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgcGF0aD86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQSB0b2tlbiBwYXJhbWV0ZXIgdGhhdCByZWZlcnMgdG8gYSBzZWFyY2ggcGFyYW1ldGVyIGRlZmluZWQgb24gdGhlIHNwZWNpZmllZCB0eXBlIG9mIHRoZSBEYXRhUmVxdWlyZW1lbnQsIGFuZCB3aGljaCBzZWFyY2hlcyBvbiBlbGVtZW50cyBvZiB0eXBlIGNvZGUsIENvZGluZywgb3IgQ29kZWFibGVDb25jZXB0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZWFyY2hQYXJhbT86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlc2V0IGZvciB0aGUgY29kZSBmaWx0ZXIuIFRoZSB2YWx1ZVNldCBhbmQgY29kZSBlbGVtZW50cyBhcmUgYWRkaXRpdmUuIElmIHZhbHVlU2V0IGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgZm9yIHdoaWNoIHRoZSB2YWx1ZSBvZiB0aGUgY29kZS12YWx1ZWQgZWxlbWVudCBzcGVjaWZpZWQgaW4gdGhlIHBhdGggaXMgYSBtZW1iZXIgb2YgdGhlIHNwZWNpZmllZCB2YWx1ZXNldC5cclxuICAgKi9cclxuICBwdWJsaWMgdmFsdWVTZXQ/OiBmaGlyLkZoaXJDYW5vbmljYWx8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBjb2RlcyBmb3IgdGhlIGNvZGUgZmlsdGVyLiBJZiB2YWx1ZXMgYXJlIGdpdmVuLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyBmb3Igd2hpY2ggdGhlIGNvZGUtdmFsdWVkIGF0dHJpYnV0ZSBzcGVjaWZpZWQgYnkgdGhlIHBhdGggaGFzIGEgdmFsdWUgdGhhdCBpcyBvbmUgb2YgdGhlIHNwZWNpZmllZCBjb2Rlcy4gSWYgY29kZXMgYXJlIHNwZWNpZmllZCBpbiBhZGRpdGlvbiB0byBhIHZhbHVlIHNldCwgdGhlIGZpbHRlciByZXR1cm5zIGl0ZW1zIG1hdGNoaW5nIGEgY29kZSBpbiB0aGUgdmFsdWUgc2V0IG9yIG9uZSBvZiB0aGUgc3BlY2lmaWVkIGNvZGVzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb2RlOiBmaGlyLkNvZGluZ1tdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIERhdGFSZXF1aXJlbWVudENvZGVGaWx0ZXIgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxEYXRhUmVxdWlyZW1lbnRDb2RlRmlsdGVyQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3BhdGgnXSkgeyB0aGlzLnBhdGggPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLnBhdGh9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3BhdGgnXSkge1xyXG4gICAgICBpZiAodGhpcy5wYXRoKSB7IHRoaXMucGF0aC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9wYXRoISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMucGF0aCA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9wYXRoIGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydzZWFyY2hQYXJhbSddKSB7IHRoaXMuc2VhcmNoUGFyYW0gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLnNlYXJjaFBhcmFtfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19zZWFyY2hQYXJhbSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnNlYXJjaFBhcmFtKSB7IHRoaXMuc2VhcmNoUGFyYW0uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fc2VhcmNoUGFyYW0hKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zZWFyY2hQYXJhbSA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9zZWFyY2hQYXJhbSBhcyBQYXJ0aWFsPGZoaXIuRmhpclN0cmluZ0FyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndmFsdWVTZXQnXSkgeyB0aGlzLnZhbHVlU2V0ID0gbmV3IGZoaXIuRmhpckNhbm9uaWNhbCh7dmFsdWU6IHNvdXJjZS52YWx1ZVNldH0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfdmFsdWVTZXQnXSkge1xyXG4gICAgICBpZiAodGhpcy52YWx1ZVNldCkgeyB0aGlzLnZhbHVlU2V0LmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3ZhbHVlU2V0ISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudmFsdWVTZXQgPSBuZXcgZmhpci5GaGlyQ2Fub25pY2FsKHNvdXJjZS5fdmFsdWVTZXQgYXMgUGFydGlhbDxmaGlyLkZoaXJDYW5vbmljYWxBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2NvZGUnXSkgeyB0aGlzLmNvZGUgPSBzb3VyY2UuY29kZS5tYXAoKHgpID0+IG5ldyBmaGlyLkNvZGluZyh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmNvZGUgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbjpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbik7XHJcbiAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHsgZXhwcmVzc2lvbiA9ICdEYXRhUmVxdWlyZW1lbnQuY29kZUZpbHRlcicgfVxyXG4gICAgdGhpcy52T3B0UygncGF0aCcsZXhwcmVzc2lvbilcclxuICAgIHRoaXMudk9wdFMoJ3NlYXJjaFBhcmFtJyxleHByZXNzaW9uKVxyXG4gICAgdGhpcy52T3B0UygndmFsdWVTZXQnLGV4cHJlc3Npb24pXHJcbiAgICB0aGlzLnZPcHRBKCdjb2RlJyxleHByZXNzaW9uKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERhdGFSZXF1aXJlbWVudERhdGVGaWx0ZXIgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVJlcXVpcmVtZW50RGF0ZUZpbHRlckFyZ3MgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogVGhlIHBhdGggYXR0cmlidXRlIGNvbnRhaW5zIGEgW1NpbXBsZSBGSElSIFN1YnNldF0oZmhpcnBhdGguaHRtbCNzaW1wbGUpIHRoYXQgYWxsb3dzIHBhdGggdHJhdmVyc2FsLCBidXQgbm90IGNhbGN1bGF0aW9uLlxyXG4gICAqL1xyXG4gIHBhdGg/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGF0YVJlcXVpcmVtZW50LmRhdGVGaWx0ZXIucGF0aFxyXG4gICAqL1xyXG4gIF9wYXRoPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBBIGRhdGUgcGFyYW1ldGVyIHRoYXQgcmVmZXJzIHRvIGEgc2VhcmNoIHBhcmFtZXRlciBkZWZpbmVkIG9uIHRoZSBzcGVjaWZpZWQgdHlwZSBvZiB0aGUgRGF0YVJlcXVpcmVtZW50LCBhbmQgd2hpY2ggc2VhcmNoZXMgb24gZWxlbWVudHMgb2YgdHlwZSBkYXRlLCBkYXRlVGltZSwgUGVyaW9kLCBTY2hlZHVsZSwgb3IgVGltaW5nLlxyXG4gICAqL1xyXG4gIHNlYXJjaFBhcmFtPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERhdGFSZXF1aXJlbWVudC5kYXRlRmlsdGVyLnNlYXJjaFBhcmFtXHJcbiAgICovXHJcbiAgX3NlYXJjaFBhcmFtPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGUgdmFsdWUgb2YgdGhlIGZpbHRlci4gSWYgcGVyaW9kIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBmYWxsIHdpdGhpbiB0aGUgYm91bmRzIGRldGVybWluZWQgYnkgdGhlIFBlcmlvZCwgaW5jbHVzaXZlIG9mIHRoZSBwZXJpb2QgYm91bmRhcmllcy4gSWYgZGF0ZVRpbWUgaXMgc3BlY2lmaWVkLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyB0aGF0IGFyZSBlcXVhbCB0byB0aGUgc3BlY2lmaWVkIGRhdGVUaW1lLiBJZiBhIER1cmF0aW9uIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBmYWxsIHdpdGhpbiBEdXJhdGlvbiBiZWZvcmUgbm93LlxyXG4gICAqL1xyXG4gIHZhbHVlPzogZmhpci5GaGlyRGF0ZVRpbWV8Zmhpci5QZXJpb2R8Zmhpci5EdXJhdGlvbnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIHZhbHVlIG9mIHRoZSBmaWx0ZXIuIElmIHBlcmlvZCBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gdGhlIGJvdW5kcyBkZXRlcm1pbmVkIGJ5IHRoZSBQZXJpb2QsIGluY2x1c2l2ZSBvZiB0aGUgcGVyaW9kIGJvdW5kYXJpZXMuIElmIGRhdGVUaW1lIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBhcmUgZXF1YWwgdG8gdGhlIHNwZWNpZmllZCBkYXRlVGltZS4gSWYgYSBEdXJhdGlvbiBpcyBzcGVjaWZpZWQsIHRoZSBmaWx0ZXIgd2lsbCByZXR1cm4gb25seSB0aG9zZSBkYXRhIGl0ZW1zIHRoYXQgZmFsbCB3aXRoaW4gRHVyYXRpb24gYmVmb3JlIG5vdy5cclxuICAgKi9cclxuICB2YWx1ZURhdGVUaW1lPzogZmhpci5GaGlyRGF0ZVRpbWV8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgdmFsdWUgb2YgdGhlIGZpbHRlci4gSWYgcGVyaW9kIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBmYWxsIHdpdGhpbiB0aGUgYm91bmRzIGRldGVybWluZWQgYnkgdGhlIFBlcmlvZCwgaW5jbHVzaXZlIG9mIHRoZSBwZXJpb2QgYm91bmRhcmllcy4gSWYgZGF0ZVRpbWUgaXMgc3BlY2lmaWVkLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyB0aGF0IGFyZSBlcXVhbCB0byB0aGUgc3BlY2lmaWVkIGRhdGVUaW1lLiBJZiBhIER1cmF0aW9uIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBmYWxsIHdpdGhpbiBEdXJhdGlvbiBiZWZvcmUgbm93LlxyXG4gICAqL1xyXG4gIHZhbHVlUGVyaW9kPzogZmhpci5QZXJpb2RBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgdmFsdWUgb2YgdGhlIGZpbHRlci4gSWYgcGVyaW9kIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBmYWxsIHdpdGhpbiB0aGUgYm91bmRzIGRldGVybWluZWQgYnkgdGhlIFBlcmlvZCwgaW5jbHVzaXZlIG9mIHRoZSBwZXJpb2QgYm91bmRhcmllcy4gSWYgZGF0ZVRpbWUgaXMgc3BlY2lmaWVkLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyB0aGF0IGFyZSBlcXVhbCB0byB0aGUgc3BlY2lmaWVkIGRhdGVUaW1lLiBJZiBhIER1cmF0aW9uIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBmYWxsIHdpdGhpbiBEdXJhdGlvbiBiZWZvcmUgbm93LlxyXG4gICAqL1xyXG4gIHZhbHVlRHVyYXRpb24/OiBmaGlyLkR1cmF0aW9uQXJnc3x1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEYXRlIGZpbHRlcnMgc3BlY2lmeSBhZGRpdGlvbmFsIGNvbnN0cmFpbnRzIG9uIHRoZSBkYXRhIGluIHRlcm1zIG9mIHRoZSBhcHBsaWNhYmxlIGRhdGUgcmFuZ2UgZm9yIHNwZWNpZmljIGVsZW1lbnRzLiBFYWNoIGRhdGUgZmlsdGVyIHNwZWNpZmllcyBhbiBhZGRpdGlvbmFsIGNvbnN0cmFpbnQgb24gdGhlIGRhdGEsIGkuZS4gZGF0ZSBmaWx0ZXJzIGFyZSBBTkQnZWQsIG5vdCBPUidlZC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBEYXRhUmVxdWlyZW1lbnREYXRlRmlsdGVyIGV4dGVuZHMgZmhpci5GaGlyRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdEYXRhUmVxdWlyZW1lbnREYXRlRmlsdGVyJztcclxuICAvKipcclxuICAgKiBUaGUgcGF0aCBhdHRyaWJ1dGUgY29udGFpbnMgYSBbU2ltcGxlIEZISVIgU3Vic2V0XShmaGlycGF0aC5odG1sI3NpbXBsZSkgdGhhdCBhbGxvd3MgcGF0aCB0cmF2ZXJzYWwsIGJ1dCBub3QgY2FsY3VsYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIHBhdGg/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEEgZGF0ZSBwYXJhbWV0ZXIgdGhhdCByZWZlcnMgdG8gYSBzZWFyY2ggcGFyYW1ldGVyIGRlZmluZWQgb24gdGhlIHNwZWNpZmllZCB0eXBlIG9mIHRoZSBEYXRhUmVxdWlyZW1lbnQsIGFuZCB3aGljaCBzZWFyY2hlcyBvbiBlbGVtZW50cyBvZiB0eXBlIGRhdGUsIGRhdGVUaW1lLCBQZXJpb2QsIFNjaGVkdWxlLCBvciBUaW1pbmcuXHJcbiAgICovXHJcbiAgcHVibGljIHNlYXJjaFBhcmFtPzogZmhpci5GaGlyU3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgdmFsdWUgb2YgdGhlIGZpbHRlci4gSWYgcGVyaW9kIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBmYWxsIHdpdGhpbiB0aGUgYm91bmRzIGRldGVybWluZWQgYnkgdGhlIFBlcmlvZCwgaW5jbHVzaXZlIG9mIHRoZSBwZXJpb2QgYm91bmRhcmllcy4gSWYgZGF0ZVRpbWUgaXMgc3BlY2lmaWVkLCB0aGUgZmlsdGVyIHdpbGwgcmV0dXJuIG9ubHkgdGhvc2UgZGF0YSBpdGVtcyB0aGF0IGFyZSBlcXVhbCB0byB0aGUgc3BlY2lmaWVkIGRhdGVUaW1lLiBJZiBhIER1cmF0aW9uIGlzIHNwZWNpZmllZCwgdGhlIGZpbHRlciB3aWxsIHJldHVybiBvbmx5IHRob3NlIGRhdGEgaXRlbXMgdGhhdCBmYWxsIHdpdGhpbiBEdXJhdGlvbiBiZWZvcmUgbm93LlxyXG4gICAqL1xyXG4gIHB1YmxpYyB2YWx1ZT86IChmaGlyLkZoaXJEYXRlVGltZXxmaGlyLlBlcmlvZHxmaGlyLkR1cmF0aW9uKXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW50ZXJuYWwgZmxhZyB0byBwcm9wZXJseSBzZXJpYWxpemUgY2hvaWNlLXR5cGUgZWxlbWVudCBEYXRhUmVxdWlyZW1lbnQuZGF0ZUZpbHRlci52YWx1ZVt4XVxyXG4gICAqL1xyXG4gIHByb3RlY3RlZCBzdGF0aWMgcmVhZG9ubHkgX2Z0c192YWx1ZUlzQ2hvaWNlOnRydWUgPSB0cnVlO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIERhdGFSZXF1aXJlbWVudERhdGVGaWx0ZXIgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxEYXRhUmVxdWlyZW1lbnREYXRlRmlsdGVyQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3BhdGgnXSkgeyB0aGlzLnBhdGggPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLnBhdGh9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3BhdGgnXSkge1xyXG4gICAgICBpZiAodGhpcy5wYXRoKSB7IHRoaXMucGF0aC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9wYXRoISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMucGF0aCA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9wYXRoIGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydzZWFyY2hQYXJhbSddKSB7IHRoaXMuc2VhcmNoUGFyYW0gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLnNlYXJjaFBhcmFtfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19zZWFyY2hQYXJhbSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnNlYXJjaFBhcmFtKSB7IHRoaXMuc2VhcmNoUGFyYW0uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fc2VhcmNoUGFyYW0hKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zZWFyY2hQYXJhbSA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9zZWFyY2hQYXJhbSBhcyBQYXJ0aWFsPGZoaXIuRmhpclN0cmluZ0FyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndmFsdWUnXSkgeyB0aGlzLnZhbHVlID0gc291cmNlLnZhbHVlOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ3ZhbHVlRGF0ZVRpbWUnXSkgeyB0aGlzLnZhbHVlID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHt2YWx1ZTogc291cmNlLnZhbHVlRGF0ZVRpbWV9KTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWyd2YWx1ZVBlcmlvZCddKSB7IHRoaXMudmFsdWUgPSBuZXcgZmhpci5QZXJpb2Qoc291cmNlLnZhbHVlUGVyaW9kKTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWyd2YWx1ZUR1cmF0aW9uJ10pIHsgdGhpcy52YWx1ZSA9IG5ldyBmaGlyLkR1cmF0aW9uKHNvdXJjZS52YWx1ZUR1cmF0aW9uKTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbjpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbik7XHJcbiAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHsgZXhwcmVzc2lvbiA9ICdEYXRhUmVxdWlyZW1lbnQuZGF0ZUZpbHRlcicgfVxyXG4gICAgdGhpcy52T3B0UygncGF0aCcsZXhwcmVzc2lvbilcclxuICAgIHRoaXMudk9wdFMoJ3NlYXJjaFBhcmFtJyxleHByZXNzaW9uKVxyXG4gICAgdGhpcy52T3B0UygndmFsdWUnLGV4cHJlc3Npb24pXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgRGF0YVJlcXVpcmVtZW50U29ydCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBEYXRhUmVxdWlyZW1lbnRTb3J0QXJncyBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgYXR0cmlidXRlIG9mIHRoZSBzb3J0LiBUaGUgc3BlY2lmaWVkIHBhdGggbXVzdCBiZSByZXNvbHZhYmxlIGZyb20gdGhlIHR5cGUgb2YgdGhlIHJlcXVpcmVkIGRhdGEuIFRoZSBwYXRoIGlzIGFsbG93ZWQgdG8gY29udGFpbiBxdWFsaWZpZXJzICguKSB0byB0cmF2ZXJzZSBzdWItZWxlbWVudHMsIGFzIHdlbGwgYXMgaW5kZXhlcnMgKFt4XSkgdG8gdHJhdmVyc2UgbXVsdGlwbGUtY2FyZGluYWxpdHkgc3ViLWVsZW1lbnRzLiBOb3RlIHRoYXQgdGhlIGluZGV4IG11c3QgYmUgYW4gaW50ZWdlciBjb25zdGFudC5cclxuICAgKi9cclxuICBwYXRoOiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGF0YVJlcXVpcmVtZW50LnNvcnQucGF0aFxyXG4gICAqL1xyXG4gIF9wYXRoPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGUgZGlyZWN0aW9uIG9mIHRoZSBzb3J0LCBhc2NlbmRpbmcgb3IgZGVzY2VuZGluZy5cclxuICAgKi9cclxuICBkaXJlY3Rpb246IGZoaXIuRmhpckNvZGU8U29ydERpcmVjdGlvbkNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBEYXRhUmVxdWlyZW1lbnQuc29ydC5kaXJlY3Rpb25cclxuICAgKi9cclxuICBfZGlyZWN0aW9uPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgZWxlbWVudCBjYW4gYmUgdXNlZCBpbiBjb21iaW5hdGlvbiB3aXRoIHRoZSBzb3J0IGVsZW1lbnQgdG8gc3BlY2lmeSBxdW90YSByZXF1aXJlbWVudHMgc3VjaCBhcyBcInRoZSBtb3N0IHJlY2VudCA1XCIgb3IgXCJ0aGUgaGlnaGVzdCA1XCIuIFdoZW4gbXVsdGlwbGUgc29ydHMgYXJlIHNwZWNpZmllZCwgdGhleSBhcmUgYXBwbGllZCBpbiB0aGUgb3JkZXIgdGhleSBhcHBlYXIgaW4gdGhlIHJlc291cmNlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIERhdGFSZXF1aXJlbWVudFNvcnQgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0RhdGFSZXF1aXJlbWVudFNvcnQnO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhdHRyaWJ1dGUgb2YgdGhlIHNvcnQuIFRoZSBzcGVjaWZpZWQgcGF0aCBtdXN0IGJlIHJlc29sdmFibGUgZnJvbSB0aGUgdHlwZSBvZiB0aGUgcmVxdWlyZWQgZGF0YS4gVGhlIHBhdGggaXMgYWxsb3dlZCB0byBjb250YWluIHF1YWxpZmllcnMgKC4pIHRvIHRyYXZlcnNlIHN1Yi1lbGVtZW50cywgYXMgd2VsbCBhcyBpbmRleGVycyAoW3hdKSB0byB0cmF2ZXJzZSBtdWx0aXBsZS1jYXJkaW5hbGl0eSBzdWItZWxlbWVudHMuIE5vdGUgdGhhdCB0aGUgaW5kZXggbXVzdCBiZSBhbiBpbnRlZ2VyIGNvbnN0YW50LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXRoOiBmaGlyLkZoaXJTdHJpbmd8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgZGlyZWN0aW9uIG9mIHRoZSBzb3J0LCBhc2NlbmRpbmcgb3IgZGVzY2VuZGluZy5cclxuICAgKi9cclxuICBwdWJsaWMgZGlyZWN0aW9uOiBmaGlyLkZoaXJDb2RlPFNvcnREaXJlY3Rpb25Db2RlVHlwZT58bnVsbDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBEYXRhUmVxdWlyZW1lbnRTb3J0IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8RGF0YVJlcXVpcmVtZW50U29ydEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWydwYXRoJ10pIHsgdGhpcy5wYXRoID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS5wYXRofSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnBhdGggPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfcGF0aCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnBhdGgpIHsgdGhpcy5wYXRoLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3BhdGghKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5wYXRoID0gbmV3IGZoaXIuRmhpclN0cmluZyhzb3VyY2UuX3BhdGggYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2RpcmVjdGlvbiddKSB7IHRoaXMuZGlyZWN0aW9uID0gbmV3IGZoaXIuRmhpckNvZGU8U29ydERpcmVjdGlvbkNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5kaXJlY3Rpb259KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZGlyZWN0aW9uID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2RpcmVjdGlvbiddKSB7XHJcbiAgICAgIGlmICh0aGlzLmRpcmVjdGlvbikgeyB0aGlzLmRpcmVjdGlvbi5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9kaXJlY3Rpb24hKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5kaXJlY3Rpb24gPSBuZXcgZmhpci5GaGlyQ29kZTxTb3J0RGlyZWN0aW9uQ29kZVR5cGU+KHNvdXJjZS5fZGlyZWN0aW9uIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHByZXNzaW9uKTtcclxuICAgIGlmIChleHByZXNzaW9uID09PSAnJykgeyBleHByZXNzaW9uID0gJ0RhdGFSZXF1aXJlbWVudC5zb3J0JyB9XHJcbiAgICB0aGlzLnZSZXFTKCdwYXRoJyxleHByZXNzaW9uKVxyXG4gICAgdGhpcy52UmVxU1YoJ2RpcmVjdGlvbicsZXhwcmVzc2lvbiwnU29ydERpcmVjdGlvbicsU29ydERpcmVjdGlvblZzVmFsaWRhdGlvbiwncicpXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgRGF0YVJlcXVpcmVtZW50IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIERhdGFSZXF1aXJlbWVudEFyZ3MgZXh0ZW5kcyBmaGlyLkZoaXJFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogVGhlIHR5cGUgb2YgdGhlIHJlcXVpcmVkIGRhdGEsIHNwZWNpZmllZCBhcyB0aGUgdHlwZSBuYW1lIG9mIGEgcmVzb3VyY2UuIEZvciBwcm9maWxlcywgdGhpcyB2YWx1ZSBpcyBzZXQgdG8gdGhlIHR5cGUgb2YgdGhlIGJhc2UgcmVzb3VyY2Ugb2YgdGhlIHByb2ZpbGUuXHJcbiAgICovXHJcbiAgdHlwZTogZmhpci5GaGlyQ29kZXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBEYXRhUmVxdWlyZW1lbnQudHlwZVxyXG4gICAqL1xyXG4gIF90eXBlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGUgcHJvZmlsZSBvZiB0aGUgcmVxdWlyZWQgZGF0YSwgc3BlY2lmaWVkIGFzIHRoZSB1cmkgb2YgdGhlIHByb2ZpbGUgZGVmaW5pdGlvbi5cclxuICAgKi9cclxuICBwcm9maWxlPzogZmhpci5GaGlyQ2Fub25pY2FsW118KHN0cmluZ3xudWxsKVtdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGF0YVJlcXVpcmVtZW50LnByb2ZpbGVcclxuICAgKi9cclxuICBfcHJvZmlsZT86KGZoaXIuRmhpckVsZW1lbnRBcmdzfG51bGwpW107XHJcbiAgLyoqXHJcbiAgICogVGhlIHN1YmplY3Qgb2YgYSBkYXRhIHJlcXVpcmVtZW50IGlzIGNyaXRpY2FsLCBhcyB0aGUgZGF0YSBiZWluZyBzcGVjaWZpZWQgaXMgZGV0ZXJtaW5lZCB3aXRoIHJlc3BlY3QgdG8gYSBwYXJ0aWN1bGFyIHN1YmplY3QuIFRoaXMgY29ycmVzcG9uZHMgcm91Z2hseSB0byB0aGUgbm90aW9uIG9mIGEgQ29tcGFydG1lbnQgaW4gdGhhdCBpdCBsaW1pdHMgd2hhdCBkYXRhIGlzIGF2YWlsYWJsZSBiYXNlZCBvbiBpdHMgcmVsYXRpb25zaGlwIHRvIHRoZSBzdWJqZWN0LiBJbiBDUUwsIHRoaXMgY29ycmVzcG9uZHMgdG8gdGhlIGNvbnRleHQgZGVjbGFyYXRpb24uXHJcbiAgICovXHJcbiAgc3ViamVjdD86IGZoaXIuQ29kZWFibGVDb25jZXB0fGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgc3ViamVjdCBvZiBhIGRhdGEgcmVxdWlyZW1lbnQgaXMgY3JpdGljYWwsIGFzIHRoZSBkYXRhIGJlaW5nIHNwZWNpZmllZCBpcyBkZXRlcm1pbmVkIHdpdGggcmVzcGVjdCB0byBhIHBhcnRpY3VsYXIgc3ViamVjdC4gVGhpcyBjb3JyZXNwb25kcyByb3VnaGx5IHRvIHRoZSBub3Rpb24gb2YgYSBDb21wYXJ0bWVudCBpbiB0aGF0IGl0IGxpbWl0cyB3aGF0IGRhdGEgaXMgYXZhaWxhYmxlIGJhc2VkIG9uIGl0cyByZWxhdGlvbnNoaXAgdG8gdGhlIHN1YmplY3QuIEluIENRTCwgdGhpcyBjb3JyZXNwb25kcyB0byB0aGUgY29udGV4dCBkZWNsYXJhdGlvbi5cclxuICAgKi9cclxuICBzdWJqZWN0Q29kZWFibGVDb25jZXB0PzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgc3ViamVjdCBvZiBhIGRhdGEgcmVxdWlyZW1lbnQgaXMgY3JpdGljYWwsIGFzIHRoZSBkYXRhIGJlaW5nIHNwZWNpZmllZCBpcyBkZXRlcm1pbmVkIHdpdGggcmVzcGVjdCB0byBhIHBhcnRpY3VsYXIgc3ViamVjdC4gVGhpcyBjb3JyZXNwb25kcyByb3VnaGx5IHRvIHRoZSBub3Rpb24gb2YgYSBDb21wYXJ0bWVudCBpbiB0aGF0IGl0IGxpbWl0cyB3aGF0IGRhdGEgaXMgYXZhaWxhYmxlIGJhc2VkIG9uIGl0cyByZWxhdGlvbnNoaXAgdG8gdGhlIHN1YmplY3QuIEluIENRTCwgdGhpcyBjb3JyZXNwb25kcyB0byB0aGUgY29udGV4dCBkZWNsYXJhdGlvbi5cclxuICAgKi9cclxuICBzdWJqZWN0UmVmZXJlbmNlPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgdGhhdCBzcGVjaWZpYyBlbGVtZW50cyBvZiB0aGUgdHlwZSBhcmUgcmVmZXJlbmNlZCBieSB0aGUga25vd2xlZGdlIG1vZHVsZSBhbmQgbXVzdCBiZSBzdXBwb3J0ZWQgYnkgdGhlIGNvbnN1bWVyIGluIG9yZGVyIHRvIG9idGFpbiBhbiBlZmZlY3RpdmUgZXZhbHVhdGlvbi4gVGhpcyBkb2VzIG5vdCBtZWFuIHRoYXQgYSB2YWx1ZSBpcyByZXF1aXJlZCBmb3IgdGhpcyBlbGVtZW50LCBvbmx5IHRoYXQgdGhlIGNvbnN1bWluZyBzeXN0ZW0gbXVzdCB1bmRlcnN0YW5kIHRoZSBlbGVtZW50IGFuZCBiZSBhYmxlIHRvIHByb3ZpZGUgdmFsdWVzIGZvciBpdCBpZiB0aGV5IGFyZSBhdmFpbGFibGUuIFxyXG4gICAqIFRoZSB2YWx1ZSBvZiBtdXN0U3VwcG9ydCBTSEFMTCBiZSBhIEZISVJQYXRoIHJlc29sdmVhYmxlIG9uIHRoZSB0eXBlIG9mIHRoZSBEYXRhUmVxdWlyZW1lbnQuIFRoZSBwYXRoIFNIQUxMIGNvbnNpc3Qgb25seSBvZiBpZGVudGlmaWVycywgY29uc3RhbnQgaW5kZXhlcnMsIGFuZCAucmVzb2x2ZSgpIChzZWUgdGhlIFtTaW1wbGUgRkhJUlBhdGggUHJvZmlsZV0oZmhpcnBhdGguaHRtbCNzaW1wbGUpIGZvciBmdWxsIGRldGFpbHMpLlxyXG4gICAqL1xyXG4gIG11c3RTdXBwb3J0PzogZmhpci5GaGlyU3RyaW5nW118KHN0cmluZ3xudWxsKVtdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGF0YVJlcXVpcmVtZW50Lm11c3RTdXBwb3J0XHJcbiAgICovXHJcbiAgX211c3RTdXBwb3J0PzooZmhpci5GaGlyRWxlbWVudEFyZ3N8bnVsbClbXTtcclxuICAvKipcclxuICAgKiBDb2RlIGZpbHRlcnMgc3BlY2lmeSBhZGRpdGlvbmFsIGNvbnN0cmFpbnRzIG9uIHRoZSBkYXRhLCBzcGVjaWZ5aW5nIHRoZSB2YWx1ZSBzZXQgb2YgaW50ZXJlc3QgZm9yIGEgcGFydGljdWxhciBlbGVtZW50IG9mIHRoZSBkYXRhLiBFYWNoIGNvZGUgZmlsdGVyIGRlZmluZXMgYW4gYWRkaXRpb25hbCBjb25zdHJhaW50IG9uIHRoZSBkYXRhLCBpLmUuIGNvZGUgZmlsdGVycyBhcmUgQU5EJ2VkLCBub3QgT1InZWQuXHJcbiAgICovXHJcbiAgY29kZUZpbHRlcj86IGZoaXIuRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlckFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGF0ZSBmaWx0ZXJzIHNwZWNpZnkgYWRkaXRpb25hbCBjb25zdHJhaW50cyBvbiB0aGUgZGF0YSBpbiB0ZXJtcyBvZiB0aGUgYXBwbGljYWJsZSBkYXRlIHJhbmdlIGZvciBzcGVjaWZpYyBlbGVtZW50cy4gRWFjaCBkYXRlIGZpbHRlciBzcGVjaWZpZXMgYW4gYWRkaXRpb25hbCBjb25zdHJhaW50IG9uIHRoZSBkYXRhLCBpLmUuIGRhdGUgZmlsdGVycyBhcmUgQU5EJ2VkLCBub3QgT1InZWQuXHJcbiAgICovXHJcbiAgZGF0ZUZpbHRlcj86IGZoaXIuRGF0YVJlcXVpcmVtZW50RGF0ZUZpbHRlckFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBlbGVtZW50IGNhbiBiZSB1c2VkIGluIGNvbWJpbmF0aW9uIHdpdGggdGhlIHNvcnQgZWxlbWVudCB0byBzcGVjaWZ5IHF1b3RhIHJlcXVpcmVtZW50cyBzdWNoIGFzIFwidGhlIG1vc3QgcmVjZW50IDVcIiBvciBcInRoZSBoaWdoZXN0IDVcIi5cclxuICAgKi9cclxuICBsaW1pdD86IGZoaXIuRmhpclBvc2l0aXZlSW50fG51bWJlcnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERhdGFSZXF1aXJlbWVudC5saW1pdFxyXG4gICAqL1xyXG4gIF9saW1pdD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVGhpcyBlbGVtZW50IGNhbiBiZSB1c2VkIGluIGNvbWJpbmF0aW9uIHdpdGggdGhlIHNvcnQgZWxlbWVudCB0byBzcGVjaWZ5IHF1b3RhIHJlcXVpcmVtZW50cyBzdWNoIGFzIFwidGhlIG1vc3QgcmVjZW50IDVcIiBvciBcInRoZSBoaWdoZXN0IDVcIi4gV2hlbiBtdWx0aXBsZSBzb3J0cyBhcmUgc3BlY2lmaWVkLCB0aGV5IGFyZSBhcHBsaWVkIGluIHRoZSBvcmRlciB0aGV5IGFwcGVhciBpbiB0aGUgcmVzb3VyY2UuXHJcbiAgICovXHJcbiAgc29ydD86IGZoaXIuRGF0YVJlcXVpcmVtZW50U29ydEFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXNjcmliZXMgYSByZXF1aXJlZCBkYXRhIGl0ZW0gZm9yIGV2YWx1YXRpb24gaW4gdGVybXMgb2YgdGhlIHR5cGUgb2YgZGF0YSwgYW5kIG9wdGlvbmFsIGNvZGUgb3IgZGF0ZS1iYXNlZCBmaWx0ZXJzIG9mIHRoZSBkYXRhLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIERhdGFSZXF1aXJlbWVudCBleHRlbmRzIGZoaXIuRmhpckVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnRGF0YVJlcXVpcmVtZW50JztcclxuICAvKipcclxuICAgKiBUaGUgdHlwZSBvZiB0aGUgcmVxdWlyZWQgZGF0YSwgc3BlY2lmaWVkIGFzIHRoZSB0eXBlIG5hbWUgb2YgYSByZXNvdXJjZS4gRm9yIHByb2ZpbGVzLCB0aGlzIHZhbHVlIGlzIHNldCB0byB0aGUgdHlwZSBvZiB0aGUgYmFzZSByZXNvdXJjZSBvZiB0aGUgcHJvZmlsZS5cclxuICAgKi9cclxuICBwdWJsaWMgdHlwZTogZmhpci5GaGlyQ29kZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBwcm9maWxlIG9mIHRoZSByZXF1aXJlZCBkYXRhLCBzcGVjaWZpZWQgYXMgdGhlIHVyaSBvZiB0aGUgcHJvZmlsZSBkZWZpbml0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwcm9maWxlOiBmaGlyLkZoaXJDYW5vbmljYWxbXTtcclxuICAvKipcclxuICAgKiBUaGUgc3ViamVjdCBvZiBhIGRhdGEgcmVxdWlyZW1lbnQgaXMgY3JpdGljYWwsIGFzIHRoZSBkYXRhIGJlaW5nIHNwZWNpZmllZCBpcyBkZXRlcm1pbmVkIHdpdGggcmVzcGVjdCB0byBhIHBhcnRpY3VsYXIgc3ViamVjdC4gVGhpcyBjb3JyZXNwb25kcyByb3VnaGx5IHRvIHRoZSBub3Rpb24gb2YgYSBDb21wYXJ0bWVudCBpbiB0aGF0IGl0IGxpbWl0cyB3aGF0IGRhdGEgaXMgYXZhaWxhYmxlIGJhc2VkIG9uIGl0cyByZWxhdGlvbnNoaXAgdG8gdGhlIHN1YmplY3QuIEluIENRTCwgdGhpcyBjb3JyZXNwb25kcyB0byB0aGUgY29udGV4dCBkZWNsYXJhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgc3ViamVjdD86IChmaGlyLkNvZGVhYmxlQ29uY2VwdHxmaGlyLlJlZmVyZW5jZSl8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEludGVybmFsIGZsYWcgdG8gcHJvcGVybHkgc2VyaWFsaXplIGNob2ljZS10eXBlIGVsZW1lbnQgRGF0YVJlcXVpcmVtZW50LnN1YmplY3RbeF1cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgc3RhdGljIHJlYWRvbmx5IF9mdHNfc3ViamVjdElzQ2hvaWNlOnRydWUgPSB0cnVlO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRlcyB0aGF0IHNwZWNpZmljIGVsZW1lbnRzIG9mIHRoZSB0eXBlIGFyZSByZWZlcmVuY2VkIGJ5IHRoZSBrbm93bGVkZ2UgbW9kdWxlIGFuZCBtdXN0IGJlIHN1cHBvcnRlZCBieSB0aGUgY29uc3VtZXIgaW4gb3JkZXIgdG8gb2J0YWluIGFuIGVmZmVjdGl2ZSBldmFsdWF0aW9uLiBUaGlzIGRvZXMgbm90IG1lYW4gdGhhdCBhIHZhbHVlIGlzIHJlcXVpcmVkIGZvciB0aGlzIGVsZW1lbnQsIG9ubHkgdGhhdCB0aGUgY29uc3VtaW5nIHN5c3RlbSBtdXN0IHVuZGVyc3RhbmQgdGhlIGVsZW1lbnQgYW5kIGJlIGFibGUgdG8gcHJvdmlkZSB2YWx1ZXMgZm9yIGl0IGlmIHRoZXkgYXJlIGF2YWlsYWJsZS4gXHJcbiAgICogVGhlIHZhbHVlIG9mIG11c3RTdXBwb3J0IFNIQUxMIGJlIGEgRkhJUlBhdGggcmVzb2x2ZWFibGUgb24gdGhlIHR5cGUgb2YgdGhlIERhdGFSZXF1aXJlbWVudC4gVGhlIHBhdGggU0hBTEwgY29uc2lzdCBvbmx5IG9mIGlkZW50aWZpZXJzLCBjb25zdGFudCBpbmRleGVycywgYW5kIC5yZXNvbHZlKCkgKHNlZSB0aGUgW1NpbXBsZSBGSElSUGF0aCBQcm9maWxlXShmaGlycGF0aC5odG1sI3NpbXBsZSkgZm9yIGZ1bGwgZGV0YWlscykuXHJcbiAgICovXHJcbiAgcHVibGljIG11c3RTdXBwb3J0OiBmaGlyLkZoaXJTdHJpbmdbXTtcclxuICAvKipcclxuICAgKiBDb2RlIGZpbHRlcnMgc3BlY2lmeSBhZGRpdGlvbmFsIGNvbnN0cmFpbnRzIG9uIHRoZSBkYXRhLCBzcGVjaWZ5aW5nIHRoZSB2YWx1ZSBzZXQgb2YgaW50ZXJlc3QgZm9yIGEgcGFydGljdWxhciBlbGVtZW50IG9mIHRoZSBkYXRhLiBFYWNoIGNvZGUgZmlsdGVyIGRlZmluZXMgYW4gYWRkaXRpb25hbCBjb25zdHJhaW50IG9uIHRoZSBkYXRhLCBpLmUuIGNvZGUgZmlsdGVycyBhcmUgQU5EJ2VkLCBub3QgT1InZWQuXHJcbiAgICovXHJcbiAgcHVibGljIGNvZGVGaWx0ZXI6IGZoaXIuRGF0YVJlcXVpcmVtZW50Q29kZUZpbHRlcltdO1xyXG4gIC8qKlxyXG4gICAqIERhdGUgZmlsdGVycyBzcGVjaWZ5IGFkZGl0aW9uYWwgY29uc3RyYWludHMgb24gdGhlIGRhdGEgaW4gdGVybXMgb2YgdGhlIGFwcGxpY2FibGUgZGF0ZSByYW5nZSBmb3Igc3BlY2lmaWMgZWxlbWVudHMuIEVhY2ggZGF0ZSBmaWx0ZXIgc3BlY2lmaWVzIGFuIGFkZGl0aW9uYWwgY29uc3RyYWludCBvbiB0aGUgZGF0YSwgaS5lLiBkYXRlIGZpbHRlcnMgYXJlIEFORCdlZCwgbm90IE9SJ2VkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBkYXRlRmlsdGVyOiBmaGlyLkRhdGFSZXF1aXJlbWVudERhdGVGaWx0ZXJbXTtcclxuICAvKipcclxuICAgKiBUaGlzIGVsZW1lbnQgY2FuIGJlIHVzZWQgaW4gY29tYmluYXRpb24gd2l0aCB0aGUgc29ydCBlbGVtZW50IHRvIHNwZWNpZnkgcXVvdGEgcmVxdWlyZW1lbnRzIHN1Y2ggYXMgXCJ0aGUgbW9zdCByZWNlbnQgNVwiIG9yIFwidGhlIGhpZ2hlc3QgNVwiLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBsaW1pdD86IGZoaXIuRmhpclBvc2l0aXZlSW50fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGlzIGVsZW1lbnQgY2FuIGJlIHVzZWQgaW4gY29tYmluYXRpb24gd2l0aCB0aGUgc29ydCBlbGVtZW50IHRvIHNwZWNpZnkgcXVvdGEgcmVxdWlyZW1lbnRzIHN1Y2ggYXMgXCJ0aGUgbW9zdCByZWNlbnQgNVwiIG9yIFwidGhlIGhpZ2hlc3QgNVwiLiBXaGVuIG11bHRpcGxlIHNvcnRzIGFyZSBzcGVjaWZpZWQsIHRoZXkgYXJlIGFwcGxpZWQgaW4gdGhlIG9yZGVyIHRoZXkgYXBwZWFyIGluIHRoZSByZXNvdXJjZS5cclxuICAgKi9cclxuICBwdWJsaWMgc29ydDogZmhpci5EYXRhUmVxdWlyZW1lbnRTb3J0W107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgRGF0YVJlcXVpcmVtZW50IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8RGF0YVJlcXVpcmVtZW50QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3R5cGUnXSkgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5GaGlyQ29kZSh7dmFsdWU6IHNvdXJjZS50eXBlfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfdHlwZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnR5cGUpIHsgdGhpcy50eXBlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3R5cGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy50eXBlID0gbmV3IGZoaXIuRmhpckNvZGUoc291cmNlLl90eXBlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZUFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsncHJvZmlsZSddKSB7IHRoaXMucHJvZmlsZSA9IHNvdXJjZS5wcm9maWxlLm1hcCgoeCkgPT4gbmV3IGZoaXIuRmhpckNhbm9uaWNhbCh7dmFsdWU6IHh9KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnByb2ZpbGUgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3Byb2ZpbGUnXSkge1xyXG4gICAgICBzb3VyY2UuX3Byb2ZpbGUuZm9yRWFjaCgoeCxpKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvZmlsZS5sZW5ndGggPj0gaSkgeyBpZiAoeCkgeyB0aGlzLnByb2ZpbGVbaV0uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHgpOyB9IH1cclxuICAgICAgICBlbHNlIHsgaWYgKHgpIHsgdGhpcy5wcm9maWxlLnB1c2gobmV3IGZoaXIuRmhpckNhbm9uaWNhbCh4IGFzIFBhcnRpYWw8Zmhpci5GaGlyQ2Fub25pY2FsQXJncz4pKTsgfSB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3ViamVjdCddKSB7IHRoaXMuc3ViamVjdCA9IHNvdXJjZS5zdWJqZWN0OyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ3N1YmplY3RDb2RlYWJsZUNvbmNlcHQnXSkgeyB0aGlzLnN1YmplY3QgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLnN1YmplY3RDb2RlYWJsZUNvbmNlcHQpOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ3N1YmplY3RSZWZlcmVuY2UnXSkgeyB0aGlzLnN1YmplY3QgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnN1YmplY3RSZWZlcmVuY2UpOyB9XHJcbiAgICBpZiAoc291cmNlWydtdXN0U3VwcG9ydCddKSB7IHRoaXMubXVzdFN1cHBvcnQgPSBzb3VyY2UubXVzdFN1cHBvcnQubWFwKCh4KSA9PiBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogeH0pKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMubXVzdFN1cHBvcnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX211c3RTdXBwb3J0J10pIHtcclxuICAgICAgc291cmNlLl9tdXN0U3VwcG9ydC5mb3JFYWNoKCh4LGkpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5tdXN0U3VwcG9ydC5sZW5ndGggPj0gaSkgeyBpZiAoeCkgeyB0aGlzLm11c3RTdXBwb3J0W2ldLmFkZEV4dGVuZGVkUHJvcGVydGllcyh4KTsgfSB9XHJcbiAgICAgICAgZWxzZSB7IGlmICh4KSB7IHRoaXMubXVzdFN1cHBvcnQucHVzaChuZXcgZmhpci5GaGlyU3RyaW5nKHggYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPikpOyB9IH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydjb2RlRmlsdGVyJ10pIHsgdGhpcy5jb2RlRmlsdGVyID0gc291cmNlLmNvZGVGaWx0ZXIubWFwKCh4KSA9PiBuZXcgZmhpci5EYXRhUmVxdWlyZW1lbnRDb2RlRmlsdGVyKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuY29kZUZpbHRlciA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydkYXRlRmlsdGVyJ10pIHsgdGhpcy5kYXRlRmlsdGVyID0gc291cmNlLmRhdGVGaWx0ZXIubWFwKCh4KSA9PiBuZXcgZmhpci5EYXRhUmVxdWlyZW1lbnREYXRlRmlsdGVyKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZGF0ZUZpbHRlciA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydsaW1pdCddKSB7IHRoaXMubGltaXQgPSBuZXcgZmhpci5GaGlyUG9zaXRpdmVJbnQoe3ZhbHVlOiBzb3VyY2UubGltaXR9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2xpbWl0J10pIHtcclxuICAgICAgaWYgKHRoaXMubGltaXQpIHsgdGhpcy5saW1pdC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9saW1pdCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmxpbWl0ID0gbmV3IGZoaXIuRmhpclBvc2l0aXZlSW50KHNvdXJjZS5fbGltaXQgYXMgUGFydGlhbDxmaGlyLkZoaXJQb3NpdGl2ZUludEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnc29ydCddKSB7IHRoaXMuc29ydCA9IHNvdXJjZS5zb3J0Lm1hcCgoeCkgPT4gbmV3IGZoaXIuRGF0YVJlcXVpcmVtZW50U29ydCh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnNvcnQgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbjpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwcmVzc2lvbik7XHJcbiAgICBpZiAoZXhwcmVzc2lvbiA9PT0gJycpIHsgZXhwcmVzc2lvbiA9ICdEYXRhUmVxdWlyZW1lbnQnIH1cclxuICAgIHRoaXMudlJlcVNWKCd0eXBlJyxleHByZXNzaW9uLCdBbGxUeXBlcycsQWxsVHlwZXNWc1ZhbGlkYXRpb24sJ3InKVxyXG4gICAgdGhpcy52T3B0QSgncHJvZmlsZScsZXhwcmVzc2lvbilcclxuICAgIHRoaXMudk9wdFMoJ3N1YmplY3QnLGV4cHJlc3Npb24pXHJcbiAgICB0aGlzLnZPcHRBKCdtdXN0U3VwcG9ydCcsZXhwcmVzc2lvbilcclxuICAgIHRoaXMudk9wdEEoJ2NvZGVGaWx0ZXInLGV4cHJlc3Npb24pXHJcbiAgICB0aGlzLnZPcHRBKCdkYXRlRmlsdGVyJyxleHByZXNzaW9uKVxyXG4gICAgdGhpcy52T3B0UygnbGltaXQnLGV4cHJlc3Npb24pXHJcbiAgICB0aGlzLnZPcHRBKCdzb3J0JyxleHByZXNzaW9uKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuIl19