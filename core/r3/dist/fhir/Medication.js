// <auto-generated/>
// Contents of: hl7.fhir.r3.core version: 3.0.2
// Minimum TypeScript Version: 3.7
// FHIR Resource: Medication
import * as fhir from '../fhir.js';
// @ts-ignore
import { MedicationStatusVsValidation } from '../fhirValueSets/MedicationStatusVsValidation.js';
/**
 * The ingredients need not be a complete list.  If an ingredient is not specified, this does not indicate whether an ingredient is present or absent.  If an ingredient is specified it does not mean that all ingredients are specified.  It is possible to specify both inactive and active ingredients.
 */
export class MedicationIngredient extends fhir.BackboneElement {
    /**
     * Default constructor for MedicationIngredient - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['item']) {
            this.item = source.item;
        }
        else if (source['itemCodeableConcept']) {
            this.item = new fhir.CodeableConcept(source.itemCodeableConcept, options);
        }
        else if (source['itemReference']) {
            this.item = new fhir.Reference(source.itemReference, options);
        }
        else {
            this.item = null;
        }
        if (source['isActive'] !== undefined) {
            this.isActive = new fhir.FhirBoolean({ value: source.isActive }, options);
        }
        if (source['_isActive']) {
            if (this.isActive) {
                this.isActive.addExtendedProperties(source._isActive);
            }
            else {
                this.isActive = new fhir.FhirBoolean(source._isActive, options);
            }
        }
        if (source['amount']) {
            this.amount = new fhir.Ratio(source.amount, options);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Medication.ingredient';
        }
        iss.push(...this.vRS('item', exp));
        iss.push(...this.vOS('isActive', exp));
        iss.push(...this.vOS('amount', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
MedicationIngredient._fts_dataType = 'MedicationIngredient';
/**
 * Internal flag to properly serialize choice-type element Medication.ingredient.item[x]
 */
MedicationIngredient._fts_itemIsChoice = true;
/**
 * A set of components that go to make up the described item.
 */
export class MedicationPackageContent extends fhir.BackboneElement {
    /**
     * Default constructor for MedicationPackageContent - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['item']) {
            this.item = source.item;
        }
        else if (source['itemCodeableConcept']) {
            this.item = new fhir.CodeableConcept(source.itemCodeableConcept, options);
        }
        else if (source['itemReference']) {
            this.item = new fhir.Reference(source.itemReference, options);
        }
        else {
            this.item = null;
        }
        if (source['amount']) {
            this.amount = new fhir.Quantity(source.amount, options);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Medication.package.content';
        }
        iss.push(...this.vRS('item', exp));
        iss.push(...this.vOS('amount', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
MedicationPackageContent._fts_dataType = 'MedicationPackageContent';
/**
 * Internal flag to properly serialize choice-type element Medication.package.content.item[x]
 */
MedicationPackageContent._fts_itemIsChoice = true;
/**
 * Information about a group of medication produced or packaged from one production run.
 */
export class MedicationPackageBatch extends fhir.BackboneElement {
    /**
     * Default constructor for MedicationPackageBatch - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['lotNumber'] !== undefined) {
            this.lotNumber = new fhir.FhirString({ value: source.lotNumber }, options);
        }
        if (source['_lotNumber']) {
            if (this.lotNumber) {
                this.lotNumber.addExtendedProperties(source._lotNumber);
            }
            else {
                this.lotNumber = new fhir.FhirString(source._lotNumber, options);
            }
        }
        if (source['expirationDate'] !== undefined) {
            this.expirationDate = new fhir.FhirDateTime({ value: source.expirationDate }, options);
        }
        if (source['_expirationDate']) {
            if (this.expirationDate) {
                this.expirationDate.addExtendedProperties(source._expirationDate);
            }
            else {
                this.expirationDate = new fhir.FhirDateTime(source._expirationDate, options);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Medication.package.batch';
        }
        iss.push(...this.vOS('lotNumber', exp));
        iss.push(...this.vOS('expirationDate', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
MedicationPackageBatch._fts_dataType = 'MedicationPackageBatch';
/**
 * Information that only applies to packages (not products).
 */
export class MedicationPackage extends fhir.BackboneElement {
    /**
     * Default constructor for MedicationPackage - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['container']) {
            this.container = new fhir.CodeableConcept(source.container, options);
        }
        if (source['content']) {
            this.content = source.content.map((x) => new fhir.MedicationPackageContent(x, options));
        }
        else {
            this.content = [];
        }
        if (source['batch']) {
            this.batch = source.batch.map((x) => new fhir.MedicationPackageBatch(x, options));
        }
        else {
            this.batch = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Medication.package';
        }
        iss.push(...this.vOS('container', exp));
        iss.push(...this.vOA('content', exp));
        iss.push(...this.vOA('batch', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
MedicationPackage._fts_dataType = 'MedicationPackage';
/**
 * This resource is primarily used for the identification and definition of a medication. It covers the ingredients and the packaging for a medication.
 */
export class Medication extends fhir.DomainResource {
    /**
     * Default constructor for Medication - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'Medication';
        if (source['code']) {
            this.code = new fhir.CodeableConcept(source.code, options);
        }
        if (source['status'] !== undefined) {
            this.status = new fhir.FhirCode({ value: source.status }, options);
        }
        if (source['_status']) {
            if (this.status) {
                this.status.addExtendedProperties(source._status);
            }
            else {
                this.status = new fhir.FhirCode(source._status, options);
            }
        }
        if (source['isBrand'] !== undefined) {
            this.isBrand = new fhir.FhirBoolean({ value: source.isBrand }, options);
        }
        if (source['_isBrand']) {
            if (this.isBrand) {
                this.isBrand.addExtendedProperties(source._isBrand);
            }
            else {
                this.isBrand = new fhir.FhirBoolean(source._isBrand, options);
            }
        }
        if (source['isOverTheCounter'] !== undefined) {
            this.isOverTheCounter = new fhir.FhirBoolean({ value: source.isOverTheCounter }, options);
        }
        if (source['_isOverTheCounter']) {
            if (this.isOverTheCounter) {
                this.isOverTheCounter.addExtendedProperties(source._isOverTheCounter);
            }
            else {
                this.isOverTheCounter = new fhir.FhirBoolean(source._isOverTheCounter, options);
            }
        }
        if (source['manufacturer']) {
            this.manufacturer = new fhir.Reference(source.manufacturer, options);
        }
        if (source['form']) {
            this.form = new fhir.CodeableConcept(source.form, options);
        }
        if (source['ingredient']) {
            this.ingredient = source.ingredient.map((x) => new fhir.MedicationIngredient(x, options));
        }
        else {
            this.ingredient = [];
        }
        if (source['package']) {
            this.package = new fhir.MedicationPackage(source.package, options);
        }
        if (source['image']) {
            this.image = source.image.map((x) => new fhir.Attachment(x, options));
        }
        else {
            this.image = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'Medication';
        }
        iss.push(...this.vOS('code', exp));
        iss.push(...this.vOSV('status', exp, 'MedicationStatus', MedicationStatusVsValidation, 'r'));
        iss.push(...this.vOS('isBrand', exp));
        iss.push(...this.vOS('isOverTheCounter', exp));
        iss.push(...this.vOS('manufacturer', exp));
        iss.push(...this.vOS('form', exp));
        iss.push(...this.vOA('ingredient', exp));
        iss.push(...this.vOS('package', exp));
        iss.push(...this.vOA('image', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
Medication._fts_dataType = 'Medication';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVkaWNhdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvTWVkaWNhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQyw0QkFBNEI7QUFFNUIsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFZbkMsYUFBYTtBQUNiLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLGtEQUFrRCxDQUFDO0FBbUNoRzs7R0FFRztBQUNILE1BQU0sT0FBTyxvQkFBcUIsU0FBUSxJQUFJLENBQUMsZUFBZTtJQXFCNUQ7O09BRUc7SUFDSCxZQUFZLFNBQTJDLEVBQUUsRUFBRSxVQUFzQyxFQUFFO1FBQ2pHLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7U0FBRTthQUMzQyxJQUFJLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLG1CQUFtQixFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQUU7YUFDakgsSUFBSSxNQUFNLENBQUMsZUFBZSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsYUFBYSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQUU7YUFDL0Y7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzFCLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLFNBQVMsRUFBRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUMsS0FBSyxFQUFF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LElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFDLEdBQUcsRUFBQyxrQkFBa0IsRUFBQyw0QkFBNEIsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3pGLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3JDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGtCQUFrQixFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDOUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDMUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbEMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDeEMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDckMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbkMsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDOztBQTFGRDs7R0FFRztBQUM2Qix3QkFBYSxHQUFVLFlBQVksQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yMy5jb3JlIHZlcnNpb246IDMuMC4yXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogTWVkaWNhdGlvblxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWVkaWNhdGlvblBhY2thZ2VGb3JtQ29kZXMsICBNZWRpY2F0aW9uUGFja2FnZUZvcm1Db2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWVkaWNhdGlvblBhY2thZ2VGb3JtQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1lZGljYXRpb25QYWNrYWdlRm9ybVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWVkaWNhdGlvblBhY2thZ2VGb3JtVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZWRpY2F0aW9uQ29kZXMsICBNZWRpY2F0aW9uQ29kZVR5cGUgfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01lZGljYXRpb25Db2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWVkaWNhdGlvblZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWVkaWNhdGlvblZzVmFsaWRhdGlvbi5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWVkaWNhdGlvblN0YXR1c0NvZGVzLCAgTWVkaWNhdGlvblN0YXR1c0NvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZWRpY2F0aW9uU3RhdHVzQ29kZXMuanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1lZGljYXRpb25TdGF0dXNWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01lZGljYXRpb25TdGF0dXNWc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1lZGljYXRpb25Gb3JtQ29kZXMsICBNZWRpY2F0aW9uRm9ybUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZWRpY2F0aW9uRm9ybUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZWRpY2F0aW9uRm9ybVZzVmFsaWRhdGlvbiB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWVkaWNhdGlvbkZvcm1Wc1ZhbGlkYXRpb24uanMnO1xyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgTWVkaWNhdGlvbkluZ3JlZGllbnQgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWVkaWNhdGlvbkluZ3JlZGllbnRBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgYWN0dWFsIGluZ3JlZGllbnQgLSBlaXRoZXIgYSBzdWJzdGFuY2UgKHNpbXBsZSBpbmdyZWRpZW50KSBvciBhbm90aGVyIG1lZGljYXRpb24uXHJcbiAgICovXHJcbiAgaXRlbT86IGZoaXIuQ29kZWFibGVDb25jZXB0fGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgYWN0dWFsIGluZ3JlZGllbnQgLSBlaXRoZXIgYSBzdWJzdGFuY2UgKHNpbXBsZSBpbmdyZWRpZW50KSBvciBhbm90aGVyIG1lZGljYXRpb24uXHJcbiAgICovXHJcbiAgaXRlbUNvZGVhYmxlQ29uY2VwdD86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGFjdHVhbCBpbmdyZWRpZW50IC0gZWl0aGVyIGEgc3Vic3RhbmNlIChzaW1wbGUgaW5ncmVkaWVudCkgb3IgYW5vdGhlciBtZWRpY2F0aW9uLlxyXG4gICAqL1xyXG4gIGl0ZW1SZWZlcmVuY2U/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRpb24gb2Ygd2hldGhlciB0aGlzwqBpbmdyZWRpZW50IGFmZmVjdHPCoHRoZSB0aGVyYXBldXRpYyBhY3Rpb24gb2YgdGhlIGRydWcuXHJcbiAgICovXHJcbiAgaXNBY3RpdmU/OiBmaGlyLkZoaXJCb29sZWFufGJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBNZWRpY2F0aW9uLmluZ3JlZGllbnQuaXNBY3RpdmVcclxuICAgKi9cclxuICBfaXNBY3RpdmU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFNwZWNpZmllcyBob3cgbWFueSAob3IgaG93IG11Y2gpIG9mIHRoZSBpdGVtcyB0aGVyZSBhcmUgaW4gdGhpcyBNZWRpY2F0aW9uLiAgRm9yIGV4YW1wbGUsIDI1MCBtZyBwZXIgdGFibGV0LiAgVGhpcyBpcyBleHByZXNzZWQgYXMgYSByYXRpbyB3aGVyZSB0aGUgbnVtZXJhdG9yIGlzIDI1MG1nIGFuZCB0aGUgZGVub21pbmF0b3IgaXMgMSB0YWJsZXQuXHJcbiAgICovXHJcbiAgYW1vdW50PzogZmhpci5SYXRpb0FyZ3N8dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogVGhlIGluZ3JlZGllbnRzIG5lZWQgbm90IGJlIGEgY29tcGxldGUgbGlzdC4gIElmIGFuIGluZ3JlZGllbnQgaXMgbm90IHNwZWNpZmllZCwgdGhpcyBkb2VzIG5vdCBpbmRpY2F0ZSB3aGV0aGVyIGFuIGluZ3JlZGllbnQgaXMgcHJlc2VudCBvciBhYnNlbnQuICBJZiBhbiBpbmdyZWRpZW50IGlzIHNwZWNpZmllZCBpdCBkb2VzIG5vdCBtZWFuIHRoYXQgYWxsIGluZ3JlZGllbnRzIGFyZSBzcGVjaWZpZWQuICBJdCBpcyBwb3NzaWJsZSB0byBzcGVjaWZ5IGJvdGggaW5hY3RpdmUgYW5kIGFjdGl2ZSBpbmdyZWRpZW50cy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBNZWRpY2F0aW9uSW5ncmVkaWVudCBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ01lZGljYXRpb25JbmdyZWRpZW50JztcclxuICAvKipcclxuICAgKiBUaGUgYWN0dWFsIGluZ3JlZGllbnQgLSBlaXRoZXIgYSBzdWJzdGFuY2UgKHNpbXBsZSBpbmdyZWRpZW50KSBvciBhbm90aGVyIG1lZGljYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIGl0ZW06IChmaGlyLkNvZGVhYmxlQ29uY2VwdHxmaGlyLlJlZmVyZW5jZSl8bnVsbDtcclxuICAvKipcclxuICAgKiBJbnRlcm5hbCBmbGFnIHRvIHByb3Blcmx5IHNlcmlhbGl6ZSBjaG9pY2UtdHlwZSBlbGVtZW50IE1lZGljYXRpb24uaW5ncmVkaWVudC5pdGVtW3hdXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIHN0YXRpYyByZWFkb25seSBfZnRzX2l0ZW1Jc0Nob2ljZTp0cnVlID0gdHJ1ZTtcclxuICAvKipcclxuICAgKiBJbmRpY2F0aW9uIG9mIHdoZXRoZXIgdGhpc8KgaW5ncmVkaWVudCBhZmZlY3RzwqB0aGUgdGhlcmFwZXV0aWMgYWN0aW9uIG9mIHRoZSBkcnVnLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpc0FjdGl2ZT86IGZoaXIuRmhpckJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFNwZWNpZmllcyBob3cgbWFueSAob3IgaG93IG11Y2gpIG9mIHRoZSBpdGVtcyB0aGVyZSBhcmUgaW4gdGhpcyBNZWRpY2F0aW9uLiAgRm9yIGV4YW1wbGUsIDI1MCBtZyBwZXIgdGFibGV0LiAgVGhpcyBpcyBleHByZXNzZWQgYXMgYSByYXRpbyB3aGVyZSB0aGUgbnVtZXJhdG9yIGlzIDI1MG1nIGFuZCB0aGUgZGVub21pbmF0b3IgaXMgMSB0YWJsZXQuXHJcbiAgICovXHJcbiAgcHVibGljIGFtb3VudD86IGZoaXIuUmF0aW98dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIE1lZGljYXRpb25JbmdyZWRpZW50IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8TWVkaWNhdGlvbkluZ3JlZGllbnRBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsnaXRlbSddKSB7IHRoaXMuaXRlbSA9IHNvdXJjZS5pdGVtOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ2l0ZW1Db2RlYWJsZUNvbmNlcHQnXSkgeyB0aGlzLml0ZW0gPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLml0ZW1Db2RlYWJsZUNvbmNlcHQsIG9wdGlvbnMpOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ2l0ZW1SZWZlcmVuY2UnXSkgeyB0aGlzLml0ZW0gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLml0ZW1SZWZlcmVuY2UsIG9wdGlvbnMpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5pdGVtID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaXNBY3RpdmUnXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMuaXNBY3RpdmUgPSBuZXcgZmhpci5GaGlyQm9vbGVhbih7dmFsdWU6IHNvdXJjZS5pc0FjdGl2ZX0sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfaXNBY3RpdmUnXSkge1xyXG4gICAgICBpZiAodGhpcy5pc0FjdGl2ZSkgeyB0aGlzLmlzQWN0aXZlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2lzQWN0aXZlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuaXNBY3RpdmUgPSBuZXcgZmhpci5GaGlyQm9vbGVhbihzb3VyY2UuX2lzQWN0aXZlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQm9vbGVhbkFyZ3M+LCBvcHRpb25zKTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnYW1vdW50J10pIHsgdGhpcy5hbW91bnQgPSBuZXcgZmhpci5SYXRpbyhzb3VyY2UuYW1vdW50LCBvcHRpb25zKTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ01lZGljYXRpb24uaW5ncmVkaWVudCcgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ2l0ZW0nLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2lzQWN0aXZlJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdhbW91bnQnLGV4cCkpO1xyXG4gICAgcmV0dXJuIGlzcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIE1lZGljYXRpb25QYWNrYWdlQ29udGVudCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBNZWRpY2F0aW9uUGFja2FnZUNvbnRlbnRBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBJZGVudGlmaWVzIG9uZSBvZiB0aGUgaXRlbXMgaW4gdGhlIHBhY2thZ2UuXHJcbiAgICovXHJcbiAgaXRlbT86IGZoaXIuQ29kZWFibGVDb25jZXB0fGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJZGVudGlmaWVzIG9uZSBvZiB0aGUgaXRlbXMgaW4gdGhlIHBhY2thZ2UuXHJcbiAgICovXHJcbiAgaXRlbUNvZGVhYmxlQ29uY2VwdD86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWRlbnRpZmllcyBvbmUgb2YgdGhlIGl0ZW1zIGluIHRoZSBwYWNrYWdlLlxyXG4gICAqL1xyXG4gIGl0ZW1SZWZlcmVuY2U/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhbW91bnQgb2YgdGhlIHByb2R1Y3QgdGhhdCBpcyBpbiB0aGUgcGFja2FnZS5cclxuICAgKi9cclxuICBhbW91bnQ/OiBmaGlyLlF1YW50aXR5QXJnc3x1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIHNldCBvZiBjb21wb25lbnRzIHRoYXQgZ28gdG8gbWFrZSB1cCB0aGUgZGVzY3JpYmVkIGl0ZW0uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTWVkaWNhdGlvblBhY2thZ2VDb250ZW50IGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnTWVkaWNhdGlvblBhY2thZ2VDb250ZW50JztcclxuICAvKipcclxuICAgKiBJZGVudGlmaWVzIG9uZSBvZiB0aGUgaXRlbXMgaW4gdGhlIHBhY2thZ2UuXHJcbiAgICovXHJcbiAgcHVibGljIGl0ZW06IChmaGlyLkNvZGVhYmxlQ29uY2VwdHxmaGlyLlJlZmVyZW5jZSl8bnVsbDtcclxuICAvKipcclxuICAgKiBJbnRlcm5hbCBmbGFnIHRvIHByb3Blcmx5IHNlcmlhbGl6ZSBjaG9pY2UtdHlwZSBlbGVtZW50IE1lZGljYXRpb24ucGFja2FnZS5jb250ZW50Lml0ZW1beF1cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgc3RhdGljIHJlYWRvbmx5IF9mdHNfaXRlbUlzQ2hvaWNlOnRydWUgPSB0cnVlO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhbW91bnQgb2YgdGhlIHByb2R1Y3QgdGhhdCBpcyBpbiB0aGUgcGFja2FnZS5cclxuICAgKi9cclxuICBwdWJsaWMgYW1vdW50PzogZmhpci5RdWFudGl0eXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgTWVkaWNhdGlvblBhY2thZ2VDb250ZW50IC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8TWVkaWNhdGlvblBhY2thZ2VDb250ZW50QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ2l0ZW0nXSkgeyB0aGlzLml0ZW0gPSBzb3VyY2UuaXRlbTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWydpdGVtQ29kZWFibGVDb25jZXB0J10pIHsgdGhpcy5pdGVtID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5pdGVtQ29kZWFibGVDb25jZXB0LCBvcHRpb25zKTsgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlWydpdGVtUmVmZXJlbmNlJ10pIHsgdGhpcy5pdGVtID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5pdGVtUmVmZXJlbmNlLCBvcHRpb25zKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaXRlbSA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ2Ftb3VudCddKSB7IHRoaXMuYW1vdW50ID0gbmV3IGZoaXIuUXVhbnRpdHkoc291cmNlLmFtb3VudCwgb3B0aW9ucyk7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdNZWRpY2F0aW9uLnBhY2thZ2UuY29udGVudCcgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ2l0ZW0nLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2Ftb3VudCcsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgTWVkaWNhdGlvblBhY2thZ2VCYXRjaCB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBNZWRpY2F0aW9uUGFja2FnZUJhdGNoQXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogVGhlIGFzc2lnbmVkIGxvdCBudW1iZXIgb2YgYSBiYXRjaCBvZiB0aGUgc3BlY2lmaWVkIHByb2R1Y3QuXHJcbiAgICovXHJcbiAgbG90TnVtYmVyPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IE1lZGljYXRpb24ucGFja2FnZS5iYXRjaC5sb3ROdW1iZXJcclxuICAgKi9cclxuICBfbG90TnVtYmVyPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBXaGVuIHRoaXMgc3BlY2lmaWMgYmF0Y2ggb2YgcHJvZHVjdCB3aWxsIGV4cGlyZS5cclxuICAgKi9cclxuICBleHBpcmF0aW9uRGF0ZT86IGZoaXIuRmhpckRhdGVUaW1lfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IE1lZGljYXRpb24ucGFja2FnZS5iYXRjaC5leHBpcmF0aW9uRGF0ZVxyXG4gICAqL1xyXG4gIF9leHBpcmF0aW9uRGF0ZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbmZvcm1hdGlvbiBhYm91dCBhIGdyb3VwIG9mIG1lZGljYXRpb24gcHJvZHVjZWQgb3IgcGFja2FnZWQgZnJvbSBvbmUgcHJvZHVjdGlvbiBydW4uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTWVkaWNhdGlvblBhY2thZ2VCYXRjaCBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ01lZGljYXRpb25QYWNrYWdlQmF0Y2gnO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBhc3NpZ25lZCBsb3QgbnVtYmVyIG9mIGEgYmF0Y2ggb2YgdGhlIHNwZWNpZmllZCBwcm9kdWN0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb3ROdW1iZXI/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFdoZW4gdGhpcyBzcGVjaWZpYyBiYXRjaCBvZiBwcm9kdWN0IHdpbGwgZXhwaXJlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBleHBpcmF0aW9uRGF0ZT86IGZoaXIuRmhpckRhdGVUaW1lfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBNZWRpY2F0aW9uUGFja2FnZUJhdGNoIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8TWVkaWNhdGlvblBhY2thZ2VCYXRjaEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWydsb3ROdW1iZXInXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMubG90TnVtYmVyID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS5sb3ROdW1iZXJ9LCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2xvdE51bWJlciddKSB7XHJcbiAgICAgIGlmICh0aGlzLmxvdE51bWJlcikgeyB0aGlzLmxvdE51bWJlci5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9sb3ROdW1iZXIhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5sb3ROdW1iZXIgPSBuZXcgZmhpci5GaGlyU3RyaW5nKHNvdXJjZS5fbG90TnVtYmVyIGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4sIG9wdGlvbnMpOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydleHBpcmF0aW9uRGF0ZSddICE9PSB1bmRlZmluZWQpIHsgdGhpcy5leHBpcmF0aW9uRGF0ZSA9IG5ldyBmaGlyLkZoaXJEYXRlVGltZSh7dmFsdWU6IHNvdXJjZS5leHBpcmF0aW9uRGF0ZX0sIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydfZXhwaXJhdGlvbkRhdGUnXSkge1xyXG4gICAgICBpZiAodGhpcy5leHBpcmF0aW9uRGF0ZSkgeyB0aGlzLmV4cGlyYXRpb25EYXRlLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2V4cGlyYXRpb25EYXRlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuZXhwaXJhdGlvbkRhdGUgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoc291cmNlLl9leHBpcmF0aW9uRGF0ZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckRhdGVUaW1lQXJncz4sIG9wdGlvbnMpOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnTWVkaWNhdGlvbi5wYWNrYWdlLmJhdGNoJyB9XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnbG90TnVtYmVyJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdleHBpcmF0aW9uRGF0ZScsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgTWVkaWNhdGlvblBhY2thZ2UgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWVkaWNhdGlvblBhY2thZ2VBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUga2luZCBvZiBjb250YWluZXIgdGhhdCB0aGlzIHBhY2thZ2UgY29tZXMgYXMuXHJcbiAgICovXHJcbiAgY29udGFpbmVyPzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIHNldCBvZiBjb21wb25lbnRzIHRoYXQgZ28gdG8gbWFrZSB1cCB0aGUgZGVzY3JpYmVkIGl0ZW0uXHJcbiAgICovXHJcbiAgY29udGVudD86IGZoaXIuTWVkaWNhdGlvblBhY2thZ2VDb250ZW50QXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJbmZvcm1hdGlvbiBhYm91dCBhIGdyb3VwIG9mIG1lZGljYXRpb24gcHJvZHVjZWQgb3IgcGFja2FnZWQgZnJvbSBvbmUgcHJvZHVjdGlvbiBydW4uXHJcbiAgICovXHJcbiAgYmF0Y2g/OiBmaGlyLk1lZGljYXRpb25QYWNrYWdlQmF0Y2hBcmdzW118dW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogSW5mb3JtYXRpb24gdGhhdCBvbmx5IGFwcGxpZXMgdG8gcGFja2FnZXMgKG5vdCBwcm9kdWN0cykuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTWVkaWNhdGlvblBhY2thZ2UgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdNZWRpY2F0aW9uUGFja2FnZSc7XHJcbiAgLyoqXHJcbiAgICogVGhlIGtpbmQgb2YgY29udGFpbmVyIHRoYXQgdGhpcyBwYWNrYWdlIGNvbWVzIGFzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb250YWluZXI/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQSBzZXQgb2YgY29tcG9uZW50cyB0aGF0IGdvIHRvIG1ha2UgdXAgdGhlIGRlc2NyaWJlZCBpdGVtLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb250ZW50OiBmaGlyLk1lZGljYXRpb25QYWNrYWdlQ29udGVudFtdO1xyXG4gIC8qKlxyXG4gICAqIEluZm9ybWF0aW9uIGFib3V0IGEgZ3JvdXAgb2YgbWVkaWNhdGlvbiBwcm9kdWNlZCBvciBwYWNrYWdlZCBmcm9tIG9uZSBwcm9kdWN0aW9uIHJ1bi5cclxuICAgKi9cclxuICBwdWJsaWMgYmF0Y2g6IGZoaXIuTWVkaWNhdGlvblBhY2thZ2VCYXRjaFtdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIE1lZGljYXRpb25QYWNrYWdlIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8TWVkaWNhdGlvblBhY2thZ2VBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsnY29udGFpbmVyJ10pIHsgdGhpcy5jb250YWluZXIgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLmNvbnRhaW5lciwgb3B0aW9ucyk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2NvbnRlbnQnXSkgeyB0aGlzLmNvbnRlbnQgPSBzb3VyY2UuY29udGVudC5tYXAoKHgpID0+IG5ldyBmaGlyLk1lZGljYXRpb25QYWNrYWdlQ29udGVudCh4LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmNvbnRlbnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnYmF0Y2gnXSkgeyB0aGlzLmJhdGNoID0gc291cmNlLmJhdGNoLm1hcCgoeCkgPT4gbmV3IGZoaXIuTWVkaWNhdGlvblBhY2thZ2VCYXRjaCh4LCBvcHRpb25zKSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmJhdGNoID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdNZWRpY2F0aW9uLnBhY2thZ2UnIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdjb250YWluZXInLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ2NvbnRlbnQnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ2JhdGNoJyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBNZWRpY2F0aW9uIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE1lZGljYXRpb25BcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJNZWRpY2F0aW9uXCJ8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlcGVuZGluZyBvbiB0aGUgY29udGV4dCBvZiB1c2UsIHRoZSBjb2RlIHRoYXQgd2FzIGFjdHVhbGx5IHNlbGVjdGVkIGJ5IHRoZSB1c2VyIChwcmVzY3JpYmVyLCBkaXNwZW5zZXIsIGV0Yy4pIHdpbGwgaGF2ZSB0aGUgY29kaW5nLnVzZXJTZWxlY3RlZCBzZXQgdG8gdHJ1ZS4gIEFzIGRlc2NyaWJlZCBpbiB0aGUgY29kaW5nIGRhdGF0eXBlOiBcIkEgY29kaW5nIG1heSBiZSBtYXJrZWQgYXMgYSBcInVzZXJTZWxlY3RlZFwiIGlmIGEgdXNlciBzZWxlY3RlZCB0aGUgcGFydGljdWxhciBjb2RlZCB2YWx1ZSBpbiBhIHVzZXIgaW50ZXJmYWNlIChlLmcuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBpbiBhIHBpY2stbGlzdCkuIElmIGEgdXNlciBzZWxlY3RlZCBjb2RpbmcgZXhpc3RzLCBpdCBpcyB0aGUgcHJlZmVycmVkIGNob2ljZSBmb3IgcGVyZm9ybWluZyB0cmFuc2xhdGlvbnMgZXRjLlxyXG4gICAqL1xyXG4gIGNvZGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgc3RhdHVzIGlzIG5vdCBpbnRlbmRlZCB0byBzcGVjaWZ5IGlmIGEgbWVkaWNhdGlvbiBpcyBwYXJ0IG9mIGEgZm9ybXVsYXJ5LlxyXG4gICAqL1xyXG4gIHN0YXR1cz86IGZoaXIuRmhpckNvZGU8TWVkaWNhdGlvblN0YXR1c0NvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBNZWRpY2F0aW9uLnN0YXR1c1xyXG4gICAqL1xyXG4gIF9zdGF0dXM/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFNldCB0byB0cnVlIGlmIHRoZSBpdGVtIGlzIGF0dHJpYnV0YWJsZSB0byBhIHNwZWNpZmljIG1hbnVmYWN0dXJlci5cclxuICAgKi9cclxuICBpc0JyYW5kPzogZmhpci5GaGlyQm9vbGVhbnxib29sZWFufHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogTWVkaWNhdGlvbi5pc0JyYW5kXHJcbiAgICovXHJcbiAgX2lzQnJhbmQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFNldCB0byB0cnVlIGlmIHRoZSBtZWRpY2F0aW9uIGNhbiBiZSBvYnRhaW5lZCB3aXRob3V0IGFuIG9yZGVyIGZyb20gYSBwcmVzY3JpYmVyLlxyXG4gICAqL1xyXG4gIGlzT3ZlclRoZUNvdW50ZXI/OiBmaGlyLkZoaXJCb29sZWFufGJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBNZWRpY2F0aW9uLmlzT3ZlclRoZUNvdW50ZXJcclxuICAgKi9cclxuICBfaXNPdmVyVGhlQ291bnRlcj86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBkZXRhaWxzIG9mIHRoZSBtYW51ZmFjdHVyZXIgb2YgdGhlIG1lZGljYXRpb24gcHJvZHVjdC4gIFRoaXMgaXMgbm90IGludGVuZGVkIHRvIHJlcHJlc2VudCB0aGUgZGlzdHJpYnV0b3Igb2YgYSBtZWRpY2F0aW9uIHByb2R1Y3QuXHJcbiAgICovXHJcbiAgbWFudWZhY3R1cmVyPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBXaGVuIE1lZGljYXRpb24gaXMgcmVmZXJlbmNlZCBmcm9tIE1lZGljYXRpb25SZXF1ZXN0LCB0aGlzIGlzIHRoZSBvcmRlcmVkIGZvcm0uICBXaGVuIE1lZGljYXRpb24gaXMgcmVmZXJlbmNlZCB3aXRoaW4gTWVkaWNhdGlvbkRpc3BlbnNlLCB0aGlzIGlzIHRoZSBkaXNwZW5zZWQgZm9ybS4gIFdoZW4gTWVkaWNhdGlvbiBpcyByZWZlcmVuY2VkIHdpdGhpbiBNZWRpY2F0aW9uQWRtaW5pc3RyYXRpb24sIHRoaXMgaXMgYWRtaW5pc3RlcmVkIGZvcm0uXHJcbiAgICovXHJcbiAgZm9ybT86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGluZ3JlZGllbnRzIG5lZWQgbm90IGJlIGEgY29tcGxldGUgbGlzdC4gIElmIGFuIGluZ3JlZGllbnQgaXMgbm90IHNwZWNpZmllZCwgdGhpcyBkb2VzIG5vdCBpbmRpY2F0ZSB3aGV0aGVyIGFuIGluZ3JlZGllbnQgaXMgcHJlc2VudCBvciBhYnNlbnQuICBJZiBhbiBpbmdyZWRpZW50IGlzIHNwZWNpZmllZCBpdCBkb2VzIG5vdCBtZWFuIHRoYXQgYWxsIGluZ3JlZGllbnRzIGFyZSBzcGVjaWZpZWQuICBJdCBpcyBwb3NzaWJsZSB0byBzcGVjaWZ5IGJvdGggaW5hY3RpdmUgYW5kIGFjdGl2ZSBpbmdyZWRpZW50cy5cclxuICAgKi9cclxuICBpbmdyZWRpZW50PzogZmhpci5NZWRpY2F0aW9uSW5ncmVkaWVudEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW5mb3JtYXRpb24gdGhhdCBvbmx5IGFwcGxpZXMgdG8gcGFja2FnZXMgKG5vdCBwcm9kdWN0cykuXHJcbiAgICovXHJcbiAgcGFja2FnZT86IGZoaXIuTWVkaWNhdGlvblBhY2thZ2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBQaG90byhzKSBvciBncmFwaGljIHJlcHJlc2VudGF0aW9uKHMpIG9mIHRoZSBtZWRpY2F0aW9uLlxyXG4gICAqL1xyXG4gIGltYWdlPzogZmhpci5BdHRhY2htZW50QXJnc1tdfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgcmVzb3VyY2UgaXMgcHJpbWFyaWx5IHVzZWQgZm9yIHRoZSBpZGVudGlmaWNhdGlvbiBhbmQgZGVmaW5pdGlvbiBvZiBhIG1lZGljYXRpb24uIEl0IGNvdmVycyB0aGUgaW5ncmVkaWVudHMgYW5kIHRoZSBwYWNrYWdpbmcgZm9yIGEgbWVkaWNhdGlvbi5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBNZWRpY2F0aW9uIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdNZWRpY2F0aW9uJztcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzb3VyY2VUeXBlOiBcIk1lZGljYXRpb25cIjtcclxuICAvKipcclxuICAgKiBEZXBlbmRpbmcgb24gdGhlIGNvbnRleHQgb2YgdXNlLCB0aGUgY29kZSB0aGF0IHdhcyBhY3R1YWxseSBzZWxlY3RlZCBieSB0aGUgdXNlciAocHJlc2NyaWJlciwgZGlzcGVuc2VyLCBldGMuKSB3aWxsIGhhdmUgdGhlIGNvZGluZy51c2VyU2VsZWN0ZWQgc2V0IHRvIHRydWUuICBBcyBkZXNjcmliZWQgaW4gdGhlIGNvZGluZyBkYXRhdHlwZTogXCJBIGNvZGluZyBtYXkgYmUgbWFya2VkIGFzIGEgXCJ1c2VyU2VsZWN0ZWRcIiBpZiBhIHVzZXIgc2VsZWN0ZWQgdGhlIHBhcnRpY3VsYXIgY29kZWQgdmFsdWUgaW4gYSB1c2VyIGludGVyZmFjZSAoZS5nLiB0aGUgdXNlciBzZWxlY3RzIGFuIGl0ZW0gaW4gYSBwaWNrLWxpc3QpLiBJZiBhIHVzZXIgc2VsZWN0ZWQgY29kaW5nIGV4aXN0cywgaXQgaXMgdGhlIHByZWZlcnJlZCBjaG9pY2UgZm9yIHBlcmZvcm1pbmcgdHJhbnNsYXRpb25zIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgY29kZT86IGZoaXIuQ29kZWFibGVDb25jZXB0fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGlzIHN0YXR1cyBpcyBub3QgaW50ZW5kZWQgdG8gc3BlY2lmeSBpZiBhIG1lZGljYXRpb24gaXMgcGFydCBvZiBhIGZvcm11bGFyeS5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdHVzPzogZmhpci5GaGlyQ29kZTxNZWRpY2F0aW9uU3RhdHVzQ29kZVR5cGU+fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBTZXQgdG8gdHJ1ZSBpZiB0aGUgaXRlbSBpcyBhdHRyaWJ1dGFibGUgdG8gYSBzcGVjaWZpYyBtYW51ZmFjdHVyZXIuXHJcbiAgICovXHJcbiAgcHVibGljIGlzQnJhbmQ/OiBmaGlyLkZoaXJCb29sZWFufHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBTZXQgdG8gdHJ1ZSBpZiB0aGUgbWVkaWNhdGlvbiBjYW4gYmUgb2J0YWluZWQgd2l0aG91dCBhbiBvcmRlciBmcm9tIGEgcHJlc2NyaWJlci5cclxuICAgKi9cclxuICBwdWJsaWMgaXNPdmVyVGhlQ291bnRlcj86IGZoaXIuRmhpckJvb2xlYW58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgZGV0YWlscyBvZiB0aGUgbWFudWZhY3R1cmVyIG9mIHRoZSBtZWRpY2F0aW9uIHByb2R1Y3QuICBUaGlzIGlzIG5vdCBpbnRlbmRlZCB0byByZXByZXNlbnQgdGhlIGRpc3RyaWJ1dG9yIG9mIGEgbWVkaWNhdGlvbiBwcm9kdWN0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBtYW51ZmFjdHVyZXI/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogV2hlbiBNZWRpY2F0aW9uIGlzIHJlZmVyZW5jZWQgZnJvbSBNZWRpY2F0aW9uUmVxdWVzdCwgdGhpcyBpcyB0aGUgb3JkZXJlZCBmb3JtLiAgV2hlbiBNZWRpY2F0aW9uIGlzIHJlZmVyZW5jZWQgd2l0aGluIE1lZGljYXRpb25EaXNwZW5zZSwgdGhpcyBpcyB0aGUgZGlzcGVuc2VkIGZvcm0uICBXaGVuIE1lZGljYXRpb24gaXMgcmVmZXJlbmNlZCB3aXRoaW4gTWVkaWNhdGlvbkFkbWluaXN0cmF0aW9uLCB0aGlzIGlzIGFkbWluaXN0ZXJlZCBmb3JtLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBmb3JtPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBpbmdyZWRpZW50cyBuZWVkIG5vdCBiZSBhIGNvbXBsZXRlIGxpc3QuICBJZiBhbiBpbmdyZWRpZW50IGlzIG5vdCBzcGVjaWZpZWQsIHRoaXMgZG9lcyBub3QgaW5kaWNhdGUgd2hldGhlciBhbiBpbmdyZWRpZW50IGlzIHByZXNlbnQgb3IgYWJzZW50LiAgSWYgYW4gaW5ncmVkaWVudCBpcyBzcGVjaWZpZWQgaXQgZG9lcyBub3QgbWVhbiB0aGF0IGFsbCBpbmdyZWRpZW50cyBhcmUgc3BlY2lmaWVkLiAgSXQgaXMgcG9zc2libGUgdG8gc3BlY2lmeSBib3RoIGluYWN0aXZlIGFuZCBhY3RpdmUgaW5ncmVkaWVudHMuXHJcbiAgICovXHJcbiAgcHVibGljIGluZ3JlZGllbnQ6IGZoaXIuTWVkaWNhdGlvbkluZ3JlZGllbnRbXTtcclxuICAvKipcclxuICAgKiBJbmZvcm1hdGlvbiB0aGF0IG9ubHkgYXBwbGllcyB0byBwYWNrYWdlcyAobm90IHByb2R1Y3RzKS5cclxuICAgKi9cclxuICBwdWJsaWMgcGFja2FnZT86IGZoaXIuTWVkaWNhdGlvblBhY2thZ2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFBob3RvKHMpIG9yIGdyYXBoaWMgcmVwcmVzZW50YXRpb24ocykgb2YgdGhlIG1lZGljYXRpb24uXHJcbiAgICovXHJcbiAgcHVibGljIGltYWdlOiBmaGlyLkF0dGFjaG1lbnRbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBNZWRpY2F0aW9uIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8TWVkaWNhdGlvbkFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdNZWRpY2F0aW9uJztcclxuICAgIGlmIChzb3VyY2VbJ2NvZGUnXSkgeyB0aGlzLmNvZGUgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLmNvZGUsIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydzdGF0dXMnXSAhPT0gdW5kZWZpbmVkKSB7IHRoaXMuc3RhdHVzID0gbmV3IGZoaXIuRmhpckNvZGU8TWVkaWNhdGlvblN0YXR1c0NvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5zdGF0dXN9LCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3N0YXR1cyddKSB7XHJcbiAgICAgIGlmICh0aGlzLnN0YXR1cykgeyB0aGlzLnN0YXR1cy5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9zdGF0dXMhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxNZWRpY2F0aW9uU3RhdHVzQ29kZVR5cGU+KHNvdXJjZS5fc3RhdHVzIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4sIG9wdGlvbnMpOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydpc0JyYW5kJ10gIT09IHVuZGVmaW5lZCkgeyB0aGlzLmlzQnJhbmQgPSBuZXcgZmhpci5GaGlyQm9vbGVhbih7dmFsdWU6IHNvdXJjZS5pc0JyYW5kfSwgb3B0aW9ucyk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19pc0JyYW5kJ10pIHtcclxuICAgICAgaWYgKHRoaXMuaXNCcmFuZCkgeyB0aGlzLmlzQnJhbmQuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5faXNCcmFuZCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmlzQnJhbmQgPSBuZXcgZmhpci5GaGlyQm9vbGVhbihzb3VyY2UuX2lzQnJhbmQgYXMgUGFydGlhbDxmaGlyLkZoaXJCb29sZWFuQXJncz4sIG9wdGlvbnMpOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydpc092ZXJUaGVDb3VudGVyJ10gIT09IHVuZGVmaW5lZCkgeyB0aGlzLmlzT3ZlclRoZUNvdW50ZXIgPSBuZXcgZmhpci5GaGlyQm9vbGVhbih7dmFsdWU6IHNvdXJjZS5pc092ZXJUaGVDb3VudGVyfSwgb3B0aW9ucyk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19pc092ZXJUaGVDb3VudGVyJ10pIHtcclxuICAgICAgaWYgKHRoaXMuaXNPdmVyVGhlQ291bnRlcikgeyB0aGlzLmlzT3ZlclRoZUNvdW50ZXIuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5faXNPdmVyVGhlQ291bnRlciEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmlzT3ZlclRoZUNvdW50ZXIgPSBuZXcgZmhpci5GaGlyQm9vbGVhbihzb3VyY2UuX2lzT3ZlclRoZUNvdW50ZXIgYXMgUGFydGlhbDxmaGlyLkZoaXJCb29sZWFuQXJncz4sIG9wdGlvbnMpOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydtYW51ZmFjdHVyZXInXSkgeyB0aGlzLm1hbnVmYWN0dXJlciA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UubWFudWZhY3R1cmVyLCBvcHRpb25zKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZm9ybSddKSB7IHRoaXMuZm9ybSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UuZm9ybSwgb3B0aW9ucyk7IH1cclxuICAgIGlmIChzb3VyY2VbJ2luZ3JlZGllbnQnXSkgeyB0aGlzLmluZ3JlZGllbnQgPSBzb3VyY2UuaW5ncmVkaWVudC5tYXAoKHgpID0+IG5ldyBmaGlyLk1lZGljYXRpb25JbmdyZWRpZW50KHgsIG9wdGlvbnMpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaW5ncmVkaWVudCA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydwYWNrYWdlJ10pIHsgdGhpcy5wYWNrYWdlID0gbmV3IGZoaXIuTWVkaWNhdGlvblBhY2thZ2Uoc291cmNlLnBhY2thZ2UsIG9wdGlvbnMpOyB9XHJcbiAgICBpZiAoc291cmNlWydpbWFnZSddKSB7IHRoaXMuaW1hZ2UgPSBzb3VyY2UuaW1hZ2UubWFwKCh4KSA9PiBuZXcgZmhpci5BdHRhY2htZW50KHgsIG9wdGlvbnMpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaW1hZ2UgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ01lZGljYXRpb24nIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdjb2RlJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TVignc3RhdHVzJyxleHAsJ01lZGljYXRpb25TdGF0dXMnLE1lZGljYXRpb25TdGF0dXNWc1ZhbGlkYXRpb24sJ3InKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnaXNCcmFuZCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnaXNPdmVyVGhlQ291bnRlcicsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnbWFudWZhY3R1cmVyJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdmb3JtJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdpbmdyZWRpZW50JyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdwYWNrYWdlJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdpbWFnZScsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxufVxyXG4iXX0=