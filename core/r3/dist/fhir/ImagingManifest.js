// <auto-generated/>
// Contents of: hl7.fhir.r3.core version: 3.0.2
// Minimum TypeScript Version: 3.7
// FHIR Resource: ImagingManifest
import * as fhir from '../fhir.js';
/**
 * SOP Instance component identify the instance selected, along with the study and series identities to form the DICOM identity hierarchy.
 */
export class ImagingManifestStudySeriesInstance extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingManifestStudySeriesInstance - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['sopClass']) {
            this.sopClass = new fhir.FhirOid({ value: source.sopClass });
        }
        else {
            this.sopClass = null;
        }
        if (source['_sopClass']) {
            if (this.sopClass) {
                this.sopClass.addExtendedProperties(source._sopClass);
            }
            else {
                this.sopClass = new fhir.FhirOid(source._sopClass);
            }
        }
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingManifest.study.series.instance';
        }
        this.vRS('sopClass', exp);
        this.vRS('uid', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingManifestStudySeriesInstance._fts_dataType = 'ImagingManifestStudySeriesInstance';
/**
 * Series component represents the series level identity and locator information of the DICOM SOP instances in the selection.
 */
export class ImagingManifestStudySeries extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingManifestStudySeries - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
        if (source['endpoint']) {
            this.endpoint = source.endpoint.map((x) => new fhir.Reference(x));
        }
        else {
            this.endpoint = [];
        }
        if (source['instance']) {
            this.instance = source.instance.map((x) => new fhir.ImagingManifestStudySeriesInstance(x));
        }
        else {
            this.instance = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingManifest.study.series';
        }
        this.vRS('uid', exp);
        this.vOA('endpoint', exp);
        this.vRA('instance', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingManifestStudySeries._fts_dataType = 'ImagingManifestStudySeries';
/**
 * Study component represents the study level identity and locator information of the DICOM SOP instances in the selection. It is the top level identity of the hierarchical identification of the instances.
 */
export class ImagingManifestStudy extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingManifestStudy - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
        if (source['imagingStudy']) {
            this.imagingStudy = new fhir.Reference(source.imagingStudy);
        }
        if (source['endpoint']) {
            this.endpoint = source.endpoint.map((x) => new fhir.Reference(x));
        }
        else {
            this.endpoint = [];
        }
        if (source['series']) {
            this.series = source.series.map((x) => new fhir.ImagingManifestStudySeries(x));
        }
        else {
            this.series = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingManifest.study';
        }
        this.vRS('uid', exp);
        this.vOS('imagingStudy', exp);
        this.vOA('endpoint', exp);
        this.vRA('series', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingManifestStudy._fts_dataType = 'ImagingManifestStudy';
/**
 * A text description of the DICOM SOP instances selected in the ImagingManifest; or the reason for, or significance of, the selection.
 */
export class ImagingManifest extends fhir.DomainResource {
    /**
     * Default constructor for ImagingManifest - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'ImagingManifest';
        if (source['identifier']) {
            this.identifier = new fhir.Identifier(source.identifier);
        }
        if (source['patient']) {
            this.patient = new fhir.Reference(source.patient);
        }
        else {
            this.patient = null;
        }
        if (source['authoringTime']) {
            this.authoringTime = new fhir.FhirDateTime({ value: source.authoringTime });
        }
        if (source['_authoringTime']) {
            if (this.authoringTime) {
                this.authoringTime.addExtendedProperties(source._authoringTime);
            }
            else {
                this.authoringTime = new fhir.FhirDateTime(source._authoringTime);
            }
        }
        if (source['author']) {
            this.author = new fhir.Reference(source.author);
        }
        if (source['description']) {
            this.description = new fhir.FhirString({ value: source.description });
        }
        if (source['_description']) {
            if (this.description) {
                this.description.addExtendedProperties(source._description);
            }
            else {
                this.description = new fhir.FhirString(source._description);
            }
        }
        if (source['study']) {
            this.study = source.study.map((x) => new fhir.ImagingManifestStudy(x));
        }
        else {
            this.study = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingManifest';
        }
        this.vRS('resourceType', exp);
        this.vOS('identifier', exp);
        this.vRS('patient', exp);
        this.vOS('authoringTime', exp);
        this.vOS('author', exp);
        this.vOS('description', exp);
        this.vRA('study', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingManifest._fts_dataType = 'ImagingManifest';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSW1hZ2luZ01hbmlmZXN0LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9JbWFnaW5nTWFuaWZlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsaUNBQWlDO0FBRWpDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBd0JuQzs7R0FFRztBQUNILE1BQU0sT0FBTyxrQ0FBbUMsU0FBUSxJQUFJLENBQUMsZUFBZTtJQWExRTs7T0FFRztJQUNILFlBQVksU0FBeUQsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDL0csS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxRQUFRLEVBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDbEY7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzlCLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQ3ZCLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRTtnQkFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxTQUFVLENBQUMsQ0FBQzthQUFFO2lCQUN6RTtnQkFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsU0FBc0MsQ0FBQyxDQUFDO2FBQUU7U0FDMUY7UUFDRCxJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxHQUFHLEVBQUMsQ0FBQyxDQUFDO1NB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O1FBQ3ZCLElBQUksQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzdCLElBQUksQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzNCLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3JCLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7O0FBckVEOztHQUVHO0FBQzZCLDZCQUFhLEdBQVUsaUJBQWlCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjMuY29yZSB2ZXJzaW9uOiAzLjAuMlxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgUmVzb3VyY2U6IEltYWdpbmdNYW5pZmVzdFxyXG5cclxuaW1wb3J0ICogYXMgZmhpciBmcm9tICcuLi9maGlyLmpzJztcclxuXHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBJbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllc0luc3RhbmNlIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEltYWdpbmdNYW5pZmVzdFN0dWR5U2VyaWVzSW5zdGFuY2VBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBTT1AgY2xhc3MgVUlEIGlkZW50aWZpZXMgdGhlIHR5cGUgb2YgdGhlIHNlbGVjdGVkIGluc3RhbmNlcywgZS5nLiBDVCBpbWFnZSwgR3JheSBzY2FsZSBzb2Z0Y29weSBwcmVzZW50YXRpb24gc3RhdGUsIEVDRyB3YXZlZm9ybSwgZXRjLlxyXG4gICAqL1xyXG4gIHNvcENsYXNzOiBmaGlyLkZoaXJPaWR8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ01hbmlmZXN0LnN0dWR5LnNlcmllcy5pbnN0YW5jZS5zb3BDbGFzc1xyXG4gICAqL1xyXG4gIF9zb3BDbGFzcz86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogU09QIGluc3RhbmNlIFVJRCBpZGVudGlmaWVzIHRoZSBpbnN0YW5jZS5cclxuICAgKi9cclxuICB1aWQ6IGZoaXIuRmhpck9pZHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbWFnaW5nTWFuaWZlc3Quc3R1ZHkuc2VyaWVzLmluc3RhbmNlLnVpZFxyXG4gICAqL1xyXG4gIF91aWQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG59XHJcblxyXG4vKipcclxuICogU09QIEluc3RhbmNlIGNvbXBvbmVudCBpZGVudGlmeSB0aGUgaW5zdGFuY2Ugc2VsZWN0ZWQsIGFsb25nIHdpdGggdGhlIHN0dWR5IGFuZCBzZXJpZXMgaWRlbnRpdGllcyB0byBmb3JtIHRoZSBESUNPTSBpZGVudGl0eSBoaWVyYXJjaHkuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNJbnN0YW5jZSBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0ltYWdpbmdNYW5pZmVzdFN0dWR5U2VyaWVzSW5zdGFuY2UnO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBjbGFzcyBVSUQgaWRlbnRpZmllcyB0aGUgdHlwZSBvZiB0aGUgc2VsZWN0ZWQgaW5zdGFuY2VzLCBlLmcuIENUIGltYWdlLCBHcmF5IHNjYWxlIHNvZnRjb3B5IHByZXNlbnRhdGlvbiBzdGF0ZSwgRUNHIHdhdmVmb3JtLCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIHNvcENsYXNzOiBmaGlyLkZoaXJPaWR8bnVsbDtcclxuICAvKipcclxuICAgKiBTT1AgaW5zdGFuY2UgVUlEIGlkZW50aWZpZXMgdGhlIGluc3RhbmNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1aWQ6IGZoaXIuRmhpck9pZHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIEltYWdpbmdNYW5pZmVzdFN0dWR5U2VyaWVzSW5zdGFuY2UgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxJbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllc0luc3RhbmNlQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3NvcENsYXNzJ10pIHsgdGhpcy5zb3BDbGFzcyA9IG5ldyBmaGlyLkZoaXJPaWQoe3ZhbHVlOiBzb3VyY2Uuc29wQ2xhc3N9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuc29wQ2xhc3MgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfc29wQ2xhc3MnXSkge1xyXG4gICAgICBpZiAodGhpcy5zb3BDbGFzcykgeyB0aGlzLnNvcENsYXNzLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3NvcENsYXNzISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuc29wQ2xhc3MgPSBuZXcgZmhpci5GaGlyT2lkKHNvdXJjZS5fc29wQ2xhc3MgYXMgUGFydGlhbDxmaGlyLkZoaXJPaWRBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3VpZCddKSB7IHRoaXMudWlkID0gbmV3IGZoaXIuRmhpck9pZCh7dmFsdWU6IHNvdXJjZS51aWR9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudWlkID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3VpZCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnVpZCkgeyB0aGlzLnVpZC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl91aWQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy51aWQgPSBuZXcgZmhpci5GaGlyT2lkKHNvdXJjZS5fdWlkIGFzIFBhcnRpYWw8Zmhpci5GaGlyT2lkQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnSW1hZ2luZ01hbmlmZXN0LnN0dWR5LnNlcmllcy5pbnN0YW5jZScgfVxyXG4gICAgdGhpcy52UlMoJ3NvcENsYXNzJyxleHApXHJcbiAgICB0aGlzLnZSUygndWlkJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXMgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBTZXJpZXMgaW5zdGFuY2UgVUlEIG9mIHRoZSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgdWlkOiBmaGlyLkZoaXJPaWR8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ01hbmlmZXN0LnN0dWR5LnNlcmllcy51aWRcclxuICAgKi9cclxuICBfdWlkPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGUgbmV0d29yayBzZXJ2aWNlIHByb3ZpZGluZyBhY2Nlc3MgKGUuZy4sIHF1ZXJ5LCB2aWV3LCBvciByZXRyaWV2YWwpIGZvciB0aGlzIHNlcmllcy4gU2VlIGltcGxlbWVudGF0aW9uIG5vdGVzIGZvciBpbmZvcm1hdGlvbiBhYm91dCB1c2luZyBESUNPTSBlbmRwb2ludHMuIEEgc2VyaWVzLWxldmVsIGVuZHBvaW50LCBpZiBwcmVzZW50LCBoYXMgcHJlY2VkZW5jZSBvdmVyIGEgc3R1ZHktbGV2ZWwgZW5kcG9pbnQgd2l0aCB0aGUgc2FtZSBFbmRwb2ludC50eXBlLlxyXG4gICAqL1xyXG4gIGVuZHBvaW50PzogZmhpci5SZWZlcmVuY2VBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBJbnN0YW5jZSBjb21wb25lbnQgaWRlbnRpZnkgdGhlIGluc3RhbmNlIHNlbGVjdGVkLCBhbG9uZyB3aXRoIHRoZSBzdHVkeSBhbmQgc2VyaWVzIGlkZW50aXRpZXMgdG8gZm9ybSB0aGUgRElDT00gaWRlbnRpdHkgaGllcmFyY2h5LlxyXG4gICAqL1xyXG4gIGluc3RhbmNlOiBmaGlyLkltYWdpbmdNYW5pZmVzdFN0dWR5U2VyaWVzSW5zdGFuY2VBcmdzW118bnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNlcmllcyBjb21wb25lbnQgcmVwcmVzZW50cyB0aGUgc2VyaWVzIGxldmVsIGlkZW50aXR5IGFuZCBsb2NhdG9yIGluZm9ybWF0aW9uIG9mIHRoZSBESUNPTSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXMgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdJbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllcyc7XHJcbiAgLyoqXHJcbiAgICogU2VyaWVzIGluc3RhbmNlIFVJRCBvZiB0aGUgU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1aWQ6IGZoaXIuRmhpck9pZHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBuZXR3b3JrIHNlcnZpY2UgcHJvdmlkaW5nIGFjY2VzcyAoZS5nLiwgcXVlcnksIHZpZXcsIG9yIHJldHJpZXZhbCkgZm9yIHRoaXMgc2VyaWVzLiBTZWUgaW1wbGVtZW50YXRpb24gbm90ZXMgZm9yIGluZm9ybWF0aW9uIGFib3V0IHVzaW5nIERJQ09NIGVuZHBvaW50cy4gQSBzZXJpZXMtbGV2ZWwgZW5kcG9pbnQsIGlmIHByZXNlbnQsIGhhcyBwcmVjZWRlbmNlIG92ZXIgYSBzdHVkeS1sZXZlbCBlbmRwb2ludCB3aXRoIHRoZSBzYW1lIEVuZHBvaW50LnR5cGUuXHJcbiAgICovXHJcbiAgcHVibGljIGVuZHBvaW50OiBmaGlyLlJlZmVyZW5jZVtdO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBJbnN0YW5jZSBjb21wb25lbnQgaWRlbnRpZnkgdGhlIGluc3RhbmNlIHNlbGVjdGVkLCBhbG9uZyB3aXRoIHRoZSBzdHVkeSBhbmQgc2VyaWVzIGlkZW50aXRpZXMgdG8gZm9ybSB0aGUgRElDT00gaWRlbnRpdHkgaGllcmFyY2h5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbnN0YW5jZTogZmhpci5JbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllc0luc3RhbmNlW107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXMgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxJbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllc0FyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWyd1aWQnXSkgeyB0aGlzLnVpZCA9IG5ldyBmaGlyLkZoaXJPaWQoe3ZhbHVlOiBzb3VyY2UudWlkfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnVpZCA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ191aWQnXSkge1xyXG4gICAgICBpZiAodGhpcy51aWQpIHsgdGhpcy51aWQuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdWlkISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudWlkID0gbmV3IGZoaXIuRmhpck9pZChzb3VyY2UuX3VpZCBhcyBQYXJ0aWFsPGZoaXIuRmhpck9pZEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnZW5kcG9pbnQnXSkgeyB0aGlzLmVuZHBvaW50ID0gc291cmNlLmVuZHBvaW50Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZW5kcG9pbnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaW5zdGFuY2UnXSkgeyB0aGlzLmluc3RhbmNlID0gc291cmNlLmluc3RhbmNlLm1hcCgoeCkgPT4gbmV3IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNJbnN0YW5jZSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmluc3RhbmNlID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbWFnaW5nTWFuaWZlc3Quc3R1ZHkuc2VyaWVzJyB9XHJcbiAgICB0aGlzLnZSUygndWlkJyxleHApXHJcbiAgICB0aGlzLnZPQSgnZW5kcG9pbnQnLGV4cClcclxuICAgIHRoaXMudlJBKCdpbnN0YW5jZScsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIEltYWdpbmdNYW5pZmVzdFN0dWR5IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEltYWdpbmdNYW5pZmVzdFN0dWR5QXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogU3R1ZHkgaW5zdGFuY2UgVUlEIG9mIHRoZSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgdWlkOiBmaGlyLkZoaXJPaWR8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ01hbmlmZXN0LnN0dWR5LnVpZFxyXG4gICAqL1xyXG4gIF91aWQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFJlZmVyZW5jZSB0byB0aGUgSW1hZ2luZyBTdHVkeSBpbiBGSElSIGZvcm0uXHJcbiAgICovXHJcbiAgaW1hZ2luZ1N0dWR5PzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgbmV0d29yayBzZXJ2aWNlIHByb3ZpZGluZyBhY2Nlc3MgKGUuZy4sIHF1ZXJ5LCB2aWV3LCBvciByZXRyaWV2YWwpIGZvciB0aGUgc3R1ZHkuIFNlZSBpbXBsZW1lbnRhdGlvbiBub3RlcyBmb3IgaW5mb3JtYXRpb24gYWJvdXQgdXNpbmcgRElDT00gZW5kcG9pbnRzLiBBIHN0dWR5LWxldmVsIGVuZHBvaW50IGFwcGxpZXMgdG8gZWFjaCBzZXJpZXMgaW4gdGhlIHN0dWR5LCB1bmxlc3Mgb3ZlcnJpZGRlbiBieSBhIHNlcmllcy1sZXZlbCBlbmRwb2ludCB3aXRoIHRoZSBzYW1lIEVuZHBvaW50LnR5cGUuXHJcbiAgICovXHJcbiAgZW5kcG9pbnQ/OiBmaGlyLlJlZmVyZW5jZUFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogU2VyaWVzIGNvbXBvbmVudCByZXByZXNlbnRzIHRoZSBzZXJpZXMgbGV2ZWwgaWRlbnRpdHkgYW5kIGxvY2F0b3IgaW5mb3JtYXRpb24gb2YgdGhlIERJQ09NIFNPUCBpbnN0YW5jZXMgaW4gdGhlIHNlbGVjdGlvbi5cclxuICAgKi9cclxuICBzZXJpZXM6IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNBcmdzW118bnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFN0dWR5IGNvbXBvbmVudCByZXByZXNlbnRzIHRoZSBzdHVkeSBsZXZlbCBpZGVudGl0eSBhbmQgbG9jYXRvciBpbmZvcm1hdGlvbiBvZiB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLiBJdCBpcyB0aGUgdG9wIGxldmVsIGlkZW50aXR5IG9mIHRoZSBoaWVyYXJjaGljYWwgaWRlbnRpZmljYXRpb24gb2YgdGhlIGluc3RhbmNlcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBJbWFnaW5nTWFuaWZlc3RTdHVkeSBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0ltYWdpbmdNYW5pZmVzdFN0dWR5JztcclxuICAvKipcclxuICAgKiBTdHVkeSBpbnN0YW5jZSBVSUQgb2YgdGhlIFNPUCBpbnN0YW5jZXMgaW4gdGhlIHNlbGVjdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgdWlkOiBmaGlyLkZoaXJPaWR8bnVsbDtcclxuICAvKipcclxuICAgKiBSZWZlcmVuY2UgdG8gdGhlIEltYWdpbmcgU3R1ZHkgaW4gRkhJUiBmb3JtLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbWFnaW5nU3R1ZHk/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIG5ldHdvcmsgc2VydmljZSBwcm92aWRpbmcgYWNjZXNzIChlLmcuLCBxdWVyeSwgdmlldywgb3IgcmV0cmlldmFsKSBmb3IgdGhlIHN0dWR5LiBTZWUgaW1wbGVtZW50YXRpb24gbm90ZXMgZm9yIGluZm9ybWF0aW9uIGFib3V0IHVzaW5nIERJQ09NIGVuZHBvaW50cy4gQSBzdHVkeS1sZXZlbCBlbmRwb2ludCBhcHBsaWVzIHRvIGVhY2ggc2VyaWVzIGluIHRoZSBzdHVkeSwgdW5sZXNzIG92ZXJyaWRkZW4gYnkgYSBzZXJpZXMtbGV2ZWwgZW5kcG9pbnQgd2l0aCB0aGUgc2FtZSBFbmRwb2ludC50eXBlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBlbmRwb2ludDogZmhpci5SZWZlcmVuY2VbXTtcclxuICAvKipcclxuICAgKiBTZXJpZXMgY29tcG9uZW50IHJlcHJlc2VudHMgdGhlIHNlcmllcyBsZXZlbCBpZGVudGl0eSBhbmQgbG9jYXRvciBpbmZvcm1hdGlvbiBvZiB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXJpZXM6IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBJbWFnaW5nTWFuaWZlc3RTdHVkeSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPEltYWdpbmdNYW5pZmVzdFN0dWR5QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3VpZCddKSB7IHRoaXMudWlkID0gbmV3IGZoaXIuRmhpck9pZCh7dmFsdWU6IHNvdXJjZS51aWR9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudWlkID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3VpZCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnVpZCkgeyB0aGlzLnVpZC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl91aWQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy51aWQgPSBuZXcgZmhpci5GaGlyT2lkKHNvdXJjZS5fdWlkIGFzIFBhcnRpYWw8Zmhpci5GaGlyT2lkQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydpbWFnaW5nU3R1ZHknXSkgeyB0aGlzLmltYWdpbmdTdHVkeSA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuaW1hZ2luZ1N0dWR5KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZW5kcG9pbnQnXSkgeyB0aGlzLmVuZHBvaW50ID0gc291cmNlLmVuZHBvaW50Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZW5kcG9pbnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc2VyaWVzJ10pIHsgdGhpcy5zZXJpZXMgPSBzb3VyY2Uuc2VyaWVzLm1hcCgoeCkgPT4gbmV3IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXMoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5zZXJpZXMgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ0ltYWdpbmdNYW5pZmVzdC5zdHVkeScgfVxyXG4gICAgdGhpcy52UlMoJ3VpZCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2ltYWdpbmdTdHVkeScsZXhwKVxyXG4gICAgdGhpcy52T0EoJ2VuZHBvaW50JyxleHApXHJcbiAgICB0aGlzLnZSQSgnc2VyaWVzJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgSW1hZ2luZ01hbmlmZXN0IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEltYWdpbmdNYW5pZmVzdEFyZ3MgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlQXJncyB7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcmVzb3VyY2VUeXBlOiBcIkltYWdpbmdNYW5pZmVzdFwifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBVbmlxdWUgaWRlbnRpZmllciBvZiB0aGUgRElDT00gS2V5IE9iamVjdCBTZWxlY3Rpb24gKEtPUykgdGhhdCB0aGlzIHJlc291cmNlIHJlcHJlc2VudHMuXHJcbiAgICovXHJcbiAgaWRlbnRpZmllcj86IGZoaXIuSWRlbnRpZmllckFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBpbnN0YW5jZXMgc2VsZWN0ZWQgaW4gdGhlIEltYWdpbmdNYW5pZmVzdCBjYW4gYmUgZnJvbSBkaWZmZXJlbnQgc3R1ZGllcywgYnV0IG11c3QgYmUgb2YgdGhlIHNhbWUgcGF0aWVudC5cclxuICAgKi9cclxuICBwYXRpZW50OiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBEYXRlIGFuZCB0aW1lIHdoZW4gdGhlIHNlbGVjdGlvbiBvZiB0aGUgcmVmZXJlbmNlZCBpbnN0YW5jZXMgd2VyZSBtYWRlLiBJdCBpcyAodHlwaWNhbGx5KSBkaWZmZXJlbnQgZnJvbSB0aGUgY3JlYXRpb24gZGF0ZSBvZiB0aGUgc2VsZWN0aW9uIHJlc291cmNlLCBhbmQgZnJvbSBkYXRlcyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlZmVyZW5jZWQgaW5zdGFuY2VzIChlLmcuIGNhcHR1cmUgdGltZSBvZiB0aGUgcmVmZXJlbmNlZCBpbWFnZSkuXHJcbiAgICovXHJcbiAgYXV0aG9yaW5nVGltZT86IGZoaXIuRmhpckRhdGVUaW1lfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEltYWdpbmdNYW5pZmVzdC5hdXRob3JpbmdUaW1lXHJcbiAgICovXHJcbiAgX2F1dGhvcmluZ1RpbWU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIEF1dGhvciBvZiBJbWFnaW5nTWFuaWZlc3QuIEl0IGNhbiBiZSBhIGh1bWFuIGF1dGhvciBvciBhIGRldmljZSB3aGljaCBtYWRlIHRoZSBkZWNpc2lvbiBvZiB0aGUgU09QIGluc3RhbmNlcyBzZWxlY3RlZC4gRm9yIGV4YW1wbGUsIGEgcmFkaW9sb2dpc3Qgc2VsZWN0ZWQgYSBzZXQgb2YgaW1hZ2luZyBTT1AgaW5zdGFuY2VzIHRvIGF0dGFjaCBpbiBhIGRpYWdub3N0aWMgcmVwb3J0LCBhbmQgYSBDQUQgYXBwbGljYXRpb24gbWF5IGF1dGhvciBhIHNlbGVjdGlvbiB0byBkZXNjcmliZSBTT1AgaW5zdGFuY2VzIGl0IHVzZWQgdG8gZ2VuZXJhdGUgYSBkZXRlY3Rpb24gY29uY2x1c2lvbi5cclxuICAgKi9cclxuICBhdXRob3I/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEZyZWUgdGV4dCBuYXJyYXRpdmUgZGVzY3JpcHRpb24gb2YgdGhlIEltYWdpbmdNYW5pZmVzdC5cclxuICAgKi9cclxuICBkZXNjcmlwdGlvbj86IGZoaXIuRmhpclN0cmluZ3xzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbWFnaW5nTWFuaWZlc3QuZGVzY3JpcHRpb25cclxuICAgKi9cclxuICBfZGVzY3JpcHRpb24/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFN0dWR5IGNvbXBvbmVudCByZXByZXNlbnRzIHRoZSBzdHVkeSBsZXZlbCBpZGVudGl0eSBhbmQgbG9jYXRvciBpbmZvcm1hdGlvbiBvZiB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLiBJdCBpcyB0aGUgdG9wIGxldmVsIGlkZW50aXR5IG9mIHRoZSBoaWVyYXJjaGljYWwgaWRlbnRpZmljYXRpb24gb2YgdGhlIGluc3RhbmNlcy5cclxuICAgKi9cclxuICBzdHVkeTogZmhpci5JbWFnaW5nTWFuaWZlc3RTdHVkeUFyZ3NbXXxudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogQSB0ZXh0IGRlc2NyaXB0aW9uIG9mIHRoZSBESUNPTSBTT1AgaW5zdGFuY2VzIHNlbGVjdGVkIGluIHRoZSBJbWFnaW5nTWFuaWZlc3Q7IG9yIHRoZSByZWFzb24gZm9yLCBvciBzaWduaWZpY2FuY2Ugb2YsIHRoZSBzZWxlY3Rpb24uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgSW1hZ2luZ01hbmlmZXN0IGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdJbWFnaW5nTWFuaWZlc3QnO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiSW1hZ2luZ01hbmlmZXN0XCI7XHJcbiAgLyoqXHJcbiAgICogVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIERJQ09NIEtleSBPYmplY3QgU2VsZWN0aW9uIChLT1MpIHRoYXQgdGhpcyByZXNvdXJjZSByZXByZXNlbnRzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpZGVudGlmaWVyPzogZmhpci5JZGVudGlmaWVyfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBTT1AgaW5zdGFuY2VzIHNlbGVjdGVkIGluIHRoZSBJbWFnaW5nTWFuaWZlc3QgY2FuIGJlIGZyb20gZGlmZmVyZW50IHN0dWRpZXMsIGJ1dCBtdXN0IGJlIG9mIHRoZSBzYW1lIHBhdGllbnQuXHJcbiAgICovXHJcbiAgcHVibGljIHBhdGllbnQ6IGZoaXIuUmVmZXJlbmNlfG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGF0ZSBhbmQgdGltZSB3aGVuIHRoZSBzZWxlY3Rpb24gb2YgdGhlIHJlZmVyZW5jZWQgaW5zdGFuY2VzIHdlcmUgbWFkZS4gSXQgaXMgKHR5cGljYWxseSkgZGlmZmVyZW50IGZyb20gdGhlIGNyZWF0aW9uIGRhdGUgb2YgdGhlIHNlbGVjdGlvbiByZXNvdXJjZSwgYW5kIGZyb20gZGF0ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSByZWZlcmVuY2VkIGluc3RhbmNlcyAoZS5nLiBjYXB0dXJlIHRpbWUgb2YgdGhlIHJlZmVyZW5jZWQgaW1hZ2UpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhdXRob3JpbmdUaW1lPzogZmhpci5GaGlyRGF0ZVRpbWV8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEF1dGhvciBvZiBJbWFnaW5nTWFuaWZlc3QuIEl0IGNhbiBiZSBhIGh1bWFuIGF1dGhvciBvciBhIGRldmljZSB3aGljaCBtYWRlIHRoZSBkZWNpc2lvbiBvZiB0aGUgU09QIGluc3RhbmNlcyBzZWxlY3RlZC4gRm9yIGV4YW1wbGUsIGEgcmFkaW9sb2dpc3Qgc2VsZWN0ZWQgYSBzZXQgb2YgaW1hZ2luZyBTT1AgaW5zdGFuY2VzIHRvIGF0dGFjaCBpbiBhIGRpYWdub3N0aWMgcmVwb3J0LCBhbmQgYSBDQUQgYXBwbGljYXRpb24gbWF5IGF1dGhvciBhIHNlbGVjdGlvbiB0byBkZXNjcmliZSBTT1AgaW5zdGFuY2VzIGl0IHVzZWQgdG8gZ2VuZXJhdGUgYSBkZXRlY3Rpb24gY29uY2x1c2lvbi5cclxuICAgKi9cclxuICBwdWJsaWMgYXV0aG9yPzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEZyZWUgdGV4dCBuYXJyYXRpdmUgZGVzY3JpcHRpb24gb2YgdGhlIEltYWdpbmdNYW5pZmVzdC5cclxuICAgKi9cclxuICBwdWJsaWMgZGVzY3JpcHRpb24/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFN0dWR5IGNvbXBvbmVudCByZXByZXNlbnRzIHRoZSBzdHVkeSBsZXZlbCBpZGVudGl0eSBhbmQgbG9jYXRvciBpbmZvcm1hdGlvbiBvZiB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLiBJdCBpcyB0aGUgdG9wIGxldmVsIGlkZW50aXR5IG9mIHRoZSBoaWVyYXJjaGljYWwgaWRlbnRpZmljYXRpb24gb2YgdGhlIGluc3RhbmNlcy5cclxuICAgKi9cclxuICBwdWJsaWMgc3R1ZHk6IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBJbWFnaW5nTWFuaWZlc3QgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxJbWFnaW5nTWFuaWZlc3RBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnSW1hZ2luZ01hbmlmZXN0JztcclxuICAgIGlmIChzb3VyY2VbJ2lkZW50aWZpZXInXSkgeyB0aGlzLmlkZW50aWZpZXIgPSBuZXcgZmhpci5JZGVudGlmaWVyKHNvdXJjZS5pZGVudGlmaWVyKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncGF0aWVudCddKSB7IHRoaXMucGF0aWVudCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UucGF0aWVudCk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnBhdGllbnQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydhdXRob3JpbmdUaW1lJ10pIHsgdGhpcy5hdXRob3JpbmdUaW1lID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHt2YWx1ZTogc291cmNlLmF1dGhvcmluZ1RpbWV9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2F1dGhvcmluZ1RpbWUnXSkge1xyXG4gICAgICBpZiAodGhpcy5hdXRob3JpbmdUaW1lKSB7IHRoaXMuYXV0aG9yaW5nVGltZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9hdXRob3JpbmdUaW1lISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuYXV0aG9yaW5nVGltZSA9IG5ldyBmaGlyLkZoaXJEYXRlVGltZShzb3VyY2UuX2F1dGhvcmluZ1RpbWUgYXMgUGFydGlhbDxmaGlyLkZoaXJEYXRlVGltZUFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnYXV0aG9yJ10pIHsgdGhpcy5hdXRob3IgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLmF1dGhvcik7IH1cclxuICAgIGlmIChzb3VyY2VbJ2Rlc2NyaXB0aW9uJ10pIHsgdGhpcy5kZXNjcmlwdGlvbiA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoe3ZhbHVlOiBzb3VyY2UuZGVzY3JpcHRpb259KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2Rlc2NyaXB0aW9uJ10pIHtcclxuICAgICAgaWYgKHRoaXMuZGVzY3JpcHRpb24pIHsgdGhpcy5kZXNjcmlwdGlvbi5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9kZXNjcmlwdGlvbiEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLmRlc2NyaXB0aW9uID0gbmV3IGZoaXIuRmhpclN0cmluZyhzb3VyY2UuX2Rlc2NyaXB0aW9uIGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydzdHVkeSddKSB7IHRoaXMuc3R1ZHkgPSBzb3VyY2Uuc3R1ZHkubWFwKCh4KSA9PiBuZXcgZmhpci5JbWFnaW5nTWFuaWZlc3RTdHVkeSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnN0dWR5ID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbWFnaW5nTWFuaWZlc3QnIH1cclxuICAgIHRoaXMudlJTKCdyZXNvdXJjZVR5cGUnLGV4cClcclxuICAgIHRoaXMudk9TKCdpZGVudGlmaWVyJyxleHApXHJcbiAgICB0aGlzLnZSUygncGF0aWVudCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2F1dGhvcmluZ1RpbWUnLGV4cClcclxuICAgIHRoaXMudk9TKCdhdXRob3InLGV4cClcclxuICAgIHRoaXMudk9TKCdkZXNjcmlwdGlvbicsZXhwKVxyXG4gICAgdGhpcy52UkEoJ3N0dWR5JyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4iXX0=