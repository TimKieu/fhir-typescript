// <auto-generated/>
// Contents of: hl7.fhir.r3.core version: 3.0.2
// Minimum TypeScript Version: 3.7
// FHIR Resource: ImagingManifest
import * as fhir from '../fhir.js';
/**
 * SOP Instance component identify the instance selected, along with the study and series identities to form the DICOM identity hierarchy.
 */
export class ImagingManifestStudySeriesInstance extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingManifestStudySeriesInstance - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['sopClass']) {
            this.sopClass = new fhir.FhirOid({ value: source.sopClass });
        }
        else {
            this.sopClass = null;
        }
        if (source['_sopClass']) {
            if (this.sopClass) {
                this.sopClass.addExtendedProperties(source._sopClass);
            }
            else {
                this.sopClass = new fhir.FhirOid(source._sopClass);
            }
        }
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingManifest.study.series.instance';
        }
        iss.push(...this.vRS('sopClass', exp));
        iss.push(...this.vRS('uid', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingManifestStudySeriesInstance._fts_dataType = 'ImagingManifestStudySeriesInstance';
/**
 * Series component represents the series level identity and locator information of the DICOM SOP instances in the selection.
 */
export class ImagingManifestStudySeries extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingManifestStudySeries - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
        if (source['endpoint']) {
            this.endpoint = source.endpoint.map((x) => new fhir.Reference(x));
        }
        else {
            this.endpoint = [];
        }
        if (source['instance']) {
            this.instance = source.instance.map((x) => new fhir.ImagingManifestStudySeriesInstance(x));
        }
        else {
            this.instance = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingManifest.study.series';
        }
        iss.push(...this.vRS('uid', exp));
        iss.push(...this.vOA('endpoint', exp));
        iss.push(...this.vRA('instance', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingManifestStudySeries._fts_dataType = 'ImagingManifestStudySeries';
/**
 * Study component represents the study level identity and locator information of the DICOM SOP instances in the selection. It is the top level identity of the hierarchical identification of the instances.
 */
export class ImagingManifestStudy extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingManifestStudy - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
        if (source['imagingStudy']) {
            this.imagingStudy = new fhir.Reference(source.imagingStudy);
        }
        if (source['endpoint']) {
            this.endpoint = source.endpoint.map((x) => new fhir.Reference(x));
        }
        else {
            this.endpoint = [];
        }
        if (source['series']) {
            this.series = source.series.map((x) => new fhir.ImagingManifestStudySeries(x));
        }
        else {
            this.series = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingManifest.study';
        }
        iss.push(...this.vRS('uid', exp));
        iss.push(...this.vOS('imagingStudy', exp));
        iss.push(...this.vOA('endpoint', exp));
        iss.push(...this.vRA('series', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingManifestStudy._fts_dataType = 'ImagingManifestStudy';
/**
 * A text description of the DICOM SOP instances selected in the ImagingManifest; or the reason for, or significance of, the selection.
 */
export class ImagingManifest extends fhir.DomainResource {
    /**
     * Default constructor for ImagingManifest - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'ImagingManifest';
        if (source['identifier']) {
            this.identifier = new fhir.Identifier(source.identifier);
        }
        if (source['patient']) {
            this.patient = new fhir.Reference(source.patient);
        }
        else {
            this.patient = null;
        }
        if (source['authoringTime']) {
            this.authoringTime = new fhir.FhirDateTime({ value: source.authoringTime });
        }
        if (source['_authoringTime']) {
            if (this.authoringTime) {
                this.authoringTime.addExtendedProperties(source._authoringTime);
            }
            else {
                this.authoringTime = new fhir.FhirDateTime(source._authoringTime);
            }
        }
        if (source['author']) {
            this.author = new fhir.Reference(source.author);
        }
        if (source['description']) {
            this.description = new fhir.FhirString({ value: source.description });
        }
        if (source['_description']) {
            if (this.description) {
                this.description.addExtendedProperties(source._description);
            }
            else {
                this.description = new fhir.FhirString(source._description);
            }
        }
        if (source['study']) {
            this.study = source.study.map((x) => new fhir.ImagingManifestStudy(x));
        }
        else {
            this.study = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingManifest';
        }
        iss.push(...this.vOS('identifier', exp));
        iss.push(...this.vRS('patient', exp));
        iss.push(...this.vOS('authoringTime', exp));
        iss.push(...this.vOS('author', exp));
        iss.push(...this.vOS('description', exp));
        iss.push(...this.vRA('study', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingManifest._fts_dataType = 'ImagingManifest';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSW1hZ2luZ01hbmlmZXN0LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9JbWFnaW5nTWFuaWZlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsaUNBQWlDO0FBRWpDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBd0JuQzs7R0FFRztBQUNILE1BQU0sT0FBTyxrQ0FBbUMsU0FBUSxJQUFJLENBQUMsZUFBZTtJQWExRTs7T0FFRztJQUNILFlBQVksU0FBeUQsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDL0csS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxRQUFRLEVBQUMsQ0FBQyxDQUFDO1NBQUU7YUFDbEY7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztTQUFFO1FBQzlCLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQ3ZCLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRTtnQkFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxTQUFVLENBQUMsQ0FBQzthQUFFO2lCQUN6RTtnQkFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsU0FBc0MsQ0FBQyxDQUFDO2FBQUU7U0FDMUY7UUFDRCxJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxHQUFHLEVBQUMsQ0FBQyxDQUFDO1NB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QUFJLEdBQUcsR0FBbUIsS0FBSyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZELElBQUksR0FBRyxLQUFLLEVBQUUsRUFBRTtZQUFFLEdBQUcsR0FBRyxpQkFBaUIsQ0FBQTtTQUFFO1FBQzNDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3hDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3JDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzNDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3pDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ25DLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQzs7QUFwRUQ7O0dBRUc7QUFDNkIsNkJBQWEsR0FBVSxpQkFBaUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yMy5jb3JlIHZlcnNpb246IDMuMC4yXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogSW1hZ2luZ01hbmlmZXN0XHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIEltYWdpbmdNYW5pZmVzdFN0dWR5U2VyaWVzSW5zdGFuY2UgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNJbnN0YW5jZUFyZ3MgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFNPUCBjbGFzcyBVSUQgaWRlbnRpZmllcyB0aGUgdHlwZSBvZiB0aGUgc2VsZWN0ZWQgaW5zdGFuY2VzLCBlLmcuIENUIGltYWdlLCBHcmF5IHNjYWxlIHNvZnRjb3B5IHByZXNlbnRhdGlvbiBzdGF0ZSwgRUNHIHdhdmVmb3JtLCBldGMuXHJcbiAgICovXHJcbiAgc29wQ2xhc3M6IGZoaXIuRmhpck9pZHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbWFnaW5nTWFuaWZlc3Quc3R1ZHkuc2VyaWVzLmluc3RhbmNlLnNvcENsYXNzXHJcbiAgICovXHJcbiAgX3NvcENsYXNzPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBTT1AgaW5zdGFuY2UgVUlEIGlkZW50aWZpZXMgdGhlIGluc3RhbmNlLlxyXG4gICAqL1xyXG4gIHVpZDogZmhpci5GaGlyT2lkfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEltYWdpbmdNYW5pZmVzdC5zdHVkeS5zZXJpZXMuaW5zdGFuY2UudWlkXHJcbiAgICovXHJcbiAgX3VpZD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTT1AgSW5zdGFuY2UgY29tcG9uZW50IGlkZW50aWZ5IHRoZSBpbnN0YW5jZSBzZWxlY3RlZCwgYWxvbmcgd2l0aCB0aGUgc3R1ZHkgYW5kIHNlcmllcyBpZGVudGl0aWVzIHRvIGZvcm0gdGhlIERJQ09NIGlkZW50aXR5IGhpZXJhcmNoeS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBJbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllc0luc3RhbmNlIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNJbnN0YW5jZSc7XHJcbiAgLyoqXHJcbiAgICogU09QIGNsYXNzIFVJRCBpZGVudGlmaWVzIHRoZSB0eXBlIG9mIHRoZSBzZWxlY3RlZCBpbnN0YW5jZXMsIGUuZy4gQ1QgaW1hZ2UsIEdyYXkgc2NhbGUgc29mdGNvcHkgcHJlc2VudGF0aW9uIHN0YXRlLCBFQ0cgd2F2ZWZvcm0sIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgc29wQ2xhc3M6IGZoaXIuRmhpck9pZHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBpbnN0YW5jZSBVSUQgaWRlbnRpZmllcyB0aGUgaW5zdGFuY2UuXHJcbiAgICovXHJcbiAgcHVibGljIHVpZDogZmhpci5GaGlyT2lkfG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNJbnN0YW5jZSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPEltYWdpbmdNYW5pZmVzdFN0dWR5U2VyaWVzSW5zdGFuY2VBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsnc29wQ2xhc3MnXSkgeyB0aGlzLnNvcENsYXNzID0gbmV3IGZoaXIuRmhpck9pZCh7dmFsdWU6IHNvdXJjZS5zb3BDbGFzc30pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5zb3BDbGFzcyA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ19zb3BDbGFzcyddKSB7XHJcbiAgICAgIGlmICh0aGlzLnNvcENsYXNzKSB7IHRoaXMuc29wQ2xhc3MuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fc29wQ2xhc3MhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zb3BDbGFzcyA9IG5ldyBmaGlyLkZoaXJPaWQoc291cmNlLl9zb3BDbGFzcyBhcyBQYXJ0aWFsPGZoaXIuRmhpck9pZEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndWlkJ10pIHsgdGhpcy51aWQgPSBuZXcgZmhpci5GaGlyT2lkKHt2YWx1ZTogc291cmNlLnVpZH0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy51aWQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfdWlkJ10pIHtcclxuICAgICAgaWYgKHRoaXMudWlkKSB7IHRoaXMudWlkLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3VpZCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnVpZCA9IG5ldyBmaGlyLkZoaXJPaWQoc291cmNlLl91aWQgYXMgUGFydGlhbDxmaGlyLkZoaXJPaWRBcmdzPik7IH1cclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbWFnaW5nTWFuaWZlc3Quc3R1ZHkuc2VyaWVzLmluc3RhbmNlJyB9XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZSUygnc29wQ2xhc3MnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ3VpZCcsZXhwKSk7XHJcbiAgICByZXR1cm4gaXNzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXMgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBTZXJpZXMgaW5zdGFuY2UgVUlEIG9mIHRoZSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgdWlkOiBmaGlyLkZoaXJPaWR8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ01hbmlmZXN0LnN0dWR5LnNlcmllcy51aWRcclxuICAgKi9cclxuICBfdWlkPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBUaGUgbmV0d29yayBzZXJ2aWNlIHByb3ZpZGluZyBhY2Nlc3MgKGUuZy4sIHF1ZXJ5LCB2aWV3LCBvciByZXRyaWV2YWwpIGZvciB0aGlzIHNlcmllcy4gU2VlIGltcGxlbWVudGF0aW9uIG5vdGVzIGZvciBpbmZvcm1hdGlvbiBhYm91dCB1c2luZyBESUNPTSBlbmRwb2ludHMuIEEgc2VyaWVzLWxldmVsIGVuZHBvaW50LCBpZiBwcmVzZW50LCBoYXMgcHJlY2VkZW5jZSBvdmVyIGEgc3R1ZHktbGV2ZWwgZW5kcG9pbnQgd2l0aCB0aGUgc2FtZSBFbmRwb2ludC50eXBlLlxyXG4gICAqL1xyXG4gIGVuZHBvaW50PzogZmhpci5SZWZlcmVuY2VBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBJbnN0YW5jZSBjb21wb25lbnQgaWRlbnRpZnkgdGhlIGluc3RhbmNlIHNlbGVjdGVkLCBhbG9uZyB3aXRoIHRoZSBzdHVkeSBhbmQgc2VyaWVzIGlkZW50aXRpZXMgdG8gZm9ybSB0aGUgRElDT00gaWRlbnRpdHkgaGllcmFyY2h5LlxyXG4gICAqL1xyXG4gIGluc3RhbmNlOiBmaGlyLkltYWdpbmdNYW5pZmVzdFN0dWR5U2VyaWVzSW5zdGFuY2VBcmdzW118bnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNlcmllcyBjb21wb25lbnQgcmVwcmVzZW50cyB0aGUgc2VyaWVzIGxldmVsIGlkZW50aXR5IGFuZCBsb2NhdG9yIGluZm9ybWF0aW9uIG9mIHRoZSBESUNPTSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXMgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdJbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllcyc7XHJcbiAgLyoqXHJcbiAgICogU2VyaWVzIGluc3RhbmNlIFVJRCBvZiB0aGUgU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1aWQ6IGZoaXIuRmhpck9pZHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFRoZSBuZXR3b3JrIHNlcnZpY2UgcHJvdmlkaW5nIGFjY2VzcyAoZS5nLiwgcXVlcnksIHZpZXcsIG9yIHJldHJpZXZhbCkgZm9yIHRoaXMgc2VyaWVzLiBTZWUgaW1wbGVtZW50YXRpb24gbm90ZXMgZm9yIGluZm9ybWF0aW9uIGFib3V0IHVzaW5nIERJQ09NIGVuZHBvaW50cy4gQSBzZXJpZXMtbGV2ZWwgZW5kcG9pbnQsIGlmIHByZXNlbnQsIGhhcyBwcmVjZWRlbmNlIG92ZXIgYSBzdHVkeS1sZXZlbCBlbmRwb2ludCB3aXRoIHRoZSBzYW1lIEVuZHBvaW50LnR5cGUuXHJcbiAgICovXHJcbiAgcHVibGljIGVuZHBvaW50OiBmaGlyLlJlZmVyZW5jZVtdO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBJbnN0YW5jZSBjb21wb25lbnQgaWRlbnRpZnkgdGhlIGluc3RhbmNlIHNlbGVjdGVkLCBhbG9uZyB3aXRoIHRoZSBzdHVkeSBhbmQgc2VyaWVzIGlkZW50aXRpZXMgdG8gZm9ybSB0aGUgRElDT00gaWRlbnRpdHkgaGllcmFyY2h5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbnN0YW5jZTogZmhpci5JbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllc0luc3RhbmNlW107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXMgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxJbWFnaW5nTWFuaWZlc3RTdHVkeVNlcmllc0FyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWyd1aWQnXSkgeyB0aGlzLnVpZCA9IG5ldyBmaGlyLkZoaXJPaWQoe3ZhbHVlOiBzb3VyY2UudWlkfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnVpZCA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ191aWQnXSkge1xyXG4gICAgICBpZiAodGhpcy51aWQpIHsgdGhpcy51aWQuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdWlkISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudWlkID0gbmV3IGZoaXIuRmhpck9pZChzb3VyY2UuX3VpZCBhcyBQYXJ0aWFsPGZoaXIuRmhpck9pZEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnZW5kcG9pbnQnXSkgeyB0aGlzLmVuZHBvaW50ID0gc291cmNlLmVuZHBvaW50Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZW5kcG9pbnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaW5zdGFuY2UnXSkgeyB0aGlzLmluc3RhbmNlID0gc291cmNlLmluc3RhbmNlLm1hcCgoeCkgPT4gbmV3IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNJbnN0YW5jZSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmluc3RhbmNlID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbWFnaW5nTWFuaWZlc3Quc3R1ZHkuc2VyaWVzJyB9XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZSUygndWlkJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdlbmRwb2ludCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZSQSgnaW5zdGFuY2UnLGV4cCkpO1xyXG4gICAgcmV0dXJuIGlzcztcclxuICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIEltYWdpbmdNYW5pZmVzdFN0dWR5IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEltYWdpbmdNYW5pZmVzdFN0dWR5QXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogU3R1ZHkgaW5zdGFuY2UgVUlEIG9mIHRoZSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgdWlkOiBmaGlyLkZoaXJPaWR8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ01hbmlmZXN0LnN0dWR5LnVpZFxyXG4gICAqL1xyXG4gIF91aWQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFJlZmVyZW5jZSB0byB0aGUgSW1hZ2luZyBTdHVkeSBpbiBGSElSIGZvcm0uXHJcbiAgICovXHJcbiAgaW1hZ2luZ1N0dWR5PzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgbmV0d29yayBzZXJ2aWNlIHByb3ZpZGluZyBhY2Nlc3MgKGUuZy4sIHF1ZXJ5LCB2aWV3LCBvciByZXRyaWV2YWwpIGZvciB0aGUgc3R1ZHkuIFNlZSBpbXBsZW1lbnRhdGlvbiBub3RlcyBmb3IgaW5mb3JtYXRpb24gYWJvdXQgdXNpbmcgRElDT00gZW5kcG9pbnRzLiBBIHN0dWR5LWxldmVsIGVuZHBvaW50IGFwcGxpZXMgdG8gZWFjaCBzZXJpZXMgaW4gdGhlIHN0dWR5LCB1bmxlc3Mgb3ZlcnJpZGRlbiBieSBhIHNlcmllcy1sZXZlbCBlbmRwb2ludCB3aXRoIHRoZSBzYW1lIEVuZHBvaW50LnR5cGUuXHJcbiAgICovXHJcbiAgZW5kcG9pbnQ/OiBmaGlyLlJlZmVyZW5jZUFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogU2VyaWVzIGNvbXBvbmVudCByZXByZXNlbnRzIHRoZSBzZXJpZXMgbGV2ZWwgaWRlbnRpdHkgYW5kIGxvY2F0b3IgaW5mb3JtYXRpb24gb2YgdGhlIERJQ09NIFNPUCBpbnN0YW5jZXMgaW4gdGhlIHNlbGVjdGlvbi5cclxuICAgKi9cclxuICBzZXJpZXM6IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNBcmdzW118bnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFN0dWR5IGNvbXBvbmVudCByZXByZXNlbnRzIHRoZSBzdHVkeSBsZXZlbCBpZGVudGl0eSBhbmQgbG9jYXRvciBpbmZvcm1hdGlvbiBvZiB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLiBJdCBpcyB0aGUgdG9wIGxldmVsIGlkZW50aXR5IG9mIHRoZSBoaWVyYXJjaGljYWwgaWRlbnRpZmljYXRpb24gb2YgdGhlIGluc3RhbmNlcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBJbWFnaW5nTWFuaWZlc3RTdHVkeSBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0ltYWdpbmdNYW5pZmVzdFN0dWR5JztcclxuICAvKipcclxuICAgKiBTdHVkeSBpbnN0YW5jZSBVSUQgb2YgdGhlIFNPUCBpbnN0YW5jZXMgaW4gdGhlIHNlbGVjdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgdWlkOiBmaGlyLkZoaXJPaWR8bnVsbDtcclxuICAvKipcclxuICAgKiBSZWZlcmVuY2UgdG8gdGhlIEltYWdpbmcgU3R1ZHkgaW4gRkhJUiBmb3JtLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbWFnaW5nU3R1ZHk/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIG5ldHdvcmsgc2VydmljZSBwcm92aWRpbmcgYWNjZXNzIChlLmcuLCBxdWVyeSwgdmlldywgb3IgcmV0cmlldmFsKSBmb3IgdGhlIHN0dWR5LiBTZWUgaW1wbGVtZW50YXRpb24gbm90ZXMgZm9yIGluZm9ybWF0aW9uIGFib3V0IHVzaW5nIERJQ09NIGVuZHBvaW50cy4gQSBzdHVkeS1sZXZlbCBlbmRwb2ludCBhcHBsaWVzIHRvIGVhY2ggc2VyaWVzIGluIHRoZSBzdHVkeSwgdW5sZXNzIG92ZXJyaWRkZW4gYnkgYSBzZXJpZXMtbGV2ZWwgZW5kcG9pbnQgd2l0aCB0aGUgc2FtZSBFbmRwb2ludC50eXBlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBlbmRwb2ludDogZmhpci5SZWZlcmVuY2VbXTtcclxuICAvKipcclxuICAgKiBTZXJpZXMgY29tcG9uZW50IHJlcHJlc2VudHMgdGhlIHNlcmllcyBsZXZlbCBpZGVudGl0eSBhbmQgbG9jYXRvciBpbmZvcm1hdGlvbiBvZiB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXJpZXM6IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXNbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBJbWFnaW5nTWFuaWZlc3RTdHVkeSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPEltYWdpbmdNYW5pZmVzdFN0dWR5QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3VpZCddKSB7IHRoaXMudWlkID0gbmV3IGZoaXIuRmhpck9pZCh7dmFsdWU6IHNvdXJjZS51aWR9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudWlkID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3VpZCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnVpZCkgeyB0aGlzLnVpZC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl91aWQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy51aWQgPSBuZXcgZmhpci5GaGlyT2lkKHNvdXJjZS5fdWlkIGFzIFBhcnRpYWw8Zmhpci5GaGlyT2lkQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydpbWFnaW5nU3R1ZHknXSkgeyB0aGlzLmltYWdpbmdTdHVkeSA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuaW1hZ2luZ1N0dWR5KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZW5kcG9pbnQnXSkgeyB0aGlzLmVuZHBvaW50ID0gc291cmNlLmVuZHBvaW50Lm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZW5kcG9pbnQgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc2VyaWVzJ10pIHsgdGhpcy5zZXJpZXMgPSBzb3VyY2Uuc2VyaWVzLm1hcCgoeCkgPT4gbmV3IGZoaXIuSW1hZ2luZ01hbmlmZXN0U3R1ZHlTZXJpZXMoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5zZXJpZXMgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ0ltYWdpbmdNYW5pZmVzdC5zdHVkeScgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ3VpZCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnaW1hZ2luZ1N0dWR5JyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9BKCdlbmRwb2ludCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZSQSgnc2VyaWVzJyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBJbWFnaW5nTWFuaWZlc3QgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2luZ01hbmlmZXN0QXJncyBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2VBcmdzIHtcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICByZXNvdXJjZVR5cGU6IFwiSW1hZ2luZ01hbmlmZXN0XCJ8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBESUNPTSBLZXkgT2JqZWN0IFNlbGVjdGlvbiAoS09TKSB0aGF0IHRoaXMgcmVzb3VyY2UgcmVwcmVzZW50cy5cclxuICAgKi9cclxuICBpZGVudGlmaWVyPzogZmhpci5JZGVudGlmaWVyQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogU09QIGluc3RhbmNlcyBzZWxlY3RlZCBpbiB0aGUgSW1hZ2luZ01hbmlmZXN0IGNhbiBiZSBmcm9tIGRpZmZlcmVudCBzdHVkaWVzLCBidXQgbXVzdCBiZSBvZiB0aGUgc2FtZSBwYXRpZW50LlxyXG4gICAqL1xyXG4gIHBhdGllbnQ6IGZoaXIuUmVmZXJlbmNlQXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIERhdGUgYW5kIHRpbWUgd2hlbiB0aGUgc2VsZWN0aW9uIG9mIHRoZSByZWZlcmVuY2VkIGluc3RhbmNlcyB3ZXJlIG1hZGUuIEl0IGlzICh0eXBpY2FsbHkpIGRpZmZlcmVudCBmcm9tIHRoZSBjcmVhdGlvbiBkYXRlIG9mIHRoZSBzZWxlY3Rpb24gcmVzb3VyY2UsIGFuZCBmcm9tIGRhdGVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVmZXJlbmNlZCBpbnN0YW5jZXMgKGUuZy4gY2FwdHVyZSB0aW1lIG9mIHRoZSByZWZlcmVuY2VkIGltYWdlKS5cclxuICAgKi9cclxuICBhdXRob3JpbmdUaW1lPzogZmhpci5GaGlyRGF0ZVRpbWV8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ01hbmlmZXN0LmF1dGhvcmluZ1RpbWVcclxuICAgKi9cclxuICBfYXV0aG9yaW5nVGltZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogQXV0aG9yIG9mIEltYWdpbmdNYW5pZmVzdC4gSXQgY2FuIGJlIGEgaHVtYW4gYXV0aG9yIG9yIGEgZGV2aWNlIHdoaWNoIG1hZGUgdGhlIGRlY2lzaW9uIG9mIHRoZSBTT1AgaW5zdGFuY2VzIHNlbGVjdGVkLiBGb3IgZXhhbXBsZSwgYSByYWRpb2xvZ2lzdCBzZWxlY3RlZCBhIHNldCBvZiBpbWFnaW5nIFNPUCBpbnN0YW5jZXMgdG8gYXR0YWNoIGluIGEgZGlhZ25vc3RpYyByZXBvcnQsIGFuZCBhIENBRCBhcHBsaWNhdGlvbiBtYXkgYXV0aG9yIGEgc2VsZWN0aW9uIHRvIGRlc2NyaWJlIFNPUCBpbnN0YW5jZXMgaXQgdXNlZCB0byBnZW5lcmF0ZSBhIGRldGVjdGlvbiBjb25jbHVzaW9uLlxyXG4gICAqL1xyXG4gIGF1dGhvcj86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRnJlZSB0ZXh0IG5hcnJhdGl2ZSBkZXNjcmlwdGlvbiBvZiB0aGUgSW1hZ2luZ01hbmlmZXN0LlxyXG4gICAqL1xyXG4gIGRlc2NyaXB0aW9uPzogZmhpci5GaGlyU3RyaW5nfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEltYWdpbmdNYW5pZmVzdC5kZXNjcmlwdGlvblxyXG4gICAqL1xyXG4gIF9kZXNjcmlwdGlvbj86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogU3R1ZHkgY29tcG9uZW50IHJlcHJlc2VudHMgdGhlIHN0dWR5IGxldmVsIGlkZW50aXR5IGFuZCBsb2NhdG9yIGluZm9ybWF0aW9uIG9mIHRoZSBESUNPTSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uIEl0IGlzIHRoZSB0b3AgbGV2ZWwgaWRlbnRpdHkgb2YgdGhlIGhpZXJhcmNoaWNhbCBpZGVudGlmaWNhdGlvbiBvZiB0aGUgaW5zdGFuY2VzLlxyXG4gICAqL1xyXG4gIHN0dWR5OiBmaGlyLkltYWdpbmdNYW5pZmVzdFN0dWR5QXJnc1tdfG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIHRleHQgZGVzY3JpcHRpb24gb2YgdGhlIERJQ09NIFNPUCBpbnN0YW5jZXMgc2VsZWN0ZWQgaW4gdGhlIEltYWdpbmdNYW5pZmVzdDsgb3IgdGhlIHJlYXNvbiBmb3IsIG9yIHNpZ25pZmljYW5jZSBvZiwgdGhlIHNlbGVjdGlvbi5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBJbWFnaW5nTWFuaWZlc3QgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0ltYWdpbmdNYW5pZmVzdCc7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc291cmNlVHlwZTogXCJJbWFnaW5nTWFuaWZlc3RcIjtcclxuICAvKipcclxuICAgKiBVbmlxdWUgaWRlbnRpZmllciBvZiB0aGUgRElDT00gS2V5IE9iamVjdCBTZWxlY3Rpb24gKEtPUykgdGhhdCB0aGlzIHJlc291cmNlIHJlcHJlc2VudHMuXHJcbiAgICovXHJcbiAgcHVibGljIGlkZW50aWZpZXI/OiBmaGlyLklkZW50aWZpZXJ8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBpbnN0YW5jZXMgc2VsZWN0ZWQgaW4gdGhlIEltYWdpbmdNYW5pZmVzdCBjYW4gYmUgZnJvbSBkaWZmZXJlbnQgc3R1ZGllcywgYnV0IG11c3QgYmUgb2YgdGhlIHNhbWUgcGF0aWVudC5cclxuICAgKi9cclxuICBwdWJsaWMgcGF0aWVudDogZmhpci5SZWZlcmVuY2V8bnVsbDtcclxuICAvKipcclxuICAgKiBEYXRlIGFuZCB0aW1lIHdoZW4gdGhlIHNlbGVjdGlvbiBvZiB0aGUgcmVmZXJlbmNlZCBpbnN0YW5jZXMgd2VyZSBtYWRlLiBJdCBpcyAodHlwaWNhbGx5KSBkaWZmZXJlbnQgZnJvbSB0aGUgY3JlYXRpb24gZGF0ZSBvZiB0aGUgc2VsZWN0aW9uIHJlc291cmNlLCBhbmQgZnJvbSBkYXRlcyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlZmVyZW5jZWQgaW5zdGFuY2VzIChlLmcuIGNhcHR1cmUgdGltZSBvZiB0aGUgcmVmZXJlbmNlZCBpbWFnZSkuXHJcbiAgICovXHJcbiAgcHVibGljIGF1dGhvcmluZ1RpbWU/OiBmaGlyLkZoaXJEYXRlVGltZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQXV0aG9yIG9mIEltYWdpbmdNYW5pZmVzdC4gSXQgY2FuIGJlIGEgaHVtYW4gYXV0aG9yIG9yIGEgZGV2aWNlIHdoaWNoIG1hZGUgdGhlIGRlY2lzaW9uIG9mIHRoZSBTT1AgaW5zdGFuY2VzIHNlbGVjdGVkLiBGb3IgZXhhbXBsZSwgYSByYWRpb2xvZ2lzdCBzZWxlY3RlZCBhIHNldCBvZiBpbWFnaW5nIFNPUCBpbnN0YW5jZXMgdG8gYXR0YWNoIGluIGEgZGlhZ25vc3RpYyByZXBvcnQsIGFuZCBhIENBRCBhcHBsaWNhdGlvbiBtYXkgYXV0aG9yIGEgc2VsZWN0aW9uIHRvIGRlc2NyaWJlIFNPUCBpbnN0YW5jZXMgaXQgdXNlZCB0byBnZW5lcmF0ZSBhIGRldGVjdGlvbiBjb25jbHVzaW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhdXRob3I/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRnJlZSB0ZXh0IG5hcnJhdGl2ZSBkZXNjcmlwdGlvbiBvZiB0aGUgSW1hZ2luZ01hbmlmZXN0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBkZXNjcmlwdGlvbj86IGZoaXIuRmhpclN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogU3R1ZHkgY29tcG9uZW50IHJlcHJlc2VudHMgdGhlIHN0dWR5IGxldmVsIGlkZW50aXR5IGFuZCBsb2NhdG9yIGluZm9ybWF0aW9uIG9mIHRoZSBESUNPTSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uIEl0IGlzIHRoZSB0b3AgbGV2ZWwgaWRlbnRpdHkgb2YgdGhlIGhpZXJhcmNoaWNhbCBpZGVudGlmaWNhdGlvbiBvZiB0aGUgaW5zdGFuY2VzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdHVkeTogZmhpci5JbWFnaW5nTWFuaWZlc3RTdHVkeVtdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIEltYWdpbmdNYW5pZmVzdCAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPEltYWdpbmdNYW5pZmVzdEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdJbWFnaW5nTWFuaWZlc3QnO1xyXG4gICAgaWYgKHNvdXJjZVsnaWRlbnRpZmllciddKSB7IHRoaXMuaWRlbnRpZmllciA9IG5ldyBmaGlyLklkZW50aWZpZXIoc291cmNlLmlkZW50aWZpZXIpOyB9XHJcbiAgICBpZiAoc291cmNlWydwYXRpZW50J10pIHsgdGhpcy5wYXRpZW50ID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5wYXRpZW50KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucGF0aWVudCA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ2F1dGhvcmluZ1RpbWUnXSkgeyB0aGlzLmF1dGhvcmluZ1RpbWUgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoe3ZhbHVlOiBzb3VyY2UuYXV0aG9yaW5nVGltZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfYXV0aG9yaW5nVGltZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLmF1dGhvcmluZ1RpbWUpIHsgdGhpcy5hdXRob3JpbmdUaW1lLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2F1dGhvcmluZ1RpbWUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5hdXRob3JpbmdUaW1lID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHNvdXJjZS5fYXV0aG9yaW5nVGltZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckRhdGVUaW1lQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydhdXRob3InXSkgeyB0aGlzLmF1dGhvciA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuYXV0aG9yKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZGVzY3JpcHRpb24nXSkgeyB0aGlzLmRlc2NyaXB0aW9uID0gbmV3IGZoaXIuRmhpclN0cmluZyh7dmFsdWU6IHNvdXJjZS5kZXNjcmlwdGlvbn0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfZGVzY3JpcHRpb24nXSkge1xyXG4gICAgICBpZiAodGhpcy5kZXNjcmlwdGlvbikgeyB0aGlzLmRlc2NyaXB0aW9uLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2Rlc2NyaXB0aW9uISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuZGVzY3JpcHRpb24gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHNvdXJjZS5fZGVzY3JpcHRpb24gYXMgUGFydGlhbDxmaGlyLkZoaXJTdHJpbmdBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3N0dWR5J10pIHsgdGhpcy5zdHVkeSA9IHNvdXJjZS5zdHVkeS5tYXAoKHgpID0+IG5ldyBmaGlyLkltYWdpbmdNYW5pZmVzdFN0dWR5KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuc3R1ZHkgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ0ltYWdpbmdNYW5pZmVzdCcgfVxyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2lkZW50aWZpZXInLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlMoJ3BhdGllbnQnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2F1dGhvcmluZ1RpbWUnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ2F1dGhvcicsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnZGVzY3JpcHRpb24nLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UkEoJ3N0dWR5JyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbiJdfQ==