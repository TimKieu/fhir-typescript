// <auto-generated/>
// Contents of: hl7.fhir.r3.core version: 3.0.2
// Minimum TypeScript Version: 3.7
// FHIR Resource: SupplyDelivery
import * as fhir from '../fhir.js';
// @ts-ignore
import { SupplydeliveryStatusVsValidation } from '../fhirValueSets/SupplydeliveryStatusVsValidation.js';
// @ts-ignore
import { SupplydeliveryTypeVsValidation } from '../fhirValueSets/SupplydeliveryTypeVsValidation.js';
/**
 * The item that is being delivered or has been supplied.
 */
export class SupplyDeliverySuppliedItem extends fhir.BackboneElement {
    /**
     * Default constructor for SupplyDeliverySuppliedItem - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['quantity']) {
            this.quantity = new fhir.Quantity(source.quantity);
        }
        if (source['item']) {
            this.item = source.item;
        }
        else if (source['itemCodeableConcept']) {
            this.item = new fhir.CodeableConcept(source.itemCodeableConcept);
        }
        else if (source['itemReference']) {
            this.item = new fhir.Reference(source.itemReference);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'SupplyDelivery.suppliedItem';
        }
        this.vOS('quantity', exp);
        this.vOS('item', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
SupplyDeliverySuppliedItem._fts_dataType = 'SupplyDeliverySuppliedItem';
/**
 * Internal flag to properly serialize choice-type element SupplyDelivery.suppliedItem.item[x]
 */
SupplyDeliverySuppliedItem._fts_itemIsChoice = true;
/**
 * Record of delivery of what is supplied.
 */
export class SupplyDelivery extends fhir.DomainResource {
    /**
     * Default constructor for SupplyDelivery - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'SupplyDelivery';
        if (source['identifier']) {
            this.identifier = new fhir.Identifier(source.identifier);
        }
        if (source['basedOn']) {
            this.basedOn = source.basedOn.map((x) => new fhir.Reference(x));
        }
        else {
            this.basedOn = [];
        }
        if (source['partOf']) {
            this.partOf = source.partOf.map((x) => new fhir.Reference(x));
        }
        else {
            this.partOf = [];
        }
        if (source['status']) {
            this.status = new fhir.FhirCode({ value: source.status });
        }
        if (source['_status']) {
            if (this.status) {
                this.status.addExtendedProperties(source._status);
            }
            else {
                this.status = new fhir.FhirCode(source._status);
            }
        }
        if (source['patient']) {
            this.patient = new fhir.Reference(source.patient);
        }
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        if (source['suppliedItem']) {
            this.suppliedItem = new fhir.SupplyDeliverySuppliedItem(source.suppliedItem);
        }
        if (source['occurrence']) {
            this.occurrence = source.occurrence;
        }
        else if (source['occurrenceDateTime']) {
            this.occurrence = new fhir.FhirDateTime({ value: source.occurrenceDateTime });
        }
        else if (source['occurrencePeriod']) {
            this.occurrence = new fhir.Period(source.occurrencePeriod);
        }
        else if (source['occurrenceTiming']) {
            this.occurrence = new fhir.Timing(source.occurrenceTiming);
        }
        if (source['supplier']) {
            this.supplier = new fhir.Reference(source.supplier);
        }
        if (source['destination']) {
            this.destination = new fhir.Reference(source.destination);
        }
        if (source['receiver']) {
            this.receiver = source.receiver.map((x) => new fhir.Reference(x));
        }
        else {
            this.receiver = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'SupplyDelivery';
        }
        this.vRS('resourceType', exp);
        this.vOS('identifier', exp);
        this.vOA('basedOn', exp);
        this.vOA('partOf', exp);
        this.vOSV('status', exp, 'SupplydeliveryStatus', SupplydeliveryStatusVsValidation, 'r');
        this.vOS('patient', exp);
        this.vOSV('type', exp, 'SupplydeliveryType', SupplydeliveryTypeVsValidation, 'r');
        this.vOS('suppliedItem', exp);
        this.vOS('occurrence', exp);
        this.vOS('supplier', exp);
        this.vOS('destination', exp);
        this.vOA('receiver', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
SupplyDelivery._fts_dataType = 'SupplyDelivery';
/**
 * Internal flag to properly serialize choice-type element SupplyDelivery.occurrence[x]
 */
SupplyDelivery._fts_occurrenceIsChoice = true;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3VwcGx5RGVsaXZlcnkuanMiLCJzb3VyY2VSb290IjoiLi9zcmMvIiwic291cmNlcyI6WyJmaGlyL1N1cHBseURlbGl2ZXJ5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLG9CQUFvQjtBQUNwQiwrQ0FBK0M7QUFDL0Msa0NBQWtDO0FBQ2xDLGdDQUFnQztBQUVoQyxPQUFPLEtBQUssSUFBSSxNQUFNLFlBQVksQ0FBQztBQUluQyxhQUFhO0FBQ2IsT0FBTyxFQUFFLGdDQUFnQyxFQUFFLE1BQU0sc0RBQXNELENBQUM7QUFHeEcsYUFBYTtBQUNiLE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLG9EQUFvRCxDQUFDO0FBdUJwRzs7R0FFRztBQUNILE1BQU0sT0FBTywwQkFBMkIsU0FBUSxJQUFJLENBQUMsZUFBZTtJQWlCbEU7O09BRUc7SUFDSCxZQUFZLFNBQWlELEVBQUUsRUFBRSxVQUFzQyxFQUFFO1FBQ3ZHLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkIsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7U0FBRTtRQUMvRSxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQztTQUFFO2FBQzNDLElBQUksTUFBTSxDQUFDLHFCQUFxQixDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQztTQUFFO2FBQ3hHLElBQUksTUFBTSxDQUFDLGVBQWUsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1NB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LE1BQU0sQ0FBQztJQUNoQixDQUFDOztBQXhHRDs7R0FFRztBQUM2Qiw0QkFBYSxHQUFVLGdCQUFnQixDQUFDO0FBc0N4RTs7R0FFRztBQUN1QixzQ0FBdUIsR0FBUSxJQUFJLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjMuY29yZSB2ZXJzaW9uOiAzLjAuMlxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgUmVzb3VyY2U6IFN1cHBseURlbGl2ZXJ5XHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBTdXBwbHlkZWxpdmVyeVN0YXR1c0NvZGVzLCAgU3VwcGx5ZGVsaXZlcnlTdGF0dXNDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvU3VwcGx5ZGVsaXZlcnlTdGF0dXNDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU3VwcGx5ZGVsaXZlcnlTdGF0dXNWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL1N1cHBseWRlbGl2ZXJ5U3RhdHVzVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBTdXBwbHlkZWxpdmVyeVR5cGVDb2RlcywgIFN1cHBseWRlbGl2ZXJ5VHlwZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TdXBwbHlkZWxpdmVyeVR5cGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgU3VwcGx5ZGVsaXZlcnlUeXBlVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9TdXBwbHlkZWxpdmVyeVR5cGVWc1ZhbGlkYXRpb24uanMnO1xyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgU3VwcGx5RGVsaXZlcnlTdXBwbGllZEl0ZW0gdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3VwcGx5RGVsaXZlcnlTdXBwbGllZEl0ZW1BcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBUaGUgYW1vdW50IG9mIHN1cHBseSB0aGF0IGhhcyBiZWVuIGRpc3BlbnNlZC4gSW5jbHVkZXMgdW5pdCBvZiBtZWFzdXJlLlxyXG4gICAqL1xyXG4gIHF1YW50aXR5PzogZmhpci5RdWFudGl0eUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXMgdGhlIG1lZGljYXRpb24sIHN1YnN0YW5jZSBvciBkZXZpY2UgYmVpbmcgZGlzcGVuc2VkLiBUaGlzIGlzIGVpdGhlciBhIGxpbmsgdG8gYSByZXNvdXJjZSByZXByZXNlbnRpbmcgdGhlIGRldGFpbHMgb2YgdGhlIGl0ZW0gb3IgYSBjb2RlIHRoYXQgaWRlbnRpZmllcyB0aGUgaXRlbSBmcm9tIGEga25vd24gbGlzdC5cclxuICAgKi9cclxuICBpdGVtPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8Zmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXMgdGhlIG1lZGljYXRpb24sIHN1YnN0YW5jZSBvciBkZXZpY2UgYmVpbmcgZGlzcGVuc2VkLiBUaGlzIGlzIGVpdGhlciBhIGxpbmsgdG8gYSByZXNvdXJjZSByZXByZXNlbnRpbmcgdGhlIGRldGFpbHMgb2YgdGhlIGl0ZW0gb3IgYSBjb2RlIHRoYXQgaWRlbnRpZmllcyB0aGUgaXRlbSBmcm9tIGEga25vd24gbGlzdC5cclxuICAgKi9cclxuICBpdGVtQ29kZWFibGVDb25jZXB0PzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJZGVudGlmaWVzIHRoZSBtZWRpY2F0aW9uLCBzdWJzdGFuY2Ugb3IgZGV2aWNlIGJlaW5nIGRpc3BlbnNlZC4gVGhpcyBpcyBlaXRoZXIgYSBsaW5rIHRvIGEgcmVzb3VyY2UgcmVwcmVzZW50aW5nIHRoZSBkZXRhaWxzIG9mIHRoZSBpdGVtIG9yIGEgY29kZSB0aGF0IGlkZW50aWZpZXMgdGhlIGl0ZW0gZnJvbSBhIGtub3duIGxpc3QuXHJcbiAgICovXHJcbiAgaXRlbVJlZmVyZW5jZT86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgaXRlbSB0aGF0IGlzIGJlaW5nIGRlbGl2ZXJlZCBvciBoYXMgYmVlbiBzdXBwbGllZC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTdXBwbHlEZWxpdmVyeVN1cHBsaWVkSXRlbSBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ1N1cHBseURlbGl2ZXJ5U3VwcGxpZWRJdGVtJztcclxuICAvKipcclxuICAgKiBUaGUgYW1vdW50IG9mIHN1cHBseSB0aGF0IGhhcyBiZWVuIGRpc3BlbnNlZC4gSW5jbHVkZXMgdW5pdCBvZiBtZWFzdXJlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBxdWFudGl0eT86IGZoaXIuUXVhbnRpdHl8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXMgdGhlIG1lZGljYXRpb24sIHN1YnN0YW5jZSBvciBkZXZpY2UgYmVpbmcgZGlzcGVuc2VkLiBUaGlzIGlzIGVpdGhlciBhIGxpbmsgdG8gYSByZXNvdXJjZSByZXByZXNlbnRpbmcgdGhlIGRldGFpbHMgb2YgdGhlIGl0ZW0gb3IgYSBjb2RlIHRoYXQgaWRlbnRpZmllcyB0aGUgaXRlbSBmcm9tIGEga25vd24gbGlzdC5cclxuICAgKi9cclxuICBwdWJsaWMgaXRlbT86IChmaGlyLkNvZGVhYmxlQ29uY2VwdHxmaGlyLlJlZmVyZW5jZSl8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEludGVybmFsIGZsYWcgdG8gcHJvcGVybHkgc2VyaWFsaXplIGNob2ljZS10eXBlIGVsZW1lbnQgU3VwcGx5RGVsaXZlcnkuc3VwcGxpZWRJdGVtLml0ZW1beF1cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgc3RhdGljIHJlYWRvbmx5IF9mdHNfaXRlbUlzQ2hvaWNlOnRydWUgPSB0cnVlO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIFN1cHBseURlbGl2ZXJ5U3VwcGxpZWRJdGVtIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8U3VwcGx5RGVsaXZlcnlTdXBwbGllZEl0ZW1BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsncXVhbnRpdHknXSkgeyB0aGlzLnF1YW50aXR5ID0gbmV3IGZoaXIuUXVhbnRpdHkoc291cmNlLnF1YW50aXR5KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnaXRlbSddKSB7IHRoaXMuaXRlbSA9IHNvdXJjZS5pdGVtOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ2l0ZW1Db2RlYWJsZUNvbmNlcHQnXSkgeyB0aGlzLml0ZW0gPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLml0ZW1Db2RlYWJsZUNvbmNlcHQpOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ2l0ZW1SZWZlcmVuY2UnXSkgeyB0aGlzLml0ZW0gPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLml0ZW1SZWZlcmVuY2UpOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnU3VwcGx5RGVsaXZlcnkuc3VwcGxpZWRJdGVtJyB9XHJcbiAgICB0aGlzLnZPUygncXVhbnRpdHknLGV4cClcclxuICAgIHRoaXMudk9TKCdpdGVtJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgU3VwcGx5RGVsaXZlcnkgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3VwcGx5RGVsaXZlcnlBcmdzIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZUFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHJlc291cmNlVHlwZTogXCJTdXBwbHlEZWxpdmVyeVwifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGlzIGlzIGFzc2lnbmVkIGJ5IHRoZSBkaXNwZW5zZXIsIGFuZCB1c2VkIHRvIHJlZmVyIHRvIHRoaXMgb3JkZXIgaW4gb3RoZXIgZXh0ZXJuYWwgc3RhbmRhcmRzLlxyXG4gICAqL1xyXG4gIGlkZW50aWZpZXI/OiBmaGlyLklkZW50aWZpZXJBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIHBsYW4sIHByb3Bvc2FsIG9yIG9yZGVyIHRoYXQgaXMgZnVsZmlsbGVkIGluIHdob2xlIG9yIGluIHBhcnQgYnkgdGhpcyBldmVudC5cclxuICAgKi9cclxuICBiYXNlZE9uPzogZmhpci5SZWZlcmVuY2VBcmdzW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIE5vdCB0byBiZSB1c2VkIHRvIGxpbmsgYW4gZXZlbnQgdG8gYW4gRW5jb3VudGVyIC0gdXNlIEV2ZW50LmNvbnRleHQgZm9yIHRoYXQuXHJcbiAgICogW1RoZSBhbGxvd2VkIHJlZmVyZW5jZSByZXNvdXJjZXMgbWF5IGJlIGFkanVzdGVkIGFzIGFwcHJvcHJpYXRlIGZvciB0aGUgZXZlbnQgcmVzb3VyY2VdLlxyXG4gICAqL1xyXG4gIHBhcnRPZj86IGZoaXIuUmVmZXJlbmNlQXJnc1tdfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGlzIGVsZW1lbnQgaXMgbGFiZWxlZCBhcyBhIG1vZGlmaWVyIGJlY2F1c2UgdGhlIHN0YXR1cyBjb250YWlucyBjb2RlcyB0aGF0IG1hcmsgdGhlIHJlc291cmNlIGFzIG5vdCBjdXJyZW50bHkgdmFsaWQuXHJcbiAgICovXHJcbiAgc3RhdHVzPzogZmhpci5GaGlyQ29kZTxTdXBwbHlkZWxpdmVyeVN0YXR1c0NvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBTdXBwbHlEZWxpdmVyeS5zdGF0dXNcclxuICAgKi9cclxuICBfc3RhdHVzPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBBIGxpbmsgdG8gYSByZXNvdXJjZSByZXByZXNlbnRpbmcgdGhlIHBlcnNvbiB3aG9tIHRoZSBkZWxpdmVyZWQgaXRlbSBpcyBmb3IuXHJcbiAgICovXHJcbiAgcGF0aWVudD86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIHRoZSB0eXBlIG9mIGRpc3BlbnNpbmcgZXZlbnQgdGhhdCBpcyBwZXJmb3JtZWQuIEV4YW1wbGVzIGluY2x1ZGU6IFRyaWFsIEZpbGwsIENvbXBsZXRpb24gb2YgVHJpYWwsIFBhcnRpYWwgRmlsbCwgRW1lcmdlbmN5IEZpbGwsIFNhbXBsZXMsIGV0Yy5cclxuICAgKi9cclxuICB0eXBlPzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgaXRlbSB0aGF0IGlzIGJlaW5nIGRlbGl2ZXJlZCBvciBoYXMgYmVlbiBzdXBwbGllZC5cclxuICAgKi9cclxuICBzdXBwbGllZEl0ZW0/OiBmaGlyLlN1cHBseURlbGl2ZXJ5U3VwcGxpZWRJdGVtQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogW1RoZSBsaXN0IG9mIHR5cGVzIG1heSBiZSBjb25zdHJhaW5lZCBhcyBhcHByb3ByaWF0ZSBmb3IgdGhlIHR5cGUgb2YgZXZlbnRdLlxyXG4gICAqL1xyXG4gIG9jY3VycmVuY2U/OiBmaGlyLkZoaXJEYXRlVGltZXxmaGlyLlBlcmlvZHxmaGlyLlRpbWluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogW1RoZSBsaXN0IG9mIHR5cGVzIG1heSBiZSBjb25zdHJhaW5lZCBhcyBhcHByb3ByaWF0ZSBmb3IgdGhlIHR5cGUgb2YgZXZlbnRdLlxyXG4gICAqL1xyXG4gIG9jY3VycmVuY2VEYXRlVGltZT86IGZoaXIuRmhpckRhdGVUaW1lfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogW1RoZSBsaXN0IG9mIHR5cGVzIG1heSBiZSBjb25zdHJhaW5lZCBhcyBhcHByb3ByaWF0ZSBmb3IgdGhlIHR5cGUgb2YgZXZlbnRdLlxyXG4gICAqL1xyXG4gIG9jY3VycmVuY2VQZXJpb2Q/OiBmaGlyLlBlcmlvZEFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFtUaGUgbGlzdCBvZiB0eXBlcyBtYXkgYmUgY29uc3RyYWluZWQgYXMgYXBwcm9wcmlhdGUgZm9yIHRoZSB0eXBlIG9mIGV2ZW50XS5cclxuICAgKi9cclxuICBvY2N1cnJlbmNlVGltaW5nPzogZmhpci5UaW1pbmdBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBUaGUgaW5kaXZpZHVhbCByZXNwb25zaWJsZSBmb3IgZGlzcGVuc2luZyB0aGUgbWVkaWNhdGlvbiwgc3VwcGxpZXIgb3IgZGV2aWNlLlxyXG4gICAqL1xyXG4gIHN1cHBsaWVyPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJZGVudGlmaWNhdGlvbiBvZiB0aGUgZmFjaWxpdHkvbG9jYXRpb24gd2hlcmUgdGhlIFN1cHBseSB3YXMgc2hpcHBlZCB0bywgYXMgcGFydCBvZiB0aGUgZGlzcGVuc2UgZXZlbnQuXHJcbiAgICovXHJcbiAgZGVzdGluYXRpb24/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIElkZW50aWZpZXMgdGhlIHBlcnNvbiB3aG8gcGlja2VkIHVwIHRoZSBTdXBwbHkuXHJcbiAgICovXHJcbiAgcmVjZWl2ZXI/OiBmaGlyLlJlZmVyZW5jZUFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZWNvcmQgb2YgZGVsaXZlcnkgb2Ygd2hhdCBpcyBzdXBwbGllZC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTdXBwbHlEZWxpdmVyeSBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2Uge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnU3VwcGx5RGVsaXZlcnknO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiU3VwcGx5RGVsaXZlcnlcIjtcclxuICAvKipcclxuICAgKiBUaGlzIGlzIGFzc2lnbmVkIGJ5IHRoZSBkaXNwZW5zZXIsIGFuZCB1c2VkIHRvIHJlZmVyIHRvIHRoaXMgb3JkZXIgaW4gb3RoZXIgZXh0ZXJuYWwgc3RhbmRhcmRzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpZGVudGlmaWVyPzogZmhpci5JZGVudGlmaWVyfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBBIHBsYW4sIHByb3Bvc2FsIG9yIG9yZGVyIHRoYXQgaXMgZnVsZmlsbGVkIGluIHdob2xlIG9yIGluIHBhcnQgYnkgdGhpcyBldmVudC5cclxuICAgKi9cclxuICBwdWJsaWMgYmFzZWRPbjogZmhpci5SZWZlcmVuY2VbXTtcclxuICAvKipcclxuICAgKiBOb3QgdG8gYmUgdXNlZCB0byBsaW5rIGFuIGV2ZW50IHRvIGFuIEVuY291bnRlciAtIHVzZSBFdmVudC5jb250ZXh0IGZvciB0aGF0LlxyXG4gICAqIFtUaGUgYWxsb3dlZCByZWZlcmVuY2UgcmVzb3VyY2VzIG1heSBiZSBhZGp1c3RlZCBhcyBhcHByb3ByaWF0ZSBmb3IgdGhlIGV2ZW50IHJlc291cmNlXS5cclxuICAgKi9cclxuICBwdWJsaWMgcGFydE9mOiBmaGlyLlJlZmVyZW5jZVtdO1xyXG4gIC8qKlxyXG4gICAqIFRoaXMgZWxlbWVudCBpcyBsYWJlbGVkIGFzIGEgbW9kaWZpZXIgYmVjYXVzZSB0aGUgc3RhdHVzIGNvbnRhaW5zIGNvZGVzIHRoYXQgbWFyayB0aGUgcmVzb3VyY2UgYXMgbm90IGN1cnJlbnRseSB2YWxpZC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdHVzPzogZmhpci5GaGlyQ29kZTxTdXBwbHlkZWxpdmVyeVN0YXR1c0NvZGVUeXBlPnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogQSBsaW5rIHRvIGEgcmVzb3VyY2UgcmVwcmVzZW50aW5nIHRoZSBwZXJzb24gd2hvbSB0aGUgZGVsaXZlcmVkIGl0ZW0gaXMgZm9yLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXRpZW50PzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRlcyB0aGUgdHlwZSBvZiBkaXNwZW5zaW5nIGV2ZW50IHRoYXQgaXMgcGVyZm9ybWVkLiBFeGFtcGxlcyBpbmNsdWRlOiBUcmlhbCBGaWxsLCBDb21wbGV0aW9uIG9mIFRyaWFsLCBQYXJ0aWFsIEZpbGwsIEVtZXJnZW5jeSBGaWxsLCBTYW1wbGVzLCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIHR5cGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVGhlIGl0ZW0gdGhhdCBpcyBiZWluZyBkZWxpdmVyZWQgb3IgaGFzIGJlZW4gc3VwcGxpZWQuXHJcbiAgICovXHJcbiAgcHVibGljIHN1cHBsaWVkSXRlbT86IGZoaXIuU3VwcGx5RGVsaXZlcnlTdXBwbGllZEl0ZW18dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFtUaGUgbGlzdCBvZiB0eXBlcyBtYXkgYmUgY29uc3RyYWluZWQgYXMgYXBwcm9wcmlhdGUgZm9yIHRoZSB0eXBlIG9mIGV2ZW50XS5cclxuICAgKi9cclxuICBwdWJsaWMgb2NjdXJyZW5jZT86IChmaGlyLkZoaXJEYXRlVGltZXxmaGlyLlBlcmlvZHxmaGlyLlRpbWluZyl8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEludGVybmFsIGZsYWcgdG8gcHJvcGVybHkgc2VyaWFsaXplIGNob2ljZS10eXBlIGVsZW1lbnQgU3VwcGx5RGVsaXZlcnkub2NjdXJyZW5jZVt4XVxyXG4gICAqL1xyXG4gIHByb3RlY3RlZCBzdGF0aWMgcmVhZG9ubHkgX2Z0c19vY2N1cnJlbmNlSXNDaG9pY2U6dHJ1ZSA9IHRydWU7XHJcbiAgLyoqXHJcbiAgICogVGhlIGluZGl2aWR1YWwgcmVzcG9uc2libGUgZm9yIGRpc3BlbnNpbmcgdGhlIG1lZGljYXRpb24sIHN1cHBsaWVyIG9yIGRldmljZS5cclxuICAgKi9cclxuICBwdWJsaWMgc3VwcGxpZXI/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSWRlbnRpZmljYXRpb24gb2YgdGhlIGZhY2lsaXR5L2xvY2F0aW9uIHdoZXJlIHRoZSBTdXBwbHkgd2FzIHNoaXBwZWQgdG8sIGFzIHBhcnQgb2YgdGhlIGRpc3BlbnNlIGV2ZW50LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBkZXN0aW5hdGlvbj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBJZGVudGlmaWVzIHRoZSBwZXJzb24gd2hvIHBpY2tlZCB1cCB0aGUgU3VwcGx5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWNlaXZlcjogZmhpci5SZWZlcmVuY2VbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBTdXBwbHlEZWxpdmVyeSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPFN1cHBseURlbGl2ZXJ5QXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIHRoaXMucmVzb3VyY2VUeXBlID0gJ1N1cHBseURlbGl2ZXJ5JztcclxuICAgIGlmIChzb3VyY2VbJ2lkZW50aWZpZXInXSkgeyB0aGlzLmlkZW50aWZpZXIgPSBuZXcgZmhpci5JZGVudGlmaWVyKHNvdXJjZS5pZGVudGlmaWVyKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnYmFzZWRPbiddKSB7IHRoaXMuYmFzZWRPbiA9IHNvdXJjZS5iYXNlZE9uLm1hcCgoeCkgPT4gbmV3IGZoaXIuUmVmZXJlbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuYmFzZWRPbiA9IFtdOyB9XHJcbiAgICBpZiAoc291cmNlWydwYXJ0T2YnXSkgeyB0aGlzLnBhcnRPZiA9IHNvdXJjZS5wYXJ0T2YubWFwKCh4KSA9PiBuZXcgZmhpci5SZWZlcmVuY2UoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5wYXJ0T2YgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc3RhdHVzJ10pIHsgdGhpcy5zdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxTdXBwbHlkZWxpdmVyeVN0YXR1c0NvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5zdGF0dXN9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3N0YXR1cyddKSB7XHJcbiAgICAgIGlmICh0aGlzLnN0YXR1cykgeyB0aGlzLnN0YXR1cy5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9zdGF0dXMhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxTdXBwbHlkZWxpdmVyeVN0YXR1c0NvZGVUeXBlPihzb3VyY2UuX3N0YXR1cyBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsncGF0aWVudCddKSB7IHRoaXMucGF0aWVudCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UucGF0aWVudCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3R5cGUnXSkgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLnR5cGUpOyB9XHJcbiAgICBpZiAoc291cmNlWydzdXBwbGllZEl0ZW0nXSkgeyB0aGlzLnN1cHBsaWVkSXRlbSA9IG5ldyBmaGlyLlN1cHBseURlbGl2ZXJ5U3VwcGxpZWRJdGVtKHNvdXJjZS5zdXBwbGllZEl0ZW0pOyB9XHJcbiAgICBpZiAoc291cmNlWydvY2N1cnJlbmNlJ10pIHsgdGhpcy5vY2N1cnJlbmNlID0gc291cmNlLm9jY3VycmVuY2U7IH1cclxuICAgIGVsc2UgaWYgKHNvdXJjZVsnb2NjdXJyZW5jZURhdGVUaW1lJ10pIHsgdGhpcy5vY2N1cnJlbmNlID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHt2YWx1ZTogc291cmNlLm9jY3VycmVuY2VEYXRlVGltZX0pOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ29jY3VycmVuY2VQZXJpb2QnXSkgeyB0aGlzLm9jY3VycmVuY2UgPSBuZXcgZmhpci5QZXJpb2Qoc291cmNlLm9jY3VycmVuY2VQZXJpb2QpOyB9XHJcbiAgICBlbHNlIGlmIChzb3VyY2VbJ29jY3VycmVuY2VUaW1pbmcnXSkgeyB0aGlzLm9jY3VycmVuY2UgPSBuZXcgZmhpci5UaW1pbmcoc291cmNlLm9jY3VycmVuY2VUaW1pbmcpOyB9XHJcbiAgICBpZiAoc291cmNlWydzdXBwbGllciddKSB7IHRoaXMuc3VwcGxpZXIgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnN1cHBsaWVyKTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnZGVzdGluYXRpb24nXSkgeyB0aGlzLmRlc3RpbmF0aW9uID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5kZXN0aW5hdGlvbik7IH1cclxuICAgIGlmIChzb3VyY2VbJ3JlY2VpdmVyJ10pIHsgdGhpcy5yZWNlaXZlciA9IHNvdXJjZS5yZWNlaXZlci5tYXAoKHgpID0+IG5ldyBmaGlyLlJlZmVyZW5jZSh4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnJlY2VpdmVyID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdTdXBwbHlEZWxpdmVyeScgfVxyXG4gICAgdGhpcy52UlMoJ3Jlc291cmNlVHlwZScsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2lkZW50aWZpZXInLGV4cClcclxuICAgIHRoaXMudk9BKCdiYXNlZE9uJyxleHApXHJcbiAgICB0aGlzLnZPQSgncGFydE9mJyxleHApXHJcbiAgICB0aGlzLnZPU1YoJ3N0YXR1cycsZXhwLCdTdXBwbHlkZWxpdmVyeVN0YXR1cycsU3VwcGx5ZGVsaXZlcnlTdGF0dXNWc1ZhbGlkYXRpb24sJ3InKVxyXG4gICAgdGhpcy52T1MoJ3BhdGllbnQnLGV4cClcclxuICAgIHRoaXMudk9TVigndHlwZScsZXhwLCdTdXBwbHlkZWxpdmVyeVR5cGUnLFN1cHBseWRlbGl2ZXJ5VHlwZVZzVmFsaWRhdGlvbiwncicpXHJcbiAgICB0aGlzLnZPUygnc3VwcGxpZWRJdGVtJyxleHApXHJcbiAgICB0aGlzLnZPUygnb2NjdXJyZW5jZScsZXhwKVxyXG4gICAgdGhpcy52T1MoJ3N1cHBsaWVyJyxleHApXHJcbiAgICB0aGlzLnZPUygnZGVzdGluYXRpb24nLGV4cClcclxuICAgIHRoaXMudk9BKCdyZWNlaXZlcicsZXhwKVxyXG4gICAgcmV0dXJuIGlzc3VlcztcclxuICB9XHJcbn1cclxuIl19