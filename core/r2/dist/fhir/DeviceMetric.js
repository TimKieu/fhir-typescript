// <auto-generated/>
// Contents of: hl7.fhir.r2.core version: 1.0.2
// Minimum TypeScript Version: 3.7
// FHIR Resource: DeviceMetric
import * as fhir from '../fhir.js';
// @ts-ignore
import { MetricCalibrationTypeVsValidation } from '../fhirValueSets/MetricCalibrationTypeVsValidation.js';
// @ts-ignore
import { MetricCalibrationStateVsValidation } from '../fhirValueSets/MetricCalibrationStateVsValidation.js';
// @ts-ignore
import { MetricOperationalStatusVsValidation } from '../fhirValueSets/MetricOperationalStatusVsValidation.js';
// @ts-ignore
import { MetricColorVsValidation } from '../fhirValueSets/MetricColorVsValidation.js';
// @ts-ignore
import { MetricCategoryVsValidation } from '../fhirValueSets/MetricCategoryVsValidation.js';
/**
 * Describes the calibrations that have been performed or that are required to be performed.
 */
export class DeviceMetricCalibration extends fhir.BackboneElement {
    /**
     * Default constructor for DeviceMetricCalibration - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['type']) {
            this.type = new fhir.FhirCode({ value: source.type });
        }
        if (source['_type']) {
            if (this.type) {
                this.type.addExtendedProperties(source._type);
            }
            else {
                this.type = new fhir.FhirCode(source._type);
            }
        }
        if (source['state']) {
            this.state = new fhir.FhirCode({ value: source.state });
        }
        if (source['_state']) {
            if (this.state) {
                this.state.addExtendedProperties(source._state);
            }
            else {
                this.state = new fhir.FhirCode(source._state);
            }
        }
        if (source['time']) {
            this.time = new fhir.FhirInstant({ value: source.time });
        }
        if (source['_time']) {
            if (this.time) {
                this.time.addExtendedProperties(source._time);
            }
            else {
                this.time = new fhir.FhirInstant(source._time);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'DeviceMetric.calibration';
        }
        iss.push(...this.vOSV('type', exp, 'MetricCalibrationType', MetricCalibrationTypeVsValidation, 'r'));
        iss.push(...this.vOSV('state', exp, 'MetricCalibrationState', MetricCalibrationStateVsValidation, 'r'));
        iss.push(...this.vOS('time', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DeviceMetricCalibration._fts_dataType = 'DeviceMetricCalibration';
/**
 * Describes a measurement, calculation or setting capability of a medical device.
 */
export class DeviceMetric extends fhir.DomainResource {
    /**
     * Default constructor for DeviceMetric - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'DeviceMetric';
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        else {
            this.type = null;
        }
        if (source['identifier']) {
            this.identifier = new fhir.Identifier(source.identifier);
        }
        else {
            this.identifier = null;
        }
        if (source['unit']) {
            this.unit = new fhir.CodeableConcept(source.unit);
        }
        if (source['source']) {
            this.source = new fhir.Reference(source.source);
        }
        if (source['parent']) {
            this.parent = new fhir.Reference(source.parent);
        }
        if (source['operationalStatus']) {
            this.operationalStatus = new fhir.FhirCode({ value: source.operationalStatus });
        }
        if (source['_operationalStatus']) {
            if (this.operationalStatus) {
                this.operationalStatus.addExtendedProperties(source._operationalStatus);
            }
            else {
                this.operationalStatus = new fhir.FhirCode(source._operationalStatus);
            }
        }
        if (source['color']) {
            this.color = new fhir.FhirCode({ value: source.color });
        }
        if (source['_color']) {
            if (this.color) {
                this.color.addExtendedProperties(source._color);
            }
            else {
                this.color = new fhir.FhirCode(source._color);
            }
        }
        if (source['category']) {
            this.category = new fhir.FhirCode({ value: source.category });
        }
        else {
            this.category = null;
        }
        if (source['_category']) {
            if (this.category) {
                this.category.addExtendedProperties(source._category);
            }
            else {
                this.category = new fhir.FhirCode(source._category);
            }
        }
        if (source['measurementPeriod']) {
            this.measurementPeriod = new fhir.Timing(source.measurementPeriod);
        }
        if (source['calibration']) {
            this.calibration = source.calibration.map((x) => new fhir.DeviceMetricCalibration(x));
        }
        else {
            this.calibration = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let iss = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'DeviceMetric';
        }
        iss.push(...this.vRS('type', exp));
        iss.push(...this.vRS('identifier', exp));
        iss.push(...this.vOS('unit', exp));
        iss.push(...this.vOS('source', exp));
        iss.push(...this.vOS('parent', exp));
        iss.push(...this.vOSV('operationalStatus', exp, 'MetricOperationalStatus', MetricOperationalStatusVsValidation, 'r'));
        iss.push(...this.vOSV('color', exp, 'MetricColor', MetricColorVsValidation, 'r'));
        iss.push(...this.vRSV('category', exp, 'MetricCategory', MetricCategoryVsValidation, 'r'));
        iss.push(...this.vOS('measurementPeriod', exp));
        iss.push(...this.vOA('calibration', exp));
        return iss;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DeviceMetric._fts_dataType = 'DeviceMetric';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGV2aWNlTWV0cmljLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9EZXZpY2VNZXRyaWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsOEJBQThCO0FBRTlCLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSx1REFBdUQsQ0FBQztBQUcxRyxhQUFhO0FBQ2IsT0FBTyxFQUFFLGtDQUFrQyxFQUFFLE1BQU0sd0RBQXdELENBQUM7QUFHNUcsYUFBYTtBQUNiLE9BQU8sRUFBRSxtQ0FBbUMsRUFBRSxNQUFNLHlEQUF5RCxDQUFDO0FBRzlHLGFBQWE7QUFDYixPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSw2Q0FBNkMsQ0FBQztBQUd0RixhQUFhO0FBQ2IsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sZ0RBQWdELENBQUM7QUErQjVGOztHQUVHO0FBQ0gsTUFBTSxPQUFPLHVCQUF3QixTQUFRLElBQUksQ0FBQyxlQUFlO0lBaUIvRDs7T0FFRztJQUNILFlBQVksU0FBOEMsRUFBRSxFQUFFLFVBQXNDLEVBQUU7UUFDcEcsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2QixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUFFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFnQyxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUFFO1FBQzNHLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxLQUFNLENBQUMsQ0FBQzthQUFFO2lC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QUFDLHVCQUF1QixFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDOUUsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFDLEdBQUcsRUFBQyxnQkFBZ0IsRUFBQywwQkFBMEIsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3ZGLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLG1CQUFtQixFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDL0MsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDekMsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDOztBQWxHRDs7R0FFRztBQUM2QiwwQkFBYSxHQUFVLGNBQWMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yMi5jb3JlIHZlcnNpb246IDEuMC4yXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogRGV2aWNlTWV0cmljXHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNDYWxpYnJhdGlvblR5cGVDb2RlcywgIE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVUeXBlIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZXRyaWNDYWxpYnJhdGlvblR5cGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljQ2FsaWJyYXRpb25UeXBlVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZXRyaWNDYWxpYnJhdGlvblR5cGVWc1ZhbGlkYXRpb24uanMnO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RlcywgIE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ2FsaWJyYXRpb25TdGF0ZUNvZGVzLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNDYWxpYnJhdGlvblN0YXRlVnNWYWxpZGF0aW9uIH0gZnJvbSAnLi4vZmhpclZhbHVlU2V0cy9NZXRyaWNDYWxpYnJhdGlvblN0YXRlVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGVzLCAgTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljT3BlcmF0aW9uYWxTdGF0dXNWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY09wZXJhdGlvbmFsU3RhdHVzVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNDb2xvckNvZGVzLCAgTWV0cmljQ29sb3JDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ29sb3JDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljQ29sb3JWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY0NvbG9yVnNWYWxpZGF0aW9uLmpzJztcclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZXRyaWNDYXRlZ29yeUNvZGVzLCAgTWV0cmljQ2F0ZWdvcnlDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWV0cmljQ2F0ZWdvcnlDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWV0cmljQ2F0ZWdvcnlWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01ldHJpY0NhdGVnb3J5VnNWYWxpZGF0aW9uLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERldmljZU1ldHJpY0NhbGlicmF0aW9uIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIERldmljZU1ldHJpY0NhbGlicmF0aW9uQXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB0eXBlIG9mIHRoZSBjYWxpYnJhdGlvbiBtZXRob2QuXHJcbiAgICovXHJcbiAgdHlwZT86IGZoaXIuRmhpckNvZGU8TWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5jYWxpYnJhdGlvbi50eXBlXHJcbiAgICovXHJcbiAgX3R5cGU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgc3RhdGUgb2YgdGhlIGNhbGlicmF0aW9uLlxyXG4gICAqL1xyXG4gIHN0YXRlPzogZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5jYWxpYnJhdGlvbi5zdGF0ZVxyXG4gICAqL1xyXG4gIF9zdGF0ZT86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB0aW1lIGxhc3QgY2FsaWJyYXRpb24gaGFzIGJlZW4gcGVyZm9ybWVkLlxyXG4gICAqL1xyXG4gIHRpbWU/OiBmaGlyLkZoaXJJbnN0YW50fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5jYWxpYnJhdGlvbi50aW1lXHJcbiAgICovXHJcbiAgX3RpbWU/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG59XHJcblxyXG4vKipcclxuICogRGVzY3JpYmVzIHRoZSBjYWxpYnJhdGlvbnMgdGhhdCBoYXZlIGJlZW4gcGVyZm9ybWVkIG9yIHRoYXQgYXJlIHJlcXVpcmVkIHRvIGJlIHBlcmZvcm1lZC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBEZXZpY2VNZXRyaWNDYWxpYnJhdGlvbiBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0RldmljZU1ldHJpY0NhbGlicmF0aW9uJztcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHR5cGUgb2YgdGhlIGNhbGlicmF0aW9uIG1ldGhvZC5cclxuICAgKi9cclxuICBwdWJsaWMgdHlwZT86IGZoaXIuRmhpckNvZGU8TWV0cmljQ2FsaWJyYXRpb25UeXBlQ29kZVR5cGU+fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHN0YXRlIG9mIHRoZSBjYWxpYnJhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGU/OiBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RlVHlwZT58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdGltZSBsYXN0IGNhbGlicmF0aW9uIGhhcyBiZWVuIHBlcmZvcm1lZC5cclxuICAgKi9cclxuICBwdWJsaWMgdGltZT86IGZoaXIuRmhpckluc3RhbnR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIERldmljZU1ldHJpY0NhbGlicmF0aW9uIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8RGV2aWNlTWV0cmljQ2FsaWJyYXRpb25BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uVHlwZUNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS50eXBlfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ190eXBlJ10pIHtcclxuICAgICAgaWYgKHRoaXMudHlwZSkgeyB0aGlzLnR5cGUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdHlwZSEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblR5cGVDb2RlVHlwZT4oc291cmNlLl90eXBlIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydzdGF0ZSddKSB7IHRoaXMuc3RhdGUgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDYWxpYnJhdGlvblN0YXRlQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLnN0YXRlfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19zdGF0ZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLnN0YXRlKSB7IHRoaXMuc3RhdGUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fc3RhdGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5zdGF0ZSA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhbGlicmF0aW9uU3RhdGVDb2RlVHlwZT4oc291cmNlLl9zdGF0ZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckNvZGU+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndGltZSddKSB7IHRoaXMudGltZSA9IG5ldyBmaGlyLkZoaXJJbnN0YW50KHt2YWx1ZTogc291cmNlLnRpbWV9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3RpbWUnXSkge1xyXG4gICAgICBpZiAodGhpcy50aW1lKSB7IHRoaXMudGltZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl90aW1lISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudGltZSA9IG5ldyBmaGlyLkZoaXJJbnN0YW50KHNvdXJjZS5fdGltZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckluc3RhbnRBcmdzPik7IH1cclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdEZXZpY2VNZXRyaWMuY2FsaWJyYXRpb24nIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TVigndHlwZScsZXhwLCdNZXRyaWNDYWxpYnJhdGlvblR5cGUnLE1ldHJpY0NhbGlicmF0aW9uVHlwZVZzVmFsaWRhdGlvbiwncicpKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TVignc3RhdGUnLGV4cCwnTWV0cmljQ2FsaWJyYXRpb25TdGF0ZScsTWV0cmljQ2FsaWJyYXRpb25TdGF0ZVZzVmFsaWRhdGlvbiwncicpKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCd0aW1lJyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBEZXZpY2VNZXRyaWMgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGV2aWNlTWV0cmljQXJncyBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2VBcmdzIHtcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICByZXNvdXJjZVR5cGU6IFwiRGV2aWNlTWV0cmljXCJ8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdHlwZSBvZiB0aGUgbWV0cmljLiBGb3IgZXhhbXBsZTogSGVhcnQgUmF0ZSwgUEVFUCBTZXR0aW5nLCBldGMuXHJcbiAgICovXHJcbiAgdHlwZTogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB1bmlxdWUgaWRlbnRpZmljYXRpb24gb2YgdGhpcyBtZXRyaWMgdGhhdCBoYXMgYmVlbiBhc3NpZ25lZCBieSB0aGUgZGV2aWNlIG9yIGdhdGV3YXkgc29mdHdhcmUuIEZvciBleGFtcGxlOiBoYW5kbGUgSUQuICBJdCBzaG91bGQgYmUgbm90ZWQgdGhhdCBpbiBvcmRlciB0byBtYWtlIHRoZSBpZGVudGlmaWVyIHVuaXF1ZSwgdGhlIHN5c3RlbSBlbGVtZW50IG9mIHRoZSBpZGVudGlmaWVyIHNob3VsZCBiZSBzZXQgdG8gdGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBkZXZpY2UuXHJcbiAgICovXHJcbiAgaWRlbnRpZmllcjogZmhpci5JZGVudGlmaWVyQXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdW5pdCB0aGF0IGFuIG9ic2VydmVkIHZhbHVlIGRldGVybWluZWQgZm9yIHRoaXMgbWV0cmljIHdpbGwgaGF2ZS4gRm9yIGV4YW1wbGU6IFBlcmNlbnQsIFNlY29uZHMsIGV0Yy5cclxuICAgKi9cclxuICB1bml0PzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxpbmsgdG8gdGhlICBEZXZpY2UgdGhhdCB0aGlzIERldmljZU1ldHJpYyBiZWxvbmdzIHRvIGFuZCB0aGF0IGNvbnRhaW5zIGFkbWluaXN0cmF0aXZlIGRldmljZSBpbmZvcm1hdGlvbiBzdWNoIGFzIG1hbnVmYWN0dXJlLCBzZXJpYWwgbnVtYmVyLCBldGMuXHJcbiAgICovXHJcbiAgc291cmNlPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxpbmsgdG8gdGhlICBEZXZpY2VDb21wb25lbnQgdGhhdCB0aGlzIERldmljZU1ldHJpYyBiZWxvbmdzIHRvIGFuZCB0aGF0IHByb3ZpZGUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGxvY2F0aW9uIG9mIHRoaXMgRGV2aWNlTWV0cmljIGluIHRoZSBjb250YWlubWVudCBzdHJ1Y3R1cmUgb2YgdGhlIHBhcmVudCBEZXZpY2UuIEFuIGV4YW1wbGUgd291bGQgYmUgYSBEZXZpY2VDb21wb25lbnQgdGhhdCByZXByZXNlbnRzIGEgQ2hhbm5lbC4gVGhpcyByZWZlcmVuY2UgY2FuIGJlIHVzZWQgYnkgYSBjbGllbnQgYXBwbGljYXRpb24gdG8gZGlzdGluZ3Vpc2ggRGV2aWNlTWV0cmljcyB0aGF0IGhhdmUgdGhlIHNhbWUgdHlwZSwgYnV0IHNob3VsZCBiZSBpbnRlcnByZXRlZCBiYXNlZCBvbiB0aGVpciBjb250YWlubWVudCBsb2NhdGlvbi5cclxuICAgKi9cclxuICBwYXJlbnQ/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRlcyBjdXJyZW50IG9wZXJhdGlvbmFsIHN0YXRlIG9mIHRoZSBkZXZpY2UuIEZvciBleGFtcGxlOiBPbiwgT2ZmLCBTdGFuZGJ5LCBldGMuXHJcbiAgICovXHJcbiAgb3BlcmF0aW9uYWxTdGF0dXM/OiBmaGlyLkZoaXJDb2RlPE1ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kZVR5cGU+fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZU1ldHJpYy5vcGVyYXRpb25hbFN0YXR1c1xyXG4gICAqL1xyXG4gIF9vcGVyYXRpb25hbFN0YXR1cz86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBjb2xvciByZXByZXNlbnRhdGlvbiBmb3IgdGhlIG1ldHJpYy4gVGhpcyBpcyBvZnRlbiB1c2VkIHRvIGFpZCBjbGluaWNpYW5zIHRvIHRyYWNrIGFuZCBpZGVudGlmeSBwYXJhbWV0ZXIgdHlwZXMgYnkgY29sb3IuIEluIHByYWN0aWNlLCBjb25zaWRlciBhIFBhdGllbnQgTW9uaXRvciB0aGF0IGhhcyBFQ0cvSFIgYW5kIFBsZXRoIGZvciBleGFtcGxlOyB0aGUgcGFyYW1ldGVycyBhcmUgZGlzcGxheWVkIGluIGRpZmZlcmVudCBjaGFyYWN0ZXJpc3RpYyBjb2xvcnMsIHN1Y2ggYXMgSFItYmx1ZSwgQlAtZ3JlZW4sIGFuZCBQUiBhbmQgU3BPMi0gbWFnZW50YS5cclxuICAgKi9cclxuICBjb2xvcj86IGZoaXIuRmhpckNvZGU8TWV0cmljQ29sb3JDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGV2aWNlTWV0cmljLmNvbG9yXHJcbiAgICovXHJcbiAgX2NvbG9yPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgdGhlIGNhdGVnb3J5IG9mIHRoZSBvYnNlcnZhdGlvbiBnZW5lcmF0aW9uIHByb2Nlc3MuIEEgRGV2aWNlTWV0cmljIGNhbiBiZSBmb3IgZXhhbXBsZSBhIHNldHRpbmcsIG1lYXN1cmVtZW50LCBvciBjYWxjdWxhdGlvbi5cclxuICAgKi9cclxuICBjYXRlZ29yeTogZmhpci5GaGlyQ29kZTxNZXRyaWNDYXRlZ29yeUNvZGVUeXBlPnxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBEZXZpY2VNZXRyaWMuY2F0ZWdvcnlcclxuICAgKi9cclxuICBfY2F0ZWdvcnk/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lLiBUaGlzIGlzIG5vdCBuZWNlc3NhcmlseSB0aGUgc2FtZSBhcyB0aGUgdXBkYXRlIHBlcmlvZC4gVGhlIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSBjYW4gcmFuZ2UgZnJvbSBtaWxsaXNlY29uZHMgdXAgdG8gaG91cnMuIEFuIGV4YW1wbGUgZm9yIGEgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lIGluIHRoZSByYW5nZSBvZiBtaWxsaXNlY29uZHMgaXMgdGhlIHNhbXBsaW5nIHJhdGUgb2YgYW4gRUNHLiBBbiBleGFtcGxlIGZvciBhIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSBpbiB0aGUgcmFuZ2Ugb2YgaG91cnMgaXMgYSBOSUJQIHRoYXQgaXMgdHJpZ2dlcmVkIGF1dG9tYXRpY2FsbHkgZXZlcnkgaG91ci4gVGhlIHVwZGF0ZSBwZXJpb2QgbWF5IGJlIGRpZmZlcmVudCB0aGFuIHRoZSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUsIGlmIHRoZSBkZXZpY2UgZG9lcyBub3QgdXBkYXRlIHRoZSBwdWJsaXNoZWQgb2JzZXJ2ZWQgdmFsdWUgd2l0aCB0aGUgc2FtZSBmcmVxdWVuY3kgYXMgaXQgd2FzIG1lYXN1cmVkLlxyXG4gICAqL1xyXG4gIG1lYXN1cmVtZW50UGVyaW9kPzogZmhpci5UaW1pbmdBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGNhbGlicmF0aW9ucyB0aGF0IGhhdmUgYmVlbiBwZXJmb3JtZWQgb3IgdGhhdCBhcmUgcmVxdWlyZWQgdG8gYmUgcGVyZm9ybWVkLlxyXG4gICAqL1xyXG4gIGNhbGlicmF0aW9uPzogZmhpci5EZXZpY2VNZXRyaWNDYWxpYnJhdGlvbkFyZ3NbXXx1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXNjcmliZXMgYSBtZWFzdXJlbWVudCwgY2FsY3VsYXRpb24gb3Igc2V0dGluZyBjYXBhYmlsaXR5IG9mIGEgbWVkaWNhbCBkZXZpY2UuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGV2aWNlTWV0cmljIGV4dGVuZHMgZmhpci5Eb21haW5SZXNvdXJjZSB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdEZXZpY2VNZXRyaWMnO1xyXG4gIC8qKlxyXG4gICAqIFJlc291cmNlIFR5cGUgTmFtZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNvdXJjZVR5cGU6IFwiRGV2aWNlTWV0cmljXCI7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB0eXBlIG9mIHRoZSBtZXRyaWMuIEZvciBleGFtcGxlOiBIZWFydCBSYXRlLCBQRUVQIFNldHRpbmcsIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgdHlwZTogZmhpci5Db2RlYWJsZUNvbmNlcHR8bnVsbDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHVuaXF1ZSBpZGVudGlmaWNhdGlvbiBvZiB0aGlzIG1ldHJpYyB0aGF0IGhhcyBiZWVuIGFzc2lnbmVkIGJ5IHRoZSBkZXZpY2Ugb3IgZ2F0ZXdheSBzb2Z0d2FyZS4gRm9yIGV4YW1wbGU6IGhhbmRsZSBJRC4gIEl0IHNob3VsZCBiZSBub3RlZCB0aGF0IGluIG9yZGVyIHRvIG1ha2UgdGhlIGlkZW50aWZpZXIgdW5pcXVlLCB0aGUgc3lzdGVtIGVsZW1lbnQgb2YgdGhlIGlkZW50aWZpZXIgc2hvdWxkIGJlIHNldCB0byB0aGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGRldmljZS5cclxuICAgKi9cclxuICBwdWJsaWMgaWRlbnRpZmllcjogZmhpci5JZGVudGlmaWVyfG51bGw7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSB1bml0IHRoYXQgYW4gb2JzZXJ2ZWQgdmFsdWUgZGV0ZXJtaW5lZCBmb3IgdGhpcyBtZXRyaWMgd2lsbCBoYXZlLiBGb3IgZXhhbXBsZTogUGVyY2VudCwgU2Vjb25kcywgZXRjLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1bml0PzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbGluayB0byB0aGUgIERldmljZSB0aGF0IHRoaXMgRGV2aWNlTWV0cmljIGJlbG9uZ3MgdG8gYW5kIHRoYXQgY29udGFpbnMgYWRtaW5pc3RyYXRpdmUgZGV2aWNlIGluZm9ybWF0aW9uIHN1Y2ggYXMgbWFudWZhY3R1cmUsIHNlcmlhbCBudW1iZXIsIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgc291cmNlPzogZmhpci5SZWZlcmVuY2V8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbGluayB0byB0aGUgIERldmljZUNvbXBvbmVudCB0aGF0IHRoaXMgRGV2aWNlTWV0cmljIGJlbG9uZ3MgdG8gYW5kIHRoYXQgcHJvdmlkZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgbG9jYXRpb24gb2YgdGhpcyBEZXZpY2VNZXRyaWMgaW4gdGhlIGNvbnRhaW5tZW50IHN0cnVjdHVyZSBvZiB0aGUgcGFyZW50IERldmljZS4gQW4gZXhhbXBsZSB3b3VsZCBiZSBhIERldmljZUNvbXBvbmVudCB0aGF0IHJlcHJlc2VudHMgYSBDaGFubmVsLiBUaGlzIHJlZmVyZW5jZSBjYW4gYmUgdXNlZCBieSBhIGNsaWVudCBhcHBsaWNhdGlvbiB0byBkaXN0aW5ndWlzaCBEZXZpY2VNZXRyaWNzIHRoYXQgaGF2ZSB0aGUgc2FtZSB0eXBlLCBidXQgc2hvdWxkIGJlIGludGVycHJldGVkIGJhc2VkIG9uIHRoZWlyIGNvbnRhaW5tZW50IGxvY2F0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXJlbnQ/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIGN1cnJlbnQgb3BlcmF0aW9uYWwgc3RhdGUgb2YgdGhlIGRldmljZS4gRm9yIGV4YW1wbGU6IE9uLCBPZmYsIFN0YW5kYnksIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgb3BlcmF0aW9uYWxTdGF0dXM/OiBmaGlyLkZoaXJDb2RlPE1ldHJpY09wZXJhdGlvbmFsU3RhdHVzQ29kZVR5cGU+fHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGNvbG9yIHJlcHJlc2VudGF0aW9uIGZvciB0aGUgbWV0cmljLiBUaGlzIGlzIG9mdGVuIHVzZWQgdG8gYWlkIGNsaW5pY2lhbnMgdG8gdHJhY2sgYW5kIGlkZW50aWZ5IHBhcmFtZXRlciB0eXBlcyBieSBjb2xvci4gSW4gcHJhY3RpY2UsIGNvbnNpZGVyIGEgUGF0aWVudCBNb25pdG9yIHRoYXQgaGFzIEVDRy9IUiBhbmQgUGxldGggZm9yIGV4YW1wbGU7IHRoZSBwYXJhbWV0ZXJzIGFyZSBkaXNwbGF5ZWQgaW4gZGlmZmVyZW50IGNoYXJhY3RlcmlzdGljIGNvbG9ycywgc3VjaCBhcyBIUi1ibHVlLCBCUC1ncmVlbiwgYW5kIFBSIGFuZCBTcE8yLSBtYWdlbnRhLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb2xvcj86IGZoaXIuRmhpckNvZGU8TWV0cmljQ29sb3JDb2RlVHlwZT58dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEluZGljYXRlcyB0aGUgY2F0ZWdvcnkgb2YgdGhlIG9ic2VydmF0aW9uIGdlbmVyYXRpb24gcHJvY2Vzcy4gQSBEZXZpY2VNZXRyaWMgY2FuIGJlIGZvciBleGFtcGxlIGEgc2V0dGluZywgbWVhc3VyZW1lbnQsIG9yIGNhbGN1bGF0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjYXRlZ29yeTogZmhpci5GaGlyQ29kZTxNZXRyaWNDYXRlZ29yeUNvZGVUeXBlPnxudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lLiBUaGlzIGlzIG5vdCBuZWNlc3NhcmlseSB0aGUgc2FtZSBhcyB0aGUgdXBkYXRlIHBlcmlvZC4gVGhlIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSBjYW4gcmFuZ2UgZnJvbSBtaWxsaXNlY29uZHMgdXAgdG8gaG91cnMuIEFuIGV4YW1wbGUgZm9yIGEgbWVhc3VyZW1lbnQgcmVwZXRpdGlvbiB0aW1lIGluIHRoZSByYW5nZSBvZiBtaWxsaXNlY29uZHMgaXMgdGhlIHNhbXBsaW5nIHJhdGUgb2YgYW4gRUNHLiBBbiBleGFtcGxlIGZvciBhIG1lYXN1cmVtZW50IHJlcGV0aXRpb24gdGltZSBpbiB0aGUgcmFuZ2Ugb2YgaG91cnMgaXMgYSBOSUJQIHRoYXQgaXMgdHJpZ2dlcmVkIGF1dG9tYXRpY2FsbHkgZXZlcnkgaG91ci4gVGhlIHVwZGF0ZSBwZXJpb2QgbWF5IGJlIGRpZmZlcmVudCB0aGFuIHRoZSBtZWFzdXJlbWVudCByZXBldGl0aW9uIHRpbWUsIGlmIHRoZSBkZXZpY2UgZG9lcyBub3QgdXBkYXRlIHRoZSBwdWJsaXNoZWQgb2JzZXJ2ZWQgdmFsdWUgd2l0aCB0aGUgc2FtZSBmcmVxdWVuY3kgYXMgaXQgd2FzIG1lYXN1cmVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBtZWFzdXJlbWVudFBlcmlvZD86IGZoaXIuVGltaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGNhbGlicmF0aW9ucyB0aGF0IGhhdmUgYmVlbiBwZXJmb3JtZWQgb3IgdGhhdCBhcmUgcmVxdWlyZWQgdG8gYmUgcGVyZm9ybWVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjYWxpYnJhdGlvbjogZmhpci5EZXZpY2VNZXRyaWNDYWxpYnJhdGlvbltdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIERldmljZU1ldHJpYyAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPERldmljZU1ldHJpY0FyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdEZXZpY2VNZXRyaWMnO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UudHlwZSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydpZGVudGlmaWVyJ10pIHsgdGhpcy5pZGVudGlmaWVyID0gbmV3IGZoaXIuSWRlbnRpZmllcihzb3VyY2UuaWRlbnRpZmllcik7IH1cclxuICAgIGVsc2UgeyB0aGlzLmlkZW50aWZpZXIgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWyd1bml0J10pIHsgdGhpcy51bml0ID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS51bml0KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc291cmNlJ10pIHsgdGhpcy5zb3VyY2UgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLnNvdXJjZSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3BhcmVudCddKSB7IHRoaXMucGFyZW50ID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5wYXJlbnQpOyB9XHJcbiAgICBpZiAoc291cmNlWydvcGVyYXRpb25hbFN0YXR1cyddKSB7IHRoaXMub3BlcmF0aW9uYWxTdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5vcGVyYXRpb25hbFN0YXR1c30pOyB9XHJcbiAgICBpZiAoc291cmNlWydfb3BlcmF0aW9uYWxTdGF0dXMnXSkge1xyXG4gICAgICBpZiAodGhpcy5vcGVyYXRpb25hbFN0YXR1cykgeyB0aGlzLm9wZXJhdGlvbmFsU3RhdHVzLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX29wZXJhdGlvbmFsU3RhdHVzISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMub3BlcmF0aW9uYWxTdGF0dXMgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNPcGVyYXRpb25hbFN0YXR1c0NvZGVUeXBlPihzb3VyY2UuX29wZXJhdGlvbmFsU3RhdHVzIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydjb2xvciddKSB7IHRoaXMuY29sb3IgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDb2xvckNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5jb2xvcn0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfY29sb3InXSkge1xyXG4gICAgICBpZiAodGhpcy5jb2xvcikgeyB0aGlzLmNvbG9yLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2NvbG9yISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuY29sb3IgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDb2xvckNvZGVUeXBlPihzb3VyY2UuX2NvbG9yIGFzIFBhcnRpYWw8Zmhpci5GaGlyQ29kZT4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydjYXRlZ29yeSddKSB7IHRoaXMuY2F0ZWdvcnkgPSBuZXcgZmhpci5GaGlyQ29kZTxNZXRyaWNDYXRlZ29yeUNvZGVUeXBlPih7dmFsdWU6IHNvdXJjZS5jYXRlZ29yeX0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5jYXRlZ29yeSA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ19jYXRlZ29yeSddKSB7XHJcbiAgICAgIGlmICh0aGlzLmNhdGVnb3J5KSB7IHRoaXMuY2F0ZWdvcnkuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fY2F0ZWdvcnkhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5jYXRlZ29yeSA9IG5ldyBmaGlyLkZoaXJDb2RlPE1ldHJpY0NhdGVnb3J5Q29kZVR5cGU+KHNvdXJjZS5fY2F0ZWdvcnkgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ21lYXN1cmVtZW50UGVyaW9kJ10pIHsgdGhpcy5tZWFzdXJlbWVudFBlcmlvZCA9IG5ldyBmaGlyLlRpbWluZyhzb3VyY2UubWVhc3VyZW1lbnRQZXJpb2QpOyB9XHJcbiAgICBpZiAoc291cmNlWydjYWxpYnJhdGlvbiddKSB7IHRoaXMuY2FsaWJyYXRpb24gPSBzb3VyY2UuY2FsaWJyYXRpb24ubWFwKCh4KSA9PiBuZXcgZmhpci5EZXZpY2VNZXRyaWNDYWxpYnJhdGlvbih4KSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLmNhbGlicmF0aW9uID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3M6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdEZXZpY2VNZXRyaWMnIH1cclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJTKCd0eXBlJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudlJTKCdpZGVudGlmaWVyJyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCd1bml0JyxleHApKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TKCdzb3VyY2UnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T1MoJ3BhcmVudCcsZXhwKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPU1YoJ29wZXJhdGlvbmFsU3RhdHVzJyxleHAsJ01ldHJpY09wZXJhdGlvbmFsU3RhdHVzJyxNZXRyaWNPcGVyYXRpb25hbFN0YXR1c1ZzVmFsaWRhdGlvbiwncicpKTtcclxuICAgIGlzcy5wdXNoKC4uLnRoaXMudk9TVignY29sb3InLGV4cCwnTWV0cmljQ29sb3InLE1ldHJpY0NvbG9yVnNWYWxpZGF0aW9uLCdyJykpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52UlNWKCdjYXRlZ29yeScsZXhwLCdNZXRyaWNDYXRlZ29yeScsTWV0cmljQ2F0ZWdvcnlWc1ZhbGlkYXRpb24sJ3InKSk7XHJcbiAgICBpc3MucHVzaCguLi50aGlzLnZPUygnbWVhc3VyZW1lbnRQZXJpb2QnLGV4cCkpO1xyXG4gICAgaXNzLnB1c2goLi4udGhpcy52T0EoJ2NhbGlicmF0aW9uJyxleHApKTtcclxuICAgIHJldHVybiBpc3M7XHJcbiAgfVxyXG59XHJcbiJdfQ==