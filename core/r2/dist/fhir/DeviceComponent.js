// <auto-generated/>
// Contents of: hl7.fhir.r2.core version: 1.0.2
// Minimum TypeScript Version: 3.7
// FHIR Resource: DeviceComponent
import * as fhir from '../fhir.js';
// @ts-ignore
import { MeasurementPrincipleVsValidation } from '../fhirValueSets/MeasurementPrincipleVsValidation.js';
/**
 * Describes the production specification such as component revision, serial number, etc.
 */
export class DeviceComponentProductionSpecification extends fhir.BackboneElement {
    /**
     * Default constructor for DeviceComponentProductionSpecification - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['specType']) {
            this.specType = new fhir.CodeableConcept(source.specType);
        }
        if (source['componentId']) {
            this.componentId = new fhir.Identifier(source.componentId);
        }
        if (source['productionSpec']) {
            this.productionSpec = new fhir.FhirString({ value: source.productionSpec });
        }
        if (source['_productionSpec']) {
            if (this.productionSpec) {
                this.productionSpec.addExtendedProperties(source._productionSpec);
            }
            else {
                this.productionSpec = new fhir.FhirString(source._productionSpec);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'DeviceComponent.productionSpecification';
        }
        this.vOS('specType', exp);
        this.vOS('componentId', exp);
        this.vOS('productionSpec', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DeviceComponentProductionSpecification._fts_dataType = 'DeviceComponentProductionSpecification';
/**
 * Describes the characteristics, operational status and capabilities of a medical-related component of a medical device.
 */
export class DeviceComponent extends fhir.DomainResource {
    /**
     * Default constructor for DeviceComponent - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'DeviceComponent';
        if (source['type']) {
            this.type = new fhir.CodeableConcept(source.type);
        }
        else {
            this.type = null;
        }
        if (source['identifier']) {
            this.identifier = new fhir.Identifier(source.identifier);
        }
        else {
            this.identifier = null;
        }
        if (source['lastSystemChange']) {
            this.lastSystemChange = new fhir.FhirInstant({ value: source.lastSystemChange });
        }
        else {
            this.lastSystemChange = null;
        }
        if (source['_lastSystemChange']) {
            if (this.lastSystemChange) {
                this.lastSystemChange.addExtendedProperties(source._lastSystemChange);
            }
            else {
                this.lastSystemChange = new fhir.FhirInstant(source._lastSystemChange);
            }
        }
        if (source['source']) {
            this.source = new fhir.Reference(source.source);
        }
        if (source['parent']) {
            this.parent = new fhir.Reference(source.parent);
        }
        if (source['operationalStatus']) {
            this.operationalStatus = source.operationalStatus.map((x) => new fhir.CodeableConcept(x));
        }
        else {
            this.operationalStatus = [];
        }
        if (source['parameterGroup']) {
            this.parameterGroup = new fhir.CodeableConcept(source.parameterGroup);
        }
        if (source['measurementPrinciple']) {
            this.measurementPrinciple = new fhir.FhirCode({ value: source.measurementPrinciple });
        }
        if (source['_measurementPrinciple']) {
            if (this.measurementPrinciple) {
                this.measurementPrinciple.addExtendedProperties(source._measurementPrinciple);
            }
            else {
                this.measurementPrinciple = new fhir.FhirCode(source._measurementPrinciple);
            }
        }
        if (source['productionSpecification']) {
            this.productionSpecification = source.productionSpecification.map((x) => new fhir.DeviceComponentProductionSpecification(x));
        }
        else {
            this.productionSpecification = [];
        }
        if (source['languageCode']) {
            this.languageCode = new fhir.CodeableConcept(source.languageCode);
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'DeviceComponent';
        }
        this.vRS('resourceType', exp);
        this.vRS('type', exp);
        this.vRS('identifier', exp);
        this.vRS('lastSystemChange', exp);
        this.vOS('source', exp);
        this.vOS('parent', exp);
        this.vOA('operationalStatus', exp);
        this.vOS('parameterGroup', exp);
        this.vOSV('measurementPrinciple', exp, 'MeasurementPrinciple', MeasurementPrincipleVsValidation, 'r');
        this.vOA('productionSpecification', exp);
        this.vOS('languageCode', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
DeviceComponent._fts_dataType = 'DeviceComponent';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGV2aWNlQ29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsiZmhpci9EZXZpY2VDb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0JBQW9CO0FBQ3BCLCtDQUErQztBQUMvQyxrQ0FBa0M7QUFDbEMsaUNBQWlDO0FBRWpDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBSW5DLGFBQWE7QUFDYixPQUFPLEVBQUUsZ0NBQWdDLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQXVCeEc7O0dBRUc7QUFDSCxNQUFNLE9BQU8sc0NBQXVDLFNBQVEsSUFBSSxDQUFDLGVBQWU7SUFpQjlFOztPQUVHO0lBQ0gsWUFBWSxTQUE2RCxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUNuSCxLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQUU7UUFDdEYsSUFBSSxNQUFNLENBQUMsYUFBYSxDQUFDLEVBQUU7WUFBRSxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7U0FBRTtRQUMxRixJQUFJLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLGNBQWMsRUFBQyxDQUFDLENBQUM7U0FBRTtRQUM1RyxJQUFJLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFO1lBQzdCLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtnQkFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxl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ZXNDb250ZW50IjpbIi8vIDxhdXRvLWdlbmVyYXRlZC8+XHJcbi8vIENvbnRlbnRzIG9mOiBobDcuZmhpci5yMi5jb3JlIHZlcnNpb246IDEuMC4yXHJcbi8vIE1pbmltdW0gVHlwZVNjcmlwdCBWZXJzaW9uOiAzLjdcclxuLy8gRkhJUiBSZXNvdXJjZTogRGV2aWNlQ29tcG9uZW50XHJcblxyXG5pbXBvcnQgKiBhcyBmaGlyIGZyb20gJy4uL2ZoaXIuanMnO1xyXG5cclxuLy8gQHRzLWlnbm9yZVxyXG5pbXBvcnQgeyBNZWFzdXJlbWVudFByaW5jaXBsZUNvZGVzLCAgTWVhc3VyZW1lbnRQcmluY2lwbGVDb2RlVHlwZSB9IGZyb20gJy4uL2ZoaXJWYWx1ZVNldHMvTWVhc3VyZW1lbnRQcmluY2lwbGVDb2Rlcy5qcyc7XHJcbi8vIEB0cy1pZ25vcmVcclxuaW1wb3J0IHsgTWVhc3VyZW1lbnRQcmluY2lwbGVWc1ZhbGlkYXRpb24gfSBmcm9tICcuLi9maGlyVmFsdWVTZXRzL01lYXN1cmVtZW50UHJpbmNpcGxlVnNWYWxpZGF0aW9uLmpzJztcclxuLyoqXHJcbiAqIFZhbGlkIGFyZ3VtZW50cyBmb3IgdGhlIERldmljZUNvbXBvbmVudFByb2R1Y3Rpb25TcGVjaWZpY2F0aW9uIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIERldmljZUNvbXBvbmVudFByb2R1Y3Rpb25TcGVjaWZpY2F0aW9uQXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBzcGVjaWZpY2F0aW9uIHR5cGUsIHN1Y2ggYXMsIHNlcmlhbCBudW1iZXIsIHBhcnQgbnVtYmVyLCBoYXJkd2FyZSByZXZpc2lvbiwgc29mdHdhcmUgcmV2aXNpb24sIGV0Yy5cclxuICAgKi9cclxuICBzcGVjVHlwZT86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBpbnRlcm5hbCBjb21wb25lbnQgdW5pcXVlIGlkZW50aWZpY2F0aW9uLiBUaGlzIGlzIGEgcHJvdmlzaW9uIGZvciBtYW51ZmFjdHVyZSBzcGVjaWZpYyBzdGFuZGFyZCBjb21wb25lbnRzIHVzaW5nIGEgcHJpdmF0ZSBPSUQuIDExMDczLTEwMTAxIGhhcyBhIHBhcnRpdGlvbiBmb3IgcHJpdmF0ZSBPSUQgc2VtYW50aWMgdGhhdCB0aGUgbWFudWZhY3R1cmUgY2FuIG1ha2UgdXNlIG9mLlxyXG4gICAqL1xyXG4gIGNvbXBvbmVudElkPzogZmhpci5JZGVudGlmaWVyQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBwcmludGFibGUgc3RyaW5nIGRlZmluaW5nIHRoZSBjb21wb25lbnQuXHJcbiAgICovXHJcbiAgcHJvZHVjdGlvblNwZWM/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGV2aWNlQ29tcG9uZW50LnByb2R1Y3Rpb25TcGVjaWZpY2F0aW9uLnByb2R1Y3Rpb25TcGVjXHJcbiAgICovXHJcbiAgX3Byb2R1Y3Rpb25TcGVjPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxufVxyXG5cclxuLyoqXHJcbiAqIERlc2NyaWJlcyB0aGUgcHJvZHVjdGlvbiBzcGVjaWZpY2F0aW9uIHN1Y2ggYXMgY29tcG9uZW50IHJldmlzaW9uLCBzZXJpYWwgbnVtYmVyLCBldGMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGV2aWNlQ29tcG9uZW50UHJvZHVjdGlvblNwZWNpZmljYXRpb24gZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdEZXZpY2VDb21wb25lbnRQcm9kdWN0aW9uU3BlY2lmaWNhdGlvbic7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBzcGVjaWZpY2F0aW9uIHR5cGUsIHN1Y2ggYXMsIHNlcmlhbCBudW1iZXIsIHBhcnQgbnVtYmVyLCBoYXJkd2FyZSByZXZpc2lvbiwgc29mdHdhcmUgcmV2aXNpb24sIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgc3BlY1R5cGU/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdHx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBpbnRlcm5hbCBjb21wb25lbnQgdW5pcXVlIGlkZW50aWZpY2F0aW9uLiBUaGlzIGlzIGEgcHJvdmlzaW9uIGZvciBtYW51ZmFjdHVyZSBzcGVjaWZpYyBzdGFuZGFyZCBjb21wb25lbnRzIHVzaW5nIGEgcHJpdmF0ZSBPSUQuIDExMDczLTEwMTAxIGhhcyBhIHBhcnRpdGlvbiBmb3IgcHJpdmF0ZSBPSUQgc2VtYW50aWMgdGhhdCB0aGUgbWFudWZhY3R1cmUgY2FuIG1ha2UgdXNlIG9mLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb21wb25lbnRJZD86IGZoaXIuSWRlbnRpZmllcnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBwcmludGFibGUgc3RyaW5nIGRlZmluaW5nIHRoZSBjb21wb25lbnQuXHJcbiAgICovXHJcbiAgcHVibGljIHByb2R1Y3Rpb25TcGVjPzogZmhpci5GaGlyU3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBEZXZpY2VDb21wb25lbnRQcm9kdWN0aW9uU3BlY2lmaWNhdGlvbiAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPERldmljZUNvbXBvbmVudFByb2R1Y3Rpb25TcGVjaWZpY2F0aW9uQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3NwZWNUeXBlJ10pIHsgdGhpcy5zcGVjVHlwZSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2Uuc3BlY1R5cGUpOyB9XHJcbiAgICBpZiAoc291cmNlWydjb21wb25lbnRJZCddKSB7IHRoaXMuY29tcG9uZW50SWQgPSBuZXcgZmhpci5JZGVudGlmaWVyKHNvdXJjZS5jb21wb25lbnRJZCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ3Byb2R1Y3Rpb25TcGVjJ10pIHsgdGhpcy5wcm9kdWN0aW9uU3BlYyA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoe3ZhbHVlOiBzb3VyY2UucHJvZHVjdGlvblNwZWN9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3Byb2R1Y3Rpb25TcGVjJ10pIHtcclxuICAgICAgaWYgKHRoaXMucHJvZHVjdGlvblNwZWMpIHsgdGhpcy5wcm9kdWN0aW9uU3BlYy5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9wcm9kdWN0aW9uU3BlYyEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnByb2R1Y3Rpb25TcGVjID0gbmV3IGZoaXIuRmhpclN0cmluZyhzb3VyY2UuX3Byb2R1Y3Rpb25TcGVjIGFzIFBhcnRpYWw8Zmhpci5GaGlyU3RyaW5nQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnRGV2aWNlQ29tcG9uZW50LnByb2R1Y3Rpb25TcGVjaWZpY2F0aW9uJyB9XHJcbiAgICB0aGlzLnZPUygnc3BlY1R5cGUnLGV4cClcclxuICAgIHRoaXMudk9TKCdjb21wb25lbnRJZCcsZXhwKVxyXG4gICAgdGhpcy52T1MoJ3Byb2R1Y3Rpb25TcGVjJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgRGV2aWNlQ29tcG9uZW50IHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIERldmljZUNvbXBvbmVudEFyZ3MgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlQXJncyB7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcmVzb3VyY2VUeXBlOiBcIkRldmljZUNvbXBvbmVudFwifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHNwZWNpZmljIGNvbXBvbmVudCB0eXBlIGFzIGRlZmluZWQgaW4gdGhlIG9iamVjdC1vcmllbnRlZCBvciBtZXRyaWMgbm9tZW5jbGF0dXJlIHBhcnRpdGlvbi5cclxuICAgKi9cclxuICB0eXBlOiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxvY2FsIGFzc2lnbmVkIHVuaXF1ZSBpZGVudGlmaWNhdGlvbiBieSB0aGUgc29mdHdhcmUuIEZvciBleGFtcGxlOiBoYW5kbGUgSUQuXHJcbiAgICovXHJcbiAgaWRlbnRpZmllcjogZmhpci5JZGVudGlmaWVyQXJnc3xudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdGltZXN0YW1wIGZvciB0aGUgbW9zdCByZWNlbnQgc3lzdGVtIGNoYW5nZSB3aGljaCBpbmNsdWRlcyBkZXZpY2UgY29uZmlndXJhdGlvbiBvciBzZXR0aW5nIGNoYW5nZS5cclxuICAgKi9cclxuICBsYXN0U3lzdGVtQ2hhbmdlOiBmaGlyLkZoaXJJbnN0YW50fHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IERldmljZUNvbXBvbmVudC5sYXN0U3lzdGVtQ2hhbmdlXHJcbiAgICovXHJcbiAgX2xhc3RTeXN0ZW1DaGFuZ2U/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbGluayB0byB0aGUgc291cmNlIERldmljZSB0aGF0IGNvbnRhaW5zIGFkbWluaXN0cmF0aXZlIGRldmljZSBpbmZvcm1hdGlvbiBzdWNoIGFzIG1hbnVmYWN0dXJlLCBzZXJpYWwgbnVtYmVyLCBldGMuXHJcbiAgICovXHJcbiAgc291cmNlPzogZmhpci5SZWZlcmVuY2VBcmdzfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxpbmsgdG8gdGhlIHBhcmVudCByZXNvdXJjZS4gRm9yIGV4YW1wbGU6IENoYW5uZWwgaXMgbGlua2VkIHRvIGl0cyBWTUQgcGFyZW50LlxyXG4gICAqL1xyXG4gIHBhcmVudD86IGZoaXIuUmVmZXJlbmNlQXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIGN1cnJlbnQgb3BlcmF0aW9uYWwgc3RhdHVzIG9mIHRoZSBkZXZpY2UuIEZvciBleGFtcGxlOiBPbiwgT2ZmLCBTdGFuZGJ5LCBldGMuXHJcbiAgICovXHJcbiAgb3BlcmF0aW9uYWxTdGF0dXM/OiBmaGlyLkNvZGVhYmxlQ29uY2VwdEFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBwYXJhbWV0ZXIgZ3JvdXAgc3VwcG9ydGVkIGJ5IHRoZSBjdXJyZW50IGRldmljZSBjb21wb25lbnQgdGhhdCBpcyBiYXNlZCBvbiBzb21lIG5vbWVuY2xhdHVyZSwgZS5nLiBjYXJkaW92YXNjdWxhci5cclxuICAgKi9cclxuICBwYXJhbWV0ZXJHcm91cD86IGZoaXIuQ29kZWFibGVDb25jZXB0QXJnc3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBwaHlzaWNhbCBwcmluY2lwbGUgb2YgdGhlIG1lYXN1cmVtZW50LiBGb3IgZXhhbXBsZTogdGhlcm1hbCwgY2hlbWljYWwsIGFjb3VzdGljYWwsIGV0Yy5cclxuICAgKi9cclxuICBtZWFzdXJlbWVudFByaW5jaXBsZT86IGZoaXIuRmhpckNvZGU8TWVhc3VyZW1lbnRQcmluY2lwbGVDb2RlVHlwZT58c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogRGV2aWNlQ29tcG9uZW50Lm1lYXN1cmVtZW50UHJpbmNpcGxlXHJcbiAgICovXHJcbiAgX21lYXN1cmVtZW50UHJpbmNpcGxlPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHByb2R1Y3Rpb24gc3BlY2lmaWNhdGlvbiBzdWNoIGFzIGNvbXBvbmVudCByZXZpc2lvbiwgc2VyaWFsIG51bWJlciwgZXRjLlxyXG4gICAqL1xyXG4gIHByb2R1Y3Rpb25TcGVjaWZpY2F0aW9uPzogZmhpci5EZXZpY2VDb21wb25lbnRQcm9kdWN0aW9uU3BlY2lmaWNhdGlvbkFyZ3NbXXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBsYW5ndWFnZSBjb2RlIGZvciB0aGUgaHVtYW4tcmVhZGFibGUgdGV4dCBzdHJpbmcgcHJvZHVjZWQgYnkgdGhlIGRldmljZS4gVGhpcyBsYW5ndWFnZSBjb2RlIHdpbGwgZm9sbG93IHRoZSBJRVRGIGxhbmd1YWdlIHRhZy4gRXhhbXBsZTogZW4tVVMuXHJcbiAgICovXHJcbiAgbGFuZ3VhZ2VDb2RlPzogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIERlc2NyaWJlcyB0aGUgY2hhcmFjdGVyaXN0aWNzLCBvcGVyYXRpb25hbCBzdGF0dXMgYW5kIGNhcGFiaWxpdGllcyBvZiBhIG1lZGljYWwtcmVsYXRlZCBjb21wb25lbnQgb2YgYSBtZWRpY2FsIGRldmljZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBEZXZpY2VDb21wb25lbnQgZXh0ZW5kcyBmaGlyLkRvbWFpblJlc291cmNlIHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0RldmljZUNvbXBvbmVudCc7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc291cmNlVHlwZTogXCJEZXZpY2VDb21wb25lbnRcIjtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIHNwZWNpZmljIGNvbXBvbmVudCB0eXBlIGFzIGRlZmluZWQgaW4gdGhlIG9iamVjdC1vcmllbnRlZCBvciBtZXRyaWMgbm9tZW5jbGF0dXJlIHBhcnRpdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgdHlwZTogZmhpci5Db2RlYWJsZUNvbmNlcHR8bnVsbDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxvY2FsIGFzc2lnbmVkIHVuaXF1ZSBpZGVudGlmaWNhdGlvbiBieSB0aGUgc29mdHdhcmUuIEZvciBleGFtcGxlOiBoYW5kbGUgSUQuXHJcbiAgICovXHJcbiAgcHVibGljIGlkZW50aWZpZXI6IGZoaXIuSWRlbnRpZmllcnxudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgdGltZXN0YW1wIGZvciB0aGUgbW9zdCByZWNlbnQgc3lzdGVtIGNoYW5nZSB3aGljaCBpbmNsdWRlcyBkZXZpY2UgY29uZmlndXJhdGlvbiBvciBzZXR0aW5nIGNoYW5nZS5cclxuICAgKi9cclxuICBwdWJsaWMgbGFzdFN5c3RlbUNoYW5nZTogZmhpci5GaGlySW5zdGFudHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgbGluayB0byB0aGUgc291cmNlIERldmljZSB0aGF0IGNvbnRhaW5zIGFkbWluaXN0cmF0aXZlIGRldmljZSBpbmZvcm1hdGlvbiBzdWNoIGFzIG1hbnVmYWN0dXJlLCBzZXJpYWwgbnVtYmVyLCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIHNvdXJjZT86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxpbmsgdG8gdGhlIHBhcmVudCByZXNvdXJjZS4gRm9yIGV4YW1wbGU6IENoYW5uZWwgaXMgbGlua2VkIHRvIGl0cyBWTUQgcGFyZW50LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXJlbnQ/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIGN1cnJlbnQgb3BlcmF0aW9uYWwgc3RhdHVzIG9mIHRoZSBkZXZpY2UuIEZvciBleGFtcGxlOiBPbiwgT2ZmLCBTdGFuZGJ5LCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIG9wZXJhdGlvbmFsU3RhdHVzOiBmaGlyLkNvZGVhYmxlQ29uY2VwdFtdO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgcGFyYW1ldGVyIGdyb3VwIHN1cHBvcnRlZCBieSB0aGUgY3VycmVudCBkZXZpY2UgY29tcG9uZW50IHRoYXQgaXMgYmFzZWQgb24gc29tZSBub21lbmNsYXR1cmUsIGUuZy4gY2FyZGlvdmFzY3VsYXIuXHJcbiAgICovXHJcbiAgcHVibGljIHBhcmFtZXRlckdyb3VwPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlc2NyaWJlcyB0aGUgcGh5c2ljYWwgcHJpbmNpcGxlIG9mIHRoZSBtZWFzdXJlbWVudC4gRm9yIGV4YW1wbGU6IHRoZXJtYWwsIGNoZW1pY2FsLCBhY291c3RpY2FsLCBldGMuXHJcbiAgICovXHJcbiAgcHVibGljIG1lYXN1cmVtZW50UHJpbmNpcGxlPzogZmhpci5GaGlyQ29kZTxNZWFzdXJlbWVudFByaW5jaXBsZUNvZGVUeXBlPnx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRGVzY3JpYmVzIHRoZSBwcm9kdWN0aW9uIHNwZWNpZmljYXRpb24gc3VjaCBhcyBjb21wb25lbnQgcmV2aXNpb24sIHNlcmlhbCBudW1iZXIsIGV0Yy5cclxuICAgKi9cclxuICBwdWJsaWMgcHJvZHVjdGlvblNwZWNpZmljYXRpb246IGZoaXIuRGV2aWNlQ29tcG9uZW50UHJvZHVjdGlvblNwZWNpZmljYXRpb25bXTtcclxuICAvKipcclxuICAgKiBEZXNjcmliZXMgdGhlIGxhbmd1YWdlIGNvZGUgZm9yIHRoZSBodW1hbi1yZWFkYWJsZSB0ZXh0IHN0cmluZyBwcm9kdWNlZCBieSB0aGUgZGV2aWNlLiBUaGlzIGxhbmd1YWdlIGNvZGUgd2lsbCBmb2xsb3cgdGhlIElFVEYgbGFuZ3VhZ2UgdGFnLiBFeGFtcGxlOiBlbi1VUy5cclxuICAgKi9cclxuICBwdWJsaWMgbGFuZ3VhZ2VDb2RlPzogZmhpci5Db2RlYWJsZUNvbmNlcHR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIERldmljZUNvbXBvbmVudCAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPERldmljZUNvbXBvbmVudEFyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICB0aGlzLnJlc291cmNlVHlwZSA9ICdEZXZpY2VDb21wb25lbnQnO1xyXG4gICAgaWYgKHNvdXJjZVsndHlwZSddKSB7IHRoaXMudHlwZSA9IG5ldyBmaGlyLkNvZGVhYmxlQ29uY2VwdChzb3VyY2UudHlwZSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnR5cGUgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydpZGVudGlmaWVyJ10pIHsgdGhpcy5pZGVudGlmaWVyID0gbmV3IGZoaXIuSWRlbnRpZmllcihzb3VyY2UuaWRlbnRpZmllcik7IH1cclxuICAgIGVsc2UgeyB0aGlzLmlkZW50aWZpZXIgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydsYXN0U3lzdGVtQ2hhbmdlJ10pIHsgdGhpcy5sYXN0U3lzdGVtQ2hhbmdlID0gbmV3IGZoaXIuRmhpckluc3RhbnQoe3ZhbHVlOiBzb3VyY2UubGFzdFN5c3RlbUNoYW5nZX0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5sYXN0U3lzdGVtQ2hhbmdlID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX2xhc3RTeXN0ZW1DaGFuZ2UnXSkge1xyXG4gICAgICBpZiAodGhpcy5sYXN0U3lzdGVtQ2hhbmdlKSB7IHRoaXMubGFzdFN5c3RlbUNoYW5nZS5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl9sYXN0U3lzdGVtQ2hhbmdlISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMubGFzdFN5c3RlbUNoYW5nZSA9IG5ldyBmaGlyLkZoaXJJbnN0YW50KHNvdXJjZS5fbGFzdFN5c3RlbUNoYW5nZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckluc3RhbnRBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3NvdXJjZSddKSB7IHRoaXMuc291cmNlID0gbmV3IGZoaXIuUmVmZXJlbmNlKHNvdXJjZS5zb3VyY2UpOyB9XHJcbiAgICBpZiAoc291cmNlWydwYXJlbnQnXSkgeyB0aGlzLnBhcmVudCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UucGFyZW50KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnb3BlcmF0aW9uYWxTdGF0dXMnXSkgeyB0aGlzLm9wZXJhdGlvbmFsU3RhdHVzID0gc291cmNlLm9wZXJhdGlvbmFsU3RhdHVzLm1hcCgoeCkgPT4gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMub3BlcmF0aW9uYWxTdGF0dXMgPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsncGFyYW1ldGVyR3JvdXAnXSkgeyB0aGlzLnBhcmFtZXRlckdyb3VwID0gbmV3IGZoaXIuQ29kZWFibGVDb25jZXB0KHNvdXJjZS5wYXJhbWV0ZXJHcm91cCk7IH1cclxuICAgIGlmIChzb3VyY2VbJ21lYXN1cmVtZW50UHJpbmNpcGxlJ10pIHsgdGhpcy5tZWFzdXJlbWVudFByaW5jaXBsZSA9IG5ldyBmaGlyLkZoaXJDb2RlPE1lYXN1cmVtZW50UHJpbmNpcGxlQ29kZVR5cGU+KHt2YWx1ZTogc291cmNlLm1lYXN1cmVtZW50UHJpbmNpcGxlfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19tZWFzdXJlbWVudFByaW5jaXBsZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLm1lYXN1cmVtZW50UHJpbmNpcGxlKSB7IHRoaXMubWVhc3VyZW1lbnRQcmluY2lwbGUuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fbWVhc3VyZW1lbnRQcmluY2lwbGUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5tZWFzdXJlbWVudFByaW5jaXBsZSA9IG5ldyBmaGlyLkZoaXJDb2RlPE1lYXN1cmVtZW50UHJpbmNpcGxlQ29kZVR5cGU+KHNvdXJjZS5fbWVhc3VyZW1lbnRQcmluY2lwbGUgYXMgUGFydGlhbDxmaGlyLkZoaXJDb2RlPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3Byb2R1Y3Rpb25TcGVjaWZpY2F0aW9uJ10pIHsgdGhpcy5wcm9kdWN0aW9uU3BlY2lmaWNhdGlvbiA9IHNvdXJjZS5wcm9kdWN0aW9uU3BlY2lmaWNhdGlvbi5tYXAoKHgpID0+IG5ldyBmaGlyLkRldmljZUNvbXBvbmVudFByb2R1Y3Rpb25TcGVjaWZpY2F0aW9uKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMucHJvZHVjdGlvblNwZWNpZmljYXRpb24gPSBbXTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnbGFuZ3VhZ2VDb2RlJ10pIHsgdGhpcy5sYW5ndWFnZUNvZGUgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLmxhbmd1YWdlQ29kZSk7IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdEZXZpY2VDb21wb25lbnQnIH1cclxuICAgIHRoaXMudlJTKCdyZXNvdXJjZVR5cGUnLGV4cClcclxuICAgIHRoaXMudlJTKCd0eXBlJyxleHApXHJcbiAgICB0aGlzLnZSUygnaWRlbnRpZmllcicsZXhwKVxyXG4gICAgdGhpcy52UlMoJ2xhc3RTeXN0ZW1DaGFuZ2UnLGV4cClcclxuICAgIHRoaXMudk9TKCdzb3VyY2UnLGV4cClcclxuICAgIHRoaXMudk9TKCdwYXJlbnQnLGV4cClcclxuICAgIHRoaXMudk9BKCdvcGVyYXRpb25hbFN0YXR1cycsZXhwKVxyXG4gICAgdGhpcy52T1MoJ3BhcmFtZXRlckdyb3VwJyxleHApXHJcbiAgICB0aGlzLnZPU1YoJ21lYXN1cmVtZW50UHJpbmNpcGxlJyxleHAsJ01lYXN1cmVtZW50UHJpbmNpcGxlJyxNZWFzdXJlbWVudFByaW5jaXBsZVZzVmFsaWRhdGlvbiwncicpXHJcbiAgICB0aGlzLnZPQSgncHJvZHVjdGlvblNwZWNpZmljYXRpb24nLGV4cClcclxuICAgIHRoaXMudk9TKCdsYW5ndWFnZUNvZGUnLGV4cClcclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbiJdfQ==