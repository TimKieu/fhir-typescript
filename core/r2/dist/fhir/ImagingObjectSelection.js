// <auto-generated/>
// Contents of: hl7.fhir.r2.core version: 1.0.2
// Minimum TypeScript Version: 3.7
// FHIR Resource: ImagingObjectSelection
import * as fhir from '../fhir.js';
/**
 * The specific set of frames referenced in this imaging object selection. The URL retrieves the pixel data, and is encapsulated in a multipart MIME response.
 */
export class ImagingObjectSelectionStudySeriesInstanceFrames extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingObjectSelectionStudySeriesInstanceFrames - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['frameNumbers']) {
            this.frameNumbers = source.frameNumbers.map((x) => new fhir.FhirUnsignedInt({ value: x }));
        }
        else {
            this.frameNumbers = [];
        }
        if (source['_frameNumbers']) {
            source._frameNumbers.forEach((x, i) => {
                if (this.frameNumbers.length >= i) {
                    if (x) {
                        this.frameNumbers[i].addExtendedProperties(x);
                    }
                }
                else {
                    if (x) {
                        this.frameNumbers.push(new fhir.FhirUnsignedInt(x));
                    }
                }
            });
        }
        if (source['url']) {
            this.url = new fhir.FhirUri({ value: source.url });
        }
        else {
            this.url = null;
        }
        if (source['_url']) {
            if (this.url) {
                this.url.addExtendedProperties(source._url);
            }
            else {
                this.url = new fhir.FhirUri(source._url);
            }
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingObjectSelection.study.series.instance.frames';
        }
        this.vRA('frameNumbers', exp);
        this.vRS('url', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingObjectSelectionStudySeriesInstanceFrames._fts_dataType = 'ImagingObjectSelectionStudySeriesInstanceFrames';
/**
 * DICOM SOP instances are identified through the UIDs of the study - series - instance hierarchy. This is the instance level identity of the instance in the selection.
 */
export class ImagingObjectSelectionStudySeriesInstance extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingObjectSelectionStudySeriesInstance - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['sopClass']) {
            this.sopClass = new fhir.FhirOid({ value: source.sopClass });
        }
        else {
            this.sopClass = null;
        }
        if (source['_sopClass']) {
            if (this.sopClass) {
                this.sopClass.addExtendedProperties(source._sopClass);
            }
            else {
                this.sopClass = new fhir.FhirOid(source._sopClass);
            }
        }
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
        if (source['url']) {
            this.url = new fhir.FhirUri({ value: source.url });
        }
        else {
            this.url = null;
        }
        if (source['_url']) {
            if (this.url) {
                this.url.addExtendedProperties(source._url);
            }
            else {
                this.url = new fhir.FhirUri(source._url);
            }
        }
        if (source['frames']) {
            this.frames = source.frames.map((x) => new fhir.ImagingObjectSelectionStudySeriesInstanceFrames(x));
        }
        else {
            this.frames = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingObjectSelection.study.series.instance';
        }
        this.vRS('sopClass', exp);
        this.vRS('uid', exp);
        this.vRS('url', exp);
        this.vOA('frames', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingObjectSelectionStudySeriesInstance._fts_dataType = 'ImagingObjectSelectionStudySeriesInstance';
/**
 * DICOM SOP instances are identified through the UIDs of the study - series - instance hierarchy. In addition, the locator at the series level provide a means of retrieving the entire series.
 */
export class ImagingObjectSelectionStudySeries extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingObjectSelectionStudySeries - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
        if (source['url']) {
            this.url = new fhir.FhirUri({ value: source.url });
        }
        if (source['_url']) {
            if (this.url) {
                this.url.addExtendedProperties(source._url);
            }
            else {
                this.url = new fhir.FhirUri(source._url);
            }
        }
        if (source['instance']) {
            this.instance = source.instance.map((x) => new fhir.ImagingObjectSelectionStudySeriesInstance(x));
        }
        else {
            this.instance = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingObjectSelection.study.series';
        }
        this.vOS('uid', exp);
        this.vOS('url', exp);
        this.vRA('instance', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingObjectSelectionStudySeries._fts_dataType = 'ImagingObjectSelectionStudySeries';
/**
 * DICOM SOP instances are identified through the UIDs of the study - series - instance hierarchy. In addition, the locator at the study level provide a means of retrieving the entire study.
 */
export class ImagingObjectSelectionStudy extends fhir.BackboneElement {
    /**
     * Default constructor for ImagingObjectSelectionStudy - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
        if (source['url']) {
            this.url = new fhir.FhirUri({ value: source.url });
        }
        if (source['_url']) {
            if (this.url) {
                this.url.addExtendedProperties(source._url);
            }
            else {
                this.url = new fhir.FhirUri(source._url);
            }
        }
        if (source['imagingStudy']) {
            this.imagingStudy = new fhir.Reference(source.imagingStudy);
        }
        if (source['series']) {
            this.series = source.series.map((x) => new fhir.ImagingObjectSelectionStudySeries(x));
        }
        else {
            this.series = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingObjectSelection.study';
        }
        this.vRS('uid', exp);
        this.vOS('url', exp);
        this.vOS('imagingStudy', exp);
        this.vRA('series', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingObjectSelectionStudy._fts_dataType = 'ImagingObjectSelectionStudy';
/**
 * A manifest of a set of DICOM Service-Object Pair Instances (SOP Instances).  The referenced SOP Instances (images or other content) are for a single patient, and may be from one or more studies. The referenced SOP Instances have been selected for a purpose, such as quality assurance, conference, or consult. Reflecting that range of purposes, typical ImagingObjectSelection resources may include all SOP Instances in a study (perhaps for sharing through a Health Information Exchange); key images from multiple studies (for reference by a referring or treating physician); a multi-frame ultrasound instance ("cine" video clip) and a set of measurements taken from that instance (for inclusion in a teaching file); and so on.
 */
export class ImagingObjectSelection extends fhir.DomainResource {
    /**
     * Default constructor for ImagingObjectSelection - initializes any required elements to null if a value is not provided.
     */
    constructor(source = {}, options = {}) {
        super(source, options);
        this.resourceType = 'ImagingObjectSelection';
        if (source['uid']) {
            this.uid = new fhir.FhirOid({ value: source.uid });
        }
        else {
            this.uid = null;
        }
        if (source['_uid']) {
            if (this.uid) {
                this.uid.addExtendedProperties(source._uid);
            }
            else {
                this.uid = new fhir.FhirOid(source._uid);
            }
        }
        if (source['patient']) {
            this.patient = new fhir.Reference(source.patient);
        }
        else {
            this.patient = null;
        }
        if (source['title']) {
            this.title = new fhir.CodeableConcept(source.title);
        }
        else {
            this.title = null;
        }
        if (source['description']) {
            this.description = new fhir.FhirString({ value: source.description });
        }
        if (source['_description']) {
            if (this.description) {
                this.description.addExtendedProperties(source._description);
            }
            else {
                this.description = new fhir.FhirString(source._description);
            }
        }
        if (source['author']) {
            this.author = new fhir.Reference(source.author);
        }
        if (source['authoringTime']) {
            this.authoringTime = new fhir.FhirDateTime({ value: source.authoringTime });
        }
        if (source['_authoringTime']) {
            if (this.authoringTime) {
                this.authoringTime.addExtendedProperties(source._authoringTime);
            }
            else {
                this.authoringTime = new fhir.FhirDateTime(source._authoringTime);
            }
        }
        if (source['study']) {
            this.study = source.study.map((x) => new fhir.ImagingObjectSelectionStudy(x));
        }
        else {
            this.study = [];
        }
    }
    /**
     * Function to perform basic model validation (e.g., check if required elements are present).
     */
    doModelValidation(exp = '') {
        let issues = super.doModelValidation(exp);
        if (exp === '') {
            exp = 'ImagingObjectSelection';
        }
        this.vRS('resourceType', exp);
        this.vRS('uid', exp);
        this.vRS('patient', exp);
        this.vRS('title', exp);
        this.vOS('description', exp);
        this.vOS('author', exp);
        this.vOS('authoringTime', exp);
        this.vRA('study', exp);
        return issues;
    }
}
/**
 * Mapping of this datatype to a FHIR equivalent
 */
ImagingObjectSelection._fts_dataType = 'ImagingObjectSelection';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSW1hZ2luZ09iamVjdFNlbGVjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbImZoaXIvSW1hZ2luZ09iamVjdFNlbGVjdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvQkFBb0I7QUFDcEIsK0NBQStDO0FBQy9DLGtDQUFrQztBQUNsQyx3Q0FBd0M7QUFFeEMsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUF3Qm5DOztHQUVHO0FBQ0gsTUFBTSxPQUFPLCtDQUFnRCxTQUFRLElBQUksQ0FBQyxlQUFlO0lBYXZGOztPQUVHO0lBQ0gsWUFBWSxTQUFzRSxFQUFFLEVBQUUsVUFBc0MsRUFBRTtRQUM1SCxLQUFLLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZCLElBQUksTUFBTSxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQUUsSUFBSSxDQUFDLFlBQVksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsZUFBZSxDQUFDLEVBQUMsS0FBSyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQztTQUFFO2FBQ3BIO1lBQUUsSUFBSSxDQUFDLFlBQVksR0FBRyxFQUFFLENBQUM7U0FBRTtRQUNoQyxJQUFJLE1BQU0sQ0FBQyxlQUFlLENBQUMsRUFBRTtZQUMzQixNQUFNLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUUsRUFBRTtnQkFDbkMsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUU7b0JBQUUsSUFBSSxDQUFDLEVBQUU7d0JBQUUsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztxQkFBRTtpQkFBRTtxQkFDM0Y7b0JBQUUsSUFBSSxDQUFDLEVBQUU7d0JBQUUsSUFBSSxDQUFD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LGlCQUFpQixDQUFDLE1BQWEsRUFBRTtRQUMvQyxJQUFJLE1BQU0sR0FBbUIsS0FBSyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQzFELElBQUksR0FBRyxLQUFLLEVBQUUsRUFBRTtZQUFFLEdBQUcsR0FBRyx3QkFBd0IsQ0FBQTtTQUFFO1FBQ2xELElBQUksQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzVCLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ25CLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3ZCLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3JCLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzNCLElBQUksQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzdCLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3JCLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7O0FBakZEOztHQUVHO0FBQzZCLG9DQUFhLEdBQVUsd0JBQXdCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA8YXV0by1nZW5lcmF0ZWQvPlxyXG4vLyBDb250ZW50cyBvZjogaGw3LmZoaXIucjIuY29yZSB2ZXJzaW9uOiAxLjAuMlxyXG4vLyBNaW5pbXVtIFR5cGVTY3JpcHQgVmVyc2lvbjogMy43XHJcbi8vIEZISVIgUmVzb3VyY2U6IEltYWdpbmdPYmplY3RTZWxlY3Rpb25cclxuXHJcbmltcG9ydCAqIGFzIGZoaXIgZnJvbSAnLi4vZmhpci5qcyc7XHJcblxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzSW5zdGFuY2VGcmFtZXMgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzSW5zdGFuY2VGcmFtZXNBcmdzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnRBcmdzIHtcclxuICAvKipcclxuICAgKiBPbmUgb3IgbW9yZSBub24tZHVwbGljYXRlIGZyYW1lIG51bWJlcnMgaW4gdGhlIHNlbGVjdGVkIGluc3RhbmNlLlxyXG4gICAqL1xyXG4gIGZyYW1lTnVtYmVyczogZmhpci5GaGlyVW5zaWduZWRJbnRbXXwobnVtYmVyfG51bGwpW118dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uLnN0dWR5LnNlcmllcy5pbnN0YW5jZS5mcmFtZXMuZnJhbWVOdW1iZXJzXHJcbiAgICovXHJcbiAgX2ZyYW1lTnVtYmVycz86KGZoaXIuRmhpckVsZW1lbnRBcmdzfG51bGwpW107XHJcbiAgLyoqXHJcbiAgICogV0FETy1SUyBVUkwgZW5hYmxlcyByZXRyaWV2YWwgb2YgdGhlIGZyYW1lcyB1c2luZyBESUNPTSBXQURPLVJTIEFQSS5cclxuICAgKi9cclxuICB1cmw6IGZoaXIuRmhpclVyaXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uLnN0dWR5LnNlcmllcy5pbnN0YW5jZS5mcmFtZXMudXJsXHJcbiAgICovXHJcbiAgX3VybD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgc3BlY2lmaWMgc2V0IG9mIGZyYW1lcyByZWZlcmVuY2VkIGluIHRoaXMgaW1hZ2luZyBvYmplY3Qgc2VsZWN0aW9uLiBUaGUgVVJMIHJldHJpZXZlcyB0aGUgcGl4ZWwgZGF0YSwgYW5kIGlzIGVuY2Fwc3VsYXRlZCBpbiBhIG11bHRpcGFydCBNSU1FIHJlc3BvbnNlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllc0luc3RhbmNlRnJhbWVzIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzSW5zdGFuY2VGcmFtZXMnO1xyXG4gIC8qKlxyXG4gICAqIE9uZSBvciBtb3JlIG5vbi1kdXBsaWNhdGUgZnJhbWUgbnVtYmVycyBpbiB0aGUgc2VsZWN0ZWQgaW5zdGFuY2UuXHJcbiAgICovXHJcbiAgcHVibGljIGZyYW1lTnVtYmVyczogZmhpci5GaGlyVW5zaWduZWRJbnRbXTtcclxuICAvKipcclxuICAgKiBXQURPLVJTIFVSTCBlbmFibGVzIHJldHJpZXZhbCBvZiB0aGUgZnJhbWVzIHVzaW5nIERJQ09NIFdBRE8tUlMgQVBJLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1cmw6IGZoaXIuRmhpclVyaXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIEltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllc0luc3RhbmNlRnJhbWVzIC0gaW5pdGlhbGl6ZXMgYW55IHJlcXVpcmVkIGVsZW1lbnRzIHRvIG51bGwgaWYgYSB2YWx1ZSBpcyBub3QgcHJvdmlkZWQuXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3Ioc291cmNlOlBhcnRpYWw8SW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzSW5zdGFuY2VGcmFtZXNBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsnZnJhbWVOdW1iZXJzJ10pIHsgdGhpcy5mcmFtZU51bWJlcnMgPSBzb3VyY2UuZnJhbWVOdW1iZXJzLm1hcCgoeCkgPT4gbmV3IGZoaXIuRmhpclVuc2lnbmVkSW50KHt2YWx1ZTogeH0pKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuZnJhbWVOdW1iZXJzID0gW107IH1cclxuICAgIGlmIChzb3VyY2VbJ19mcmFtZU51bWJlcnMnXSkge1xyXG4gICAgICBzb3VyY2UuX2ZyYW1lTnVtYmVycy5mb3JFYWNoKCh4LGkpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5mcmFtZU51bWJlcnMubGVuZ3RoID49IGkpIHsgaWYgKHgpIHsgdGhpcy5mcmFtZU51bWJlcnNbaV0uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHgpOyB9IH1cclxuICAgICAgICBlbHNlIHsgaWYgKHgpIHsgdGhpcy5mcmFtZU51bWJlcnMucHVzaChuZXcgZmhpci5GaGlyVW5zaWduZWRJbnQoeCBhcyBQYXJ0aWFsPGZoaXIuRmhpclVuc2lnbmVkSW50QXJncz4pKTsgfSB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndXJsJ10pIHsgdGhpcy51cmwgPSBuZXcgZmhpci5GaGlyVXJpKHt2YWx1ZTogc291cmNlLnVybH0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy51cmwgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfdXJsJ10pIHtcclxuICAgICAgaWYgKHRoaXMudXJsKSB7IHRoaXMudXJsLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3VybCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnVybCA9IG5ldyBmaGlyLkZoaXJVcmkoc291cmNlLl91cmwgYXMgUGFydGlhbDxmaGlyLkZoaXJVcmlBcmdzPik7IH1cclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbWFnaW5nT2JqZWN0U2VsZWN0aW9uLnN0dWR5LnNlcmllcy5pbnN0YW5jZS5mcmFtZXMnIH1cclxuICAgIHRoaXMudlJBKCdmcmFtZU51bWJlcnMnLGV4cClcclxuICAgIHRoaXMudlJTKCd1cmwnLGV4cClcclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHlTZXJpZXNJbnN0YW5jZSB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHlTZXJpZXNJbnN0YW5jZUFyZ3MgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudEFyZ3Mge1xyXG4gIC8qKlxyXG4gICAqIERJQ09NIFNPUCBpbnN0YW5jZXMgY2FuIGJlIGFuIGltYWdlIG9yIG90aGVyIGRhdGEgb2JqZWN0LiBUaGUgU09QIGNsYXNzIFVJRCBwcm92aWRlIHRoZSBhY2N1cmF0ZSBpbmZvcm1hdGlvbiBhYm91dCB3aGF0IHR5cGUgdGhlIGluc3RhbmNlIGlzLlxyXG4gICAqL1xyXG4gIHNvcENsYXNzOiBmaGlyLkZoaXJPaWR8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ09iamVjdFNlbGVjdGlvbi5zdHVkeS5zZXJpZXMuaW5zdGFuY2Uuc29wQ2xhc3NcclxuICAgKi9cclxuICBfc29wQ2xhc3M/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBpbnN0YW5jZSBVSUQgaXMgcmVxdWlyZWQgdG8gZnVsbHkgaWRlbnRpZnkgdGhlIERJQ09NIFNPUCBpbnN0YW5jZSBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHVpZDogZmhpci5GaGlyT2lkfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEltYWdpbmdPYmplY3RTZWxlY3Rpb24uc3R1ZHkuc2VyaWVzLmluc3RhbmNlLnVpZFxyXG4gICAqL1xyXG4gIF91aWQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFdBRE8tUlMgVVJMIGVuYWJsZXMgcmV0cmlldmFsIG9mIHRoZSBTT1AgaW5zdGFuY2UgdXNpbmcgRElDT00gV0FETy1SUyBBUEkuXHJcbiAgICovXHJcbiAgdXJsOiBmaGlyLkZoaXJVcml8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ09iamVjdFNlbGVjdGlvbi5zdHVkeS5zZXJpZXMuaW5zdGFuY2UudXJsXHJcbiAgICovXHJcbiAgX3VybD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVGhlIHNwZWNpZmljIHNldCBvZiBmcmFtZXMgcmVmZXJlbmNlZCBpbiB0aGlzIGltYWdpbmcgb2JqZWN0IHNlbGVjdGlvbi4gVGhlIFVSTCByZXRyaWV2ZXMgdGhlIHBpeGVsIGRhdGEsIGFuZCBpcyBlbmNhcHN1bGF0ZWQgaW4gYSBtdWx0aXBhcnQgTUlNRSByZXNwb25zZS5cclxuICAgKi9cclxuICBmcmFtZXM/OiBmaGlyLkltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllc0luc3RhbmNlRnJhbWVzQXJnc1tdfHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIERJQ09NIFNPUCBpbnN0YW5jZXMgYXJlIGlkZW50aWZpZWQgdGhyb3VnaCB0aGUgVUlEcyBvZiB0aGUgc3R1ZHkgLSBzZXJpZXMgLSBpbnN0YW5jZSBoaWVyYXJjaHkuIFRoaXMgaXMgdGhlIGluc3RhbmNlIGxldmVsIGlkZW50aXR5IG9mIHRoZSBpbnN0YW5jZSBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllc0luc3RhbmNlIGV4dGVuZHMgZmhpci5CYWNrYm9uZUVsZW1lbnQge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzSW5zdGFuY2UnO1xyXG4gIC8qKlxyXG4gICAqIERJQ09NIFNPUCBpbnN0YW5jZXMgY2FuIGJlIGFuIGltYWdlIG9yIG90aGVyIGRhdGEgb2JqZWN0LiBUaGUgU09QIGNsYXNzIFVJRCBwcm92aWRlIHRoZSBhY2N1cmF0ZSBpbmZvcm1hdGlvbiBhYm91dCB3aGF0IHR5cGUgdGhlIGluc3RhbmNlIGlzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzb3BDbGFzczogZmhpci5GaGlyT2lkfG51bGw7XHJcbiAgLyoqXHJcbiAgICogU09QIGluc3RhbmNlIFVJRCBpcyByZXF1aXJlZCB0byBmdWxseSBpZGVudGlmeSB0aGUgRElDT00gU09QIGluc3RhbmNlIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgcHVibGljIHVpZDogZmhpci5GaGlyT2lkfG51bGw7XHJcbiAgLyoqXHJcbiAgICogV0FETy1SUyBVUkwgZW5hYmxlcyByZXRyaWV2YWwgb2YgdGhlIFNPUCBpbnN0YW5jZSB1c2luZyBESUNPTSBXQURPLVJTIEFQSS5cclxuICAgKi9cclxuICBwdWJsaWMgdXJsOiBmaGlyLkZoaXJVcml8bnVsbDtcclxuICAvKipcclxuICAgKiBUaGUgc3BlY2lmaWMgc2V0IG9mIGZyYW1lcyByZWZlcmVuY2VkIGluIHRoaXMgaW1hZ2luZyBvYmplY3Qgc2VsZWN0aW9uLiBUaGUgVVJMIHJldHJpZXZlcyB0aGUgcGl4ZWwgZGF0YSwgYW5kIGlzIGVuY2Fwc3VsYXRlZCBpbiBhIG11bHRpcGFydCBNSU1FIHJlc3BvbnNlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBmcmFtZXM6IGZoaXIuSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzSW5zdGFuY2VGcmFtZXNbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHlTZXJpZXNJbnN0YW5jZSAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPEltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllc0luc3RhbmNlQXJncz4gPSB7fSwgb3B0aW9uczpmaGlyLkZoaXJDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7fSkge1xyXG4gICAgc3VwZXIoc291cmNlLCBvcHRpb25zKTtcclxuICAgIGlmIChzb3VyY2VbJ3NvcENsYXNzJ10pIHsgdGhpcy5zb3BDbGFzcyA9IG5ldyBmaGlyLkZoaXJPaWQoe3ZhbHVlOiBzb3VyY2Uuc29wQ2xhc3N9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuc29wQ2xhc3MgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfc29wQ2xhc3MnXSkge1xyXG4gICAgICBpZiAodGhpcy5zb3BDbGFzcykgeyB0aGlzLnNvcENsYXNzLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3NvcENsYXNzISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMuc29wQ2xhc3MgPSBuZXcgZmhpci5GaGlyT2lkKHNvdXJjZS5fc29wQ2xhc3MgYXMgUGFydGlhbDxmaGlyLkZoaXJPaWRBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3VpZCddKSB7IHRoaXMudWlkID0gbmV3IGZoaXIuRmhpck9pZCh7dmFsdWU6IHNvdXJjZS51aWR9KTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudWlkID0gbnVsbDsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3VpZCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnVpZCkgeyB0aGlzLnVpZC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl91aWQhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy51aWQgPSBuZXcgZmhpci5GaGlyT2lkKHNvdXJjZS5fdWlkIGFzIFBhcnRpYWw8Zmhpci5GaGlyT2lkQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWyd1cmwnXSkgeyB0aGlzLnVybCA9IG5ldyBmaGlyLkZoaXJVcmkoe3ZhbHVlOiBzb3VyY2UudXJsfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnVybCA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ191cmwnXSkge1xyXG4gICAgICBpZiAodGhpcy51cmwpIHsgdGhpcy51cmwuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdXJsISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudXJsID0gbmV3IGZoaXIuRmhpclVyaShzb3VyY2UuX3VybCBhcyBQYXJ0aWFsPGZoaXIuRmhpclVyaUFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnZnJhbWVzJ10pIHsgdGhpcy5mcmFtZXMgPSBzb3VyY2UuZnJhbWVzLm1hcCgoeCkgPT4gbmV3IGZoaXIuSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzSW5zdGFuY2VGcmFtZXMoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5mcmFtZXMgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ0ltYWdpbmdPYmplY3RTZWxlY3Rpb24uc3R1ZHkuc2VyaWVzLmluc3RhbmNlJyB9XHJcbiAgICB0aGlzLnZSUygnc29wQ2xhc3MnLGV4cClcclxuICAgIHRoaXMudlJTKCd1aWQnLGV4cClcclxuICAgIHRoaXMudlJTKCd1cmwnLGV4cClcclxuICAgIHRoaXMudk9BKCdmcmFtZXMnLGV4cClcclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHlTZXJpZXMgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzQXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogU2VyaWVzIGluc3RhbmNlIFVJRCBpcyByZXF1aXJlZCB0byBmdWxseSBpZGVudGlmeSB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHVpZD86IGZoaXIuRmhpck9pZHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uLnN0dWR5LnNlcmllcy51aWRcclxuICAgKi9cclxuICBfdWlkPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBXQURPLVJTIFVSTCBlbmFibGVzIHJldHJpZXZhbCBvZiB0aGUgZW50aXJlIHNlcmllcyB1c2luZyBESUNPTSBXQURPLVJTIEFQSS5cclxuICAgKi9cclxuICB1cmw/OiBmaGlyLkZoaXJVcml8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ09iamVjdFNlbGVjdGlvbi5zdHVkeS5zZXJpZXMudXJsXHJcbiAgICovXHJcbiAgX3VybD86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogRElDT00gU09QIGluc3RhbmNlcyBhcmUgaWRlbnRpZmllZCB0aHJvdWdoIHRoZSBVSURzIG9mIHRoZSBzdHVkeSAtIHNlcmllcyAtIGluc3RhbmNlIGhpZXJhcmNoeS4gVGhpcyBpcyB0aGUgaW5zdGFuY2UgbGV2ZWwgaWRlbnRpdHkgb2YgdGhlIGluc3RhbmNlIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgaW5zdGFuY2U6IGZoaXIuSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzSW5zdGFuY2VBcmdzW118bnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIERJQ09NIFNPUCBpbnN0YW5jZXMgYXJlIGlkZW50aWZpZWQgdGhyb3VnaCB0aGUgVUlEcyBvZiB0aGUgc3R1ZHkgLSBzZXJpZXMgLSBpbnN0YW5jZSBoaWVyYXJjaHkuIEluIGFkZGl0aW9uLCB0aGUgbG9jYXRvciBhdCB0aGUgc2VyaWVzIGxldmVsIHByb3ZpZGUgYSBtZWFucyBvZiByZXRyaWV2aW5nIHRoZSBlbnRpcmUgc2VyaWVzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllcyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50IHtcclxuICAvKipcclxuICAgKiBNYXBwaW5nIG9mIHRoaXMgZGF0YXR5cGUgdG8gYSBGSElSIGVxdWl2YWxlbnRcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG92ZXJyaWRlIHJlYWRvbmx5IF9mdHNfZGF0YVR5cGU6c3RyaW5nID0gJ0ltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllcyc7XHJcbiAgLyoqXHJcbiAgICogU2VyaWVzIGluc3RhbmNlIFVJRCBpcyByZXF1aXJlZCB0byBmdWxseSBpZGVudGlmeSB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1aWQ/OiBmaGlyLkZoaXJPaWR8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFdBRE8tUlMgVVJMIGVuYWJsZXMgcmV0cmlldmFsIG9mIHRoZSBlbnRpcmUgc2VyaWVzIHVzaW5nIERJQ09NIFdBRE8tUlMgQVBJLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1cmw/OiBmaGlyLkZoaXJVcml8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERJQ09NIFNPUCBpbnN0YW5jZXMgYXJlIGlkZW50aWZpZWQgdGhyb3VnaCB0aGUgVUlEcyBvZiB0aGUgc3R1ZHkgLSBzZXJpZXMgLSBpbnN0YW5jZSBoaWVyYXJjaHkuIFRoaXMgaXMgdGhlIGluc3RhbmNlIGxldmVsIGlkZW50aXR5IG9mIHRoZSBpbnN0YW5jZSBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbnN0YW5jZTogZmhpci5JbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHlTZXJpZXNJbnN0YW5jZVtdO1xyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIEltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllcyAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPEltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllc0FyZ3M+ID0ge30sIG9wdGlvbnM6Zmhpci5GaGlyQ29uc3RydWN0b3JPcHRpb25zID0ge30pIHtcclxuICAgIHN1cGVyKHNvdXJjZSwgb3B0aW9ucyk7XHJcbiAgICBpZiAoc291cmNlWyd1aWQnXSkgeyB0aGlzLnVpZCA9IG5ldyBmaGlyLkZoaXJPaWQoe3ZhbHVlOiBzb3VyY2UudWlkfSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ191aWQnXSkge1xyXG4gICAgICBpZiAodGhpcy51aWQpIHsgdGhpcy51aWQuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdWlkISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudWlkID0gbmV3IGZoaXIuRmhpck9pZChzb3VyY2UuX3VpZCBhcyBQYXJ0aWFsPGZoaXIuRmhpck9pZEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsndXJsJ10pIHsgdGhpcy51cmwgPSBuZXcgZmhpci5GaGlyVXJpKHt2YWx1ZTogc291cmNlLnVybH0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfdXJsJ10pIHtcclxuICAgICAgaWYgKHRoaXMudXJsKSB7IHRoaXMudXJsLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3VybCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnVybCA9IG5ldyBmaGlyLkZoaXJVcmkoc291cmNlLl91cmwgYXMgUGFydGlhbDxmaGlyLkZoaXJVcmlBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ2luc3RhbmNlJ10pIHsgdGhpcy5pbnN0YW5jZSA9IHNvdXJjZS5pbnN0YW5jZS5tYXAoKHgpID0+IG5ldyBmaGlyLkltYWdpbmdPYmplY3RTZWxlY3Rpb25TdHVkeVNlcmllc0luc3RhbmNlKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuaW5zdGFuY2UgPSBbXTsgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byBwZXJmb3JtIGJhc2ljIG1vZGVsIHZhbGlkYXRpb24gKGUuZy4sIGNoZWNrIGlmIHJlcXVpcmVkIGVsZW1lbnRzIGFyZSBwcmVzZW50KS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZG9Nb2RlbFZhbGlkYXRpb24oZXhwOnN0cmluZyA9ICcnKTpmaGlyLkZ0c0lzc3VlW10ge1xyXG4gICAgbGV0IGlzc3VlczpmaGlyLkZ0c0lzc3VlW10gPSBzdXBlci5kb01vZGVsVmFsaWRhdGlvbihleHApO1xyXG4gICAgaWYgKGV4cCA9PT0gJycpIHsgZXhwID0gJ0ltYWdpbmdPYmplY3RTZWxlY3Rpb24uc3R1ZHkuc2VyaWVzJyB9XHJcbiAgICB0aGlzLnZPUygndWlkJyxleHApXHJcbiAgICB0aGlzLnZPUygndXJsJyxleHApXHJcbiAgICB0aGlzLnZSQSgnaW5zdGFuY2UnLGV4cClcclxuICAgIHJldHVybiBpc3N1ZXM7XHJcbiAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZCBhcmd1bWVudHMgZm9yIHRoZSBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHkgdHlwZS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5QXJncyBleHRlbmRzIGZoaXIuQmFja2JvbmVFbGVtZW50QXJncyB7XHJcbiAgLyoqXHJcbiAgICogU3R1ZHkgaW5zdGFuY2UgVUlEIGlzIHJlcXVpcmVkIHRvIGZ1bGx5IGlkZW50aWZ5IHRoZSBESUNPTSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgdWlkOiBmaGlyLkZoaXJPaWR8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ09iamVjdFNlbGVjdGlvbi5zdHVkeS51aWRcclxuICAgKi9cclxuICBfdWlkPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBXQURPLVJTIFVSTCBlbmFibGVzIHJldHJpZXZhbCBvZiB0aGUgZW50aXJlIHN0dWR5IHVzaW5nIERJQ09NIFdBRE8tUlMgQVBJLlxyXG4gICAqL1xyXG4gIHVybD86IGZoaXIuRmhpclVyaXxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uLnN0dWR5LnVybFxyXG4gICAqL1xyXG4gIF91cmw/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFVzZWQgdG8gcmV0cmlldmUgdGhlIEltYWdpbmdTdHVkeSB0aGF0IGNvbnRhaW4gdGhlIGltYWdlcyByZWZlcmVuY2VkIGluIHRoZSBJbWFnaW5nIE9iamVjdFNlbGVjdGlvbi5zdHVkeS5cclxuICAgKi9cclxuICBpbWFnaW5nU3R1ZHk/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERJQ09NIFNPUCBpbnN0YW5jZXMgYXJlIGlkZW50aWZpZWQgdGhyb3VnaCB0aGUgVUlEcyBvZiB0aGUgc3R1ZHkgLSBzZXJpZXMgLSBpbnN0YW5jZSBoaWVyYXJjaHkuIEluIGFkZGl0aW9uLCB0aGUgbG9jYXRvciBhdCB0aGUgc2VyaWVzIGxldmVsIHByb3ZpZGUgYSBtZWFucyBvZiByZXRyaWV2aW5nIHRoZSBlbnRpcmUgc2VyaWVzLlxyXG4gICAqL1xyXG4gIHNlcmllczogZmhpci5JbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHlTZXJpZXNBcmdzW118bnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIERJQ09NIFNPUCBpbnN0YW5jZXMgYXJlIGlkZW50aWZpZWQgdGhyb3VnaCB0aGUgVUlEcyBvZiB0aGUgc3R1ZHkgLSBzZXJpZXMgLSBpbnN0YW5jZSBoaWVyYXJjaHkuIEluIGFkZGl0aW9uLCB0aGUgbG9jYXRvciBhdCB0aGUgc3R1ZHkgbGV2ZWwgcHJvdmlkZSBhIG1lYW5zIG9mIHJldHJpZXZpbmcgdGhlIGVudGlyZSBzdHVkeS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHkgZXh0ZW5kcyBmaGlyLkJhY2tib25lRWxlbWVudCB7XHJcbiAgLyoqXHJcbiAgICogTWFwcGluZyBvZiB0aGlzIGRhdGF0eXBlIHRvIGEgRkhJUiBlcXVpdmFsZW50XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBfZnRzX2RhdGFUeXBlOnN0cmluZyA9ICdJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHknO1xyXG4gIC8qKlxyXG4gICAqIFN0dWR5IGluc3RhbmNlIFVJRCBpcyByZXF1aXJlZCB0byBmdWxseSBpZGVudGlmeSB0aGUgRElDT00gU09QIGluc3RhbmNlcyBpbiB0aGUgc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1aWQ6IGZoaXIuRmhpck9pZHxudWxsO1xyXG4gIC8qKlxyXG4gICAqIFdBRE8tUlMgVVJMIGVuYWJsZXMgcmV0cmlldmFsIG9mIHRoZSBlbnRpcmUgc3R1ZHkgdXNpbmcgRElDT00gV0FETy1SUyBBUEkuXHJcbiAgICovXHJcbiAgcHVibGljIHVybD86IGZoaXIuRmhpclVyaXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogVXNlZCB0byByZXRyaWV2ZSB0aGUgSW1hZ2luZ1N0dWR5IHRoYXQgY29udGFpbiB0aGUgaW1hZ2VzIHJlZmVyZW5jZWQgaW4gdGhlIEltYWdpbmcgT2JqZWN0U2VsZWN0aW9uLnN0dWR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbWFnaW5nU3R1ZHk/OiBmaGlyLlJlZmVyZW5jZXx1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRElDT00gU09QIGluc3RhbmNlcyBhcmUgaWRlbnRpZmllZCB0aHJvdWdoIHRoZSBVSURzIG9mIHRoZSBzdHVkeSAtIHNlcmllcyAtIGluc3RhbmNlIGhpZXJhcmNoeS4gSW4gYWRkaXRpb24sIHRoZSBsb2NhdG9yIGF0IHRoZSBzZXJpZXMgbGV2ZWwgcHJvdmlkZSBhIG1lYW5zIG9mIHJldHJpZXZpbmcgdGhlIGVudGlyZSBzZXJpZXMuXHJcbiAgICovXHJcbiAgcHVibGljIHNlcmllczogZmhpci5JbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHlTZXJpZXNbXTtcclxuICAvKipcclxuICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIGZvciBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHkgLSBpbml0aWFsaXplcyBhbnkgcmVxdWlyZWQgZWxlbWVudHMgdG8gbnVsbCBpZiBhIHZhbHVlIGlzIG5vdCBwcm92aWRlZC5cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihzb3VyY2U6UGFydGlhbDxJbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHlBcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgaWYgKHNvdXJjZVsndWlkJ10pIHsgdGhpcy51aWQgPSBuZXcgZmhpci5GaGlyT2lkKHt2YWx1ZTogc291cmNlLnVpZH0pOyB9XHJcbiAgICBlbHNlIHsgdGhpcy51aWQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydfdWlkJ10pIHtcclxuICAgICAgaWYgKHRoaXMudWlkKSB7IHRoaXMudWlkLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX3VpZCEpOyB9XHJcbiAgICAgIGVsc2UgeyB0aGlzLnVpZCA9IG5ldyBmaGlyLkZoaXJPaWQoc291cmNlLl91aWQgYXMgUGFydGlhbDxmaGlyLkZoaXJPaWRBcmdzPik7IH1cclxuICAgIH1cclxuICAgIGlmIChzb3VyY2VbJ3VybCddKSB7IHRoaXMudXJsID0gbmV3IGZoaXIuRmhpclVyaSh7dmFsdWU6IHNvdXJjZS51cmx9KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnX3VybCddKSB7XHJcbiAgICAgIGlmICh0aGlzLnVybCkgeyB0aGlzLnVybC5hZGRFeHRlbmRlZFByb3BlcnRpZXMoc291cmNlLl91cmwhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy51cmwgPSBuZXcgZmhpci5GaGlyVXJpKHNvdXJjZS5fdXJsIGFzIFBhcnRpYWw8Zmhpci5GaGlyVXJpQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydpbWFnaW5nU3R1ZHknXSkgeyB0aGlzLmltYWdpbmdTdHVkeSA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UuaW1hZ2luZ1N0dWR5KTsgfVxyXG4gICAgaWYgKHNvdXJjZVsnc2VyaWVzJ10pIHsgdGhpcy5zZXJpZXMgPSBzb3VyY2Uuc2VyaWVzLm1hcCgoeCkgPT4gbmV3IGZoaXIuSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5U2VyaWVzKHgpKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMuc2VyaWVzID0gW107IH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdG8gcGVyZm9ybSBiYXNpYyBtb2RlbCB2YWxpZGF0aW9uIChlLmcuLCBjaGVjayBpZiByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudCkuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRvTW9kZWxWYWxpZGF0aW9uKGV4cDpzdHJpbmcgPSAnJyk6Zmhpci5GdHNJc3N1ZVtdIHtcclxuICAgIGxldCBpc3N1ZXM6Zmhpci5GdHNJc3N1ZVtdID0gc3VwZXIuZG9Nb2RlbFZhbGlkYXRpb24oZXhwKTtcclxuICAgIGlmIChleHAgPT09ICcnKSB7IGV4cCA9ICdJbWFnaW5nT2JqZWN0U2VsZWN0aW9uLnN0dWR5JyB9XHJcbiAgICB0aGlzLnZSUygndWlkJyxleHApXHJcbiAgICB0aGlzLnZPUygndXJsJyxleHApXHJcbiAgICB0aGlzLnZPUygnaW1hZ2luZ1N0dWR5JyxleHApXHJcbiAgICB0aGlzLnZSQSgnc2VyaWVzJyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4vKipcclxuICogVmFsaWQgYXJndW1lbnRzIGZvciB0aGUgSW1hZ2luZ09iamVjdFNlbGVjdGlvbiB0eXBlLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uQXJncyBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2VBcmdzIHtcclxuICAvKipcclxuICAgKiBSZXNvdXJjZSBUeXBlIE5hbWVcclxuICAgKi9cclxuICByZXNvdXJjZVR5cGU6IFwiSW1hZ2luZ09iamVjdFNlbGVjdGlvblwifHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBESUNPTSBTT1AgSW5zdGFuY2UgaXMgYWx3YXlzIGFzc2lnbmVkIHdpdGggYSB1bmlxdWUgaWRlbnRpZmllciAoVUlEKS5cclxuICAgKi9cclxuICB1aWQ6IGZoaXIuRmhpck9pZHxzdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIEV4dGVuZGVkIHByb3BlcnRpZXMgZm9yIHByaW1pdGl2ZSBlbGVtZW50OiBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uLnVpZFxyXG4gICAqL1xyXG4gIF91aWQ/OmZoaXIuRmhpckVsZW1lbnRBcmdzO1xyXG4gIC8qKlxyXG4gICAqIFNPUCBJbnN0YW5jZXMgaW4gSW1hZ2luZ09iamVjdFNlbGVjdGlvbiBtdXN0IGJlIGZyb20gdGhlIHNhbWUgcGF0aWVudC5cclxuICAgKi9cclxuICBwYXRpZW50OiBmaGlyLlJlZmVyZW5jZUFyZ3N8bnVsbDtcclxuICAvKipcclxuICAgKiBOZWVkIHRvIHJlcHJlc2VudCB0aGUgYXBwbGljYXRpb24gcHVycG9zZSB0aGF0IHRoZSBTT1AgaW5zdGFuY2VzIGluIEltYWdpbmdPYmplY3RTZWxlY3Rpb24gYXJlIHNlbGVjdGVkIGZvci5cclxuICAgKi9cclxuICB0aXRsZTogZmhpci5Db2RlYWJsZUNvbmNlcHRBcmdzfG51bGw7XHJcbiAgLyoqXHJcbiAgICogTmVlZCB0byBwcm92aWRlIGEgbmFycmF0aXZlIGRlc2NyaXB0aW9uIG9mIHRoZSBTT1AgaW5zdGFuY2VzIGluIHRoZSBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgZGVzY3JpcHRpb24/OiBmaGlyLkZoaXJTdHJpbmd8c3RyaW5nfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBFeHRlbmRlZCBwcm9wZXJ0aWVzIGZvciBwcmltaXRpdmUgZWxlbWVudDogSW1hZ2luZ09iamVjdFNlbGVjdGlvbi5kZXNjcmlwdGlvblxyXG4gICAqL1xyXG4gIF9kZXNjcmlwdGlvbj86Zmhpci5GaGlyRWxlbWVudEFyZ3M7XHJcbiAgLyoqXHJcbiAgICogVHJhY2sgdGhlIHNlbGVjdGlvbiBkZWNpc2lvbiBtYWtlci5cclxuICAgKi9cclxuICBhdXRob3I/OiBmaGlyLlJlZmVyZW5jZUFyZ3N8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERhdGUgYW5kIHRpbWUgd2hlbiB0aGUgc2VsZWN0aW9uIHdhcyBtYWRlIGNhbiBiZSBpbXBvcnRhbnQgdG8gdW5kZXJzdGFuZCB0aGUgY29udGVudCBvZiBzZWxlY3Rpb24uXHJcbiAgICovXHJcbiAgYXV0aG9yaW5nVGltZT86IGZoaXIuRmhpckRhdGVUaW1lfHN0cmluZ3x1bmRlZmluZWQ7XHJcbiAgLyoqXHJcbiAgICogRXh0ZW5kZWQgcHJvcGVydGllcyBmb3IgcHJpbWl0aXZlIGVsZW1lbnQ6IEltYWdpbmdPYmplY3RTZWxlY3Rpb24uYXV0aG9yaW5nVGltZVxyXG4gICAqL1xyXG4gIF9hdXRob3JpbmdUaW1lPzpmaGlyLkZoaXJFbGVtZW50QXJncztcclxuICAvKipcclxuICAgKiBESUNPTSBTT1AgaW5zdGFuY2VzIGFyZSBpZGVudGlmaWVkIHRocm91Z2ggdGhlIFVJRHMgb2YgdGhlIHN0dWR5IC0gc2VyaWVzIC0gaW5zdGFuY2UgaGllcmFyY2h5LiBJbiBhZGRpdGlvbiwgdGhlIGxvY2F0b3IgYXQgdGhlIHN0dWR5IGxldmVsIHByb3ZpZGUgYSBtZWFucyBvZiByZXRyaWV2aW5nIHRoZSBlbnRpcmUgc3R1ZHkuXHJcbiAgICovXHJcbiAgc3R1ZHk6IGZoaXIuSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5QXJnc1tdfG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIG1hbmlmZXN0IG9mIGEgc2V0IG9mIERJQ09NIFNlcnZpY2UtT2JqZWN0IFBhaXIgSW5zdGFuY2VzIChTT1AgSW5zdGFuY2VzKS4gIFRoZSByZWZlcmVuY2VkIFNPUCBJbnN0YW5jZXMgKGltYWdlcyBvciBvdGhlciBjb250ZW50KSBhcmUgZm9yIGEgc2luZ2xlIHBhdGllbnQsIGFuZCBtYXkgYmUgZnJvbSBvbmUgb3IgbW9yZSBzdHVkaWVzLiBUaGUgcmVmZXJlbmNlZCBTT1AgSW5zdGFuY2VzIGhhdmUgYmVlbiBzZWxlY3RlZCBmb3IgYSBwdXJwb3NlLCBzdWNoIGFzIHF1YWxpdHkgYXNzdXJhbmNlLCBjb25mZXJlbmNlLCBvciBjb25zdWx0LiBSZWZsZWN0aW5nIHRoYXQgcmFuZ2Ugb2YgcHVycG9zZXMsIHR5cGljYWwgSW1hZ2luZ09iamVjdFNlbGVjdGlvbiByZXNvdXJjZXMgbWF5IGluY2x1ZGUgYWxsIFNPUCBJbnN0YW5jZXMgaW4gYSBzdHVkeSAocGVyaGFwcyBmb3Igc2hhcmluZyB0aHJvdWdoIGEgSGVhbHRoIEluZm9ybWF0aW9uIEV4Y2hhbmdlKTsga2V5IGltYWdlcyBmcm9tIG11bHRpcGxlIHN0dWRpZXMgKGZvciByZWZlcmVuY2UgYnkgYSByZWZlcnJpbmcgb3IgdHJlYXRpbmcgcGh5c2ljaWFuKTsgYSBtdWx0aS1mcmFtZSB1bHRyYXNvdW5kIGluc3RhbmNlIChcImNpbmVcIiB2aWRlbyBjbGlwKSBhbmQgYSBzZXQgb2YgbWVhc3VyZW1lbnRzIHRha2VuIGZyb20gdGhhdCBpbnN0YW5jZSAoZm9yIGluY2x1c2lvbiBpbiBhIHRlYWNoaW5nIGZpbGUpOyBhbmQgc28gb24uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgSW1hZ2luZ09iamVjdFNlbGVjdGlvbiBleHRlbmRzIGZoaXIuRG9tYWluUmVzb3VyY2Uge1xyXG4gIC8qKlxyXG4gICAqIE1hcHBpbmcgb2YgdGhpcyBkYXRhdHlwZSB0byBhIEZISVIgZXF1aXZhbGVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgb3ZlcnJpZGUgcmVhZG9ubHkgX2Z0c19kYXRhVHlwZTpzdHJpbmcgPSAnSW1hZ2luZ09iamVjdFNlbGVjdGlvbic7XHJcbiAgLyoqXHJcbiAgICogUmVzb3VyY2UgVHlwZSBOYW1lXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc291cmNlVHlwZTogXCJJbWFnaW5nT2JqZWN0U2VsZWN0aW9uXCI7XHJcbiAgLyoqXHJcbiAgICogRElDT00gU09QIEluc3RhbmNlIGlzIGFsd2F5cyBhc3NpZ25lZCB3aXRoIGEgdW5pcXVlIGlkZW50aWZpZXIgKFVJRCkuXHJcbiAgICovXHJcbiAgcHVibGljIHVpZDogZmhpci5GaGlyT2lkfG51bGw7XHJcbiAgLyoqXHJcbiAgICogU09QIEluc3RhbmNlcyBpbiBJbWFnaW5nT2JqZWN0U2VsZWN0aW9uIG11c3QgYmUgZnJvbSB0aGUgc2FtZSBwYXRpZW50LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwYXRpZW50OiBmaGlyLlJlZmVyZW5jZXxudWxsO1xyXG4gIC8qKlxyXG4gICAqIE5lZWQgdG8gcmVwcmVzZW50IHRoZSBhcHBsaWNhdGlvbiBwdXJwb3NlIHRoYXQgdGhlIFNPUCBpbnN0YW5jZXMgaW4gSW1hZ2luZ09iamVjdFNlbGVjdGlvbiBhcmUgc2VsZWN0ZWQgZm9yLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0aXRsZTogZmhpci5Db2RlYWJsZUNvbmNlcHR8bnVsbDtcclxuICAvKipcclxuICAgKiBOZWVkIHRvIHByb3ZpZGUgYSBuYXJyYXRpdmUgZGVzY3JpcHRpb24gb2YgdGhlIFNPUCBpbnN0YW5jZXMgaW4gdGhlIHNlbGVjdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgZGVzY3JpcHRpb24/OiBmaGlyLkZoaXJTdHJpbmd8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIFRyYWNrIHRoZSBzZWxlY3Rpb24gZGVjaXNpb24gbWFrZXIuXHJcbiAgICovXHJcbiAgcHVibGljIGF1dGhvcj86IGZoaXIuUmVmZXJlbmNlfHVuZGVmaW5lZDtcclxuICAvKipcclxuICAgKiBEYXRlIGFuZCB0aW1lIHdoZW4gdGhlIHNlbGVjdGlvbiB3YXMgbWFkZSBjYW4gYmUgaW1wb3J0YW50IHRvIHVuZGVyc3RhbmQgdGhlIGNvbnRlbnQgb2Ygc2VsZWN0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhdXRob3JpbmdUaW1lPzogZmhpci5GaGlyRGF0ZVRpbWV8dW5kZWZpbmVkO1xyXG4gIC8qKlxyXG4gICAqIERJQ09NIFNPUCBpbnN0YW5jZXMgYXJlIGlkZW50aWZpZWQgdGhyb3VnaCB0aGUgVUlEcyBvZiB0aGUgc3R1ZHkgLSBzZXJpZXMgLSBpbnN0YW5jZSBoaWVyYXJjaHkuIEluIGFkZGl0aW9uLCB0aGUgbG9jYXRvciBhdCB0aGUgc3R1ZHkgbGV2ZWwgcHJvdmlkZSBhIG1lYW5zIG9mIHJldHJpZXZpbmcgdGhlIGVudGlyZSBzdHVkeS5cclxuICAgKi9cclxuICBwdWJsaWMgc3R1ZHk6IGZoaXIuSW1hZ2luZ09iamVjdFNlbGVjdGlvblN0dWR5W107XHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciBmb3IgSW1hZ2luZ09iamVjdFNlbGVjdGlvbiAtIGluaXRpYWxpemVzIGFueSByZXF1aXJlZCBlbGVtZW50cyB0byBudWxsIGlmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTpQYXJ0aWFsPEltYWdpbmdPYmplY3RTZWxlY3Rpb25BcmdzPiA9IHt9LCBvcHRpb25zOmZoaXIuRmhpckNvbnN0cnVjdG9yT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihzb3VyY2UsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5yZXNvdXJjZVR5cGUgPSAnSW1hZ2luZ09iamVjdFNlbGVjdGlvbic7XHJcbiAgICBpZiAoc291cmNlWyd1aWQnXSkgeyB0aGlzLnVpZCA9IG5ldyBmaGlyLkZoaXJPaWQoe3ZhbHVlOiBzb3VyY2UudWlkfSk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnVpZCA9IG51bGw7IH1cclxuICAgIGlmIChzb3VyY2VbJ191aWQnXSkge1xyXG4gICAgICBpZiAodGhpcy51aWQpIHsgdGhpcy51aWQuYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fdWlkISk7IH1cclxuICAgICAgZWxzZSB7IHRoaXMudWlkID0gbmV3IGZoaXIuRmhpck9pZChzb3VyY2UuX3VpZCBhcyBQYXJ0aWFsPGZoaXIuRmhpck9pZEFyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsncGF0aWVudCddKSB7IHRoaXMucGF0aWVudCA9IG5ldyBmaGlyLlJlZmVyZW5jZShzb3VyY2UucGF0aWVudCk7IH1cclxuICAgIGVsc2UgeyB0aGlzLnBhdGllbnQgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWyd0aXRsZSddKSB7IHRoaXMudGl0bGUgPSBuZXcgZmhpci5Db2RlYWJsZUNvbmNlcHQoc291cmNlLnRpdGxlKTsgfVxyXG4gICAgZWxzZSB7IHRoaXMudGl0bGUgPSBudWxsOyB9XHJcbiAgICBpZiAoc291cmNlWydkZXNjcmlwdGlvbiddKSB7IHRoaXMuZGVzY3JpcHRpb24gPSBuZXcgZmhpci5GaGlyU3RyaW5nKHt2YWx1ZTogc291cmNlLmRlc2NyaXB0aW9ufSk7IH1cclxuICAgIGlmIChzb3VyY2VbJ19kZXNjcmlwdGlvbiddKSB7XHJcbiAgICAgIGlmICh0aGlzLmRlc2NyaXB0aW9uKSB7IHRoaXMuZGVzY3JpcHRpb24uYWRkRXh0ZW5kZWRQcm9wZXJ0aWVzKHNvdXJjZS5fZGVzY3JpcHRpb24hKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5kZXNjcmlwdGlvbiA9IG5ldyBmaGlyLkZoaXJTdHJpbmcoc291cmNlLl9kZXNjcmlwdGlvbiBhcyBQYXJ0aWFsPGZoaXIuRmhpclN0cmluZ0FyZ3M+KTsgfVxyXG4gICAgfVxyXG4gICAgaWYgKHNvdXJjZVsnYXV0aG9yJ10pIHsgdGhpcy5hdXRob3IgPSBuZXcgZmhpci5SZWZlcmVuY2Uoc291cmNlLmF1dGhvcik7IH1cclxuICAgIGlmIChzb3VyY2VbJ2F1dGhvcmluZ1RpbWUnXSkgeyB0aGlzLmF1dGhvcmluZ1RpbWUgPSBuZXcgZmhpci5GaGlyRGF0ZVRpbWUoe3ZhbHVlOiBzb3VyY2UuYXV0aG9yaW5nVGltZX0pOyB9XHJcbiAgICBpZiAoc291cmNlWydfYXV0aG9yaW5nVGltZSddKSB7XHJcbiAgICAgIGlmICh0aGlzLmF1dGhvcmluZ1RpbWUpIHsgdGhpcy5hdXRob3JpbmdUaW1lLmFkZEV4dGVuZGVkUHJvcGVydGllcyhzb3VyY2UuX2F1dGhvcmluZ1RpbWUhKTsgfVxyXG4gICAgICBlbHNlIHsgdGhpcy5hdXRob3JpbmdUaW1lID0gbmV3IGZoaXIuRmhpckRhdGVUaW1lKHNvdXJjZS5fYXV0aG9yaW5nVGltZSBhcyBQYXJ0aWFsPGZoaXIuRmhpckRhdGVUaW1lQXJncz4pOyB9XHJcbiAgICB9XHJcbiAgICBpZiAoc291cmNlWydzdHVkeSddKSB7IHRoaXMuc3R1ZHkgPSBzb3VyY2Uuc3R1ZHkubWFwKCh4KSA9PiBuZXcgZmhpci5JbWFnaW5nT2JqZWN0U2VsZWN0aW9uU3R1ZHkoeCkpOyB9XHJcbiAgICBlbHNlIHsgdGhpcy5zdHVkeSA9IFtdOyB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBlcmZvcm0gYmFzaWMgbW9kZWwgdmFsaWRhdGlvbiAoZS5nLiwgY2hlY2sgaWYgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkb01vZGVsVmFsaWRhdGlvbihleHA6c3RyaW5nID0gJycpOmZoaXIuRnRzSXNzdWVbXSB7XHJcbiAgICBsZXQgaXNzdWVzOmZoaXIuRnRzSXNzdWVbXSA9IHN1cGVyLmRvTW9kZWxWYWxpZGF0aW9uKGV4cCk7XHJcbiAgICBpZiAoZXhwID09PSAnJykgeyBleHAgPSAnSW1hZ2luZ09iamVjdFNlbGVjdGlvbicgfVxyXG4gICAgdGhpcy52UlMoJ3Jlc291cmNlVHlwZScsZXhwKVxyXG4gICAgdGhpcy52UlMoJ3VpZCcsZXhwKVxyXG4gICAgdGhpcy52UlMoJ3BhdGllbnQnLGV4cClcclxuICAgIHRoaXMudlJTKCd0aXRsZScsZXhwKVxyXG4gICAgdGhpcy52T1MoJ2Rlc2NyaXB0aW9uJyxleHApXHJcbiAgICB0aGlzLnZPUygnYXV0aG9yJyxleHApXHJcbiAgICB0aGlzLnZPUygnYXV0aG9yaW5nVGltZScsZXhwKVxyXG4gICAgdGhpcy52UkEoJ3N0dWR5JyxleHApXHJcbiAgICByZXR1cm4gaXNzdWVzO1xyXG4gIH1cclxufVxyXG4iXX0=